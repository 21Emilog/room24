{"ast":null,"code":"import React,{useState,useRef}from'react';import{X,Camera,Upload,Crop,Move,Trash2,Check}from'lucide-react';import{compressImage}from'../utils/imageCompression';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";export default function PhotoEditor(_ref){let{photos,onPhotosChange,onClose,maxPhotos=5}=_ref;const[editingIndex,setEditingIndex]=useState(null);const[cropData,setCropData]=useState(null);const fileInputRef=useRef(null);const cameraInputRef=useRef(null);const canvasRef=useRef(null);const handleAddPhotos=async e=>{const files=Array.from(e.target.files||[]);if(files.length+photos.length>maxPhotos){alert(\"Maximum \".concat(maxPhotos,\" photos allowed\"));return;}try{// Compress images\nconst compressed=await Promise.all(files.map(file=>compressImage(file,{maxWidth:1200,maxHeight:1200,quality:0.8,maxSizeKB:500})));onPhotosChange([...photos,...compressed]);}catch(err){console.error('Compression failed, falling back to direct load:',err);// Fallback: load without compression\nconst readers=files.map(file=>new Promise(resolve=>{const reader=new FileReader();reader.onload=ev=>resolve(ev.target.result);reader.readAsDataURL(file);}));const images=await Promise.all(readers);onPhotosChange([...photos,...images]);}};const handleReorder=(fromIndex,toIndex)=>{const newPhotos=[...photos];const[moved]=newPhotos.splice(fromIndex,1);newPhotos.splice(toIndex,0,moved);onPhotosChange(newPhotos);};const handleDelete=index=>{if(window.confirm('Delete this photo?')){onPhotosChange(photos.filter((_,i)=>i!==index));if(editingIndex===index)setEditingIndex(null);}};const startCrop=index=>{setEditingIndex(index);setCropData({x:0,y:0,width:100,height:100});};const applyCrop=()=>{if(editingIndex===null||!cropData)return;const img=new Image();img.onload=()=>{const canvas=canvasRef.current;if(!canvas)return;// Calculate crop dimensions (cropData is in percentages)\nconst cropX=cropData.x/100*img.width;const cropY=cropData.y/100*img.height;const cropWidth=cropData.width/100*img.width;const cropHeight=cropData.height/100*img.height;canvas.width=cropWidth;canvas.height=cropHeight;const ctx=canvas.getContext('2d');ctx.drawImage(img,cropX,cropY,cropWidth,cropHeight,0,0,cropWidth,cropHeight);const croppedDataUrl=canvas.toDataURL('image/jpeg',0.9);const newPhotos=[...photos];newPhotos[editingIndex]=croppedDataUrl;onPhotosChange(newPhotos);setEditingIndex(null);setCropData(null);};img.src=photos[editingIndex];};return/*#__PURE__*/_jsx(\"div\",{className:\"fixed inset-0 bg-black/60 backdrop-blur-sm flex items-center justify-center p-4 z-50 animate-fadeIn\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white rounded-2xl max-w-3xl w-full max-h-[90vh] overflow-y-auto shadow-2xl border border-gray-100\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"sticky top-0 bg-gradient-to-r from-teal-600 to-cyan-600 p-4 flex justify-between items-center z-10 rounded-t-2xl\",children:[/*#__PURE__*/_jsxs(\"h2\",{className:\"text-lg font-bold text-white flex items-center gap-2\",children:[/*#__PURE__*/_jsx(Camera,{className:\"w-5 h-5\"}),\"Manage Photos\"]}),/*#__PURE__*/_jsx(\"button\",{onClick:onClose,className:\"text-white/80 hover:text-white hover:bg-white/20 p-1.5 rounded-lg transition-all duration-200 hover:scale-110 active:scale-95\",children:/*#__PURE__*/_jsx(X,{className:\"w-5 h-5\"})})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"p-4\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex flex-wrap gap-2 mb-4\",children:[/*#__PURE__*/_jsxs(\"button\",{onClick:()=>{var _fileInputRef$current;return(_fileInputRef$current=fileInputRef.current)===null||_fileInputRef$current===void 0?void 0:_fileInputRef$current.click();},disabled:photos.length>=maxPhotos,className:\"flex items-center gap-2 px-4 py-2.5 bg-gradient-to-r from-teal-500 to-teal-600 text-white rounded-xl hover:from-teal-600 hover:to-teal-700 disabled:opacity-50 disabled:cursor-not-allowed transition-all duration-200 hover:scale-105 hover:shadow-lg hover:shadow-teal-500/25 active:scale-95 font-medium\",children:[/*#__PURE__*/_jsx(Upload,{className:\"w-4 h-4\"}),\"Upload Photos\"]}),/*#__PURE__*/_jsxs(\"button\",{onClick:()=>{var _cameraInputRef$curre;return(_cameraInputRef$curre=cameraInputRef.current)===null||_cameraInputRef$curre===void 0?void 0:_cameraInputRef$curre.click();},disabled:photos.length>=maxPhotos,className:\"flex items-center gap-2 px-4 py-2.5 bg-gradient-to-r from-blue-500 to-blue-600 text-white rounded-xl hover:from-blue-600 hover:to-blue-700 disabled:opacity-50 disabled:cursor-not-allowed transition-all duration-200 hover:scale-105 hover:shadow-lg hover:shadow-blue-500/25 active:scale-95 font-medium\",children:[/*#__PURE__*/_jsx(Camera,{className:\"w-4 h-4\"}),\"Take Photo\"]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center gap-1 px-3 py-2 bg-gray-100 rounded-xl\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"text-sm font-semibold text-gray-700\",children:photos.length}),/*#__PURE__*/_jsx(\"span\",{className:\"text-sm text-gray-400\",children:\"/\"}),/*#__PURE__*/_jsx(\"span\",{className:\"text-sm text-gray-500\",children:maxPhotos})]})]}),/*#__PURE__*/_jsx(\"input\",{ref:fileInputRef,type:\"file\",accept:\"image/*\",multiple:true,onChange:handleAddPhotos,className:\"hidden\"}),/*#__PURE__*/_jsx(\"input\",{ref:cameraInputRef,type:\"file\",accept:\"image/*\",capture:\"environment\",onChange:handleAddPhotos,className:\"hidden\"}),photos.length===0?/*#__PURE__*/_jsxs(\"div\",{className:\"text-center py-12 bg-gradient-to-br from-gray-50 to-teal-50 rounded-2xl border-2 border-dashed border-gray-200\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"w-20 h-20 mx-auto mb-4 bg-gradient-to-br from-teal-100 to-cyan-100 rounded-full flex items-center justify-center\",children:/*#__PURE__*/_jsx(Camera,{className:\"w-10 h-10 text-teal-500\"})}),/*#__PURE__*/_jsx(\"p\",{className:\"text-gray-600 font-medium mb-1\",children:\"No photos yet\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-sm text-gray-400\",children:\"Upload or take photos to showcase your property\"})]}):/*#__PURE__*/_jsx(\"div\",{className:\"grid grid-cols-2 sm:grid-cols-3 gap-4\",children:photos.map((photo,index)=>/*#__PURE__*/_jsxs(\"div\",{className:\"relative group rounded-xl overflow-hidden shadow-md hover:shadow-xl transition-all duration-300\",children:[index===0&&/*#__PURE__*/_jsxs(\"div\",{className:\"absolute top-2 left-2 bg-gradient-to-r from-blue-500 to-indigo-500 text-white text-xs px-2.5 py-1 rounded-full font-bold z-10 shadow-lg flex items-center gap-1\",children:[/*#__PURE__*/_jsx(\"span\",{children:\"\\u2B50\"}),\" Cover\"]}),/*#__PURE__*/_jsx(\"img\",{src:photo,alt:\"Property \".concat(index+1),className:\"w-full h-40 object-cover group-hover:scale-105 transition-transform duration-300\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"absolute inset-0 bg-black bg-opacity-0 group-hover:bg-opacity-40 transition rounded-lg flex items-center justify-center gap-2\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:()=>startCrop(index),className:\"opacity-0 group-hover:opacity-100 transition p-2 bg-white rounded-full hover:bg-gray-100\",title:\"Crop\",children:/*#__PURE__*/_jsx(Crop,{className:\"w-4 h-4 text-gray-700\"})}),index>0&&/*#__PURE__*/_jsx(\"button\",{onClick:()=>handleReorder(index,index-1),className:\"opacity-0 group-hover:opacity-100 transition p-2 bg-white rounded-full hover:bg-gray-100\",title:\"Move left\",children:/*#__PURE__*/_jsx(Move,{className:\"w-4 h-4 text-gray-700 rotate-180\"})}),index<photos.length-1&&/*#__PURE__*/_jsx(\"button\",{onClick:()=>handleReorder(index,index+1),className:\"opacity-0 group-hover:opacity-100 transition p-2 bg-white rounded-full hover:bg-gray-100\",title:\"Move right\",children:/*#__PURE__*/_jsx(Move,{className:\"w-4 h-4 text-gray-700\"})}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>handleDelete(index),className:\"opacity-0 group-hover:opacity-100 transition p-2 bg-red-600 rounded-full hover:bg-red-700\",title:\"Delete\",children:/*#__PURE__*/_jsx(Trash2,{className:\"w-4 h-4 text-white\"})})]})]},index))}),editingIndex!==null&&/*#__PURE__*/_jsx(\"div\",{className:\"fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center p-4 z-50\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white rounded-lg max-w-2xl w-full p-4\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-between items-center mb-4\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"text-lg font-bold\",children:\"Crop Photo\"}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>{setEditingIndex(null);setCropData(null);},className:\"text-gray-500 hover:text-gray-700\",children:/*#__PURE__*/_jsx(X,{className:\"w-5 h-5\"})})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"relative\",children:[/*#__PURE__*/_jsx(\"img\",{src:photos[editingIndex],alt:\"Crop preview\",className:\"w-full max-h-96 object-contain\"}),/*#__PURE__*/_jsx(\"div\",{className:\"mt-4 text-sm text-gray-600 text-center\",children:/*#__PURE__*/_jsx(\"p\",{children:\"Drag to adjust crop area (simplified preview)\"})})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex gap-2 mt-4\",children:[/*#__PURE__*/_jsxs(\"button\",{onClick:applyCrop,className:\"flex-1 flex items-center justify-center gap-2 px-4 py-2 bg-green-600 text-white rounded-md hover:bg-green-700\",children:[/*#__PURE__*/_jsx(Check,{className:\"w-4 h-4\"}),\"Apply Crop\"]}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>{setEditingIndex(null);setCropData(null);},className:\"px-4 py-2 border border-gray-300 text-gray-700 rounded-md hover:bg-gray-50\",children:\"Cancel\"})]})]})}),/*#__PURE__*/_jsx(\"canvas\",{ref:canvasRef,className:\"hidden\"})]})]})});}","map":{"version":3,"names":["React","useState","useRef","X","Camera","Upload","Crop","Move","Trash2","Check","compressImage","jsx","_jsx","jsxs","_jsxs","PhotoEditor","_ref","photos","onPhotosChange","onClose","maxPhotos","editingIndex","setEditingIndex","cropData","setCropData","fileInputRef","cameraInputRef","canvasRef","handleAddPhotos","e","files","Array","from","target","length","alert","concat","compressed","Promise","all","map","file","maxWidth","maxHeight","quality","maxSizeKB","err","console","error","readers","resolve","reader","FileReader","onload","ev","result","readAsDataURL","images","handleReorder","fromIndex","toIndex","newPhotos","moved","splice","handleDelete","index","window","confirm","filter","_","i","startCrop","x","y","width","height","applyCrop","img","Image","canvas","current","cropX","cropY","cropWidth","cropHeight","ctx","getContext","drawImage","croppedDataUrl","toDataURL","src","className","children","onClick","_fileInputRef$current","click","disabled","_cameraInputRef$curre","ref","type","accept","multiple","onChange","capture","photo","alt","title"],"sources":["C:/Users/kutum/Documents/room-rental-platform/src/components/PhotoEditor.jsx"],"sourcesContent":["import React, { useState, useRef } from 'react';\r\nimport { X, Camera, Upload, Crop, Move, Trash2, Check } from 'lucide-react';\r\nimport { compressImage } from '../utils/imageCompression';\r\n\r\nexport default function PhotoEditor({ photos, onPhotosChange, onClose, maxPhotos = 5 }) {\r\n  const [editingIndex, setEditingIndex] = useState(null);\r\n  const [cropData, setCropData] = useState(null);\r\n  const fileInputRef = useRef(null);\r\n  const cameraInputRef = useRef(null);\r\n  const canvasRef = useRef(null);\r\n\r\n  const handleAddPhotos = async (e) => {\r\n    const files = Array.from(e.target.files || []);\r\n    if (files.length + photos.length > maxPhotos) {\r\n      alert(`Maximum ${maxPhotos} photos allowed`);\r\n      return;\r\n    }\r\n    \r\n    try {\r\n      // Compress images\r\n      const compressed = await Promise.all(\r\n        files.map(file => compressImage(file, { maxWidth: 1200, maxHeight: 1200, quality: 0.8, maxSizeKB: 500 }))\r\n      );\r\n      onPhotosChange([...photos, ...compressed]);\r\n    } catch (err) {\r\n      console.error('Compression failed, falling back to direct load:', err);\r\n      // Fallback: load without compression\r\n      const readers = files.map(file => new Promise((resolve) => {\r\n        const reader = new FileReader();\r\n        reader.onload = (ev) => resolve(ev.target.result);\r\n        reader.readAsDataURL(file);\r\n      }));\r\n      const images = await Promise.all(readers);\r\n      onPhotosChange([...photos, ...images]);\r\n    }\r\n  };\r\n\r\n  const handleReorder = (fromIndex, toIndex) => {\r\n    const newPhotos = [...photos];\r\n    const [moved] = newPhotos.splice(fromIndex, 1);\r\n    newPhotos.splice(toIndex, 0, moved);\r\n    onPhotosChange(newPhotos);\r\n  };\r\n\r\n  const handleDelete = (index) => {\r\n    if (window.confirm('Delete this photo?')) {\r\n      onPhotosChange(photos.filter((_, i) => i !== index));\r\n      if (editingIndex === index) setEditingIndex(null);\r\n    }\r\n  };\r\n\r\n  const startCrop = (index) => {\r\n    setEditingIndex(index);\r\n    setCropData({\r\n      x: 0,\r\n      y: 0,\r\n      width: 100,\r\n      height: 100,\r\n    });\r\n  };\r\n\r\n  const applyCrop = () => {\r\n    if (editingIndex === null || !cropData) return;\r\n    \r\n    const img = new Image();\r\n    img.onload = () => {\r\n      const canvas = canvasRef.current;\r\n      if (!canvas) return;\r\n      \r\n      // Calculate crop dimensions (cropData is in percentages)\r\n      const cropX = (cropData.x / 100) * img.width;\r\n      const cropY = (cropData.y / 100) * img.height;\r\n      const cropWidth = (cropData.width / 100) * img.width;\r\n      const cropHeight = (cropData.height / 100) * img.height;\r\n      \r\n      canvas.width = cropWidth;\r\n      canvas.height = cropHeight;\r\n      \r\n      const ctx = canvas.getContext('2d');\r\n      ctx.drawImage(\r\n        img,\r\n        cropX, cropY, cropWidth, cropHeight,\r\n        0, 0, cropWidth, cropHeight\r\n      );\r\n      \r\n      const croppedDataUrl = canvas.toDataURL('image/jpeg', 0.9);\r\n      const newPhotos = [...photos];\r\n      newPhotos[editingIndex] = croppedDataUrl;\r\n      onPhotosChange(newPhotos);\r\n      setEditingIndex(null);\r\n      setCropData(null);\r\n    };\r\n    img.src = photos[editingIndex];\r\n  };\r\n\r\n  return (\r\n    <div className=\"fixed inset-0 bg-black/60 backdrop-blur-sm flex items-center justify-center p-4 z-50 animate-fadeIn\">\r\n      <div className=\"bg-white rounded-2xl max-w-3xl w-full max-h-[90vh] overflow-y-auto shadow-2xl border border-gray-100\">\r\n        <div className=\"sticky top-0 bg-gradient-to-r from-teal-600 to-cyan-600 p-4 flex justify-between items-center z-10 rounded-t-2xl\">\r\n          <h2 className=\"text-lg font-bold text-white flex items-center gap-2\">\r\n            <Camera className=\"w-5 h-5\" />\r\n            Manage Photos\r\n          </h2>\r\n          <button \r\n            onClick={onClose} \r\n            className=\"text-white/80 hover:text-white hover:bg-white/20 p-1.5 rounded-lg transition-all duration-200 hover:scale-110 active:scale-95\"\r\n          >\r\n            <X className=\"w-5 h-5\" />\r\n          </button>\r\n        </div>\r\n\r\n        <div className=\"p-4\">\r\n          {/* Add Photo Buttons */}\r\n          <div className=\"flex flex-wrap gap-2 mb-4\">\r\n            <button\r\n              onClick={() => fileInputRef.current?.click()}\r\n              disabled={photos.length >= maxPhotos}\r\n              className=\"flex items-center gap-2 px-4 py-2.5 bg-gradient-to-r from-teal-500 to-teal-600 text-white rounded-xl hover:from-teal-600 hover:to-teal-700 disabled:opacity-50 disabled:cursor-not-allowed transition-all duration-200 hover:scale-105 hover:shadow-lg hover:shadow-teal-500/25 active:scale-95 font-medium\"\r\n            >\r\n              <Upload className=\"w-4 h-4\" />\r\n              Upload Photos\r\n            </button>\r\n            <button\r\n              onClick={() => cameraInputRef.current?.click()}\r\n              disabled={photos.length >= maxPhotos}\r\n              className=\"flex items-center gap-2 px-4 py-2.5 bg-gradient-to-r from-blue-500 to-blue-600 text-white rounded-xl hover:from-blue-600 hover:to-blue-700 disabled:opacity-50 disabled:cursor-not-allowed transition-all duration-200 hover:scale-105 hover:shadow-lg hover:shadow-blue-500/25 active:scale-95 font-medium\"\r\n            >\r\n              <Camera className=\"w-4 h-4\" />\r\n              Take Photo\r\n            </button>\r\n            <div className=\"flex items-center gap-1 px-3 py-2 bg-gray-100 rounded-xl\">\r\n              <span className=\"text-sm font-semibold text-gray-700\">{photos.length}</span>\r\n              <span className=\"text-sm text-gray-400\">/</span>\r\n              <span className=\"text-sm text-gray-500\">{maxPhotos}</span>\r\n            </div>\r\n          </div>\r\n\r\n          <input\r\n            ref={fileInputRef}\r\n            type=\"file\"\r\n            accept=\"image/*\"\r\n            multiple\r\n            onChange={handleAddPhotos}\r\n            className=\"hidden\"\r\n          />\r\n          <input\r\n            ref={cameraInputRef}\r\n            type=\"file\"\r\n            accept=\"image/*\"\r\n            capture=\"environment\"\r\n            onChange={handleAddPhotos}\r\n            className=\"hidden\"\r\n          />\r\n\r\n          {/* Photo Grid */}\r\n          {photos.length === 0 ? (\r\n            <div className=\"text-center py-12 bg-gradient-to-br from-gray-50 to-teal-50 rounded-2xl border-2 border-dashed border-gray-200\">\r\n              <div className=\"w-20 h-20 mx-auto mb-4 bg-gradient-to-br from-teal-100 to-cyan-100 rounded-full flex items-center justify-center\">\r\n                <Camera className=\"w-10 h-10 text-teal-500\" />\r\n              </div>\r\n              <p className=\"text-gray-600 font-medium mb-1\">No photos yet</p>\r\n              <p className=\"text-sm text-gray-400\">Upload or take photos to showcase your property</p>\r\n            </div>\r\n          ) : (\r\n            <div className=\"grid grid-cols-2 sm:grid-cols-3 gap-4\">\r\n              {photos.map((photo, index) => (\r\n                <div key={index} className=\"relative group rounded-xl overflow-hidden shadow-md hover:shadow-xl transition-all duration-300\">\r\n                  {index === 0 && (\r\n                    <div className=\"absolute top-2 left-2 bg-gradient-to-r from-blue-500 to-indigo-500 text-white text-xs px-2.5 py-1 rounded-full font-bold z-10 shadow-lg flex items-center gap-1\">\r\n                      <span>‚≠ê</span> Cover\r\n                    </div>\r\n                  )}\r\n                  <img\r\n                    src={photo}\r\n                    alt={`Property ${index + 1}`}\r\n                    className=\"w-full h-40 object-cover group-hover:scale-105 transition-transform duration-300\"\r\n                  />\r\n                  \r\n                  {/* Action Buttons */}\r\n                  <div className=\"absolute inset-0 bg-black bg-opacity-0 group-hover:bg-opacity-40 transition rounded-lg flex items-center justify-center gap-2\">\r\n                    <button\r\n                      onClick={() => startCrop(index)}\r\n                      className=\"opacity-0 group-hover:opacity-100 transition p-2 bg-white rounded-full hover:bg-gray-100\"\r\n                      title=\"Crop\"\r\n                    >\r\n                      <Crop className=\"w-4 h-4 text-gray-700\" />\r\n                    </button>\r\n                    {index > 0 && (\r\n                      <button\r\n                        onClick={() => handleReorder(index, index - 1)}\r\n                        className=\"opacity-0 group-hover:opacity-100 transition p-2 bg-white rounded-full hover:bg-gray-100\"\r\n                        title=\"Move left\"\r\n                      >\r\n                        <Move className=\"w-4 h-4 text-gray-700 rotate-180\" />\r\n                      </button>\r\n                    )}\r\n                    {index < photos.length - 1 && (\r\n                      <button\r\n                        onClick={() => handleReorder(index, index + 1)}\r\n                        className=\"opacity-0 group-hover:opacity-100 transition p-2 bg-white rounded-full hover:bg-gray-100\"\r\n                        title=\"Move right\"\r\n                      >\r\n                        <Move className=\"w-4 h-4 text-gray-700\" />\r\n                      </button>\r\n                    )}\r\n                    <button\r\n                      onClick={() => handleDelete(index)}\r\n                      className=\"opacity-0 group-hover:opacity-100 transition p-2 bg-red-600 rounded-full hover:bg-red-700\"\r\n                      title=\"Delete\"\r\n                    >\r\n                      <Trash2 className=\"w-4 h-4 text-white\" />\r\n                    </button>\r\n                  </div>\r\n                </div>\r\n              ))}\r\n            </div>\r\n          )}\r\n\r\n          {/* Crop Modal */}\r\n          {editingIndex !== null && (\r\n            <div className=\"fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center p-4 z-50\">\r\n              <div className=\"bg-white rounded-lg max-w-2xl w-full p-4\">\r\n                <div className=\"flex justify-between items-center mb-4\">\r\n                  <h3 className=\"text-lg font-bold\">Crop Photo</h3>\r\n                  <button\r\n                    onClick={() => {\r\n                      setEditingIndex(null);\r\n                      setCropData(null);\r\n                    }}\r\n                    className=\"text-gray-500 hover:text-gray-700\"\r\n                  >\r\n                    <X className=\"w-5 h-5\" />\r\n                  </button>\r\n                </div>\r\n                \r\n                <div className=\"relative\">\r\n                  <img\r\n                    src={photos[editingIndex]}\r\n                    alt=\"Crop preview\"\r\n                    className=\"w-full max-h-96 object-contain\"\r\n                  />\r\n                  <div className=\"mt-4 text-sm text-gray-600 text-center\">\r\n                    <p>Drag to adjust crop area (simplified preview)</p>\r\n                  </div>\r\n                </div>\r\n\r\n                <div className=\"flex gap-2 mt-4\">\r\n                  <button\r\n                    onClick={applyCrop}\r\n                    className=\"flex-1 flex items-center justify-center gap-2 px-4 py-2 bg-green-600 text-white rounded-md hover:bg-green-700\"\r\n                  >\r\n                    <Check className=\"w-4 h-4\" />\r\n                    Apply Crop\r\n                  </button>\r\n                  <button\r\n                    onClick={() => {\r\n                      setEditingIndex(null);\r\n                      setCropData(null);\r\n                    }}\r\n                    className=\"px-4 py-2 border border-gray-300 text-gray-700 rounded-md hover:bg-gray-50\"\r\n                  >\r\n                    Cancel\r\n                  </button>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          )}\r\n\r\n          <canvas ref={canvasRef} className=\"hidden\" />\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}