{"ast":null,"code":"import _objectSpread from \"C:/Users/kutum/Documents/room-rental-platform/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";\nimport * as React from 'react';\nimport { useContext, useEffect, useMemo, useState, useRef, cloneElement } from 'react';\nimport { MapContext } from \"./map.js\";\nimport assert from \"../utils/assert.js\";\nimport { deepEqual } from \"../utils/deep-equal.js\";\nlet sourceCounter = 0;\nfunction createSource(map, id, props) {\n  // @ts-ignore\n  if (map.style && map.style._loaded) {\n    const options = _objectSpread({}, props);\n    delete options.id;\n    delete options.children;\n    // @ts-ignore\n    map.addSource(id, options);\n    return map.getSource(id);\n  }\n  return null;\n}\n/* eslint-disable complexity */\nfunction updateSource(source, props, prevProps) {\n  var _source$setCoordinate, _source$setUrl, _source$setTiles;\n  assert(props.id === prevProps.id, 'source id changed');\n  assert(props.type === prevProps.type, 'source type changed');\n  let changedKey = '';\n  let changedKeyCount = 0;\n  for (const key in props) {\n    if (key !== 'children' && key !== 'id' && !deepEqual(prevProps[key], props[key])) {\n      changedKey = key;\n      changedKeyCount++;\n    }\n  }\n  if (!changedKeyCount) {\n    return;\n  }\n  const type = props.type;\n  if (type === 'geojson') {\n    source.setData(props.data);\n  } else if (type === 'image') {\n    source.updateImage({\n      url: props.url,\n      coordinates: props.coordinates\n    });\n  } else {\n    switch (changedKey) {\n      case 'coordinates':\n        // @ts-ignore\n        (_source$setCoordinate = source.setCoordinates) === null || _source$setCoordinate === void 0 || _source$setCoordinate.call(source, props.coordinates);\n        break;\n      case 'url':\n        // @ts-ignore\n        (_source$setUrl = source.setUrl) === null || _source$setUrl === void 0 || _source$setUrl.call(source, props.url);\n        break;\n      case 'tiles':\n        // @ts-ignore\n        (_source$setTiles = source.setTiles) === null || _source$setTiles === void 0 || _source$setTiles.call(source, props.tiles);\n        break;\n      default:\n        // eslint-disable-next-line\n        console.warn(\"Unable to update <Source> prop: \".concat(changedKey));\n    }\n  }\n}\n/* eslint-enable complexity */\nexport function Source(props) {\n  const map = useContext(MapContext).map.getMap();\n  const propsRef = useRef(props);\n  const [, setStyleLoaded] = useState(0);\n  const id = useMemo(() => props.id || \"jsx-source-\".concat(sourceCounter++), []);\n  useEffect(() => {\n    if (map) {\n      /* global setTimeout */\n      const forceUpdate = () => setTimeout(() => setStyleLoaded(version => version + 1), 0);\n      map.on('styledata', forceUpdate);\n      forceUpdate();\n      return () => {\n        map.off('styledata', forceUpdate);\n        // @ts-ignore\n        if (map.style && map.style._loaded && map.getSource(id)) {\n          var _map$getStyle;\n          // Parent effects are destroyed before child ones, see\n          // https://github.com/facebook/react/issues/16728\n          // Source can only be removed after all child layers are removed\n          const allLayers = (_map$getStyle = map.getStyle()) === null || _map$getStyle === void 0 ? void 0 : _map$getStyle.layers;\n          if (allLayers) {\n            for (const layer of allLayers) {\n              // @ts-ignore (2339) source does not exist on all layer types\n              if (layer.source === id) {\n                map.removeLayer(layer.id);\n              }\n            }\n          }\n          map.removeSource(id);\n        }\n      };\n    }\n    return undefined;\n  }, [map]);\n  // @ts-ignore\n  let source = map && map.style && map.getSource(id);\n  if (source) {\n    updateSource(source, props, propsRef.current);\n  } else {\n    source = createSource(map, id, props);\n  }\n  propsRef.current = props;\n  return source && React.Children.map(props.children, child => child && cloneElement(child, {\n    source: id\n  })) || null;\n}","map":{"version":3,"names":["React","useContext","useEffect","useMemo","useState","useRef","cloneElement","MapContext","assert","deepEqual","sourceCounter","createSource","map","id","props","style","_loaded","options","_objectSpread","children","addSource","getSource","updateSource","source","prevProps","_source$setCoordinate","_source$setUrl","_source$setTiles","type","changedKey","changedKeyCount","key","setData","data","updateImage","url","coordinates","setCoordinates","call","setUrl","setTiles","tiles","console","warn","concat","Source","getMap","propsRef","setStyleLoaded","forceUpdate","setTimeout","version","on","off","_map$getStyle","allLayers","getStyle","layers","layer","removeLayer","removeSource","undefined","current","Children","child"],"sources":["C:\\Users\\kutum\\Documents\\room-rental-platform\\node_modules\\@vis.gl\\react-maplibre\\src\\components\\source.ts"],"sourcesContent":["import * as React from 'react';\nimport {useContext, useEffect, useMemo, useState, useRef, cloneElement} from 'react';\nimport {MapContext} from './map';\nimport assert from '../utils/assert';\nimport {deepEqual} from '../utils/deep-equal';\n\nimport type {\n  GeoJSONSourceImplementation,\n  ImageSourceImplementation,\n  AnySourceImplementation\n} from '../types/internal';\nimport type {SourceSpecification} from '../types/style-spec';\nimport type {MapInstance} from '../types/lib';\n\nexport type SourceProps = SourceSpecification & {\n  id?: string;\n  children?: any;\n};\n\nlet sourceCounter = 0;\n\nfunction createSource(map: MapInstance, id: string, props: SourceProps) {\n  // @ts-ignore\n  if (map.style && map.style._loaded) {\n    const options = {...props};\n    delete options.id;\n    delete options.children;\n    // @ts-ignore\n    map.addSource(id, options);\n    return map.getSource(id);\n  }\n  return null;\n}\n\n/* eslint-disable complexity */\nfunction updateSource(source: AnySourceImplementation, props: SourceProps, prevProps: SourceProps) {\n  assert(props.id === prevProps.id, 'source id changed');\n  assert(props.type === prevProps.type, 'source type changed');\n\n  let changedKey = '';\n  let changedKeyCount = 0;\n\n  for (const key in props) {\n    if (key !== 'children' && key !== 'id' && !deepEqual(prevProps[key], props[key])) {\n      changedKey = key;\n      changedKeyCount++;\n    }\n  }\n\n  if (!changedKeyCount) {\n    return;\n  }\n\n  const type = props.type;\n\n  if (type === 'geojson') {\n    (source as GeoJSONSourceImplementation).setData(props.data);\n  } else if (type === 'image') {\n    (source as ImageSourceImplementation).updateImage({\n      url: props.url,\n      coordinates: props.coordinates\n    });\n  } else {\n    switch (changedKey) {\n      case 'coordinates':\n        // @ts-ignore\n        source.setCoordinates?.(props.coordinates);\n        break;\n      case 'url':\n        // @ts-ignore\n        source.setUrl?.(props.url);\n        break;\n      case 'tiles':\n        // @ts-ignore\n        source.setTiles?.(props.tiles);\n        break;\n      default:\n        // eslint-disable-next-line\n        console.warn(`Unable to update <Source> prop: ${changedKey}`);\n    }\n  }\n}\n/* eslint-enable complexity */\n\nexport function Source(props: SourceProps) {\n  const map = useContext(MapContext).map.getMap();\n  const propsRef = useRef(props);\n  const [, setStyleLoaded] = useState(0);\n\n  const id = useMemo(() => props.id || `jsx-source-${sourceCounter++}`, []);\n\n  useEffect(() => {\n    if (map) {\n      /* global setTimeout */\n      const forceUpdate = () => setTimeout(() => setStyleLoaded(version => version + 1), 0);\n      map.on('styledata', forceUpdate);\n      forceUpdate();\n\n      return () => {\n        map.off('styledata', forceUpdate);\n        // @ts-ignore\n        if (map.style && map.style._loaded && map.getSource(id)) {\n          // Parent effects are destroyed before child ones, see\n          // https://github.com/facebook/react/issues/16728\n          // Source can only be removed after all child layers are removed\n          const allLayers = map.getStyle()?.layers;\n          if (allLayers) {\n            for (const layer of allLayers) {\n              // @ts-ignore (2339) source does not exist on all layer types\n              if (layer.source === id) {\n                map.removeLayer(layer.id);\n              }\n            }\n          }\n          map.removeSource(id);\n        }\n      };\n    }\n    return undefined;\n  }, [map]);\n\n  // @ts-ignore\n  let source = map && map.style && map.getSource(id);\n  if (source) {\n    updateSource(source, props, propsRef.current);\n  } else {\n    source = createSource(map, id, props);\n  }\n  propsRef.current = props;\n\n  return (\n    (source &&\n      React.Children.map(\n        props.children,\n        child =>\n          child &&\n          cloneElement(child, {\n            source: id\n          })\n      )) ||\n    null\n  );\n}\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}