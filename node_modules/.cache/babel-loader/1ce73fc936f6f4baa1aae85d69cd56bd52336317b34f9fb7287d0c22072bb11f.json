{"ast":null,"code":"// Firebase client initialization for Room24\n// Replace placeholder environment variables with real Firebase project config.\n// Ensure you have added a web app in Firebase console and enabled Cloud Messaging.\nimport{initializeApp}from'firebase/app';import{getMessaging,getToken,onMessage}from'firebase/messaging';import{getAnalytics,logEvent}from'firebase/analytics';const firebaseConfig={apiKey:process.env.REACT_APP_FIREBASE_API_KEY,authDomain:process.env.REACT_APP_FIREBASE_AUTH_DOMAIN,projectId:process.env.REACT_APP_FIREBASE_PROJECT_ID,storageBucket:process.env.REACT_APP_FIREBASE_STORAGE_BUCKET,messagingSenderId:process.env.REACT_APP_FIREBASE_MESSAGING_SENDER_ID,appId:process.env.REACT_APP_FIREBASE_APP_ID,measurementId:process.env.REACT_APP_FIREBASE_MEASUREMENT_ID};let messagingInstance;let analyticsInstance;export function initFirebase(){const app=initializeApp(firebaseConfig);try{messagingInstance=getMessaging(app);}catch(e){console.warn('Messaging not available',e);}return app;}export function initAnalytics(app){if(process.env.REACT_APP_ENABLE_ANALYTICS!=='true')return;const consent=localStorage.getItem('analytics-consent');if(consent!=='yes')return;try{analyticsInstance=getAnalytics(app);console.log('Analytics initialized');}catch(e){console.warn('Analytics not available',e);}}export function trackEvent(eventName){let params=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};if(!analyticsInstance)return;try{logEvent(analyticsInstance,eventName,params);}catch(e){console.warn('Event tracking failed',e);}}// Request notification permission and fetch token\nexport async function requestFcmToken(){if(!messagingInstance)return null;const permission=await Notification.requestPermission();if(permission!=='granted'){console.log('Notification permission denied');return null;}try{const vapidKey=process.env.REACT_APP_FIREBASE_VAPID_KEY;// Public VAPID key\nconst currentToken=await getToken(messagingInstance,{vapidKey});if(currentToken){console.log('FCM token:',currentToken);// Persist token to backend if configured\ntry{const backend=process.env.REACT_APP_BACKEND_URL;if(backend){await fetch(\"\".concat(backend.replace(/\\/$/,''),\"/api/push/register\"),{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({token:currentToken})});}}catch(e){console.warn('Token persistence failed',e);}return currentToken;}else{console.log('No registration token available.');return null;}}catch(err){console.error('An error occurred while retrieving token.',err);return null;}}export function listenForegroundMessages(callback){if(!messagingInstance)return;onMessage(messagingInstance,payload=>{console.log('Foreground message received',payload);if(callback)callback(payload);});}","map":{"version":3,"names":["initializeApp","getMessaging","getToken","onMessage","getAnalytics","logEvent","firebaseConfig","apiKey","process","env","REACT_APP_FIREBASE_API_KEY","authDomain","REACT_APP_FIREBASE_AUTH_DOMAIN","projectId","REACT_APP_FIREBASE_PROJECT_ID","storageBucket","REACT_APP_FIREBASE_STORAGE_BUCKET","messagingSenderId","REACT_APP_FIREBASE_MESSAGING_SENDER_ID","appId","REACT_APP_FIREBASE_APP_ID","measurementId","REACT_APP_FIREBASE_MEASUREMENT_ID","messagingInstance","analyticsInstance","initFirebase","app","e","console","warn","initAnalytics","REACT_APP_ENABLE_ANALYTICS","consent","localStorage","getItem","log","trackEvent","eventName","params","arguments","length","undefined","requestFcmToken","permission","Notification","requestPermission","vapidKey","REACT_APP_FIREBASE_VAPID_KEY","currentToken","backend","REACT_APP_BACKEND_URL","fetch","concat","replace","method","headers","body","JSON","stringify","token","err","error","listenForegroundMessages","callback","payload"],"sources":["C:/Users/kutum/Documents/room-rental-platform/src/firebase.js"],"sourcesContent":["// Firebase client initialization for Room24\r\n// Replace placeholder environment variables with real Firebase project config.\r\n// Ensure you have added a web app in Firebase console and enabled Cloud Messaging.\r\n\r\nimport { initializeApp } from 'firebase/app';\r\nimport { getMessaging, getToken, onMessage } from 'firebase/messaging';\r\nimport { getAnalytics, logEvent } from 'firebase/analytics';\r\n\r\nconst firebaseConfig = {\r\n  apiKey: process.env.REACT_APP_FIREBASE_API_KEY,\r\n  authDomain: process.env.REACT_APP_FIREBASE_AUTH_DOMAIN,\r\n  projectId: process.env.REACT_APP_FIREBASE_PROJECT_ID,\r\n  storageBucket: process.env.REACT_APP_FIREBASE_STORAGE_BUCKET,\r\n  messagingSenderId: process.env.REACT_APP_FIREBASE_MESSAGING_SENDER_ID,\r\n  appId: process.env.REACT_APP_FIREBASE_APP_ID,\r\n  measurementId: process.env.REACT_APP_FIREBASE_MEASUREMENT_ID,\r\n};\r\n\r\nlet messagingInstance;\r\nlet analyticsInstance;\r\n\r\nexport function initFirebase() {\r\n  const app = initializeApp(firebaseConfig);\r\n  try {\r\n    messagingInstance = getMessaging(app);\r\n  } catch (e) {\r\n    console.warn('Messaging not available', e);\r\n  }\r\n  return app;\r\n}\r\n\r\nexport function initAnalytics(app) {\r\n  if (process.env.REACT_APP_ENABLE_ANALYTICS !== 'true') return;\r\n  const consent = localStorage.getItem('analytics-consent');\r\n  if (consent !== 'yes') return;\r\n  try {\r\n    analyticsInstance = getAnalytics(app);\r\n    console.log('Analytics initialized');\r\n  } catch (e) {\r\n    console.warn('Analytics not available', e);\r\n  }\r\n}\r\n\r\nexport function trackEvent(eventName, params = {}) {\r\n  if (!analyticsInstance) return;\r\n  try {\r\n    logEvent(analyticsInstance, eventName, params);\r\n  } catch (e) {\r\n    console.warn('Event tracking failed', e);\r\n  }\r\n}\r\n\r\n// Request notification permission and fetch token\r\nexport async function requestFcmToken() {\r\n  if (!messagingInstance) return null;\r\n  const permission = await Notification.requestPermission();\r\n  if (permission !== 'granted') {\r\n    console.log('Notification permission denied');\r\n    return null;\r\n  }\r\n  try {\r\n    const vapidKey = process.env.REACT_APP_FIREBASE_VAPID_KEY; // Public VAPID key\r\n    const currentToken = await getToken(messagingInstance, { vapidKey });\r\n    if (currentToken) {\r\n      console.log('FCM token:', currentToken);\r\n      // Persist token to backend if configured\r\n      try {\r\n        const backend = process.env.REACT_APP_BACKEND_URL;\r\n        if (backend) {\r\n          await fetch(`${backend.replace(/\\/$/, '')}/api/push/register`, {\r\n            method: 'POST',\r\n            headers: { 'Content-Type': 'application/json' },\r\n            body: JSON.stringify({ token: currentToken })\r\n          });\r\n        }\r\n      } catch (e) {\r\n        console.warn('Token persistence failed', e);\r\n      }\r\n      return currentToken;\r\n    } else {\r\n      console.log('No registration token available.');\r\n      return null;\r\n    }\r\n  } catch (err) {\r\n    console.error('An error occurred while retrieving token.', err);\r\n    return null;\r\n  }\r\n}\r\n\r\nexport function listenForegroundMessages(callback) {\r\n  if (!messagingInstance) return;\r\n  onMessage(messagingInstance, payload => {\r\n    console.log('Foreground message received', payload);\r\n    if (callback) callback(payload);\r\n  });\r\n}\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}