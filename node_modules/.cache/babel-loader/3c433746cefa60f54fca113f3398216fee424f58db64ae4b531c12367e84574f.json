{"ast":null,"code":"import _objectSpread from\"C:/Users/kutum/Documents/room-rental-platform/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import React,{useState,useEffect}from'react';import{initFirebase,initAnalytics,requestFcmToken,listenForegroundMessages,trackEvent}from'./firebase';import{MapContainer,TileLayer,Marker}from'react-leaflet';import{Home,PlusCircle,Search,MapPin,X,User,Phone,Mail,Edit,CheckCircle}from'lucide-react';import Header from'./components/Header';import ListingDetailModal from'./components/ListingDetailModal';import Footer from'./components/Footer';import BrowseView from'./components/BrowseView';import PrivacyPolicyModal from'./components/PrivacyPolicyModal';import NotificationBanner from'./components/NotificationBanner';import AnalyticsConsentModal from'./components/AnalyticsConsentModal';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";export default function RentalPlatform(){const[currentView,setCurrentView]=useState('browse');const[mapView,setMapView]=useState(false);const[userType,setUserType]=useState(null);const[previewAsRenter,setPreviewAsRenter]=useState(false);// landlord UI preview toggle\nconst[listings,setListings]=useState([]);const[selectedListing,setSelectedListing]=useState(null);const[users,setUsers]=useState([]);// registry of all users (localStorage 'users')\nconst[searchLocation,setSearchLocation]=useState('');const[priceRange,setPriceRange]=useState([0,10000]);const[selectedAmenities,setSelectedAmenities]=useState([]);const[sortBy,setSortBy]=useState('newest');const[currentUser,setCurrentUser]=useState(null);const[showAuthModal,setShowAuthModal]=useState(false);const[authDefaultType,setAuthDefaultType]=useState('renter');const[nearbyMode,setNearbyMode]=useState(false);const[nearbyRadius,setNearbyRadius]=useState(5);// km\nconst[userLocation,setUserLocation]=useState(null);const[nearbyStatus,setNearbyStatus]=useState('');const[showLocationConsent,setShowLocationConsent]=useState(false);// Mobile menu state moved into Header component\nconst[toast,setToast]=useState(null);const[showPrivacyPolicy,setShowPrivacyPolicy]=useState(false);const[notificationBanner,setNotificationBanner]=useState(null);const[showAnalyticsConsent,setShowAnalyticsConsent]=useState(false);const openAuthModal=function(){let type=arguments.length>0&&arguments[0]!==undefined?arguments[0]:'renter';setAuthDefaultType(type);setShowAuthModal(true);};useEffect(()=>{loadData();// Initialize Firebase + FCM token fetch (deferred until user interaction if desired)\nconst app=initFirebase();// Check analytics consent and show modal if not set\nconst analyticsConsent=localStorage.getItem('analytics-consent');if(!analyticsConsent&&process.env.REACT_APP_ENABLE_ANALYTICS==='true'){// Delay modal slightly so UI loads first\nsetTimeout(()=>setShowAnalyticsConsent(true),2000);}else if(analyticsConsent==='yes'){initAnalytics(app);}(async()=>{try{const token=await requestFcmToken();if(token){console.log('Obtained FCM token:',token);trackEvent('fcm_token_obtained');}}catch(e){console.warn('FCM token request failed',e);}})();listenForegroundMessages(payload=>{// Display notification banner instead of toast\nconst notification=(payload===null||payload===void 0?void 0:payload.notification)||{};if(notification.title||notification.body){setNotificationBanner({title:notification.title,body:notification.body});// Auto-dismiss after 8 seconds\nsetTimeout(()=>setNotificationBanner(null),8000);}});},[]);// Guard: if someone navigates to 'add' without landlord auth, prompt to sign in\nuseEffect(()=>{if(currentView==='add'){if(!currentUser){openAuthModal('landlord');setCurrentView('browse');}else if(userType!=='landlord'){// Not a landlord - prompt to become one\nopenAuthModal('landlord');setCurrentView('browse');}else if(!currentUser.landlordComplete){// Landlord but hasn't completed onboarding\nsetCurrentView('landlord-onboarding');}}},[currentView,currentUser,userType]);const loadData=async()=>{try{const listingsResult=localStorage.getItem('listings');const userResult=localStorage.getItem('current-user');const usersResult=localStorage.getItem('users');if(listingsResult)setListings(JSON.parse(listingsResult));if(userResult){const user=JSON.parse(userResult);setCurrentUser(user);setUserType(user.type);}if(usersResult){try{const parsed=JSON.parse(usersResult);setUsers(Array.isArray(parsed)?parsed:[]);}catch(e){console.warn('Corrupt users array in storage, resetting');setUsers([]);}}}catch(error){console.log('No existing data found, starting fresh');// Add sample listings for testing the map\nconst sampleListings=[{id:'listing-1',title:'Cozy Room in Soweto',price:2500,location:'Soweto, Johannesburg',description:'Comfortable room with bathroom and kitchen access',photos:[],status:'available',availableDate:new Date().toISOString(),amenities:['WiFi','Kitchen'],landlordId:'landlord-1',landlordName:'John Smith',landlordPhone:'+27 123 456 7890',landlordEmail:'john@example.com',landlordPhoto:'',createdAt:new Date().toISOString()},{id:'listing-2',title:'Modern Apartment in Sandton',price:4500,location:'Sandton, Johannesburg',description:'Luxurious apartment with parking and security',photos:[],status:'available',availableDate:new Date().toISOString(),amenities:['WiFi','Parking','Air Conditioning'],landlordId:'landlord-2',landlordName:'Jane Doe',landlordPhone:'+27 987 654 3210',landlordEmail:'jane@example.com',landlordPhoto:'',createdAt:new Date().toISOString()},{id:'listing-3',title:'Studio in Midrand',price:3200,location:'Midrand, Johannesburg',description:'Spacious studio flat with laundry facilities',photos:[],status:'available',availableDate:new Date().toISOString(),amenities:['Laundry','WiFi'],landlordId:'landlord-3',landlordName:'Mike Johnson',landlordPhone:'+27 555 555 5555',landlordEmail:'mike@example.com',landlordPhoto:'',createdAt:new Date().toISOString()}];setListings(sampleListings);}};// Helper: check for duplicate phone or email in registry (exclude an optional user id)\nconst isDuplicateContact=function(phone,email){let ignoreId=arguments.length>2&&arguments[2]!==undefined?arguments[2]:null;const normalizedPhone=(phone||'').trim();const normalizedEmail=(email||'').trim().toLowerCase();if(!users||users.length===0)return false;return users.some(u=>{if(ignoreId&&u.id===ignoreId)return false;const uPhone=(u.phone||'').trim();const uEmail=(u.email||'').trim().toLowerCase();const phoneMatch=normalizedPhone&&uPhone&&uPhone===normalizedPhone;const emailMatch=normalizedEmail&&uEmail&&uEmail===normalizedEmail;return phoneMatch||emailMatch;});};// Haversine formula to compute distance in kilometers between two coords\nconst haversineDistance=(lat1,lon1,lat2,lon2)=>{const toRad=v=>v*Math.PI/180;const R=6371;// km\nconst dLat=toRad(lat2-lat1);const dLon=toRad(lon2-lon1);const a=Math.sin(dLat/2)*Math.sin(dLat/2)+Math.cos(toRad(lat1))*Math.cos(toRad(lat2))*Math.sin(dLon/2)*Math.sin(dLon/2);const c=2*Math.atan2(Math.sqrt(a),Math.sqrt(1-a));return R*c;};const handleFindNearby=()=>{if(!navigator.geolocation){setNearbyStatus('Geolocation not supported');return;}// Show consent modal before accessing location\nsetShowLocationConsent(true);};const handleLocationConsentAccept=()=>{setShowLocationConsent(false);setNearbyStatus('Locating...');navigator.geolocation.getCurrentPosition(pos=>{const lat=pos.coords.latitude;const lon=pos.coords.longitude;setUserLocation({lat,lon});setNearbyMode(true);setNearbyStatus('Nearby mode enabled');setTimeout(()=>setNearbyStatus(''),2000);},err=>{console.error('Geolocation error',err);setNearbyStatus('Could not get location');},{enableHighAccuracy:true,timeout:10000});};const clearNearby=()=>{setNearbyMode(false);setUserLocation(null);setNearbyStatus('');};// Toast notification helper\nconst showToast=function(message){let type=arguments.length>1&&arguments[1]!==undefined?arguments[1]:'info';let title=arguments.length>2&&arguments[2]!==undefined?arguments[2]:'';setToast({message,type,title});setTimeout(()=>setToast(null),5000);};const handleAnalyticsConsentAccept=()=>{localStorage.setItem('analytics-consent','yes');setShowAnalyticsConsent(false);const app=initFirebase();initAnalytics(app);trackEvent('analytics_consent_granted');showToast('Analytics enabled','success','Thank you!');};const handleAnalyticsConsentDecline=()=>{localStorage.setItem('analytics-consent','no');setShowAnalyticsConsent(false);showToast('Analytics disabled','info');};const saveListings=async newListings=>{try{localStorage.setItem('listings',JSON.stringify(newListings));setListings(newListings);}catch(error){console.error('Error saving listings:',error);}};const saveSubscriptions=async subscriptions=>{try{localStorage.setItem('subscriptions',JSON.stringify(subscriptions));}catch(error){console.error('Error saving subscriptions:',error);}};const getSubscriptions=async()=>{try{const res=localStorage.getItem('subscriptions');return res?JSON.parse(res):{};}catch(err){console.error('Error loading subscriptions',err);}return{};};const subscribeToArea=async(userId,area)=>{if(!userId){openAuthModal('renter');return;}if(!area||area.trim()===''){alert('Please enter a location to subscribe to.');return;}try{const subs=await getSubscriptions();subs[userId]=subs[userId]||[];if(!subs[userId].includes(area)){subs[userId].push(area);await saveSubscriptions(subs);alert(\"Subscribed to updates for \".concat(area));}else{alert(\"You are already subscribed to \".concat(area));}}catch(err){console.error('Subscribe failed',err);alert('Could not subscribe. Please try again.');}};const handleProfileSetup=async profileData=>{try{// Duplicate guard\nif(isDuplicateContact(profileData.phone,profileData.email)){showToast('Phone or email already registered','error','Duplicate');return;}const userId=\"user-\".concat(Date.now());const user=_objectSpread(_objectSpread({id:userId,type:userType},profileData),{},{whatsapp:profileData.whatsapp||'',createdAt:new Date().toISOString()});localStorage.setItem('current-user',JSON.stringify(user));setCurrentUser(user);// Update users registry\nconst existingUsersRaw=localStorage.getItem('users');let existingUsers=[];if(existingUsersRaw){try{existingUsers=JSON.parse(existingUsersRaw);}catch(_unused){existingUsers=[];}}existingUsers.push(user);localStorage.setItem('users',JSON.stringify(existingUsers));setUsers(existingUsers);showToast('Profile created successfully!','success','Welcome!');setCurrentView('browse');}catch(error){console.error('Error saving profile:',error);// Still set the user locally even if storage fails\nconst userId=\"user-\".concat(Date.now());const user=_objectSpread(_objectSpread({id:userId,type:userType},profileData),{},{whatsapp:profileData.whatsapp||'',createdAt:new Date().toISOString()});setCurrentUser(user);const existingUsersRaw=localStorage.getItem('users');let existingUsers=[];if(existingUsersRaw){try{existingUsers=JSON.parse(existingUsersRaw);}catch(_unused2){existingUsers=[];}}existingUsers.push(user);try{localStorage.setItem('users',JSON.stringify(existingUsers));}catch(_unused3){}setUsers(existingUsers);showToast('Profile created (data may not be persisted)','error');setCurrentView('browse');}};const handleUpdateProfile=async profileData=>{try{// Duplicate guard (exclude current user id)\nif(isDuplicateContact(profileData.phone,profileData.email,currentUser===null||currentUser===void 0?void 0:currentUser.id)){showToast('Phone or email already used by another account','error','Duplicate');return;}const updatedUser=_objectSpread(_objectSpread({},currentUser),profileData);localStorage.setItem('current-user',JSON.stringify(updatedUser));setCurrentUser(updatedUser);// Update registry entry\nconst existingUsersRaw=localStorage.getItem('users');let existingUsers=[];if(existingUsersRaw){try{existingUsers=JSON.parse(existingUsersRaw);}catch(_unused4){existingUsers=[];}}const idx=existingUsers.findIndex(u=>u.id===updatedUser.id);if(idx!==-1){existingUsers[idx]=updatedUser;}else{existingUsers.push(updatedUser);// ensure presence\n}localStorage.setItem('users',JSON.stringify(existingUsers));setUsers(existingUsers);showToast('Profile updated successfully!','success');setCurrentView('browse');}catch(error){console.error('Error updating profile:',error);const updatedUser=_objectSpread(_objectSpread({},currentUser),profileData);setCurrentUser(updatedUser);const existingUsersRaw=localStorage.getItem('users');let existingUsers=[];if(existingUsersRaw){try{existingUsers=JSON.parse(existingUsersRaw);}catch(_unused5){existingUsers=[];}}const idx=existingUsers.findIndex(u=>u.id===updatedUser.id);if(idx!==-1){existingUsers[idx]=updatedUser;}else{existingUsers.push(updatedUser);}try{localStorage.setItem('users',JSON.stringify(existingUsers));}catch(_unused6){}setUsers(existingUsers);showToast('Profile updated (data may not be persisted)','error');setCurrentView('browse');}};const handleQuickAuth=async profileData=>{// Lightweight auth (used by AuthModal) - create and persist a user\ntry{if(isDuplicateContact(profileData.phone,profileData.email)){showToast('Phone or email already registered','error','Duplicate');return;}const userId=\"user-\".concat(Date.now());const user={id:userId,type:profileData.type||'renter',name:profileData.name,phone:profileData.phone||'',email:profileData.email||'',photo:profileData.photo||'',createdAt:new Date().toISOString()};localStorage.setItem('current-user',JSON.stringify(user));setCurrentUser(user);setUserType(user.type);// registry update\nconst existingUsersRaw=localStorage.getItem('users');let existingUsers=[];if(existingUsersRaw){try{existingUsers=JSON.parse(existingUsersRaw);}catch(_unused7){existingUsers=[];}}existingUsers.push(user);localStorage.setItem('users',JSON.stringify(existingUsers));setUsers(existingUsers);setShowAuthModal(false);// If landlord, route to onboarding to complete setup before posting\nif(user.type==='landlord'){setCurrentView('landlord-onboarding');}else{setCurrentView('browse');}}catch(err){console.error('Auth failed',err);}};// Sign out helper so you can re-auth as renter for perspective preview\nconst handleSignOut=()=>{try{localStorage.removeItem('current-user');}catch(e){console.warn('Could not clear localStorage current-user');}setCurrentUser(null);setUserType(null);setCurrentView('browse');showToast('Signed out. You can now sign in as Renter.','info');};const handleCompleteOnboarding=async onboardData=>{try{const updated=_objectSpread(_objectSpread({},currentUser),{},{landlordComplete:true,landlordInfo:onboardData});localStorage.setItem('current-user',JSON.stringify(updated));setCurrentUser(updated);setCurrentView('browse');}catch(err){console.error('Onboarding save failed',err);setCurrentUser(_objectSpread(_objectSpread({},currentUser),{},{landlordComplete:true,landlordInfo:onboardData}));setCurrentView('browse');}};const handleAddListing=async listingData=>{var _listingData$latitude,_listingData$longitud;const newListing={id:\"listing-\".concat(Date.now()),title:listingData.title,price:listingData.price,location:listingData.location,description:listingData.description,photos:listingData.photos||[],status:listingData.status||'available',availableDate:listingData.availableDate||new Date().toISOString(),amenities:listingData.amenities||[],latitude:(_listingData$latitude=listingData.latitude)!==null&&_listingData$latitude!==void 0?_listingData$latitude:null,longitude:(_listingData$longitud=listingData.longitude)!==null&&_listingData$longitud!==void 0?_listingData$longitud:null,paymentMethod:listingData.paymentMethod||'Bank and Cash',landlordId:currentUser.id,landlordName:currentUser.name,landlordPhone:currentUser.phone,landlordEmail:currentUser.email,landlordPhoto:currentUser.photo,createdAt:new Date().toISOString()};const updatedListings=[...listings,newListing];await saveListings(updatedListings);showToast('Listing created successfully!','success','Success!');setCurrentView('browse');// Scroll to top to see new listing\nwindow.scrollTo({top:0,behavior:'smooth'});};// Messaging removed\nconst filteredListings=listings.map(listing=>{// attach distance if we have userLocation\nif(userLocation&&listing.latitude!=null&&listing.longitude!=null){const d=haversineDistance(userLocation.lat,userLocation.lon,listing.latitude,listing.longitude);return _objectSpread(_objectSpread({},listing),{},{__distanceKm:d});}if(userLocation&&(listing.latitude==null||listing.longitude==null)){// try to geocode-less accurate: leave distance undefined\nreturn _objectSpread({},listing);}return _objectSpread({},listing);}).filter(listing=>{const matchesLocation=!searchLocation||(listing.location||'').toLowerCase().includes(searchLocation.toLowerCase());const price=parseFloat(listing.price);const matchesPrice=price>=priceRange[0]&&price<=priceRange[1];const matchesAmenities=selectedAmenities.length===0||selectedAmenities.every(amenity=>{var _listing$amenities;return(_listing$amenities=listing.amenities)===null||_listing$amenities===void 0?void 0:_listing$amenities.includes(amenity);});let passesNearby=true;if(nearbyMode&&userLocation){// require listing to have coordinates to be included\nif(listing.latitude!=null&&listing.longitude!=null){var _listing$__distanceKm;const d=(_listing$__distanceKm=listing.__distanceKm)!==null&&_listing$__distanceKm!==void 0?_listing$__distanceKm:haversineDistance(userLocation.lat,userLocation.lon,listing.latitude,listing.longitude);passesNearby=d<=nearbyRadius;}else{passesNearby=false;}}return matchesLocation&&matchesPrice&&matchesAmenities&&passesNearby;}).sort((a,b)=>{if(nearbyMode&&userLocation){var _a$__distanceKm,_b$__distanceKm;const da=(_a$__distanceKm=a.__distanceKm)!==null&&_a$__distanceKm!==void 0?_a$__distanceKm:Infinity;const db=(_b$__distanceKm=b.__distanceKm)!==null&&_b$__distanceKm!==void 0?_b$__distanceKm:Infinity;return da-db;}if(sortBy==='newest'){return new Date(b.createdAt)-new Date(a.createdAt);}else if(sortBy==='cheapest'){return parseFloat(a.price)-parseFloat(b.price);}else if(sortBy==='expensive'){return parseFloat(b.price)-parseFloat(a.price);}return 0;});// Allow guests to land on Browse by default. If userType isn't set,\n// show a gentle callout in the header (below) so users can pick a role\n// when they want to post or set up their profile.\nreturn/*#__PURE__*/_jsxs(\"div\",{className:\"min-h-screen bg-gray-50\",children:[/*#__PURE__*/_jsx(\"a\",{href:\"#main-content\",className:\"absolute left-2 top-2 -translate-y-full focus:translate-y-0 transition bg-blue-600 text-white px-3 py-2 rounded shadow\",style:{clipPath:'inset(0)',zIndex:1000},children:\"Skip to main content\"}),/*#__PURE__*/_jsx(Header,{currentUser:currentUser,previewAsRenter:previewAsRenter,setPreviewAsRenter:setPreviewAsRenter,openAuthModal:openAuthModal,handleSignOut:handleSignOut,setCurrentView:setCurrentView}),previewAsRenter&&(currentUser===null||currentUser===void 0?void 0:currentUser.type)==='landlord'&&/*#__PURE__*/_jsx(\"div\",{className:\"bg-indigo-50 border-b border-indigo-200 text-indigo-700 text-xs py-1 text-center\",role:\"status\",\"aria-live\":\"polite\",children:\"Renter preview mode: interactions are read-only. Toggle off to resume landlord actions.\"}),notificationBanner&&/*#__PURE__*/_jsx(NotificationBanner,{title:notificationBanner.title,body:notificationBanner.body,onClose:()=>setNotificationBanner(null)}),toast&&/*#__PURE__*/_jsxs(\"div\",{className:\"fixed top-20 right-4 z-50 bg-white border-l-4 \".concat(toast.type==='success'?'border-green-500':toast.type==='error'?'border-red-500':'border-blue-500',\" rounded shadow-lg p-4 animate-slideInRight flex items-start gap-3 max-w-sm\"),children:[toast.type==='success'&&/*#__PURE__*/_jsx(CheckCircle,{className:\"w-5 h-5 text-green-500 flex-shrink-0 mt-0.5\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex-1\",children:[toast.title&&/*#__PURE__*/_jsx(\"p\",{className:\"font-semibold text-gray-800 mb-1\",children:toast.title}),/*#__PURE__*/_jsx(\"p\",{className:\"text-sm text-gray-600\",children:toast.message})]}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>setToast(null),className:\"text-gray-400 hover:text-gray-600\",\"aria-label\":\"Close notification\",children:/*#__PURE__*/_jsx(X,{className:\"w-4 h-4\"})})]}),/*#__PURE__*/_jsxs(\"div\",{id:\"main-content\",className:\"max-w-6xl mx-auto pb-20\",role:\"main\",children:[currentView==='setup-profile'&&/*#__PURE__*/_jsx(ProfileSetupView,{onSubmit:handleProfileSetup,userType:userType}),currentView==='profile'&&currentUser&&/*#__PURE__*/_jsx(ProfileView,{user:currentUser,onEdit:()=>setCurrentView('edit-profile')}),currentView==='edit-profile'&&currentUser&&/*#__PURE__*/_jsx(EditProfileView,{user:currentUser,onSubmit:handleUpdateProfile,onCancel:()=>setCurrentView('profile')}),currentView==='landlord-onboarding'&&currentUser&&userType==='landlord'&&/*#__PURE__*/_jsx(LandlordOnboardingView,{onComplete:handleCompleteOnboarding,onCancel:()=>setCurrentView('browse'),currentUser:currentUser}),currentView==='browse'&&/*#__PURE__*/_jsx(BrowseView,{listings:filteredListings,searchLocation:searchLocation,setSearchLocation:setSearchLocation,priceRange:priceRange,setPriceRange:setPriceRange,selectedAmenities:selectedAmenities,setSelectedAmenities:setSelectedAmenities,sortBy:sortBy,setSortBy:setSortBy,mapView:mapView,setMapView:setMapView,onSelectListing:setSelectedListing,setCurrentView:setCurrentView,currentUser:currentUser,onRequireAuth:openAuthModal,subscribeToArea:subscribeToArea,onFindNearby:handleFindNearby,nearbyRadius:nearbyRadius,setNearbyRadius:setNearbyRadius,nearbyMode:nearbyMode,clearNearby:clearNearby,userLocation:userLocation,nearbyStatus:nearbyStatus,previewMode:previewAsRenter}),currentView==='add'&&/*#__PURE__*/_jsx(AddListingView,{onSubmit:handleAddListing,onCancel:()=>setCurrentView('browse'),currentUser:currentUser,userType:userType,onRequireAuth:openAuthModal,onRequireOnboarding:()=>setCurrentView('landlord-onboarding')}),currentView==='my-listings'&&currentUser&&userType==='landlord'&&/*#__PURE__*/_jsx(MyListingsView,{listings:listings.filter(l=>l.landlordId===currentUser.id),onDelete:async id=>{const updated=listings.filter(l=>l.id!==id);await saveListings(updated);}})]}),selectedListing&&/*#__PURE__*/_jsx(ListingDetailModal,{listing:selectedListing,landlord:{name:selectedListing.landlordName,phone:selectedListing.landlordPhone,email:selectedListing.landlordEmail,photo:selectedListing.landlordPhoto},onClose:()=>setSelectedListing(null),userType:userType,currentUser:currentUser,onRequireAuth:openAuthModal,previewMode:previewAsRenter,showToast:showToast}),showAuthModal&&/*#__PURE__*/_jsx(AuthModal,{defaultType:authDefaultType,onClose:()=>setShowAuthModal(false),onSubmit:handleQuickAuth}),/*#__PURE__*/_jsx(BottomNav,{currentView:currentView,setCurrentView:setCurrentView,userType:userType}),showLocationConsent&&/*#__PURE__*/_jsx(LocationConsentModal,{onAccept:handleLocationConsentAccept,onDecline:()=>setShowLocationConsent(false)}),showPrivacyPolicy&&/*#__PURE__*/_jsx(PrivacyPolicyModal,{onClose:()=>setShowPrivacyPolicy(false)}),showAnalyticsConsent&&/*#__PURE__*/_jsx(AnalyticsConsentModal,{onAccept:handleAnalyticsConsentAccept,onDecline:handleAnalyticsConsentDecline}),/*#__PURE__*/_jsx(Footer,{onOpenPrivacy:()=>setShowPrivacyPolicy(true)})]});}function ProfileSetupView(_ref){let{onSubmit,userType}=_ref;const[formData,setFormData]=useState({name:'',phone:'',email:'',whatsapp:'',photo:''});const[errors,setErrors]=useState({});const[touched,setTouched]=useState({});const validateField=(name,value)=>{const newErrors=_objectSpread({},errors);switch(name){case'name':if(!value||value.trim().length<2){newErrors.name='Name must be at least 2 characters';}else{delete newErrors.name;}break;case'phone':if(!value||!/^[+]?[-0-9()\\s]{7,}$/.test(value.trim())){newErrors.phone='Enter a valid phone number (min 7 digits)';}else{delete newErrors.phone;}break;case'email':if(!value||!/^[^@\\s]+@[^@\\s]+\\.[^@\\s]+$/.test(value.trim())){newErrors.email='Enter a valid email address';}else{delete newErrors.email;}break;case'photo':if(value==='FILE_TOO_LARGE'){newErrors.photo='Photo is too large (max 2MB)';}else{delete newErrors.photo;}break;default:break;}setErrors(newErrors);};const handlePhotoUpload=e=>{const file=e.target.files[0];if(file){if(file.size>2*1024*1024){// 2MB limit\nsetFormData(_objectSpread(_objectSpread({},formData),{},{photo:''}));validateField('photo','FILE_TOO_LARGE');return;}const reader=new FileReader();reader.onloadend=()=>{setFormData(_objectSpread(_objectSpread({},formData),{},{photo:reader.result}));validateField('photo',reader.result);};reader.readAsDataURL(file);}};const handleSubmit=()=>{// Touch all fields\nconst allTouched={name:true,phone:true,email:true,photo:true};setTouched(allTouched);validateField('name',formData.name);validateField('phone',formData.phone);validateField('email',formData.email);if(Object.keys(errors).length===0&&formData.name&&formData.phone&&formData.email){onSubmit(formData);}};return/*#__PURE__*/_jsx(\"div\",{className:\"p-4 min-h-screen bg-gray-50 pb-20\",children:/*#__PURE__*/_jsx(\"div\",{className:\"max-w-2xl mx-auto mt-8\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white rounded-lg shadow-sm border border-gray-200 p-8\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"text-center mb-8\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\"text-3xl font-bold text-gray-800 mb-2\",children:\"Complete Your Profile\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-gray-600\",children:\"Help others know who you are\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-6\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"flex justify-center mb-8\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"relative\",children:[formData.photo?/*#__PURE__*/_jsx(\"img\",{src:formData.photo,alt:\"Profile\",className:\"w-32 h-32 rounded-full object-cover border-4 border-blue-200 shadow-lg\"}):/*#__PURE__*/_jsx(\"div\",{className:\"w-32 h-32 rounded-full bg-gradient-to-br from-blue-100 to-blue-200 flex items-center justify-center border-4 border-blue-200 shadow-lg\",children:/*#__PURE__*/_jsx(User,{className:\"w-16 h-16 text-blue-600\"})}),/*#__PURE__*/_jsxs(\"label\",{className:\"absolute bottom-0 right-0 bg-blue-600 hover:bg-blue-700 text-white p-3 rounded-full cursor-pointer shadow-lg transition group\",\"aria-label\":\"Upload profile photo\",children:[/*#__PURE__*/_jsx(Edit,{className:\"w-5 h-5\"}),/*#__PURE__*/_jsx(\"input\",{type:\"file\",accept:\"image/*\",onChange:handlePhotoUpload,className:\"hidden\"})]})]})}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-semibold text-gray-800 mb-2\",children:\"Full Name *\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",required:true,value:formData.name,onChange:e=>{setFormData(_objectSpread(_objectSpread({},formData),{},{name:e.target.value}));if(touched.name)validateField('name',e.target.value);},onBlur:e=>{setTouched(_objectSpread(_objectSpread({},touched),{},{name:true}));validateField('name',e.target.value);},placeholder:\"Enter your full name\",\"aria-invalid\":errors.name?'true':'false',\"aria-describedby\":errors.name?'profile-name-error':undefined,className:\"w-full px-4 py-3 border \".concat(errors.name?'border-red-500':'border-gray-300',\" bg-white text-gray-800 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition placeholder-gray-400\")}),errors.name&&touched.name&&/*#__PURE__*/_jsx(\"p\",{id:\"profile-name-error\",className:\"mt-1 text-xs text-red-600\",children:errors.name})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-semibold text-gray-800 mb-2\",children:\"Phone Number *\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"relative\",children:[/*#__PURE__*/_jsx(Phone,{className:\"absolute left-4 top-3.5 w-5 h-5 text-gray-400\"}),/*#__PURE__*/_jsx(\"input\",{type:\"tel\",required:true,value:formData.phone,onChange:e=>{setFormData(_objectSpread(_objectSpread({},formData),{},{phone:e.target.value}));if(touched.phone)validateField('phone',e.target.value);},onBlur:e=>{setTouched(_objectSpread(_objectSpread({},touched),{},{phone:true}));validateField('phone',e.target.value);},placeholder:\"e.g., +27 12 345 6789\",\"aria-invalid\":errors.phone?'true':'false',\"aria-describedby\":errors.phone?'profile-phone-error':undefined,className:\"w-full pl-11 pr-4 py-3 border \".concat(errors.phone?'border-red-500':'border-gray-300',\" bg-white text-gray-800 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition placeholder-gray-400\")})]}),errors.phone&&touched.phone&&/*#__PURE__*/_jsx(\"p\",{id:\"profile-phone-error\",className:\"mt-1 text-xs text-red-600\",children:errors.phone})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-semibold text-gray-800 mb-2\",children:\"Email Address *\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"relative\",children:[/*#__PURE__*/_jsx(Mail,{className:\"absolute left-4 top-3.5 w-5 h-5 text-gray-400\"}),/*#__PURE__*/_jsx(\"input\",{type:\"email\",required:true,value:formData.email,onChange:e=>{setFormData(_objectSpread(_objectSpread({},formData),{},{email:e.target.value}));if(touched.email)validateField('email',e.target.value);},onBlur:e=>{setTouched(_objectSpread(_objectSpread({},touched),{},{email:true}));validateField('email',e.target.value);},placeholder:\"your.email@example.com\",\"aria-invalid\":errors.email?'true':'false',\"aria-describedby\":errors.email?'profile-email-error':undefined,className:\"w-full pl-11 pr-4 py-3 border \".concat(errors.email?'border-red-500':'border-gray-300',\" bg-white text-gray-800 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition placeholder-gray-400\")})]}),errors.email&&touched.email&&/*#__PURE__*/_jsx(\"p\",{id:\"profile-email-error\",className:\"mt-1 text-xs text-red-600\",children:errors.email})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-semibold text-gray-800 mb-2\",children:\"WhatsApp (optional)\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"relative\",children:[/*#__PURE__*/_jsx(Phone,{className:\"absolute left-4 top-3.5 w-5 h-5 text-gray-400\"}),/*#__PURE__*/_jsx(\"input\",{type:\"tel\",value:formData.whatsapp,onChange:e=>setFormData(_objectSpread(_objectSpread({},formData),{},{whatsapp:e.target.value})),placeholder:\"e.g., +27 71 234 5678\",className:\"w-full pl-11 pr-4 py-3 border border-gray-300 bg-white text-gray-800 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition placeholder-gray-400\"})]}),/*#__PURE__*/_jsx(\"p\",{className:\"text-xs text-gray-500 mt-1\",children:\"Used to create a WhatsApp chat link on your listings.\"})]}),/*#__PURE__*/_jsx(\"button\",{onClick:handleSubmit,className:\"w-full bg-blue-600 hover:bg-blue-700 text-white font-semibold py-3 rounded-lg transition mt-8 shadow-sm\",children:\"Complete Setup\"})]})]})})});}function ProfileView(_ref2){let{user,onEdit}=_ref2;return/*#__PURE__*/_jsx(\"div\",{className:\"p-4\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white rounded-lg shadow p-6 max-w-xl mx-auto\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-between items-start mb-6\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\"text-2xl font-bold text-gray-800\",children:\"My Profile\"}),/*#__PURE__*/_jsxs(\"button\",{onClick:onEdit,className:\"bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg transition flex items-center gap-2\",children:[/*#__PURE__*/_jsx(Edit,{className:\"w-4 h-4\"}),\"Edit\"]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex flex-col items-center mb-6\",children:[user.photo?/*#__PURE__*/_jsx(\"img\",{src:user.photo,alt:\"Profile\",className:\"w-32 h-32 rounded-full object-cover border-4 border-blue-500 mb-4\"}):/*#__PURE__*/_jsx(\"div\",{className:\"w-32 h-32 rounded-full bg-gray-200 flex items-center justify-center border-4 border-gray-300 mb-4\",children:/*#__PURE__*/_jsx(User,{className:\"w-16 h-16 text-gray-400\"})}),/*#__PURE__*/_jsx(\"h3\",{className:\"text-2xl font-bold text-gray-800\",children:user.name}),/*#__PURE__*/_jsx(\"span\",{className:\"inline-block mt-2 px-4 py-1 bg-blue-100 text-blue-700 rounded-full text-sm font-semibold\",children:user.type==='landlord'?'Landlord':'Renter'})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-4\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"bg-gray-50 rounded-lg p-4\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center text-gray-600\",children:[/*#__PURE__*/_jsx(Phone,{className:\"w-5 h-5 mr-3 text-blue-600\"}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-xs text-gray-500 mb-1\",children:\"Phone Number\"}),/*#__PURE__*/_jsx(\"p\",{className:\"font-semibold text-gray-800\",children:user.phone})]})]})}),/*#__PURE__*/_jsx(\"div\",{className:\"bg-gray-50 rounded-lg p-4\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center text-gray-600\",children:[/*#__PURE__*/_jsx(Mail,{className:\"w-5 h-5 mr-3 text-blue-600\"}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-xs text-gray-500 mb-1\",children:\"Email Address\"}),/*#__PURE__*/_jsx(\"p\",{className:\"font-semibold text-gray-800\",children:user.email})]})]})}),/*#__PURE__*/_jsx(\"div\",{className:\"bg-gray-50 rounded-lg p-4\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center text-gray-600\",children:[/*#__PURE__*/_jsx(User,{className:\"w-5 h-5 mr-3 text-blue-600\"}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-xs text-gray-500 mb-1\",children:\"Member Since\"}),/*#__PURE__*/_jsx(\"p\",{className:\"font-semibold text-gray-800\",children:new Date(user.createdAt).toLocaleDateString()})]})]})})]})]})});}function LandlordOnboardingView(_ref3){let{onComplete,onCancel,currentUser}=_ref3;const[form,setForm]=useState({businessName:(currentUser===null||currentUser===void 0?void 0:currentUser.name)||'',bankDetails:'',idNumber:'',agree:false});const handleSubmit=()=>{if(!form.businessName||!form.agree){alert('Please provide a display name and agree to the terms.');return;}onComplete(form);};return/*#__PURE__*/_jsx(\"div\",{className:\"p-4 min-h-screen bg-gray-50 pb-20\",children:/*#__PURE__*/_jsx(\"div\",{className:\"max-w-2xl mx-auto mt-8\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white rounded-lg shadow-sm border border-gray-200 p-8\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center gap-6 mb-6\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"w-16 h-16 rounded-full bg-blue-50 flex items-center justify-center text-blue-600 text-2xl font-bold\",children:currentUser&&currentUser.name?currentUser.name.charAt(0):'L'}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsxs(\"h2\",{className:\"text-2xl font-bold text-gray-800\",children:[\"Welcome, \",(currentUser===null||currentUser===void 0?void 0:currentUser.name)||'Landlord']}),/*#__PURE__*/_jsx(\"p\",{className:\"text-gray-600\",children:\"A few details to get your listings live and increase trust with renters.\"})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-4\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-semibold text-gray-800 mb-1\",children:\"Display Name *\"}),/*#__PURE__*/_jsx(\"input\",{value:form.businessName,onChange:e=>setForm(_objectSpread(_objectSpread({},form),{},{businessName:e.target.value})),className:\"w-full px-4 py-3 border border-gray-300 rounded-lg\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-xs text-gray-500 mt-1\",children:\"This name is shown to renters on your listings and messages.\"})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-semibold text-gray-800 mb-1\",children:\"How do you want to receive payments?\"}),/*#__PURE__*/_jsx(\"input\",{value:form.bankDetails,onChange:e=>setForm(_objectSpread(_objectSpread({},form),{},{bankDetails:e.target.value})),placeholder:\"Bank account or payment details (optional)\",className:\"w-full px-4 py-3 border border-gray-300 rounded-lg\"})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-semibold text-gray-800 mb-1\",children:\"ID Number (optional)\"}),/*#__PURE__*/_jsx(\"input\",{value:form.idNumber,onChange:e=>setForm(_objectSpread(_objectSpread({},form),{},{idNumber:e.target.value})),className:\"w-full px-4 py-3 border border-gray-300 rounded-lg\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-start gap-2\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"checkbox\",checked:form.agree,onChange:e=>setForm(_objectSpread(_objectSpread({},form),{},{agree:e.target.checked}))}),/*#__PURE__*/_jsxs(\"div\",{className:\"text-sm text-gray-600\",children:[\"I confirm I am authorised to list these properties and agree to the \",/*#__PURE__*/_jsx(\"button\",{type:\"button\",onClick:e=>e.preventDefault(),className:\"text-blue-600 underline p-0\",children:\"terms of service\"}),\".\"]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex gap-3 pt-4\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:onCancel,className:\"flex-1 bg-gray-100 hover:bg-gray-200 py-3 rounded\",children:\"Cancel\"}),/*#__PURE__*/_jsx(\"button\",{onClick:handleSubmit,className:\"flex-1 bg-blue-600 hover:bg-blue-700 text-white py-3 rounded\",children:\"Complete and Start Listing\"})]})]})]})})});}function EditProfileView(_ref4){let{user,onSubmit,onCancel}=_ref4;const[formData,setFormData]=useState({name:user.name||'',phone:user.phone||'',email:user.email||'',whatsapp:user.whatsapp||'',photo:user.photo||''});const[errors,setErrors]=useState({});const[touched,setTouched]=useState({});const validateField=(name,value)=>{const newErrors=_objectSpread({},errors);switch(name){case'name':if(!value||value.trim().length<2){newErrors.name='Name must be at least 2 characters';}else{delete newErrors.name;}break;case'phone':if(!value||!/^[+]?[-0-9()\\s]{7,}$/.test(value.trim())){newErrors.phone='Enter a valid phone number';}else{delete newErrors.phone;}break;case'email':if(!value||!/^[^@\\s]+@[^@\\s]+\\.[^@\\s]+$/.test(value.trim())){newErrors.email='Enter a valid email';}else{delete newErrors.email;}break;default:break;}setErrors(newErrors);};const handlePhotoUpload=e=>{const file=e.target.files[0];if(file){const reader=new FileReader();reader.onloadend=()=>{setFormData(_objectSpread(_objectSpread({},formData),{},{photo:reader.result}));};reader.readAsDataURL(file);}};const handleSubmit=()=>{setTouched({name:true,phone:true,email:true});validateField('name',formData.name);validateField('phone',formData.phone);validateField('email',formData.email);if(Object.keys(errors).length===0&&formData.name&&formData.phone&&formData.email){onSubmit(formData);}};return/*#__PURE__*/_jsx(\"div\",{className:\"p-4 min-h-screen bg-gray-50 pb-20\",children:/*#__PURE__*/_jsx(\"div\",{className:\"max-w-2xl mx-auto mt-8\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white rounded-lg shadow-sm border border-gray-200 p-8\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between mb-8\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\"text-3xl font-bold text-gray-800\",children:\"Edit Profile\"}),/*#__PURE__*/_jsx(\"button\",{onClick:onCancel,className:\"text-gray-400 hover:text-gray-600 transition\",children:/*#__PURE__*/_jsx(X,{className:\"w-6 h-6\"})})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-6\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"flex justify-center mb-8\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"relative\",children:[formData.photo?/*#__PURE__*/_jsx(\"img\",{src:formData.photo,alt:\"Profile\",className:\"w-32 h-32 rounded-full object-cover border-4 border-blue-200 shadow-lg\"}):/*#__PURE__*/_jsx(\"div\",{className:\"w-32 h-32 rounded-full bg-gradient-to-br from-blue-100 to-blue-200 flex items-center justify-center border-4 border-blue-200 shadow-lg\",children:/*#__PURE__*/_jsx(User,{className:\"w-16 h-16 text-blue-600\"})}),/*#__PURE__*/_jsxs(\"label\",{className:\"absolute bottom-0 right-0 bg-blue-600 hover:bg-blue-700 text-white p-3 rounded-full cursor-pointer shadow-lg transition\",\"aria-label\":\"Upload new profile photo\",children:[/*#__PURE__*/_jsx(Edit,{className:\"w-5 h-5\"}),/*#__PURE__*/_jsx(\"input\",{type:\"file\",accept:\"image/*\",onChange:handlePhotoUpload,className:\"hidden\"})]})]})}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-semibold text-gray-800 mb-2\",children:\"Full Name\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",required:true,value:formData.name,onChange:e=>{setFormData(_objectSpread(_objectSpread({},formData),{},{name:e.target.value}));if(touched.name)validateField('name',e.target.value);},onBlur:e=>{setTouched(_objectSpread(_objectSpread({},touched),{},{name:true}));validateField('name',e.target.value);},\"aria-invalid\":errors.name?'true':'false',\"aria-describedby\":errors.name?'edit-name-error':undefined,className:\"w-full px-4 py-3 border \".concat(errors.name?'border-red-500':'border-gray-300',\" bg-white text-gray-800 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition placeholder-gray-400\")}),errors.name&&touched.name&&/*#__PURE__*/_jsx(\"p\",{id:\"edit-name-error\",className:\"mt-1 text-xs text-red-600\",children:errors.name})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-semibold text-gray-800 mb-2\",children:\"Phone Number\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"relative\",children:[/*#__PURE__*/_jsx(Phone,{className:\"absolute left-4 top-3.5 w-5 h-5 text-gray-400\"}),/*#__PURE__*/_jsx(\"input\",{type:\"tel\",required:true,value:formData.phone,onChange:e=>{setFormData(_objectSpread(_objectSpread({},formData),{},{phone:e.target.value}));if(touched.phone)validateField('phone',e.target.value);},onBlur:e=>{setTouched(_objectSpread(_objectSpread({},touched),{},{phone:true}));validateField('phone',e.target.value);},\"aria-invalid\":errors.phone?'true':'false',\"aria-describedby\":errors.phone?'edit-phone-error':undefined,className:\"w-full pl-11 pr-4 py-3 border \".concat(errors.phone?'border-red-500':'border-gray-300',\" bg-white text-gray-800 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition placeholder-gray-400\")})]}),errors.phone&&touched.phone&&/*#__PURE__*/_jsx(\"p\",{id:\"edit-phone-error\",className:\"mt-1 text-xs text-red-600\",children:errors.phone})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-semibold text-gray-800 mb-2\",children:\"Email Address\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"relative\",children:[/*#__PURE__*/_jsx(Mail,{className:\"absolute left-4 top-3.5 w-5 h-5 text-gray-400\"}),/*#__PURE__*/_jsx(\"input\",{type:\"email\",required:true,value:formData.email,onChange:e=>{setFormData(_objectSpread(_objectSpread({},formData),{},{email:e.target.value}));if(touched.email)validateField('email',e.target.value);},onBlur:e=>{setTouched(_objectSpread(_objectSpread({},touched),{},{email:true}));validateField('email',e.target.value);},\"aria-invalid\":errors.email?'true':'false',\"aria-describedby\":errors.email?'edit-email-error':undefined,className:\"w-full pl-11 pr-4 py-3 border \".concat(errors.email?'border-red-500':'border-gray-300',\" bg-white text-gray-800 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition placeholder-gray-400\")})]}),errors.email&&touched.email&&/*#__PURE__*/_jsx(\"p\",{id:\"edit-email-error\",className:\"mt-1 text-xs text-red-600\",children:errors.email})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-semibold text-gray-800 mb-2\",children:\"WhatsApp (optional)\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"relative\",children:[/*#__PURE__*/_jsx(Phone,{className:\"absolute left-4 top-3.5 w-5 h-5 text-gray-400\"}),/*#__PURE__*/_jsx(\"input\",{type:\"tel\",value:formData.whatsapp,onChange:e=>setFormData(_objectSpread(_objectSpread({},formData),{},{whatsapp:e.target.value})),placeholder:\"e.g., +27 71 234 5678\",className:\"w-full pl-11 pr-4 py-3 border border-gray-300 bg-white text-gray-800 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition placeholder-gray-400\"})]}),/*#__PURE__*/_jsx(\"p\",{className:\"text-xs text-gray-500 mt-1\",children:\"Used to create a WhatsApp chat link on your listings.\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex gap-3 pt-6 border-t border-gray-200\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:onCancel,className:\"flex-1 bg-gray-100 hover:bg-gray-200 text-gray-800 font-semibold py-3 rounded-lg transition\",children:\"Cancel\"}),/*#__PURE__*/_jsx(\"button\",{onClick:handleSubmit,className:\"flex-1 bg-blue-600 hover:bg-blue-700 text-white font-semibold py-3 rounded-lg transition shadow-sm\",children:\"Save Changes\"})]})]})]})})});}/* BrowseView extracted to components/BrowseView.jsx */function AddListingView(_ref5){let{onSubmit,onCancel,currentUser,userType,onRequireAuth,onRequireOnboarding}=_ref5;const GEOCODER_KEY=process.env.REACT_APP_GEOCODER_API_KEY;const GEOCODER_PROVIDER=(process.env.REACT_APP_GEOCODER_PROVIDER||'').toLowerCase();const[formData,setFormData]=useState({title:'',price:'',location:'',streetAddress:'',description:'',photos:[],status:'available',availableDate:new Date().toISOString().split('T')[0],amenities:[],latitude:null,longitude:null,paymentMethod:'Bank and Cash'});const[geocodingStatus,setGecodingStatus]=useState('');const[errors,setErrors]=useState({});const[locationHelpBanner,setLocationHelpBanner]=useState('');const[locationSuggestions,setLocationSuggestions]=useState([]);const[locationSuggestionsLoading,setLocationSuggestionsLoading]=useState(false);const locationSuggestionCacheRef=React.useRef({});// { queryLower: { data, ts } }\nconst LOCATION_SUGGESTION_TTL_MS=15*60*1000;const availableAmenities=['WiFi','Parking','Kitchen','Laundry','Air Conditioning','Heating','TV','Furnished','Pet Friendly','Garden'];const validateField=(name,value)=>{const newErrors=_objectSpread({},errors);switch(name){case'title':if(!value||value.trim().length<5){newErrors.title='Title must be at least 5 characters';}else{delete newErrors.title;}break;case'price':if(!value||parseFloat(value)<=0){newErrors.price='Price must be greater than 0';}else if(parseFloat(value)<500){newErrors.price='Price seems too low (minimum R500)';}else if(parseFloat(value)>50000){newErrors.price='Price seems too high (maximum R50,000)';}else{delete newErrors.price;}break;case'location':if(!value||value.trim().length<3){newErrors.location='Location is required (min 3 characters)';}else{delete newErrors.location;}break;case'description':if(value&&value.length>500){newErrors.description='Description is too long (max 500 characters)';}else{delete newErrors.description;}break;default:break;}setErrors(newErrors);};// Debounced provider-aware suggestions (Mapbox/Nominatim) with caching & bias\nuseEffect(()=>{const raw=(formData.location||'').trim();if(raw.length<3){setLocationSuggestions([]);setLocationSuggestionsLoading(false);return;}const qLower=raw.toLowerCase();const cached=locationSuggestionCacheRef.current[qLower];if(cached&&Date.now()-cached.ts<LOCATION_SUGGESTION_TTL_MS){setLocationSuggestions(cached.data);return;}const controller=new AbortController();setLocationSuggestionsLoading(true);const t=setTimeout(async()=>{try{let suggestions=[];if(GEOCODER_PROVIDER==='mapbox'&&GEOCODER_KEY){const proximity=formData.latitude&&formData.longitude?\"&proximity=\".concat(formData.longitude,\",\").concat(formData.latitude):'';const url=\"https://api.mapbox.com/geocoding/v5/mapbox.places/\".concat(encodeURIComponent(raw),\".json?access_token=\").concat(GEOCODER_KEY,\"&limit=5&country=ZA&language=en\").concat(proximity,\"&types=place,locality,neighborhood\");const resp=await fetch(url,{signal:controller.signal});const data=await resp.json();if(data&&Array.isArray(data.features)){suggestions=data.features.map(f=>f.place_name).filter(Boolean);}}else{let biasParams='';if(formData.latitude&&formData.longitude){const delta=0.2;const minLon=formData.longitude-delta;const maxLon=formData.longitude+delta;const minLat=formData.latitude-delta;const maxLat=formData.latitude+delta;biasParams=\"&bounded=1&viewbox=\".concat(minLon,\",\").concat(maxLat,\",\").concat(maxLon,\",\").concat(minLat);}const url=\"https://nominatim.openstreetmap.org/search?format=json&q=\".concat(encodeURIComponent(raw+', South Africa'),\"&limit=5\").concat(biasParams);const resp=await fetch(url,{signal:controller.signal,headers:{'Accept-Language':'en'}});const data=await resp.json();const uniq=[];data.forEach(item=>{const display=item.display_name||'';const parts=display.split(',').map(p=>p.trim());const area=parts.slice(0,2).join(', ');if(area&&!uniq.includes(area))uniq.push(area);});suggestions=uniq.slice(0,5);}locationSuggestionCacheRef.current[qLower]={data:suggestions,ts:Date.now()};setLocationSuggestions(suggestions);}catch(e){setLocationSuggestions([]);}finally{setLocationSuggestionsLoading(false);}},500);return()=>{clearTimeout(t);controller.abort();};},[formData.location,formData.latitude,formData.longitude,GEOCODER_PROVIDER,GEOCODER_KEY,LOCATION_SUGGESTION_TTL_MS]);// Geocode address using Nominatim (OpenStreetMap)\n// Use browser geolocation and reverse-geocode to fill address/coords\nconst geolocateCurrentPosition=()=>{if(!navigator.geolocation){setGecodingStatus('Geolocation not supported by your browser');setLocationHelpBanner('Location is disabled. Tap for steps to enable.');return;}setGecodingStatus('Locating...');navigator.geolocation.getCurrentPosition(async pos=>{const lat=pos.coords.latitude;const lon=pos.coords.longitude;setFormData(_objectSpread(_objectSpread({},formData),{},{latitude:lat,longitude:lon}));// Reverse geocode to get a readable address\ntry{if(GEOCODER_PROVIDER==='mapbox'&&GEOCODER_KEY){const rev=await fetch(\"https://api.mapbox.com/geocoding/v5/mapbox.places/\".concat(lon,\",\").concat(lat,\".json?access_token=\").concat(GEOCODER_KEY,\"&limit=1&country=za\"));const revData=await rev.json();if(revData&&revData.features&&revData.features.length>0){const place=revData.features[0].place_name||'';const parts=place.split(',').map(p=>p.trim());const street=parts.slice(0,2).join(', ');const area=parts.slice(2,4).join(', ');setFormData(prev=>_objectSpread(_objectSpread({},prev),{},{streetAddress:street||prev.streetAddress,location:area||prev.location}));setGecodingStatus(' Current location set');setTimeout(()=>setGecodingStatus(''),2500);return;}}else{const rev=await fetch(\"https://nominatim.openstreetmap.org/reverse?format=json&lat=\".concat(lat,\"&lon=\").concat(lon));const revData=await rev.json();if(revData){const display=revData.display_name||'';// Try to split display name into street and area\nconst parts=display.split(',').map(p=>p.trim());const street=parts.slice(0,2).join(', ');const area=parts.slice(2,4).join(', ');setFormData(prev=>_objectSpread(_objectSpread({},prev),{},{streetAddress:street||prev.streetAddress,location:area||prev.location}));setGecodingStatus(' Current location set');setTimeout(()=>setGecodingStatus(''),2500);return;}}}catch(e){console.error('Reverse geocode failed',e);}setGecodingStatus(' Coordinates obtained');setTimeout(()=>setGecodingStatus(''),2000);},err=>{console.error('Geolocation error',err);setGecodingStatus('Could not get your location');setLocationHelpBanner('Location permission denied. Tap here for steps to enable.');},{enableHighAccuracy:true,timeout:10000});};const geocodeAddress=async()=>{if(!formData.streetAddress){setGecodingStatus('Please enter a street address');return;}setGecodingStatus('Finding coordinates...');try{const fullAddress=\"\".concat(formData.streetAddress,\", \").concat(formData.location,\", South Africa\");// Try Mapbox if configured\nif(GEOCODER_PROVIDER==='mapbox'&&GEOCODER_KEY){try{const resp=await fetch(\"https://api.mapbox.com/geocoding/v5/mapbox.places/\".concat(encodeURIComponent(fullAddress),\".json?access_token=\").concat(GEOCODER_KEY,\"&limit=1&country=za\"));const data=await resp.json();if(data&&data.features&&data.features.length>0){const[lon,lat]=data.features[0].center||[];setFormData(_objectSpread(_objectSpread({},formData),{},{latitude:parseFloat(lat),longitude:parseFloat(lon)}));setGecodingStatus(' Address found (Mapbox)!');setTimeout(()=>setGecodingStatus(''),2000);return;}}catch(err){console.warn('Mapbox geocoding failed, falling back to Nominatim',err);}}// Default / fallback: Nominatim\nconst response=await fetch(\"https://nominatim.openstreetmap.org/search?format=json&q=\".concat(encodeURIComponent(fullAddress)));const results=await response.json();if(results.length>0){const{lat,lon}=results[0];setFormData(_objectSpread(_objectSpread({},formData),{},{latitude:parseFloat(lat),longitude:parseFloat(lon)}));setGecodingStatus(' Address found!');setTimeout(()=>setGecodingStatus(''),2000);}else{setGecodingStatus('Address not found. Trying with area only...');// Fallback: just use the area/city\nconst areaResponse=await fetch(\"https://nominatim.openstreetmap.org/search?format=json&q=\".concat(encodeURIComponent(formData.location+', South Africa')));const areaResults=await areaResponse.json();if(areaResults.length>0){const{lat,lon}=areaResults[0];setFormData(_objectSpread(_objectSpread({},formData),{},{latitude:parseFloat(lat),longitude:parseFloat(lon)}));setGecodingStatus(' Area found!');setTimeout(()=>setGecodingStatus(''),2000);}else{setGecodingStatus('Could not find location');}}}catch(error){console.error('Geocoding error:',error);setGecodingStatus('Error finding address. Check your connection.');}};// Draggable preview marker component for Add Listing\nfunction DraggablePreview(_ref6){let{lat,lng}=_ref6;const[pos,setPos]=useState(lat&&lng?[lat,lng]:null);useEffect(()=>{if(lat&&lng)setPos([lat,lng]);},[lat,lng]);if(!pos)return null;return/*#__PURE__*/_jsxs(MapContainer,{center:pos,zoom:15,className:\"w-full h-48 rounded-lg\",whenCreated:()=>{},children:[/*#__PURE__*/_jsx(TileLayer,{url:\"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png\"}),/*#__PURE__*/_jsx(Marker,{position:pos,draggable:true,eventHandlers:{dragend:e=>{const ll=e.target.getLatLng();setPos([ll.lat,ll.lng]);setFormData(prev=>_objectSpread(_objectSpread({},prev),{},{latitude:ll.lat,longitude:ll.lng}));}}})]});}const toggleAmenity=amenity=>{if(formData.amenities.includes(amenity)){setFormData(_objectSpread(_objectSpread({},formData),{},{amenities:formData.amenities.filter(a=>a!==amenity)}));}else{setFormData(_objectSpread(_objectSpread({},formData),{},{amenities:[...formData.amenities,amenity]}));}};const handlePhotoUpload=e=>{const files=Array.from(e.target.files||[]);if(files.length===0)return;const readers=files.map(file=>new Promise(resolve=>{const reader=new FileReader();reader.onloadend=()=>resolve(reader.result);reader.readAsDataURL(file);}));Promise.all(readers).then(images=>{const combined=[...formData.photos,...images].slice(0,5);// cap at 5\nsetFormData(_objectSpread(_objectSpread({},formData),{},{photos:combined}));});};const removePhoto=index=>{const newPhotos=formData.photos.filter((_,i)=>i!==index);setFormData(_objectSpread(_objectSpread({},formData),{},{photos:newPhotos}));};const handleSubmit=()=>{// Enforce auth and onboarding checks before allowing submission\nif(!currentUser){onRequireAuth&&onRequireAuth('landlord');return;}if(userType!=='landlord'){// prompt to become landlord\nonRequireAuth&&onRequireAuth('landlord');return;}if(!currentUser.landlordComplete){// send to onboarding\nonRequireOnboarding&&onRequireOnboarding();return;}// Validate all fields\nvalidateField('title',formData.title);validateField('price',formData.price);validateField('location',formData.location);validateField('description',formData.description);if(!formData.title||formData.title.trim().length<5){setErrors(prev=>_objectSpread(_objectSpread({},prev),{},{title:'Title must be at least 5 characters'}));return;}if(!formData.price||parseFloat(formData.price)<=0){setErrors(prev=>_objectSpread(_objectSpread({},prev),{},{price:'Price must be greater than 0'}));return;}if(!formData.location||formData.location.trim().length<3){setErrors(prev=>_objectSpread(_objectSpread({},prev),{},{location:'Location is required'}));return;}if(Object.keys(errors).length>0){return;}onSubmit(formData);};// Auto-attempt geolocation shortly after mount for landlord convenience\nuseEffect(()=>{const shouldAttempt=!formData.latitude&&!formData.longitude;if(shouldAttempt){const t=setTimeout(()=>{geolocateCurrentPosition();},800);return()=>clearTimeout(t);}// eslint-disable-next-line react-hooks/exhaustive-deps\n},[formData.latitude,formData.longitude]);return/*#__PURE__*/_jsx(\"div\",{className:\"p-4 bg-gray-50 min-h-screen pb-20\",children:/*#__PURE__*/_jsx(\"div\",{className:\"max-w-3xl mx-auto mt-8\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white rounded-lg shadow-sm border border-gray-200 p-8\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between mb-8\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\"text-3xl font-bold text-gray-800\",children:\"Post a Room\"}),/*#__PURE__*/_jsx(\"button\",{onClick:onCancel,className:\"text-gray-400 hover:text-gray-600 transition\",children:/*#__PURE__*/_jsx(X,{className:\"w-6 h-6\"})})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-6\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-semibold text-gray-800 mb-2\",children:\"Room Title *\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",required:true,value:formData.title,onChange:e=>{setFormData(_objectSpread(_objectSpread({},formData),{},{title:e.target.value}));validateField('title',e.target.value);},onBlur:e=>validateField('title',e.target.value),placeholder:\"e.g., Cozy backroom with bathroom\",className:\"w-full px-4 py-3 border \".concat(errors.title?'border-red-500':'border-gray-300',\" bg-white text-gray-800 rounded-lg focus:ring-2 \").concat(errors.title?'focus:ring-red-500':'focus:ring-blue-500',\" focus:border-transparent transition placeholder-gray-400\")}),errors.title&&/*#__PURE__*/_jsx(\"p\",{className:\"text-red-500 text-xs mt-1\",children:errors.title})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-semibold text-gray-800 mb-2\",children:\"Monthly Price (R) *\"}),/*#__PURE__*/_jsx(\"input\",{type:\"number\",required:true,value:formData.price,onChange:e=>{setFormData(_objectSpread(_objectSpread({},formData),{},{price:e.target.value}));validateField('price',e.target.value);},onBlur:e=>validateField('price',e.target.value),placeholder:\"e.g., 2500\",className:\"w-full px-4 py-3 border \".concat(errors.price?'border-red-500':'border-gray-300',\" bg-white text-gray-800 rounded-lg focus:ring-2 \").concat(errors.price?'focus:ring-red-500':'focus:ring-blue-500',\" focus:border-transparent transition placeholder-gray-400\")}),errors.price&&/*#__PURE__*/_jsx(\"p\",{className:\"text-red-500 text-xs mt-1\",children:errors.price})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"grid grid-cols-1 md:grid-cols-2 gap-4\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-semibold text-gray-800 mb-2\",children:\"Area / City *\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",required:true,value:formData.location,onChange:e=>{setFormData(_objectSpread(_objectSpread({},formData),{},{location:e.target.value}));validateField('location',e.target.value);},onBlur:e=>validateField('location',e.target.value),placeholder:\"e.g., Soweto, Johannesburg\",className:\"w-full px-4 py-3 border \".concat(errors.location?'border-red-500':'border-gray-300',\" bg-white text-gray-800 rounded-lg focus:ring-2 \").concat(errors.location?'focus:ring-red-500':'focus:ring-blue-500',\" focus:border-transparent transition placeholder-gray-400\")}),errors.location&&/*#__PURE__*/_jsx(\"p\",{className:\"text-red-500 text-xs mt-1\",children:errors.location}),locationSuggestionsLoading&&/*#__PURE__*/_jsx(\"p\",{className:\"text-xs text-blue-600 mt-1 animate-pulse\",\"aria-live\":\"polite\",children:\"Loading suggestions...\"}),locationSuggestions.length>0&&/*#__PURE__*/_jsx(\"div\",{className:\"mt-2 border border-gray-200 rounded-lg bg-white shadow-sm divide-y\",children:locationSuggestions.map(s=>/*#__PURE__*/_jsx(\"button\",{type:\"button\",onClick:()=>{setFormData(_objectSpread(_objectSpread({},formData),{},{location:s}));setLocationSuggestions([]);validateField('location',s);},className:\"w-full text-left px-3 py-2 text-sm hover:bg-blue-50\",children:s},s))})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-semibold text-gray-800 mb-2\",children:\"Street Address\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",value:formData.streetAddress,onChange:e=>setFormData(_objectSpread(_objectSpread({},formData),{},{streetAddress:e.target.value})),placeholder:\"e.g., 123 Main Street\",className:\"w-full px-4 py-3 border border-gray-300 bg-white text-gray-800 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition placeholder-gray-400\"})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"bg-blue-50 border-2 border-blue-200 rounded-lg p-6\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-start gap-3 mb-4\",children:[/*#__PURE__*/_jsx(MapPin,{className:\"w-6 h-6 text-blue-600 flex-shrink-0 mt-1\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex-1\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"text-lg font-semibold text-gray-800 mb-1\",children:\"Set Location on Map\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-sm text-gray-600\",children:\"Help renters find your listing by pinpointing its exact location.\"})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex flex-wrap gap-3 items-center mb-4\",children:[locationHelpBanner&&/*#__PURE__*/_jsxs(\"div\",{className:\"w-full bg-yellow-50 border-2 border-yellow-200 text-yellow-800 rounded-lg p-3 text-sm flex items-start gap-2\",children:[/*#__PURE__*/_jsx(\"span\",{children:\"\\u26A0\\uFE0F\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex-1\",children:[locationHelpBanner,/*#__PURE__*/_jsx(\"button\",{type:\"button\",className:\"ml-2 underline font-semibold\",onClick:()=>window.alert('To enable location: 1) Tap the lock icon in the address bar. 2) Find Location permission. 3) Set to Allow. Then refresh the page.'),children:\"How to enable\"})]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"w-full text-xs text-blue-700 bg-blue-50 border border-blue-200 rounded p-2\",children:\"Tip: Using \\\"Use Current Location\\\" is recommended for accuracy. Street address can be approximate \\u2013 drag the pin to fine tune.\"}),/*#__PURE__*/_jsxs(\"button\",{type:\"button\",onClick:geocodeAddress,className:\"bg-blue-600 hover:bg-blue-700 text-white px-6 py-3 rounded-lg text-sm font-semibold transition shadow-sm flex items-center gap-2\",children:[/*#__PURE__*/_jsx(MapPin,{className:\"w-4 h-4\"}),\"Find on Map\"]}),/*#__PURE__*/_jsxs(\"button\",{type:\"button\",onClick:geolocateCurrentPosition,className:\"bg-white hover:bg-gray-50 border-2 border-gray-300 text-gray-800 px-6 py-3 rounded-lg text-sm font-semibold transition shadow-sm flex items-center gap-2\",children:[/*#__PURE__*/_jsx(MapPin,{className:\"w-4 h-4\"}),\"Use Current Location\"]}),/*#__PURE__*/_jsxs(\"div\",{className:\"text-sm flex-1\",children:[geocodingStatus&&/*#__PURE__*/_jsxs(\"span\",{className:\"\".concat(geocodingStatus.startsWith('')?'text-green-600 font-semibold':'text-gray-700',\" flex items-center gap-1\"),children:[geocodingStatus.startsWith('')&&/*#__PURE__*/_jsx(CheckCircle,{className:\"w-4 h-4\"}),geocodingStatus]}),formData.latitude&&formData.longitude&&!geocodingStatus&&/*#__PURE__*/_jsxs(\"span\",{className:\"text-green-600 font-semibold flex items-center gap-1\",children:[/*#__PURE__*/_jsx(CheckCircle,{className:\"w-4 h-4\"}),\"Location set: \",formData.latitude.toFixed(4),\", \",formData.longitude.toFixed(4)]})]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"mt-4\",children:formData.latitude&&formData.longitude?/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-semibold text-gray-800 mb-2\",children:\"Fine-tune Location (drag pin)\"}),/*#__PURE__*/_jsx(DraggablePreview,{lat:formData.latitude,lng:formData.longitude})]}):/*#__PURE__*/_jsxs(\"div\",{className:\"text-sm text-gray-600 bg-white border border-gray-200 rounded-lg p-4 text-center\",children:[/*#__PURE__*/_jsx(MapPin,{className:\"w-8 h-8 mx-auto mb-2 text-gray-400\"}),\"No location set yet. Click \\\"Find on Map\\\" or \\\"Use Current Location\\\" to place a pin.\"]})})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"grid grid-cols-1 md:grid-cols-2 gap-4\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-semibold text-gray-800 mb-2\",children:\"Status\"}),/*#__PURE__*/_jsxs(\"select\",{value:formData.status,onChange:e=>setFormData(_objectSpread(_objectSpread({},formData),{},{status:e.target.value})),className:\"w-full px-4 py-3 border border-gray-300 bg-white text-gray-800 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition\",children:[/*#__PURE__*/_jsx(\"option\",{value:\"available\",children:\"Available\"}),/*#__PURE__*/_jsx(\"option\",{value:\"rented\",children:\"Rented\"})]})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-semibold text-gray-800 mb-2\",children:\"Available Date\"}),/*#__PURE__*/_jsx(\"input\",{type:\"date\",value:formData.availableDate,onChange:e=>setFormData(_objectSpread(_objectSpread({},formData),{},{availableDate:e.target.value})),className:\"w-full px-4 py-3 border border-gray-300 bg-white text-gray-800 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition\"})]})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-semibold text-gray-800 mb-2\",children:\"Payment Method\"}),/*#__PURE__*/_jsxs(\"select\",{value:formData.paymentMethod,onChange:e=>setFormData(_objectSpread(_objectSpread({},formData),{},{paymentMethod:e.target.value})),className:\"w-full px-4 py-3 border border-gray-300 bg-white text-gray-800 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition\",children:[/*#__PURE__*/_jsx(\"option\",{value:\"Bank and Cash\",children:\"Bank and Cash\"}),/*#__PURE__*/_jsx(\"option\",{value:\"Cash Only\",children:\"Cash Only\"}),/*#__PURE__*/_jsx(\"option\",{value:\"Bank Only\",children:\"Bank Only\"})]})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsxs(\"label\",{className:\"block text-sm font-semibold text-gray-800 mb-2\",children:[\"Description\",formData.description&&/*#__PURE__*/_jsxs(\"span\",{className:\"ml-2 text-xs \".concat(formData.description.length>500?'text-red-500':'text-gray-500'),children:[\"(\",formData.description.length,\"/500 characters)\"]})]}),/*#__PURE__*/_jsx(\"textarea\",{value:formData.description,onChange:e=>{setFormData(_objectSpread(_objectSpread({},formData),{},{description:e.target.value}));validateField('description',e.target.value);},onBlur:e=>validateField('description',e.target.value),placeholder:\"Describe the room, amenities, rules, and any other details...\",rows:\"4\",className:\"w-full px-4 py-3 border \".concat(errors.description?'border-red-500':'border-gray-300',\" bg-white text-gray-800 rounded-lg focus:ring-2 \").concat(errors.description?'focus:ring-red-500':'focus:ring-blue-500',\" focus:border-transparent transition placeholder-gray-400\")}),errors.description&&/*#__PURE__*/_jsx(\"p\",{className:\"text-red-500 text-xs mt-1\",children:errors.description})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-semibold text-gray-800 mb-3\",children:\"Amenities\"}),/*#__PURE__*/_jsx(\"div\",{className:\"grid grid-cols-2 md:grid-cols-3 gap-2\",children:availableAmenities.map(amenity=>/*#__PURE__*/_jsx(\"button\",{type:\"button\",onClick:()=>toggleAmenity(amenity),className:\"px-4 py-2 rounded-lg text-sm font-medium transition \".concat(formData.amenities.includes(amenity)?'bg-blue-600 text-white shadow-sm':'bg-gray-100 text-gray-700 border border-gray-300 hover:bg-gray-200'),children:amenity},amenity))})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-semibold text-gray-800 mb-2\",children:\"Photos (Max 5)\"}),/*#__PURE__*/_jsx(\"input\",{type:\"file\",accept:\"image/*\",multiple:true,onChange:handlePhotoUpload,disabled:formData.photos.length>=5,className:\"w-full px-4 py-3 border border-gray-300 bg-white text-gray-700 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition cursor-pointer\"}),formData.photos.length>0&&/*#__PURE__*/_jsx(\"div\",{className:\"mt-4 grid grid-cols-2 md:grid-cols-3 gap-3\",children:formData.photos.map((photo,index)=>/*#__PURE__*/_jsxs(\"div\",{className:\"relative group\",children:[/*#__PURE__*/_jsx(\"img\",{src:photo,alt:\"Preview \".concat(index+1),className:\"w-full h-32 object-cover rounded-lg border border-gray-200 shadow-sm\"}),/*#__PURE__*/_jsx(\"button\",{type:\"button\",onClick:()=>removePhoto(index),className:\"absolute top-2 right-2 bg-red-500 hover:bg-red-600 text-white rounded-full w-6 h-6 flex items-center justify-center shadow-lg opacity-0 group-hover:opacity-100 transition\",children:/*#__PURE__*/_jsx(X,{className:\"w-4 h-4\"})})]},index))}),formData.photos.length>=5&&/*#__PURE__*/_jsx(\"p\",{className:\"text-sm text-gray-500 mt-2\",children:\"Maximum 5 photos reached\"})]}),/*#__PURE__*/_jsx(\"div\",{className:\"border-t border-gray-200 pt-6\",children:/*#__PURE__*/_jsx(\"button\",{onClick:handleSubmit,className:\"w-full bg-blue-600 hover:bg-blue-700 text-white font-semibold py-3 rounded-lg transition shadow-sm\",children:\"Post Room\"})})]})]})})});}// MessagesView removed - using direct contact instead\nfunction MyListingsView(_ref7){let{listings,onDelete}=_ref7;return/*#__PURE__*/_jsxs(\"div\",{className:\"p-4\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\"text-2xl font-bold mb-4 text-gray-800\",children:\"My Listings\"}),/*#__PURE__*/_jsx(\"div\",{className:\"space-y-4\",children:listings.length===0?/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white rounded-lg shadow p-8 text-center text-gray-500\",children:[/*#__PURE__*/_jsx(Home,{className:\"w-16 h-16 mx-auto mb-4 text-gray-300\"}),/*#__PURE__*/_jsx(\"p\",{children:\"You haven't posted any rooms yet.\"})]}):listings.map(listing=>/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white rounded-lg shadow p-4\",children:[listing.photos&&listing.photos.length>0&&/*#__PURE__*/_jsxs(\"div\",{className:\"relative mb-3\",children:[/*#__PURE__*/_jsx(\"img\",{src:listing.photos[0],alt:\"Room\",className:\"w-full h-32 object-cover rounded-lg\"}),listing.photos.length>1&&/*#__PURE__*/_jsxs(\"div\",{className:\"absolute top-2 right-2 bg-black bg-opacity-60 text-white px-2 py-1 rounded text-xs\",children:[listing.photos.length,\" photos\"]})]}),/*#__PURE__*/_jsx(\"h3\",{className:\"font-bold text-lg mb-1\",children:listing.title}),/*#__PURE__*/_jsxs(\"div\",{className:\"text-blue-600 font-bold mb-2\",children:[\"R\",listing.price,\"/month\"]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center text-gray-600 text-sm mb-3\",children:[/*#__PURE__*/_jsx(MapPin,{className:\"w-4 h-4 mr-1\"}),listing.location]}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>onDelete(listing.id),className:\"w-full bg-red-500 hover:bg-red-600 text-white py-2 rounded-lg transition\",children:\"Delete Listing\"})]},listing.id))})]});}// Inline message box component with validation for listing detail view\n// ListingInlineMessageBox removed\n// ConversationModal removed\nfunction AuthModal(_ref8){let{defaultType='renter',onClose,onSubmit}=_ref8;const[form,setForm]=useState({name:'',phone:'',email:'',type:defaultType,photo:''});const handleSubmit=()=>{if(!form.name||!form.email){alert('Please add a name and email');return;}onSubmit(form);};return/*#__PURE__*/_jsx(\"div\",{className:\"fixed inset-0 bg-black bg-opacity-50 flex items-start sm:items-center justify-center p-4 pt-16 sm:pt-4 z-50 overflow-y-auto\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white rounded-lg w-full max-w-md p-6 my-auto\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between mb-4\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"text-lg font-bold\",children:\"Sign in / Create account\"}),/*#__PURE__*/_jsx(\"button\",{onClick:onClose,className:\"text-gray-400 hover:text-gray-600\",children:/*#__PURE__*/_jsx(X,{className:\"w-5 h-5\"})})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-3\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-semibold text-gray-700 mb-1\",children:\"Full name\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",value:form.name,onChange:e=>setForm(_objectSpread(_objectSpread({},form),{},{name:e.target.value})),className:\"w-full px-3 py-2 border rounded\"})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-semibold text-gray-700 mb-1\",children:\"Email\"}),/*#__PURE__*/_jsx(\"input\",{type:\"email\",value:form.email,onChange:e=>setForm(_objectSpread(_objectSpread({},form),{},{email:e.target.value})),className:\"w-full px-3 py-2 border rounded\"})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-semibold text-gray-700 mb-1\",children:\"Phone (optional)\"}),/*#__PURE__*/_jsx(\"input\",{type:\"tel\",value:form.phone,onChange:e=>setForm(_objectSpread(_objectSpread({},form),{},{phone:e.target.value})),className:\"w-full px-3 py-2 border rounded\"})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-semibold text-gray-700 mb-1\",children:\"I am a\"}),/*#__PURE__*/_jsxs(\"select\",{value:form.type,onChange:e=>setForm(_objectSpread(_objectSpread({},form),{},{type:e.target.value})),className:\"w-full px-3 py-2 border rounded\",children:[/*#__PURE__*/_jsx(\"option\",{value:\"renter\",children:\"Looking for a room\"}),/*#__PURE__*/_jsx(\"option\",{value:\"landlord\",children:\"Listing rooms\"})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex gap-3 pt-4\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:onClose,className:\"flex-1 bg-gray-100 hover:bg-gray-200 py-2 rounded\",children:\"Cancel\"}),/*#__PURE__*/_jsx(\"button\",{onClick:handleSubmit,className:\"flex-1 bg-blue-600 hover:bg-blue-700 text-white py-2 rounded\",children:\"Continue\"})]})]})]})});}function LocationConsentModal(_ref9){let{onAccept,onDecline}=_ref9;return/*#__PURE__*/_jsx(\"div\",{className:\"fixed inset-0 bg-black bg-opacity-60 flex items-center justify-center p-4 z-50\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white rounded-lg max-w-md w-full p-6 shadow-xl\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center gap-3 mb-4\",children:[/*#__PURE__*/_jsx(MapPin,{className:\"w-8 h-8 text-blue-600\"}),/*#__PURE__*/_jsx(\"h3\",{className:\"text-xl font-bold text-gray-800\",children:\"Location Access\"})]}),/*#__PURE__*/_jsx(\"p\",{className:\"text-gray-600 mb-4\",children:\"Room24 would like to access your location to show nearby rental listings. Your location data:\"}),/*#__PURE__*/_jsxs(\"ul\",{className:\"text-sm text-gray-600 mb-6 space-y-2\",children:[/*#__PURE__*/_jsxs(\"li\",{className:\"flex items-start gap-2\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"text-green-600 mt-0.5\",children:\"\\u2713\"}),/*#__PURE__*/_jsx(\"span\",{children:\"Is only used to calculate distances to listings\"})]}),/*#__PURE__*/_jsxs(\"li\",{className:\"flex items-start gap-2\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"text-green-600 mt-0.5\",children:\"\\u2713\"}),/*#__PURE__*/_jsx(\"span\",{children:\"Is not stored on our servers\"})]}),/*#__PURE__*/_jsxs(\"li\",{className:\"flex items-start gap-2\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"text-green-600 mt-0.5\",children:\"\\u2713\"}),/*#__PURE__*/_jsx(\"span\",{children:\"Is not shared with third parties\"})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex gap-3\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:onDecline,className:\"flex-1 bg-gray-100 hover:bg-gray-200 text-gray-800 font-semibold py-3 rounded-lg transition\",children:\"Not Now\"}),/*#__PURE__*/_jsx(\"button\",{onClick:onAccept,className:\"flex-1 bg-blue-600 hover:bg-blue-700 text-white font-semibold py-3 rounded-lg transition\",children:\"Allow\"})]}),/*#__PURE__*/_jsx(\"p\",{className:\"text-xs text-gray-500 mt-4 text-center\",children:\"You can change this permission anytime in your browser settings.\"})]})});}function BottomNav(_ref0){let{currentView,setCurrentView,userType}=_ref0;const navItems=[{id:'browse',label:'Browse',icon:Search,show:true},{id:'add',label:'List Room',icon:PlusCircle,show:userType==='landlord'},{id:'my-listings',label:'My Rooms',icon:Home,show:userType==='landlord'},{id:'profile',label:'Profile',icon:User,show:true}];return/*#__PURE__*/_jsx(\"div\",{className:\"fixed bottom-0 left-0 right-0 bg-white border-t border-gray-200 shadow-2xl\",children:/*#__PURE__*/_jsx(\"div\",{className:\"max-w-7xl mx-auto flex justify-around\",children:navItems.filter(item=>item.show).map(item=>{const Icon=item.icon;const isActive=currentView===item.id||item.id==='profile'&&currentView==='edit-profile';return/*#__PURE__*/_jsxs(\"button\",{onClick:()=>setCurrentView(item.id),className:\"flex-1 flex flex-col items-center justify-center py-3 px-2 transition relative border-t-2 \".concat(isActive?'border-blue-600 text-blue-600 bg-blue-50':'border-transparent text-gray-600 hover:text-gray-800 hover:bg-gray-50'),children:[/*#__PURE__*/_jsxs(\"div\",{className:\"relative\",children:[/*#__PURE__*/_jsx(Icon,{className:\"w-6 h-6\"}),item.badge&&item.badge>0&&/*#__PURE__*/_jsx(\"span\",{className:\"absolute -top-2 -right-2 bg-red-500 text-white text-xs rounded-full w-5 h-5 flex items-center justify-center font-bold\",children:item.badge>99?'99+':item.badge})]}),/*#__PURE__*/_jsx(\"span\",{className:\"text-xs mt-1 font-medium\",children:item.label})]},item.id);})})});}","map":{"version":3,"names":["React","useState","useEffect","initFirebase","initAnalytics","requestFcmToken","listenForegroundMessages","trackEvent","MapContainer","TileLayer","Marker","Home","PlusCircle","Search","MapPin","X","User","Phone","Mail","Edit","CheckCircle","Header","ListingDetailModal","Footer","BrowseView","PrivacyPolicyModal","NotificationBanner","AnalyticsConsentModal","jsx","_jsx","jsxs","_jsxs","RentalPlatform","currentView","setCurrentView","mapView","setMapView","userType","setUserType","previewAsRenter","setPreviewAsRenter","listings","setListings","selectedListing","setSelectedListing","users","setUsers","searchLocation","setSearchLocation","priceRange","setPriceRange","selectedAmenities","setSelectedAmenities","sortBy","setSortBy","currentUser","setCurrentUser","showAuthModal","setShowAuthModal","authDefaultType","setAuthDefaultType","nearbyMode","setNearbyMode","nearbyRadius","setNearbyRadius","userLocation","setUserLocation","nearbyStatus","setNearbyStatus","showLocationConsent","setShowLocationConsent","toast","setToast","showPrivacyPolicy","setShowPrivacyPolicy","notificationBanner","setNotificationBanner","showAnalyticsConsent","setShowAnalyticsConsent","openAuthModal","type","arguments","length","undefined","loadData","app","analyticsConsent","localStorage","getItem","process","env","REACT_APP_ENABLE_ANALYTICS","setTimeout","token","console","log","e","warn","payload","notification","title","body","landlordComplete","listingsResult","userResult","usersResult","JSON","parse","user","parsed","Array","isArray","error","sampleListings","id","price","location","description","photos","status","availableDate","Date","toISOString","amenities","landlordId","landlordName","landlordPhone","landlordEmail","landlordPhoto","createdAt","isDuplicateContact","phone","email","ignoreId","normalizedPhone","trim","normalizedEmail","toLowerCase","some","u","uPhone","uEmail","phoneMatch","emailMatch","haversineDistance","lat1","lon1","lat2","lon2","toRad","v","Math","PI","R","dLat","dLon","a","sin","cos","c","atan2","sqrt","handleFindNearby","navigator","geolocation","handleLocationConsentAccept","getCurrentPosition","pos","lat","coords","latitude","lon","longitude","err","enableHighAccuracy","timeout","clearNearby","showToast","message","handleAnalyticsConsentAccept","setItem","handleAnalyticsConsentDecline","saveListings","newListings","stringify","saveSubscriptions","subscriptions","getSubscriptions","res","subscribeToArea","userId","area","alert","subs","includes","push","concat","handleProfileSetup","profileData","now","_objectSpread","whatsapp","existingUsersRaw","existingUsers","_unused","_unused2","_unused3","handleUpdateProfile","updatedUser","_unused4","idx","findIndex","_unused5","_unused6","handleQuickAuth","name","photo","_unused7","handleSignOut","removeItem","handleCompleteOnboarding","onboardData","updated","landlordInfo","handleAddListing","listingData","_listingData$latitude","_listingData$longitud","newListing","paymentMethod","updatedListings","window","scrollTo","top","behavior","filteredListings","map","listing","d","__distanceKm","filter","matchesLocation","parseFloat","matchesPrice","matchesAmenities","every","amenity","_listing$amenities","passesNearby","_listing$__distanceKm","sort","b","_a$__distanceKm","_b$__distanceKm","da","Infinity","db","className","children","href","style","clipPath","zIndex","role","onClose","onClick","ProfileSetupView","onSubmit","ProfileView","onEdit","EditProfileView","onCancel","LandlordOnboardingView","onComplete","onSelectListing","onRequireAuth","onFindNearby","previewMode","AddListingView","onRequireOnboarding","MyListingsView","l","onDelete","landlord","AuthModal","defaultType","BottomNav","LocationConsentModal","onAccept","onDecline","onOpenPrivacy","_ref","formData","setFormData","errors","setErrors","touched","setTouched","validateField","value","newErrors","test","handlePhotoUpload","file","target","files","size","reader","FileReader","onloadend","result","readAsDataURL","handleSubmit","allTouched","Object","keys","src","alt","accept","onChange","required","onBlur","placeholder","_ref2","toLocaleDateString","_ref3","form","setForm","businessName","bankDetails","idNumber","agree","charAt","checked","preventDefault","_ref4","_ref5","GEOCODER_KEY","REACT_APP_GEOCODER_API_KEY","GEOCODER_PROVIDER","REACT_APP_GEOCODER_PROVIDER","streetAddress","split","geocodingStatus","setGecodingStatus","locationHelpBanner","setLocationHelpBanner","locationSuggestions","setLocationSuggestions","locationSuggestionsLoading","setLocationSuggestionsLoading","locationSuggestionCacheRef","useRef","LOCATION_SUGGESTION_TTL_MS","availableAmenities","raw","qLower","cached","current","ts","data","controller","AbortController","t","suggestions","proximity","url","encodeURIComponent","resp","fetch","signal","json","features","f","place_name","Boolean","biasParams","delta","minLon","maxLon","minLat","maxLat","headers","uniq","forEach","item","display","display_name","parts","p","slice","join","clearTimeout","abort","geolocateCurrentPosition","rev","revData","place","street","prev","geocodeAddress","fullAddress","center","response","results","areaResponse","areaResults","DraggablePreview","_ref6","lng","setPos","zoom","whenCreated","position","draggable","eventHandlers","dragend","ll","getLatLng","toggleAmenity","from","readers","Promise","resolve","all","then","images","combined","removePhoto","index","newPhotos","_","i","shouldAttempt","s","startsWith","toFixed","rows","multiple","disabled","_ref7","_ref8","_ref9","_ref0","navItems","label","icon","show","Icon","isActive","badge"],"sources":["C:/Users/kutum/Documents/room-rental-platform/src/App.js"],"sourcesContent":["import React, { useState, useEffect } from 'react';\nimport { initFirebase, initAnalytics, requestFcmToken, listenForegroundMessages, trackEvent } from './firebase';\nimport { MapContainer, TileLayer, Marker } from 'react-leaflet';\nimport { Home, PlusCircle, Search, MapPin, X, User, Phone, Mail, Edit, CheckCircle } from 'lucide-react';\nimport Header from './components/Header';\nimport ListingDetailModal from './components/ListingDetailModal';\nimport Footer from './components/Footer';\nimport BrowseView from './components/BrowseView';\nimport PrivacyPolicyModal from './components/PrivacyPolicyModal';\nimport NotificationBanner from './components/NotificationBanner';\nimport AnalyticsConsentModal from './components/AnalyticsConsentModal';\nexport default function RentalPlatform() {\n  const [currentView, setCurrentView] = useState('browse');\n  const [mapView, setMapView] = useState(false);\n  const [userType, setUserType] = useState(null);\n  const [previewAsRenter, setPreviewAsRenter] = useState(false); // landlord UI preview toggle\n  const [listings, setListings] = useState([]);\n  const [selectedListing, setSelectedListing] = useState(null);\n  const [users, setUsers] = useState([]); // registry of all users (localStorage 'users')\n  const [searchLocation, setSearchLocation] = useState('');\n  const [priceRange, setPriceRange] = useState([0, 10000]);\n  const [selectedAmenities, setSelectedAmenities] = useState([]);\n  const [sortBy, setSortBy] = useState('newest');\n  const [currentUser, setCurrentUser] = useState(null);\n  const [showAuthModal, setShowAuthModal] = useState(false);\n  const [authDefaultType, setAuthDefaultType] = useState('renter');\n  const [nearbyMode, setNearbyMode] = useState(false);\n  const [nearbyRadius, setNearbyRadius] = useState(5); // km\n  const [userLocation, setUserLocation] = useState(null);\n  const [nearbyStatus, setNearbyStatus] = useState('');\n  const [showLocationConsent, setShowLocationConsent] = useState(false);\n  // Mobile menu state moved into Header component\n  const [toast, setToast] = useState(null);\n  const [showPrivacyPolicy, setShowPrivacyPolicy] = useState(false);\n  const [notificationBanner, setNotificationBanner] = useState(null);\n  const [showAnalyticsConsent, setShowAnalyticsConsent] = useState(false);\n\n  const openAuthModal = (type = 'renter') => {\n    setAuthDefaultType(type);\n    setShowAuthModal(true);\n  };\n  \n\n  useEffect(() => {\n    loadData();\n    // Initialize Firebase + FCM token fetch (deferred until user interaction if desired)\n    const app = initFirebase();\n    \n    // Check analytics consent and show modal if not set\n    const analyticsConsent = localStorage.getItem('analytics-consent');\n    if (!analyticsConsent && process.env.REACT_APP_ENABLE_ANALYTICS === 'true') {\n      // Delay modal slightly so UI loads first\n      setTimeout(() => setShowAnalyticsConsent(true), 2000);\n    } else if (analyticsConsent === 'yes') {\n      initAnalytics(app);\n    }\n\n    (async () => {\n      try {\n        const token = await requestFcmToken();\n        if (token) {\n          console.log('Obtained FCM token:', token);\n          trackEvent('fcm_token_obtained');\n        }\n      } catch (e) {\n        console.warn('FCM token request failed', e);\n      }\n    })();\n    \n    listenForegroundMessages((payload) => {\n      // Display notification banner instead of toast\n      const notification = payload?.notification || {};\n      if (notification.title || notification.body) {\n        setNotificationBanner({\n          title: notification.title,\n          body: notification.body\n        });\n        // Auto-dismiss after 8 seconds\n        setTimeout(() => setNotificationBanner(null), 8000);\n      }\n    });\n  }, []);\n\n  // Guard: if someone navigates to 'add' without landlord auth, prompt to sign in\n  useEffect(() => {\n    if (currentView === 'add') {\n      if (!currentUser) {\n        openAuthModal('landlord');\n        setCurrentView('browse');\n      } else if (userType !== 'landlord') {\n        // Not a landlord - prompt to become one\n        openAuthModal('landlord');\n        setCurrentView('browse');\n      } else if (!currentUser.landlordComplete) {\n        // Landlord but hasn't completed onboarding\n        setCurrentView('landlord-onboarding');\n      }\n    }\n  }, [currentView, currentUser, userType]);\n\n  const loadData = async () => {\n    try {\n      const listingsResult = localStorage.getItem('listings');\n      const userResult = localStorage.getItem('current-user');\n      const usersResult = localStorage.getItem('users');\n      \n      if (listingsResult) setListings(JSON.parse(listingsResult));\n      if (userResult) {\n        const user = JSON.parse(userResult);\n        setCurrentUser(user);\n        setUserType(user.type);\n      }\n      if (usersResult) {\n        try {\n          const parsed = JSON.parse(usersResult);\n          setUsers(Array.isArray(parsed) ? parsed : []);\n        } catch (e) {\n          console.warn('Corrupt users array in storage, resetting');\n          setUsers([]);\n        }\n      }\n    } catch (error) {\n      console.log('No existing data found, starting fresh');\n      // Add sample listings for testing the map\n      const sampleListings = [\n        {\n          id: 'listing-1',\n          title: 'Cozy Room in Soweto',\n          price: 2500,\n          location: 'Soweto, Johannesburg',\n          description: 'Comfortable room with bathroom and kitchen access',\n          photos: [],\n          status: 'available',\n          availableDate: new Date().toISOString(),\n          amenities: ['WiFi', 'Kitchen'],\n          landlordId: 'landlord-1',\n          landlordName: 'John Smith',\n          landlordPhone: '+27 123 456 7890',\n          landlordEmail: 'john@example.com',\n          landlordPhoto: '',\n          createdAt: new Date().toISOString()\n        },\n        {\n          id: 'listing-2',\n          title: 'Modern Apartment in Sandton',\n          price: 4500,\n          location: 'Sandton, Johannesburg',\n          description: 'Luxurious apartment with parking and security',\n          photos: [],\n          status: 'available',\n          availableDate: new Date().toISOString(),\n          amenities: ['WiFi', 'Parking', 'Air Conditioning'],\n          landlordId: 'landlord-2',\n          landlordName: 'Jane Doe',\n          landlordPhone: '+27 987 654 3210',\n          landlordEmail: 'jane@example.com',\n          landlordPhoto: '',\n          createdAt: new Date().toISOString()\n        },\n        {\n          id: 'listing-3',\n          title: 'Studio in Midrand',\n          price: 3200,\n          location: 'Midrand, Johannesburg',\n          description: 'Spacious studio flat with laundry facilities',\n          photos: [],\n          status: 'available',\n          availableDate: new Date().toISOString(),\n          amenities: ['Laundry', 'WiFi'],\n          landlordId: 'landlord-3',\n          landlordName: 'Mike Johnson',\n          landlordPhone: '+27 555 555 5555',\n          landlordEmail: 'mike@example.com',\n          landlordPhoto: '',\n          createdAt: new Date().toISOString()\n        }\n      ];\n      setListings(sampleListings);\n    }\n  };\n\n  // Helper: check for duplicate phone or email in registry (exclude an optional user id)\n  const isDuplicateContact = (phone, email, ignoreId = null) => {\n    const normalizedPhone = (phone || '').trim();\n    const normalizedEmail = (email || '').trim().toLowerCase();\n    if (!users || users.length === 0) return false;\n    return users.some(u => {\n      if (ignoreId && u.id === ignoreId) return false;\n      const uPhone = (u.phone || '').trim();\n      const uEmail = (u.email || '').trim().toLowerCase();\n      const phoneMatch = normalizedPhone && uPhone && uPhone === normalizedPhone;\n      const emailMatch = normalizedEmail && uEmail && uEmail === normalizedEmail;\n      return phoneMatch || emailMatch;\n    });\n  };\n\n  // Haversine formula to compute distance in kilometers between two coords\n  const haversineDistance = (lat1, lon1, lat2, lon2) => {\n    const toRad = (v) => (v * Math.PI) / 180;\n    const R = 6371; // km\n    const dLat = toRad(lat2 - lat1);\n    const dLon = toRad(lon2 - lon1);\n    const a = Math.sin(dLat / 2) * Math.sin(dLat / 2) + Math.cos(toRad(lat1)) * Math.cos(toRad(lat2)) * Math.sin(dLon / 2) * Math.sin(dLon / 2);\n    const c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1 - a));\n    return R * c;\n  };\n\n  const handleFindNearby = () => {\n    if (!navigator.geolocation) {\n      setNearbyStatus('Geolocation not supported');\n      return;\n    }\n    // Show consent modal before accessing location\n    setShowLocationConsent(true);\n  };\n\n  const handleLocationConsentAccept = () => {\n    setShowLocationConsent(false);\n    setNearbyStatus('Locating...');\n    navigator.geolocation.getCurrentPosition((pos) => {\n      const lat = pos.coords.latitude;\n      const lon = pos.coords.longitude;\n      setUserLocation({ lat, lon });\n      setNearbyMode(true);\n      setNearbyStatus('Nearby mode enabled');\n      setTimeout(() => setNearbyStatus(''), 2000);\n    }, (err) => {\n      console.error('Geolocation error', err);\n      setNearbyStatus('Could not get location');\n    }, { enableHighAccuracy: true, timeout: 10000 });\n  };\n\n  const clearNearby = () => {\n    setNearbyMode(false);\n    setUserLocation(null);\n    setNearbyStatus('');\n  };\n\n  // Toast notification helper\n  const showToast = (message, type = 'info', title = '') => {\n    setToast({ message, type, title });\n    setTimeout(() => setToast(null), 5000);\n  };\n\n  const handleAnalyticsConsentAccept = () => {\n    localStorage.setItem('analytics-consent', 'yes');\n    setShowAnalyticsConsent(false);\n    const app = initFirebase();\n    initAnalytics(app);\n    trackEvent('analytics_consent_granted');\n    showToast('Analytics enabled', 'success', 'Thank you!');\n  };\n\n  const handleAnalyticsConsentDecline = () => {\n    localStorage.setItem('analytics-consent', 'no');\n    setShowAnalyticsConsent(false);\n    showToast('Analytics disabled', 'info');\n  };\n\n  const saveListings = async (newListings) => {\n    try {\n      localStorage.setItem('listings', JSON.stringify(newListings));\n      setListings(newListings);\n    } catch (error) {\n      console.error('Error saving listings:', error);\n    }\n  };\n\n  const saveSubscriptions = async (subscriptions) => {\n    try {\n      localStorage.setItem('subscriptions', JSON.stringify(subscriptions));\n    } catch (error) {\n      console.error('Error saving subscriptions:', error);\n    }\n  };\n\n  const getSubscriptions = async () => {\n    try {\n      const res = localStorage.getItem('subscriptions');\n      return res ? JSON.parse(res) : {};\n    } catch (err) {\n      console.error('Error loading subscriptions', err);\n    }\n    return {};\n  };\n\n  const subscribeToArea = async (userId, area) => {\n    if (!userId) {\n      openAuthModal('renter');\n      return;\n    }\n    if (!area || area.trim() === '') {\n      alert('Please enter a location to subscribe to.');\n      return;\n    }\n    try {\n      const subs = await getSubscriptions();\n      subs[userId] = subs[userId] || [];\n      if (!subs[userId].includes(area)) {\n        subs[userId].push(area);\n        await saveSubscriptions(subs);\n        alert(`Subscribed to updates for ${area}`);\n      } else {\n        alert(`You are already subscribed to ${area}`);\n      }\n    } catch (err) {\n      console.error('Subscribe failed', err);\n      alert('Could not subscribe. Please try again.');\n    }\n  };\n\n  \n\nconst handleProfileSetup = async (profileData) => {\n  try {\n    // Duplicate guard\n    if (isDuplicateContact(profileData.phone, profileData.email)) {\n      showToast('Phone or email already registered', 'error', 'Duplicate');\n      return;\n    }\n    const userId = `user-${Date.now()}`;\n    const user = { \n      id: userId, \n      type: userType, \n      ...profileData,\n      whatsapp: profileData.whatsapp || '',\n      createdAt: new Date().toISOString()\n    };\n    \n    localStorage.setItem('current-user', JSON.stringify(user));\n    setCurrentUser(user);\n    // Update users registry\n    const existingUsersRaw = localStorage.getItem('users');\n    let existingUsers = [];\n    if (existingUsersRaw) {\n      try { existingUsers = JSON.parse(existingUsersRaw); } catch { existingUsers = []; }\n    }\n    existingUsers.push(user);\n    localStorage.setItem('users', JSON.stringify(existingUsers));\n    setUsers(existingUsers);\n    showToast('Profile created successfully!', 'success', 'Welcome!');\n    setCurrentView('browse');\n  } catch (error) {\n    console.error('Error saving profile:', error);\n    // Still set the user locally even if storage fails\n    const userId = `user-${Date.now()}`;\n    const user = { \n      id: userId, \n      type: userType, \n      ...profileData,\n      whatsapp: profileData.whatsapp || '',\n      createdAt: new Date().toISOString()\n    };\n    setCurrentUser(user);\n    const existingUsersRaw = localStorage.getItem('users');\n    let existingUsers = [];\n    if (existingUsersRaw) {\n      try { existingUsers = JSON.parse(existingUsersRaw); } catch { existingUsers = []; }\n    }\n    existingUsers.push(user);\n    try { localStorage.setItem('users', JSON.stringify(existingUsers)); } catch {}\n    setUsers(existingUsers);\n    showToast('Profile created (data may not be persisted)', 'error');\n    setCurrentView('browse');\n  }\n};\n\nconst handleUpdateProfile = async (profileData) => {\n  try {\n    // Duplicate guard (exclude current user id)\n    if (isDuplicateContact(profileData.phone, profileData.email, currentUser?.id)) {\n      showToast('Phone or email already used by another account', 'error', 'Duplicate');\n      return;\n    }\n    const updatedUser = { ...currentUser, ...profileData };\n    \n    localStorage.setItem('current-user', JSON.stringify(updatedUser));\n    setCurrentUser(updatedUser);\n    // Update registry entry\n    const existingUsersRaw = localStorage.getItem('users');\n    let existingUsers = [];\n    if (existingUsersRaw) {\n      try { existingUsers = JSON.parse(existingUsersRaw); } catch { existingUsers = []; }\n    }\n    const idx = existingUsers.findIndex(u => u.id === updatedUser.id);\n    if (idx !== -1) {\n      existingUsers[idx] = updatedUser;\n    } else {\n      existingUsers.push(updatedUser); // ensure presence\n    }\n    localStorage.setItem('users', JSON.stringify(existingUsers));\n    setUsers(existingUsers);\n    showToast('Profile updated successfully!', 'success');\n    setCurrentView('browse');\n  } catch (error) {\n    console.error('Error updating profile:', error);\n    const updatedUser = { ...currentUser, ...profileData };\n    setCurrentUser(updatedUser);\n    const existingUsersRaw = localStorage.getItem('users');\n    let existingUsers = [];\n    if (existingUsersRaw) {\n      try { existingUsers = JSON.parse(existingUsersRaw); } catch { existingUsers = []; }\n    }\n    const idx = existingUsers.findIndex(u => u.id === updatedUser.id);\n    if (idx !== -1) {\n      existingUsers[idx] = updatedUser;\n    } else {\n      existingUsers.push(updatedUser);\n    }\n    try { localStorage.setItem('users', JSON.stringify(existingUsers)); } catch {}\n    setUsers(existingUsers);\n    showToast('Profile updated (data may not be persisted)', 'error');\n    setCurrentView('browse');\n  }\n};\n\nconst handleQuickAuth = async (profileData) => {\n  // Lightweight auth (used by AuthModal) - create and persist a user\n  try {\n    if (isDuplicateContact(profileData.phone, profileData.email)) {\n      showToast('Phone or email already registered', 'error', 'Duplicate');\n      return;\n    }\n    const userId = `user-${Date.now()}`;\n    const user = {\n      id: userId,\n      type: profileData.type || 'renter',\n      name: profileData.name,\n      phone: profileData.phone || '',\n      email: profileData.email || '',\n      photo: profileData.photo || '',\n      createdAt: new Date().toISOString()\n    };\n    localStorage.setItem('current-user', JSON.stringify(user));\n    setCurrentUser(user);\n    setUserType(user.type);\n    // registry update\n    const existingUsersRaw = localStorage.getItem('users');\n    let existingUsers = [];\n    if (existingUsersRaw) {\n      try { existingUsers = JSON.parse(existingUsersRaw); } catch { existingUsers = []; }\n    }\n    existingUsers.push(user);\n    localStorage.setItem('users', JSON.stringify(existingUsers));\n    setUsers(existingUsers);\n    setShowAuthModal(false);\n    // If landlord, route to onboarding to complete setup before posting\n    if (user.type === 'landlord') {\n      setCurrentView('landlord-onboarding');\n    } else {\n      setCurrentView('browse');\n    }\n  } catch (err) {\n    console.error('Auth failed', err);\n  }\n};\n\n// Sign out helper so you can re-auth as renter for perspective preview\nconst handleSignOut = () => {\n  try {\n    localStorage.removeItem('current-user');\n  } catch (e) {\n    console.warn('Could not clear localStorage current-user');\n  }\n  setCurrentUser(null);\n  setUserType(null);\n  setCurrentView('browse');\n  showToast('Signed out. You can now sign in as Renter.', 'info');\n};\n\nconst handleCompleteOnboarding = async (onboardData) => {\n  try {\n    const updated = { ...currentUser, landlordComplete: true, landlordInfo: onboardData };\n    localStorage.setItem('current-user', JSON.stringify(updated));\n    setCurrentUser(updated);\n    setCurrentView('browse');\n  } catch (err) {\n    console.error('Onboarding save failed', err);\n    setCurrentUser({ ...currentUser, landlordComplete: true, landlordInfo: onboardData });\n    setCurrentView('browse');\n  }\n};\n\nconst handleAddListing = async (listingData) => {\n  const newListing = {\n    id: `listing-${Date.now()}`,\n    title: listingData.title,\n    price: listingData.price,\n    location: listingData.location,\n    description: listingData.description,\n    photos: listingData.photos || [],\n    status: listingData.status || 'available',\n    availableDate: listingData.availableDate || new Date().toISOString(),\n    amenities: listingData.amenities || [],\n    latitude: listingData.latitude ?? null,\n    longitude: listingData.longitude ?? null,\n      paymentMethod: listingData.paymentMethod || 'Bank and Cash',\n    landlordId: currentUser.id,\n    landlordName: currentUser.name,\n    landlordPhone: currentUser.phone,\n    landlordEmail: currentUser.email,\n    landlordPhoto: currentUser.photo,\n    createdAt: new Date().toISOString()\n  };\n\n    const updatedListings = [...listings, newListing];\n    await saveListings(updatedListings);\n    showToast('Listing created successfully!', 'success', 'Success!');\n    setCurrentView('browse');\n    // Scroll to top to see new listing\n    window.scrollTo({ top: 0, behavior: 'smooth' });\n  };\n\n  // Messaging removed\n\nconst filteredListings = listings\n  .map(listing => {\n    // attach distance if we have userLocation\n    if (userLocation && listing.latitude != null && listing.longitude != null) {\n      const d = haversineDistance(userLocation.lat, userLocation.lon, listing.latitude, listing.longitude);\n      return { ...listing, __distanceKm: d };\n    }\n    if (userLocation && (listing.latitude == null || listing.longitude == null)) {\n      // try to geocode-less accurate: leave distance undefined\n      return { ...listing };\n    }\n    return { ...listing };\n  })\n  .filter(listing => {\n    const matchesLocation = !searchLocation || \n      (listing.location || '').toLowerCase().includes(searchLocation.toLowerCase());\n    const price = parseFloat(listing.price);\n    const matchesPrice = price >= priceRange[0] && price <= priceRange[1];\n    const matchesAmenities = selectedAmenities.length === 0 || \n      selectedAmenities.every(amenity => listing.amenities?.includes(amenity));\n\n    let passesNearby = true;\n    if (nearbyMode && userLocation) {\n      // require listing to have coordinates to be included\n      if (listing.latitude != null && listing.longitude != null) {\n        const d = listing.__distanceKm ?? haversineDistance(userLocation.lat, userLocation.lon, listing.latitude, listing.longitude);\n        passesNearby = d <= nearbyRadius;\n      } else {\n        passesNearby = false;\n      }\n    }\n\n    return matchesLocation && matchesPrice && matchesAmenities && passesNearby;\n  })\n  .sort((a, b) => {\n    if (nearbyMode && userLocation) {\n      const da = a.__distanceKm ?? Infinity;\n      const db = b.__distanceKm ?? Infinity;\n      return da - db;\n    }\n    if (sortBy === 'newest') {\n      return new Date(b.createdAt) - new Date(a.createdAt);\n    } else if (sortBy === 'cheapest') {\n      return parseFloat(a.price) - parseFloat(b.price);\n    } else if (sortBy === 'expensive') {\n      return parseFloat(b.price) - parseFloat(a.price);\n    }\n    return 0;\n  });\n\n  // Allow guests to land on Browse by default. If userType isn't set,\n  // show a gentle callout in the header (below) so users can pick a role\n  // when they want to post or set up their profile.\n\n  return (\n    <div className=\"min-h-screen bg-gray-50\">\n      {/* Accessibility: Skip link */}\n      <a href=\"#main-content\" className=\"absolute left-2 top-2 -translate-y-full focus:translate-y-0 transition bg-blue-600 text-white px-3 py-2 rounded shadow\" style={{clipPath: 'inset(0)', zIndex: 1000}}>Skip to main content</a>\n      <Header\n        currentUser={currentUser}\n        previewAsRenter={previewAsRenter}\n        setPreviewAsRenter={setPreviewAsRenter}\n        openAuthModal={openAuthModal}\n        handleSignOut={handleSignOut}\n        setCurrentView={setCurrentView}\n      />\n      {previewAsRenter && currentUser?.type === 'landlord' && (\n        <div className=\"bg-indigo-50 border-b border-indigo-200 text-indigo-700 text-xs py-1 text-center\" role=\"status\" aria-live=\"polite\">\n          Renter preview mode: interactions are read-only. Toggle off to resume landlord actions.\n        </div>\n      )}\n\n      {/* Notification Banner (Push Notifications) */}\n      {notificationBanner && (\n        <NotificationBanner\n          title={notificationBanner.title}\n          body={notificationBanner.body}\n          onClose={() => setNotificationBanner(null)}\n        />\n      )}\n\n      {/* Toast Notification */}\n      {toast && (\n        <div className={`fixed top-20 right-4 z-50 bg-white border-l-4 ${\n          toast.type === 'success' ? 'border-green-500' : \n          toast.type === 'error' ? 'border-red-500' : \n          'border-blue-500'\n        } rounded shadow-lg p-4 animate-slideInRight flex items-start gap-3 max-w-sm`}>\n          {toast.type === 'success' && <CheckCircle className=\"w-5 h-5 text-green-500 flex-shrink-0 mt-0.5\" />}\n          <div className=\"flex-1\">\n            {toast.title && <p className=\"font-semibold text-gray-800 mb-1\">{toast.title}</p>}\n            <p className=\"text-sm text-gray-600\">{toast.message}</p>\n          </div>\n          <button \n            onClick={() => setToast(null)}\n            className=\"text-gray-400 hover:text-gray-600\"\n            aria-label=\"Close notification\"\n          >\n            <X className=\"w-4 h-4\" />\n          </button>\n        </div>\n      )}\n\n      <div id=\"main-content\" className=\"max-w-6xl mx-auto pb-20\" role=\"main\">\n        {currentView === 'setup-profile' && (\n          <ProfileSetupView onSubmit={handleProfileSetup} userType={userType} />\n        )}\n\n        {currentView === 'profile' && currentUser && (\n          <ProfileView user={currentUser} onEdit={() => setCurrentView('edit-profile')} />\n        )}\n\n        {currentView === 'edit-profile' && currentUser && (\n          <EditProfileView user={currentUser} onSubmit={handleUpdateProfile} onCancel={() => setCurrentView('profile')} />\n        )}\n\n        {currentView === 'landlord-onboarding' && currentUser && userType === 'landlord' && (\n          <LandlordOnboardingView onComplete={handleCompleteOnboarding} onCancel={() => setCurrentView('browse')} currentUser={currentUser} />\n        )}\n\n        {currentView === 'browse' && (\n                    <BrowseView \n                      listings={filteredListings}\n                      searchLocation={searchLocation}\n                      setSearchLocation={setSearchLocation}\n                      priceRange={priceRange}\n                      setPriceRange={setPriceRange}\n                      selectedAmenities={selectedAmenities}\n                      setSelectedAmenities={setSelectedAmenities}\n                      sortBy={sortBy}\n                      setSortBy={setSortBy}\n                      mapView={mapView}\n                      setMapView={setMapView}\n                      onSelectListing={setSelectedListing}\n                      setCurrentView={setCurrentView}\n                      currentUser={currentUser}\n                      onRequireAuth={openAuthModal}\n                      subscribeToArea={subscribeToArea}\n                      onFindNearby={handleFindNearby}\n                      nearbyRadius={nearbyRadius}\n                      setNearbyRadius={setNearbyRadius}\n                      nearbyMode={nearbyMode}\n                      clearNearby={clearNearby}\n                      userLocation={userLocation}\n                      nearbyStatus={nearbyStatus}\n                      previewMode={previewAsRenter}\n                    />\n        )}\n\n        {/* Messages view removed */}\n\n        {currentView === 'add' && (\n          <AddListingView\n            onSubmit={handleAddListing}\n            onCancel={() => setCurrentView('browse')}\n            currentUser={currentUser}\n            userType={userType}\n            onRequireAuth={openAuthModal}\n            onRequireOnboarding={() => setCurrentView('landlord-onboarding')}\n          />\n        )}\n\n        {currentView === 'my-listings' && currentUser && userType === 'landlord' && (\n          <MyListingsView \n            listings={listings.filter(l => l.landlordId === currentUser.id)}\n            onDelete={async (id) => {\n              const updated = listings.filter(l => l.id !== id);\n              await saveListings(updated);\n            }}\n          />\n        )}\n      </div>\n\n      {selectedListing && (\n        <ListingDetailModal \n          listing={selectedListing}\n          landlord={{\n            name: selectedListing.landlordName,\n            phone: selectedListing.landlordPhone,\n            email: selectedListing.landlordEmail,\n            photo: selectedListing.landlordPhoto\n          }}\n          onClose={() => setSelectedListing(null)}\n          userType={userType}\n          currentUser={currentUser}\n          onRequireAuth={openAuthModal}\n          previewMode={previewAsRenter}\n          showToast={showToast}\n        />\n      )}\n\n      {/* Conversation modal removed */}\n\n      {showAuthModal && (\n        <AuthModal\n          defaultType={authDefaultType}\n          onClose={() => setShowAuthModal(false)}\n          onSubmit={handleQuickAuth}\n        />\n      )}\n\n      <BottomNav \n        currentView={currentView}\n        setCurrentView={setCurrentView}\n        userType={userType}\n      />\n\n      {showLocationConsent && (\n        <LocationConsentModal\n          onAccept={handleLocationConsentAccept}\n          onDecline={() => setShowLocationConsent(false)}\n        />\n      )}\n\n      {showPrivacyPolicy && (\n        <PrivacyPolicyModal onClose={() => setShowPrivacyPolicy(false)} />\n      )}\n\n      {showAnalyticsConsent && (\n        <AnalyticsConsentModal\n          onAccept={handleAnalyticsConsentAccept}\n          onDecline={handleAnalyticsConsentDecline}\n        />\n      )}\n\n      <Footer onOpenPrivacy={() => setShowPrivacyPolicy(true)} />\n    </div>\n  );\n}\n\n\n\nfunction ProfileSetupView({ onSubmit, userType }) {\n  const [formData, setFormData] = useState({\n    name: '',\n    phone: '',\n    email: '',\n    whatsapp: '',\n    photo: ''\n  });\n  const [errors, setErrors] = useState({});\n  const [touched, setTouched] = useState({});\n\n  const validateField = (name, value) => {\n    const newErrors = { ...errors };\n    switch (name) {\n      case 'name':\n        if (!value || value.trim().length < 2) {\n          newErrors.name = 'Name must be at least 2 characters';\n        } else {\n          delete newErrors.name;\n        }\n        break;\n      case 'phone':\n        if (!value || !/^[+]?[-0-9()\\s]{7,}$/.test(value.trim())) {\n          newErrors.phone = 'Enter a valid phone number (min 7 digits)';\n        } else {\n          delete newErrors.phone;\n        }\n        break;\n      case 'email':\n        if (!value || !/^[^@\\s]+@[^@\\s]+\\.[^@\\s]+$/.test(value.trim())) {\n          newErrors.email = 'Enter a valid email address';\n        } else {\n          delete newErrors.email;\n        }\n        break;\n      case 'photo':\n        if (value === 'FILE_TOO_LARGE') {\n          newErrors.photo = 'Photo is too large (max 2MB)';\n        } else {\n          delete newErrors.photo;\n        }\n        break;\n      default:\n        break;\n    }\n    setErrors(newErrors);\n  };\n\n  const handlePhotoUpload = (e) => {\n    const file = e.target.files[0];\n    if (file) {\n      if (file.size > 2 * 1024 * 1024) { // 2MB limit\n        setFormData({ ...formData, photo: '' });\n        validateField('photo', 'FILE_TOO_LARGE');\n        return;\n      }\n      const reader = new FileReader();\n      reader.onloadend = () => {\n        setFormData({ ...formData, photo: reader.result });\n        validateField('photo', reader.result);\n      };\n      reader.readAsDataURL(file);\n    }\n  };\n\n  const handleSubmit = () => {\n    // Touch all fields\n    const allTouched = { name: true, phone: true, email: true, photo: true };\n    setTouched(allTouched);\n    validateField('name', formData.name);\n    validateField('phone', formData.phone);\n    validateField('email', formData.email);\n    if (Object.keys(errors).length === 0 && formData.name && formData.phone && formData.email) {\n      onSubmit(formData);\n    }\n  };\n\n  return (\n    <div className=\"p-4 min-h-screen bg-gray-50 pb-20\">\n      <div className=\"max-w-2xl mx-auto mt-8\">\n        <div className=\"bg-white rounded-lg shadow-sm border border-gray-200 p-8\">\n          <div className=\"text-center mb-8\">\n            <h2 className=\"text-3xl font-bold text-gray-800 mb-2\">Complete Your Profile</h2>\n            <p className=\"text-gray-600\">Help others know who you are</p>\n          </div>\n\n          <div className=\"space-y-6\">\n            {/* Photo Upload */}\n            <div className=\"flex justify-center mb-8\">\n              <div className=\"relative\">\n                {formData.photo ? (\n                  <img \n                    src={formData.photo} \n                    alt=\"Profile\" \n                    className=\"w-32 h-32 rounded-full object-cover border-4 border-blue-200 shadow-lg\" \n                  />\n                ) : (\n                  <div className=\"w-32 h-32 rounded-full bg-gradient-to-br from-blue-100 to-blue-200 flex items-center justify-center border-4 border-blue-200 shadow-lg\">\n                    <User className=\"w-16 h-16 text-blue-600\" />\n                  </div>\n                )}\n                <label className=\"absolute bottom-0 right-0 bg-blue-600 hover:bg-blue-700 text-white p-3 rounded-full cursor-pointer shadow-lg transition group\" aria-label=\"Upload profile photo\">\n                  <Edit className=\"w-5 h-5\" />\n                  <input\n                    type=\"file\"\n                    accept=\"image/*\"\n                    onChange={handlePhotoUpload}\n                    className=\"hidden\"\n                  />\n                </label>\n              </div>\n            </div>\n\n            {/* Form Fields */}\n            <div>\n              <label className=\"block text-sm font-semibold text-gray-800 mb-2\">Full Name *</label>\n              <input\n                type=\"text\"\n                required\n                value={formData.name}\n                onChange={(e) => { setFormData({ ...formData, name: e.target.value }); if (touched.name) validateField('name', e.target.value); }}\n                onBlur={(e) => { setTouched({ ...touched, name: true }); validateField('name', e.target.value); }}\n                placeholder=\"Enter your full name\"\n                aria-invalid={errors.name ? 'true' : 'false'}\n                aria-describedby={errors.name ? 'profile-name-error' : undefined}\n                className={`w-full px-4 py-3 border ${errors.name ? 'border-red-500' : 'border-gray-300'} bg-white text-gray-800 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition placeholder-gray-400`}\n              />\n              {errors.name && touched.name && <p id=\"profile-name-error\" className=\"mt-1 text-xs text-red-600\">{errors.name}</p>}\n            </div>\n\n            <div>\n              <label className=\"block text-sm font-semibold text-gray-800 mb-2\">Phone Number *</label>\n              <div className=\"relative\">\n                <Phone className=\"absolute left-4 top-3.5 w-5 h-5 text-gray-400\" />\n                <input\n                  type=\"tel\"\n                  required\n                  value={formData.phone}\n                  onChange={(e) => { setFormData({ ...formData, phone: e.target.value }); if (touched.phone) validateField('phone', e.target.value); }}\n                  onBlur={(e) => { setTouched({ ...touched, phone: true }); validateField('phone', e.target.value); }}\n                  placeholder=\"e.g., +27 12 345 6789\"\n                  aria-invalid={errors.phone ? 'true' : 'false'}\n                  aria-describedby={errors.phone ? 'profile-phone-error' : undefined}\n                  className={`w-full pl-11 pr-4 py-3 border ${errors.phone ? 'border-red-500' : 'border-gray-300'} bg-white text-gray-800 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition placeholder-gray-400`}\n                />\n              </div>\n              {errors.phone && touched.phone && <p id=\"profile-phone-error\" className=\"mt-1 text-xs text-red-600\">{errors.phone}</p>}\n            </div>\n\n            <div>\n              <label className=\"block text-sm font-semibold text-gray-800 mb-2\">Email Address *</label>\n              <div className=\"relative\">\n                <Mail className=\"absolute left-4 top-3.5 w-5 h-5 text-gray-400\" />\n                <input\n                  type=\"email\"\n                  required\n                  value={formData.email}\n                  onChange={(e) => { setFormData({ ...formData, email: e.target.value }); if (touched.email) validateField('email', e.target.value); }}\n                  onBlur={(e) => { setTouched({ ...touched, email: true }); validateField('email', e.target.value); }}\n                  placeholder=\"your.email@example.com\"\n                  aria-invalid={errors.email ? 'true' : 'false'}\n                  aria-describedby={errors.email ? 'profile-email-error' : undefined}\n                  className={`w-full pl-11 pr-4 py-3 border ${errors.email ? 'border-red-500' : 'border-gray-300'} bg-white text-gray-800 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition placeholder-gray-400`}\n                />\n              </div>\n              {errors.email && touched.email && <p id=\"profile-email-error\" className=\"mt-1 text-xs text-red-600\">{errors.email}</p>}\n            </div>\n\n            <div>\n              <label className=\"block text-sm font-semibold text-gray-800 mb-2\">WhatsApp (optional)</label>\n              <div className=\"relative\">\n                <Phone className=\"absolute left-4 top-3.5 w-5 h-5 text-gray-400\" />\n                <input\n                  type=\"tel\"\n                  value={formData.whatsapp}\n                  onChange={(e) => setFormData({ ...formData, whatsapp: e.target.value })}\n                  placeholder=\"e.g., +27 71 234 5678\"\n                  className=\"w-full pl-11 pr-4 py-3 border border-gray-300 bg-white text-gray-800 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition placeholder-gray-400\"\n                />\n              </div>\n              <p className=\"text-xs text-gray-500 mt-1\">Used to create a WhatsApp chat link on your listings.</p>\n            </div>\n\n            {/* Submit Button */}\n            <button\n              onClick={handleSubmit}\n              className=\"w-full bg-blue-600 hover:bg-blue-700 text-white font-semibold py-3 rounded-lg transition mt-8 shadow-sm\"\n            >\n              Complete Setup\n            </button>\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n}\n\nfunction ProfileView({ user, onEdit }) {\n  return (\n    <div className=\"p-4\">\n      <div className=\"bg-white rounded-lg shadow p-6 max-w-xl mx-auto\">\n        <div className=\"flex justify-between items-start mb-6\">\n          <h2 className=\"text-2xl font-bold text-gray-800\">My Profile</h2>\n          <button\n            onClick={onEdit}\n            className=\"bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg transition flex items-center gap-2\"\n          >\n            <Edit className=\"w-4 h-4\" />\n            Edit\n          </button>\n        </div>\n\n        <div className=\"flex flex-col items-center mb-6\">\n          {user.photo ? (\n            <img src={user.photo} alt=\"Profile\" className=\"w-32 h-32 rounded-full object-cover border-4 border-blue-500 mb-4\" />\n          ) : (\n            <div className=\"w-32 h-32 rounded-full bg-gray-200 flex items-center justify-center border-4 border-gray-300 mb-4\">\n              <User className=\"w-16 h-16 text-gray-400\" />\n            </div>\n          )}\n          <h3 className=\"text-2xl font-bold text-gray-800\">{user.name}</h3>\n          <span className=\"inline-block mt-2 px-4 py-1 bg-blue-100 text-blue-700 rounded-full text-sm font-semibold\">\n            {user.type === 'landlord' ? 'Landlord' : 'Renter'}\n          </span>\n        </div>\n\n        <div className=\"space-y-4\">\n          <div className=\"bg-gray-50 rounded-lg p-4\">\n            <div className=\"flex items-center text-gray-600\">\n              <Phone className=\"w-5 h-5 mr-3 text-blue-600\" />\n              <div>\n                <p className=\"text-xs text-gray-500 mb-1\">Phone Number</p>\n                <p className=\"font-semibold text-gray-800\">{user.phone}</p>\n              </div>\n            </div>\n          </div>\n\n          <div className=\"bg-gray-50 rounded-lg p-4\">\n            <div className=\"flex items-center text-gray-600\">\n              <Mail className=\"w-5 h-5 mr-3 text-blue-600\" />\n              <div>\n                <p className=\"text-xs text-gray-500 mb-1\">Email Address</p>\n                <p className=\"font-semibold text-gray-800\">{user.email}</p>\n              </div>\n            </div>\n          </div>\n\n          <div className=\"bg-gray-50 rounded-lg p-4\">\n            <div className=\"flex items-center text-gray-600\">\n              <User className=\"w-5 h-5 mr-3 text-blue-600\" />\n              <div>\n                <p className=\"text-xs text-gray-500 mb-1\">Member Since</p>\n                <p className=\"font-semibold text-gray-800\">\n                  {new Date(user.createdAt).toLocaleDateString()}\n                </p>\n              </div>\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n}\n\nfunction LandlordOnboardingView({ onComplete, onCancel, currentUser }) {\n  const [form, setForm] = useState({ businessName: currentUser?.name || '', bankDetails: '', idNumber: '', agree: false });\n\n  const handleSubmit = () => {\n    if (!form.businessName || !form.agree) {\n      alert('Please provide a display name and agree to the terms.');\n      return;\n    }\n    onComplete(form);\n  };\n\n  return (\n    <div className=\"p-4 min-h-screen bg-gray-50 pb-20\">\n      <div className=\"max-w-2xl mx-auto mt-8\">\n        <div className=\"bg-white rounded-lg shadow-sm border border-gray-200 p-8\">\n          <div className=\"flex items-center gap-6 mb-6\">\n            <div className=\"w-16 h-16 rounded-full bg-blue-50 flex items-center justify-center text-blue-600 text-2xl font-bold\">\n              {currentUser && currentUser.name ? currentUser.name.charAt(0) : 'L'}\n            </div>\n            <div>\n              <h2 className=\"text-2xl font-bold text-gray-800\">Welcome, {currentUser?.name || 'Landlord'}</h2>\n              <p className=\"text-gray-600\">A few details to get your listings live and increase trust with renters.</p>\n            </div>\n          </div>\n\n          <div className=\"space-y-4\">\n            <div>\n              <label className=\"block text-sm font-semibold text-gray-800 mb-1\">Display Name *</label>\n              <input value={form.businessName} onChange={(e) => setForm({ ...form, businessName: e.target.value })} className=\"w-full px-4 py-3 border border-gray-300 rounded-lg\" />\n              <p className=\"text-xs text-gray-500 mt-1\">This name is shown to renters on your listings and messages.</p>\n            </div>\n\n            <div>\n              <label className=\"block text-sm font-semibold text-gray-800 mb-1\">How do you want to receive payments?</label>\n              <input value={form.bankDetails} onChange={(e) => setForm({ ...form, bankDetails: e.target.value })} placeholder=\"Bank account or payment details (optional)\" className=\"w-full px-4 py-3 border border-gray-300 rounded-lg\" />\n            </div>\n\n            <div>\n              <label className=\"block text-sm font-semibold text-gray-800 mb-1\">ID Number (optional)</label>\n              <input value={form.idNumber} onChange={(e) => setForm({ ...form, idNumber: e.target.value })} className=\"w-full px-4 py-3 border border-gray-300 rounded-lg\" />\n            </div>\n\n            <div className=\"flex items-start gap-2\">\n              <input type=\"checkbox\" checked={form.agree} onChange={(e) => setForm({ ...form, agree: e.target.checked })} />\n              <div className=\"text-sm text-gray-600\">I confirm I am authorised to list these properties and agree to the <button type=\"button\" onClick={(e) => e.preventDefault()} className=\"text-blue-600 underline p-0\">terms of service</button>.</div>\n            </div>\n\n            <div className=\"flex gap-3 pt-4\">\n              <button onClick={onCancel} className=\"flex-1 bg-gray-100 hover:bg-gray-200 py-3 rounded\">Cancel</button>\n              <button onClick={handleSubmit} className=\"flex-1 bg-blue-600 hover:bg-blue-700 text-white py-3 rounded\">Complete and Start Listing</button>\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n}\n\nfunction EditProfileView({ user, onSubmit, onCancel }) {\n  const [formData, setFormData] = useState({\n    name: user.name || '',\n    phone: user.phone || '',\n    email: user.email || '',\n    whatsapp: user.whatsapp || '',\n    photo: user.photo || ''\n  });\n  const [errors, setErrors] = useState({});\n  const [touched, setTouched] = useState({});\n\n  const validateField = (name, value) => {\n    const newErrors = { ...errors };\n    switch (name) {\n      case 'name':\n        if (!value || value.trim().length < 2) {\n          newErrors.name = 'Name must be at least 2 characters';\n        } else {\n          delete newErrors.name;\n        }\n        break;\n      case 'phone':\n        if (!value || !/^[+]?[-0-9()\\s]{7,}$/.test(value.trim())) {\n          newErrors.phone = 'Enter a valid phone number';\n        } else {\n          delete newErrors.phone;\n        }\n        break;\n      case 'email':\n        if (!value || !/^[^@\\s]+@[^@\\s]+\\.[^@\\s]+$/.test(value.trim())) {\n          newErrors.email = 'Enter a valid email';\n        } else {\n          delete newErrors.email;\n        }\n        break;\n      default:\n        break;\n    }\n    setErrors(newErrors);\n  };\n\n  const handlePhotoUpload = (e) => {\n    const file = e.target.files[0];\n    if (file) {\n      const reader = new FileReader();\n      reader.onloadend = () => {\n        setFormData({ ...formData, photo: reader.result });\n      };\n      reader.readAsDataURL(file);\n    }\n  };\n\n  const handleSubmit = () => {\n    setTouched({ name: true, phone: true, email: true });\n    validateField('name', formData.name);\n    validateField('phone', formData.phone);\n    validateField('email', formData.email);\n    if (Object.keys(errors).length === 0 && formData.name && formData.phone && formData.email) {\n      onSubmit(formData);\n    }\n  };\n\n  return (\n    <div className=\"p-4 min-h-screen bg-gray-50 pb-20\">\n      <div className=\"max-w-2xl mx-auto mt-8\">\n        <div className=\"bg-white rounded-lg shadow-sm border border-gray-200 p-8\">\n          <div className=\"flex items-center justify-between mb-8\">\n            <h2 className=\"text-3xl font-bold text-gray-800\">Edit Profile</h2>\n            <button onClick={onCancel} className=\"text-gray-400 hover:text-gray-600 transition\">\n              <X className=\"w-6 h-6\" />\n            </button>\n          </div>\n\n          <div className=\"space-y-6\">\n            {/* Photo Upload */}\n            <div className=\"flex justify-center mb-8\">\n              <div className=\"relative\">\n                {formData.photo ? (\n                  <img src={formData.photo} alt=\"Profile\" className=\"w-32 h-32 rounded-full object-cover border-4 border-blue-200 shadow-lg\" />\n                ) : (\n                  <div className=\"w-32 h-32 rounded-full bg-gradient-to-br from-blue-100 to-blue-200 flex items-center justify-center border-4 border-blue-200 shadow-lg\">\n                    <User className=\"w-16 h-16 text-blue-600\" />\n                  </div>\n                )}\n                <label className=\"absolute bottom-0 right-0 bg-blue-600 hover:bg-blue-700 text-white p-3 rounded-full cursor-pointer shadow-lg transition\" aria-label=\"Upload new profile photo\">\n                  <Edit className=\"w-5 h-5\" />\n                  <input\n                    type=\"file\"\n                    accept=\"image/*\"\n                    onChange={handlePhotoUpload}\n                    className=\"hidden\"\n                  />\n                </label>\n              </div>\n            </div>\n\n            {/* Form Fields */}\n            <div>\n              <label className=\"block text-sm font-semibold text-gray-800 mb-2\">Full Name</label>\n              <input\n                type=\"text\"\n                required\n                value={formData.name}\n                onChange={(e) => { setFormData({ ...formData, name: e.target.value }); if (touched.name) validateField('name', e.target.value); }}\n                onBlur={(e) => { setTouched({ ...touched, name: true }); validateField('name', e.target.value); }}\n                aria-invalid={errors.name ? 'true' : 'false'}\n                aria-describedby={errors.name ? 'edit-name-error' : undefined}\n                className={`w-full px-4 py-3 border ${errors.name ? 'border-red-500' : 'border-gray-300'} bg-white text-gray-800 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition placeholder-gray-400`}\n              />\n              {errors.name && touched.name && <p id=\"edit-name-error\" className=\"mt-1 text-xs text-red-600\">{errors.name}</p>}\n            </div>\n\n            <div>\n              <label className=\"block text-sm font-semibold text-gray-800 mb-2\">Phone Number</label>\n              <div className=\"relative\">\n                <Phone className=\"absolute left-4 top-3.5 w-5 h-5 text-gray-400\" />\n                <input\n                  type=\"tel\"\n                  required\n                  value={formData.phone}\n                  onChange={(e) => { setFormData({ ...formData, phone: e.target.value }); if (touched.phone) validateField('phone', e.target.value); }}\n                  onBlur={(e) => { setTouched({ ...touched, phone: true }); validateField('phone', e.target.value); }}\n                  aria-invalid={errors.phone ? 'true' : 'false'}\n                  aria-describedby={errors.phone ? 'edit-phone-error' : undefined}\n                  className={`w-full pl-11 pr-4 py-3 border ${errors.phone ? 'border-red-500' : 'border-gray-300'} bg-white text-gray-800 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition placeholder-gray-400`}\n                />\n              </div>\n              {errors.phone && touched.phone && <p id=\"edit-phone-error\" className=\"mt-1 text-xs text-red-600\">{errors.phone}</p>}\n            </div>\n\n            <div>\n              <label className=\"block text-sm font-semibold text-gray-800 mb-2\">Email Address</label>\n              <div className=\"relative\">\n                <Mail className=\"absolute left-4 top-3.5 w-5 h-5 text-gray-400\" />\n                <input\n                  type=\"email\"\n                  required\n                  value={formData.email}\n                  onChange={(e) => { setFormData({ ...formData, email: e.target.value }); if (touched.email) validateField('email', e.target.value); }}\n                  onBlur={(e) => { setTouched({ ...touched, email: true }); validateField('email', e.target.value); }}\n                  aria-invalid={errors.email ? 'true' : 'false'}\n                  aria-describedby={errors.email ? 'edit-email-error' : undefined}\n                  className={`w-full pl-11 pr-4 py-3 border ${errors.email ? 'border-red-500' : 'border-gray-300'} bg-white text-gray-800 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition placeholder-gray-400`}\n                />\n              </div>\n              {errors.email && touched.email && <p id=\"edit-email-error\" className=\"mt-1 text-xs text-red-600\">{errors.email}</p>}\n            </div>\n\n            <div>\n              <label className=\"block text-sm font-semibold text-gray-800 mb-2\">WhatsApp (optional)</label>\n              <div className=\"relative\">\n                <Phone className=\"absolute left-4 top-3.5 w-5 h-5 text-gray-400\" />\n                <input\n                  type=\"tel\"\n                  value={formData.whatsapp}\n                  onChange={(e) => setFormData({ ...formData, whatsapp: e.target.value })}\n                  placeholder=\"e.g., +27 71 234 5678\"\n                  className=\"w-full pl-11 pr-4 py-3 border border-gray-300 bg-white text-gray-800 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition placeholder-gray-400\"\n                />\n              </div>\n              <p className=\"text-xs text-gray-500 mt-1\">Used to create a WhatsApp chat link on your listings.</p>\n            </div>\n\n            {/* Action Buttons */}\n            <div className=\"flex gap-3 pt-6 border-t border-gray-200\">\n              <button\n                onClick={onCancel}\n                className=\"flex-1 bg-gray-100 hover:bg-gray-200 text-gray-800 font-semibold py-3 rounded-lg transition\"\n              >\n                Cancel\n              </button>\n              <button\n                onClick={handleSubmit}\n                className=\"flex-1 bg-blue-600 hover:bg-blue-700 text-white font-semibold py-3 rounded-lg transition shadow-sm\"\n              >\n                Save Changes\n              </button>\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n}\n\n/* BrowseView extracted to components/BrowseView.jsx */\n\nfunction AddListingView({ onSubmit, onCancel, currentUser, userType, onRequireAuth, onRequireOnboarding }) {\n  const GEOCODER_KEY = process.env.REACT_APP_GEOCODER_API_KEY;\n  const GEOCODER_PROVIDER = (process.env.REACT_APP_GEOCODER_PROVIDER || '').toLowerCase();\n\n  const [formData, setFormData] = useState({\n    title: '',\n    price: '',\n    location: '',\n    streetAddress: '',\n    description: '',\n    photos: [],\n    status: 'available',\n    availableDate: new Date().toISOString().split('T')[0],\n    amenities: [],\n    latitude: null,\n    longitude: null,\n    paymentMethod: 'Bank and Cash'\n  });\n  const [geocodingStatus, setGecodingStatus] = useState('');\n  const [errors, setErrors] = useState({});\n  const [locationHelpBanner, setLocationHelpBanner] = useState('');\n  const [locationSuggestions, setLocationSuggestions] = useState([]);\n  const [locationSuggestionsLoading, setLocationSuggestionsLoading] = useState(false);\n  const locationSuggestionCacheRef = React.useRef({}); // { queryLower: { data, ts } }\n  const LOCATION_SUGGESTION_TTL_MS = 15 * 60 * 1000;\n\n  const availableAmenities = [\n    'WiFi', 'Parking', 'Kitchen', 'Laundry', 'Air Conditioning', \n    'Heating', 'TV', 'Furnished', 'Pet Friendly', 'Garden'\n  ];\n\n  const validateField = (name, value) => {\n    const newErrors = { ...errors };\n    \n    switch (name) {\n      case 'title':\n        if (!value || value.trim().length < 5) {\n          newErrors.title = 'Title must be at least 5 characters';\n        } else {\n          delete newErrors.title;\n        }\n        break;\n      case 'price':\n        if (!value || parseFloat(value) <= 0) {\n          newErrors.price = 'Price must be greater than 0';\n        } else if (parseFloat(value) < 500) {\n          newErrors.price = 'Price seems too low (minimum R500)';\n        } else if (parseFloat(value) > 50000) {\n          newErrors.price = 'Price seems too high (maximum R50,000)';\n        } else {\n          delete newErrors.price;\n        }\n        break;\n      case 'location':\n        if (!value || value.trim().length < 3) {\n          newErrors.location = 'Location is required (min 3 characters)';\n        } else {\n          delete newErrors.location;\n        }\n        break;\n      case 'description':\n        if (value && value.length > 500) {\n          newErrors.description = 'Description is too long (max 500 characters)';\n        } else {\n          delete newErrors.description;\n        }\n        break;\n      default:\n        break;\n    }\n    \n    setErrors(newErrors);\n  };\n\n  // Debounced provider-aware suggestions (Mapbox/Nominatim) with caching & bias\n  useEffect(() => {\n    const raw = (formData.location || '').trim();\n    if (raw.length < 3) { setLocationSuggestions([]); setLocationSuggestionsLoading(false); return; }\n    const qLower = raw.toLowerCase();\n    const cached = locationSuggestionCacheRef.current[qLower];\n    if (cached && (Date.now() - cached.ts) < LOCATION_SUGGESTION_TTL_MS) {\n      setLocationSuggestions(cached.data);\n      return;\n    }\n    const controller = new AbortController();\n    setLocationSuggestionsLoading(true);\n    const t = setTimeout(async () => {\n      try {\n        let suggestions = [];\n        if (GEOCODER_PROVIDER === 'mapbox' && GEOCODER_KEY) {\n          const proximity = (formData.latitude && formData.longitude) ? `&proximity=${formData.longitude},${formData.latitude}` : '';\n          const url = `https://api.mapbox.com/geocoding/v5/mapbox.places/${encodeURIComponent(raw)}.json?access_token=${GEOCODER_KEY}&limit=5&country=ZA&language=en${proximity}&types=place,locality,neighborhood`;\n          const resp = await fetch(url, { signal: controller.signal });\n          const data = await resp.json();\n          if (data && Array.isArray(data.features)) {\n            suggestions = data.features.map(f => f.place_name).filter(Boolean);\n          }\n        } else {\n          let biasParams = '';\n          if (formData.latitude && formData.longitude) {\n            const delta = 0.2;\n            const minLon = formData.longitude - delta;\n            const maxLon = formData.longitude + delta;\n            const minLat = formData.latitude - delta;\n            const maxLat = formData.latitude + delta;\n            biasParams = `&bounded=1&viewbox=${minLon},${maxLat},${maxLon},${minLat}`;\n          }\n          const url = `https://nominatim.openstreetmap.org/search?format=json&q=${encodeURIComponent(raw + ', South Africa')}&limit=5${biasParams}`;\n          const resp = await fetch(url, { signal: controller.signal, headers: { 'Accept-Language': 'en' } });\n          const data = await resp.json();\n          const uniq = [];\n          data.forEach(item => {\n            const display = item.display_name || '';\n            const parts = display.split(',').map(p => p.trim());\n            const area = parts.slice(0, 2).join(', ');\n            if (area && !uniq.includes(area)) uniq.push(area);\n          });\n          suggestions = uniq.slice(0,5);\n        }\n        locationSuggestionCacheRef.current[qLower] = { data: suggestions, ts: Date.now() };\n        setLocationSuggestions(suggestions);\n      } catch (e) {\n        setLocationSuggestions([]);\n      } finally {\n        setLocationSuggestionsLoading(false);\n      }\n    }, 500);\n    return () => { clearTimeout(t); controller.abort(); };\n  }, [formData.location, formData.latitude, formData.longitude, GEOCODER_PROVIDER, GEOCODER_KEY, LOCATION_SUGGESTION_TTL_MS]);\n\n  // Geocode address using Nominatim (OpenStreetMap)\n  // Use browser geolocation and reverse-geocode to fill address/coords\n  const geolocateCurrentPosition = () => {\n    if (!navigator.geolocation) {\n      setGecodingStatus('Geolocation not supported by your browser');\n      setLocationHelpBanner('Location is disabled. Tap for steps to enable.');\n      return;\n    }\n\n    setGecodingStatus('Locating...');\n    navigator.geolocation.getCurrentPosition(async (pos) => {\n      const lat = pos.coords.latitude;\n      const lon = pos.coords.longitude;\n      setFormData({ ...formData, latitude: lat, longitude: lon });\n\n      // Reverse geocode to get a readable address\n      try {\n        if (GEOCODER_PROVIDER === 'mapbox' && GEOCODER_KEY) {\n          const rev = await fetch(`https://api.mapbox.com/geocoding/v5/mapbox.places/${lon},${lat}.json?access_token=${GEOCODER_KEY}&limit=1&country=za`);\n          const revData = await rev.json();\n          if (revData && revData.features && revData.features.length > 0) {\n            const place = revData.features[0].place_name || '';\n            const parts = place.split(',').map(p => p.trim());\n            const street = parts.slice(0, 2).join(', ');\n            const area = parts.slice(2, 4).join(', ');\n            setFormData(prev => ({ ...prev, streetAddress: street || prev.streetAddress, location: area || prev.location }));\n            setGecodingStatus(' Current location set');\n            setTimeout(() => setGecodingStatus(''), 2500);\n            return;\n          }\n        } else {\n          const rev = await fetch(`https://nominatim.openstreetmap.org/reverse?format=json&lat=${lat}&lon=${lon}`);\n          const revData = await rev.json();\n          if (revData) {\n            const display = revData.display_name || '';\n            // Try to split display name into street and area\n            const parts = display.split(',').map(p => p.trim());\n            const street = parts.slice(0, 2).join(', ');\n            const area = parts.slice(2, 4).join(', ');\n            setFormData(prev => ({ ...prev, streetAddress: street || prev.streetAddress, location: area || prev.location }));\n            setGecodingStatus(' Current location set');\n            setTimeout(() => setGecodingStatus(''), 2500);\n            return;\n          }\n        }\n\n      } catch (e) {\n        console.error('Reverse geocode failed', e);\n      }\n\n      setGecodingStatus(' Coordinates obtained');\n      setTimeout(() => setGecodingStatus(''), 2000);\n    }, (err) => {\n      console.error('Geolocation error', err);\n      setGecodingStatus('Could not get your location');\n      setLocationHelpBanner('Location permission denied. Tap here for steps to enable.');\n    }, { enableHighAccuracy: true, timeout: 10000 });\n  };\n\n  const geocodeAddress = async () => {\n    if (!formData.streetAddress) {\n      setGecodingStatus('Please enter a street address');\n      return;\n    }\n    \n    setGecodingStatus('Finding coordinates...');\n    try {\n      const fullAddress = `${formData.streetAddress}, ${formData.location}, South Africa`;\n      // Try Mapbox if configured\n      if (GEOCODER_PROVIDER === 'mapbox' && GEOCODER_KEY) {\n        try {\n          const resp = await fetch(`https://api.mapbox.com/geocoding/v5/mapbox.places/${encodeURIComponent(fullAddress)}.json?access_token=${GEOCODER_KEY}&limit=1&country=za`);\n          const data = await resp.json();\n          if (data && data.features && data.features.length > 0) {\n            const [lon, lat] = data.features[0].center || [];\n            setFormData({ ...formData, latitude: parseFloat(lat), longitude: parseFloat(lon) });\n            setGecodingStatus(' Address found (Mapbox)!');\n            setTimeout(() => setGecodingStatus(''), 2000);\n            return;\n          }\n        } catch (err) {\n          console.warn('Mapbox geocoding failed, falling back to Nominatim', err);\n        }\n      }\n\n      // Default / fallback: Nominatim\n      const response = await fetch(\n        `https://nominatim.openstreetmap.org/search?format=json&q=${encodeURIComponent(fullAddress)}`\n      );\n      const results = await response.json();\n\n      if (results.length > 0) {\n        const { lat, lon } = results[0];\n        setFormData({ \n          ...formData, \n          latitude: parseFloat(lat), \n          longitude: parseFloat(lon) \n        });\n        setGecodingStatus(' Address found!');\n        setTimeout(() => setGecodingStatus(''), 2000);\n      } else {\n        setGecodingStatus('Address not found. Trying with area only...');\n        // Fallback: just use the area/city\n        const areaResponse = await fetch(\n          `https://nominatim.openstreetmap.org/search?format=json&q=${encodeURIComponent(formData.location + ', South Africa')}`\n        );\n        const areaResults = await areaResponse.json();\n        if (areaResults.length > 0) {\n          const { lat, lon } = areaResults[0];\n          setFormData({ \n            ...formData, \n            latitude: parseFloat(lat), \n            longitude: parseFloat(lon) \n          });\n          setGecodingStatus(' Area found!');\n          setTimeout(() => setGecodingStatus(''), 2000);\n        } else {\n          setGecodingStatus('Could not find location');\n        }\n      }\n    } catch (error) {\n      console.error('Geocoding error:', error);\n      setGecodingStatus('Error finding address. Check your connection.');\n    }\n  };\n\n  // Draggable preview marker component for Add Listing\n  function DraggablePreview({ lat, lng }) {\n    const [pos, setPos] = useState(lat && lng ? [lat, lng] : null);\n    useEffect(() => {\n      if (lat && lng) setPos([lat, lng]);\n    }, [lat, lng]);\n\n    if (!pos) return null;\n    return (\n      <MapContainer center={pos} zoom={15} className=\"w-full h-48 rounded-lg\" whenCreated={() => {}}>\n        <TileLayer url=\"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png\" />\n        <Marker\n          position={pos}\n          draggable={true}\n          eventHandlers={{\n            dragend: (e) => {\n              const ll = e.target.getLatLng();\n              setPos([ll.lat, ll.lng]);\n              setFormData(prev => ({ ...prev, latitude: ll.lat, longitude: ll.lng }));\n            }\n          }}\n        />\n      </MapContainer>\n    );\n  }\n\n  const toggleAmenity = (amenity) => {\n    if (formData.amenities.includes(amenity)) {\n      setFormData({ ...formData, amenities: formData.amenities.filter(a => a !== amenity) });\n    } else {\n      setFormData({ ...formData, amenities: [...formData.amenities, amenity] });\n    }\n  };\n\n  const handlePhotoUpload = (e) => {\n    const files = Array.from(e.target.files || []);\n    if (files.length === 0) return;\n\n    const readers = files.map(file => new Promise((resolve) => {\n      const reader = new FileReader();\n      reader.onloadend = () => resolve(reader.result);\n      reader.readAsDataURL(file);\n    }));\n\n    Promise.all(readers).then(images => {\n      const combined = [...formData.photos, ...images].slice(0, 5); // cap at 5\n      setFormData({ ...formData, photos: combined });\n    });\n  };\n\n  const removePhoto = (index) => {\n    const newPhotos = formData.photos.filter((_, i) => i !== index);\n    setFormData({ ...formData, photos: newPhotos });\n  };\n\n  const handleSubmit = () => {\n    // Enforce auth and onboarding checks before allowing submission\n    if (!currentUser) {\n      onRequireAuth && onRequireAuth('landlord');\n      return;\n    }\n    if (userType !== 'landlord') {\n      // prompt to become landlord\n      onRequireAuth && onRequireAuth('landlord');\n      return;\n    }\n    if (!currentUser.landlordComplete) {\n      // send to onboarding\n      onRequireOnboarding && onRequireOnboarding();\n      return;\n    }\n\n    // Validate all fields\n    validateField('title', formData.title);\n    validateField('price', formData.price);\n    validateField('location', formData.location);\n    validateField('description', formData.description);\n\n    if (!formData.title || formData.title.trim().length < 5) {\n      setErrors(prev => ({ ...prev, title: 'Title must be at least 5 characters' }));\n      return;\n    }\n    if (!formData.price || parseFloat(formData.price) <= 0) {\n      setErrors(prev => ({ ...prev, price: 'Price must be greater than 0' }));\n      return;\n    }\n    if (!formData.location || formData.location.trim().length < 3) {\n      setErrors(prev => ({ ...prev, location: 'Location is required' }));\n      return;\n    }\n    if (Object.keys(errors).length > 0) {\n      return;\n    }\n\n    onSubmit(formData);\n  };\n\n  // Auto-attempt geolocation shortly after mount for landlord convenience\n  useEffect(() => {\n    const shouldAttempt = !formData.latitude && !formData.longitude;\n    if (shouldAttempt) {\n      const t = setTimeout(() => {\n        geolocateCurrentPosition();\n      }, 800);\n      return () => clearTimeout(t);\n    }\n  // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [formData.latitude, formData.longitude]);\n\n  return (\n    <div className=\"p-4 bg-gray-50 min-h-screen pb-20\">\n      <div className=\"max-w-3xl mx-auto mt-8\">\n        <div className=\"bg-white rounded-lg shadow-sm border border-gray-200 p-8\">\n          <div className=\"flex items-center justify-between mb-8\">\n            <h2 className=\"text-3xl font-bold text-gray-800\">Post a Room</h2>\n            <button onClick={onCancel} className=\"text-gray-400 hover:text-gray-600 transition\">\n              <X className=\"w-6 h-6\" />\n            </button>\n          </div>\n\n          <div className=\"space-y-6\">\n            {/* Title */}\n            <div>\n              <label className=\"block text-sm font-semibold text-gray-800 mb-2\">Room Title *</label>\n              <input\n                type=\"text\"\n                required\n                value={formData.title}\n                onChange={(e) => {\n                  setFormData({ ...formData, title: e.target.value });\n                  validateField('title', e.target.value);\n                }}\n                onBlur={(e) => validateField('title', e.target.value)}\n                placeholder=\"e.g., Cozy backroom with bathroom\"\n                className={`w-full px-4 py-3 border ${errors.title ? 'border-red-500' : 'border-gray-300'} bg-white text-gray-800 rounded-lg focus:ring-2 ${errors.title ? 'focus:ring-red-500' : 'focus:ring-blue-500'} focus:border-transparent transition placeholder-gray-400`}\n              />\n              {errors.title && <p className=\"text-red-500 text-xs mt-1\">{errors.title}</p>}\n            </div>\n\n            {/* Price */}\n            <div>\n              <label className=\"block text-sm font-semibold text-gray-800 mb-2\">Monthly Price (R) *</label>\n              <input\n                type=\"number\"\n                required\n                value={formData.price}\n                onChange={(e) => {\n                  setFormData({ ...formData, price: e.target.value });\n                  validateField('price', e.target.value);\n                }}\n                onBlur={(e) => validateField('price', e.target.value)}\n                placeholder=\"e.g., 2500\"\n                className={`w-full px-4 py-3 border ${errors.price ? 'border-red-500' : 'border-gray-300'} bg-white text-gray-800 rounded-lg focus:ring-2 ${errors.price ? 'focus:ring-red-500' : 'focus:ring-blue-500'} focus:border-transparent transition placeholder-gray-400`}\n              />\n              {errors.price && <p className=\"text-red-500 text-xs mt-1\">{errors.price}</p>}\n            </div>\n\n            {/* Location and Street Address */}\n            <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n              <div>\n                <label className=\"block text-sm font-semibold text-gray-800 mb-2\">Area / City *</label>\n                <input\n                  type=\"text\"\n                  required\n                  value={formData.location}\n                  onChange={(e) => {\n                    setFormData({ ...formData, location: e.target.value });\n                    validateField('location', e.target.value);\n                  }}\n                  onBlur={(e) => validateField('location', e.target.value)}\n                  placeholder=\"e.g., Soweto, Johannesburg\"\n                  className={`w-full px-4 py-3 border ${errors.location ? 'border-red-500' : 'border-gray-300'} bg-white text-gray-800 rounded-lg focus:ring-2 ${errors.location ? 'focus:ring-red-500' : 'focus:ring-blue-500'} focus:border-transparent transition placeholder-gray-400`}\n                />\n                {errors.location && <p className=\"text-red-500 text-xs mt-1\">{errors.location}</p>}\n                {locationSuggestionsLoading && (\n                  <p className=\"text-xs text-blue-600 mt-1 animate-pulse\" aria-live=\"polite\">Loading suggestions...</p>\n                )}\n                {locationSuggestions.length > 0 && (\n                  <div className=\"mt-2 border border-gray-200 rounded-lg bg-white shadow-sm divide-y\">\n                    {locationSuggestions.map(s => (\n                      <button\n                        key={s}\n                        type=\"button\"\n                        onClick={() => { setFormData({ ...formData, location: s }); setLocationSuggestions([]); validateField('location', s); }}\n                        className=\"w-full text-left px-3 py-2 text-sm hover:bg-blue-50\"\n                      >{s}</button>\n                    ))}\n                  </div>\n                )}\n              </div>\n\n              <div>\n                <label className=\"block text-sm font-semibold text-gray-800 mb-2\">Street Address</label>\n                <input\n                  type=\"text\"\n                  value={formData.streetAddress}\n                  onChange={(e) => setFormData({ ...formData, streetAddress: e.target.value })}\n                  placeholder=\"e.g., 123 Main Street\"\n                  className=\"w-full px-4 py-3 border border-gray-300 bg-white text-gray-800 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition placeholder-gray-400\"\n                />\n              </div>\n            </div>\n\n            {/* Geocode Section - More Prominent */}\n            <div className=\"bg-blue-50 border-2 border-blue-200 rounded-lg p-6\">\n              <div className=\"flex items-start gap-3 mb-4\">\n                <MapPin className=\"w-6 h-6 text-blue-600 flex-shrink-0 mt-1\" />\n                <div className=\"flex-1\">\n                  <h3 className=\"text-lg font-semibold text-gray-800 mb-1\">Set Location on Map</h3>\n                  <p className=\"text-sm text-gray-600\">Help renters find your listing by pinpointing its exact location.</p>\n                </div>\n              </div>\n\n              <div className=\"flex flex-wrap gap-3 items-center mb-4\">\n                {locationHelpBanner && (\n                  <div className=\"w-full bg-yellow-50 border-2 border-yellow-200 text-yellow-800 rounded-lg p-3 text-sm flex items-start gap-2\">\n                    <span></span>\n                    <div className=\"flex-1\">\n                      {locationHelpBanner}\n                      <button\n                        type=\"button\"\n                        className=\"ml-2 underline font-semibold\"\n                        onClick={() => window.alert('To enable location: 1) Tap the lock icon in the address bar. 2) Find Location permission. 3) Set to Allow. Then refresh the page.')}\n                      >How to enable</button>\n                    </div>\n                  </div>\n                )}\n                <div className=\"w-full text-xs text-blue-700 bg-blue-50 border border-blue-200 rounded p-2\">\n                  Tip: Using \"Use Current Location\" is recommended for accuracy. Street address can be approximate  drag the pin to fine tune.\n                </div>\n                <button\n                  type=\"button\"\n                  onClick={geocodeAddress}\n                  className=\"bg-blue-600 hover:bg-blue-700 text-white px-6 py-3 rounded-lg text-sm font-semibold transition shadow-sm flex items-center gap-2\"\n                >\n                  <MapPin className=\"w-4 h-4\" />\n                  Find on Map\n                </button>\n\n                <button\n                  type=\"button\"\n                  onClick={geolocateCurrentPosition}\n                  className=\"bg-white hover:bg-gray-50 border-2 border-gray-300 text-gray-800 px-6 py-3 rounded-lg text-sm font-semibold transition shadow-sm flex items-center gap-2\"\n                >\n                  <MapPin className=\"w-4 h-4\" />\n                  Use Current Location\n                </button>\n\n                <div className=\"text-sm flex-1\">\n                  {geocodingStatus && (\n                    <span className={`${geocodingStatus.startsWith('') ? 'text-green-600 font-semibold' : 'text-gray-700'} flex items-center gap-1`}>\n                      {geocodingStatus.startsWith('') && <CheckCircle className=\"w-4 h-4\" />}\n                      {geocodingStatus}\n                    </span>\n                  )}\n                  {formData.latitude && formData.longitude && !geocodingStatus && (\n                    <span className=\"text-green-600 font-semibold flex items-center gap-1\">\n                      <CheckCircle className=\"w-4 h-4\" />\n                      Location set: {formData.latitude.toFixed(4)}, {formData.longitude.toFixed(4)}\n                    </span>\n                  )}\n                </div>\n              </div>\n\n              {/* Draggable preview map */}\n              <div className=\"mt-4\">\n                {(formData.latitude && formData.longitude) ? (\n                  <div>\n                    <label className=\"block text-sm font-semibold text-gray-800 mb-2\">Fine-tune Location (drag pin)</label>\n                    <DraggablePreview lat={formData.latitude} lng={formData.longitude} />\n                  </div>\n                ) : (\n                  <div className=\"text-sm text-gray-600 bg-white border border-gray-200 rounded-lg p-4 text-center\">\n                    <MapPin className=\"w-8 h-8 mx-auto mb-2 text-gray-400\" />\n                    No location set yet. Click \"Find on Map\" or \"Use Current Location\" to place a pin.\n                  </div>\n                )}\n              </div>\n            </div>\n\n            {/* Status and Available Date - Two columns */}\n            <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n              <div>\n                <label className=\"block text-sm font-semibold text-gray-800 mb-2\">Status</label>\n                <select\n                  value={formData.status}\n                  onChange={(e) => setFormData({ ...formData, status: e.target.value })}\n                  className=\"w-full px-4 py-3 border border-gray-300 bg-white text-gray-800 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition\"\n                >\n                  <option value=\"available\">Available</option>\n                  <option value=\"rented\">Rented</option>\n                </select>\n              </div>\n\n              <div>\n                <label className=\"block text-sm font-semibold text-gray-800 mb-2\">Available Date</label>\n                <input\n                  type=\"date\"\n                  value={formData.availableDate}\n                  onChange={(e) => setFormData({ ...formData, availableDate: e.target.value })}\n                  className=\"w-full px-4 py-3 border border-gray-300 bg-white text-gray-800 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition\"\n                />\n              </div>\n            </div>\n\n            {/* Payment Method */}\n            <div>\n              <label className=\"block text-sm font-semibold text-gray-800 mb-2\">Payment Method</label>\n              <select\n                value={formData.paymentMethod}\n                onChange={(e) => setFormData({ ...formData, paymentMethod: e.target.value })}\n                className=\"w-full px-4 py-3 border border-gray-300 bg-white text-gray-800 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition\"\n              >\n                <option value=\"Bank and Cash\">Bank and Cash</option>\n                <option value=\"Cash Only\">Cash Only</option>\n                <option value=\"Bank Only\">Bank Only</option>\n              </select>\n            </div>\n\n            {/* Description */}\n            <div>\n              <label className=\"block text-sm font-semibold text-gray-800 mb-2\">\n                Description \n                {formData.description && (\n                  <span className={`ml-2 text-xs ${formData.description.length > 500 ? 'text-red-500' : 'text-gray-500'}`}>\n                    ({formData.description.length}/500 characters)\n                  </span>\n                )}\n              </label>\n              <textarea\n                value={formData.description}\n                onChange={(e) => {\n                  setFormData({ ...formData, description: e.target.value });\n                  validateField('description', e.target.value);\n                }}\n                onBlur={(e) => validateField('description', e.target.value)}\n                placeholder=\"Describe the room, amenities, rules, and any other details...\"\n                rows=\"4\"\n                className={`w-full px-4 py-3 border ${errors.description ? 'border-red-500' : 'border-gray-300'} bg-white text-gray-800 rounded-lg focus:ring-2 ${errors.description ? 'focus:ring-red-500' : 'focus:ring-blue-500'} focus:border-transparent transition placeholder-gray-400`}\n              />\n              {errors.description && <p className=\"text-red-500 text-xs mt-1\">{errors.description}</p>}\n            </div>\n\n            {/* Amenities */}\n            <div>\n              <label className=\"block text-sm font-semibold text-gray-800 mb-3\">Amenities</label>\n              <div className=\"grid grid-cols-2 md:grid-cols-3 gap-2\">\n                {availableAmenities.map(amenity => (\n                  <button\n                    key={amenity}\n                    type=\"button\"\n                    onClick={() => toggleAmenity(amenity)}\n                    className={`px-4 py-2 rounded-lg text-sm font-medium transition ${\n                      formData.amenities.includes(amenity)\n                        ? 'bg-blue-600 text-white shadow-sm'\n                        : 'bg-gray-100 text-gray-700 border border-gray-300 hover:bg-gray-200'\n                    }`}\n                  >\n                    {amenity}\n                  </button>\n                ))}\n              </div>\n            </div>\n\n            {/* Photos */}\n            <div>\n              <label className=\"block text-sm font-semibold text-gray-800 mb-2\">Photos (Max 5)</label>\n              <input\n                type=\"file\"\n                accept=\"image/*\"\n                multiple\n                onChange={handlePhotoUpload}\n                disabled={formData.photos.length >= 5}\n                className=\"w-full px-4 py-3 border border-gray-300 bg-white text-gray-700 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition cursor-pointer\"\n              />\n              {formData.photos.length > 0 && (\n                <div className=\"mt-4 grid grid-cols-2 md:grid-cols-3 gap-3\">\n                  {formData.photos.map((photo, index) => (\n                    <div key={index} className=\"relative group\">\n                      <img \n                        src={photo} \n                        alt={`Preview ${index + 1}`} \n                        className=\"w-full h-32 object-cover rounded-lg border border-gray-200 shadow-sm\" \n                      />\n                      <button\n                        type=\"button\"\n                        onClick={() => removePhoto(index)}\n                        className=\"absolute top-2 right-2 bg-red-500 hover:bg-red-600 text-white rounded-full w-6 h-6 flex items-center justify-center shadow-lg opacity-0 group-hover:opacity-100 transition\"\n                      >\n                        <X className=\"w-4 h-4\" />\n                      </button>\n                    </div>\n                  ))}\n                </div>\n              )}\n              {formData.photos.length >= 5 && (\n                <p className=\"text-sm text-gray-500 mt-2\">Maximum 5 photos reached</p>\n              )}\n            </div>\n\n            {/* Submit Button */}\n            <div className=\"border-t border-gray-200 pt-6\">\n              <button\n                onClick={handleSubmit}\n                className=\"w-full bg-blue-600 hover:bg-blue-700 text-white font-semibold py-3 rounded-lg transition shadow-sm\"\n              >\n                Post Room\n              </button>\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n}\n\n// MessagesView removed - using direct contact instead\n\nfunction MyListingsView({ listings, onDelete }) {\n  return (\n    <div className=\"p-4\">\n      <h2 className=\"text-2xl font-bold mb-4 text-gray-800\">My Listings</h2>\n      <div className=\"space-y-4\">\n        {listings.length === 0 ? (\n          <div className=\"bg-white rounded-lg shadow p-8 text-center text-gray-500\">\n            <Home className=\"w-16 h-16 mx-auto mb-4 text-gray-300\" />\n            <p>You haven't posted any rooms yet.</p>\n          </div>\n        ) : (\n          listings.map(listing => (\n            <div key={listing.id} className=\"bg-white rounded-lg shadow p-4\">\n{listing.photos && listing.photos.length > 0 && (\n  <div className=\"relative mb-3\">\n    <img src={listing.photos[0]} alt=\"Room\" className=\"w-full h-32 object-cover rounded-lg\" />\n    {listing.photos.length > 1 && (\n      <div className=\"absolute top-2 right-2 bg-black bg-opacity-60 text-white px-2 py-1 rounded text-xs\">\n        {listing.photos.length} photos\n      </div>\n    )}\n  </div>\n)}\n              <h3 className=\"font-bold text-lg mb-1\">{listing.title}</h3>\n              <div className=\"text-blue-600 font-bold mb-2\">R{listing.price}/month</div>\n              <div className=\"flex items-center text-gray-600 text-sm mb-3\">\n                <MapPin className=\"w-4 h-4 mr-1\" />\n                {listing.location}\n              </div>\n              <button\n                onClick={() => onDelete(listing.id)}\n                className=\"w-full bg-red-500 hover:bg-red-600 text-white py-2 rounded-lg transition\"\n              >\n                Delete Listing\n              </button>\n            </div>\n          ))\n        )}\n      </div>\n    </div>\n  );\n}\n\n\n// Inline message box component with validation for listing detail view\n// ListingInlineMessageBox removed\n\n// ConversationModal removed\n\nfunction AuthModal({ defaultType = 'renter', onClose, onSubmit }) {\n  const [form, setForm] = useState({ name: '', phone: '', email: '', type: defaultType, photo: '' });\n\n  const handleSubmit = () => {\n    if (!form.name || !form.email) {\n      alert('Please add a name and email');\n      return;\n    }\n    onSubmit(form);\n  };\n\n  return (\n    <div className=\"fixed inset-0 bg-black bg-opacity-50 flex items-start sm:items-center justify-center p-4 pt-16 sm:pt-4 z-50 overflow-y-auto\">\n      <div className=\"bg-white rounded-lg w-full max-w-md p-6 my-auto\">\n        <div className=\"flex items-center justify-between mb-4\">\n          <h3 className=\"text-lg font-bold\">Sign in / Create account</h3>\n          <button onClick={onClose} className=\"text-gray-400 hover:text-gray-600\"><X className=\"w-5 h-5\" /></button>\n        </div>\n\n        <div className=\"space-y-3\">\n          <div>\n            <label className=\"block text-sm font-semibold text-gray-700 mb-1\">Full name</label>\n            <input type=\"text\" value={form.name} onChange={(e) => setForm({ ...form, name: e.target.value })} className=\"w-full px-3 py-2 border rounded\" />\n          </div>\n\n          <div>\n            <label className=\"block text-sm font-semibold text-gray-700 mb-1\">Email</label>\n            <input type=\"email\" value={form.email} onChange={(e) => setForm({ ...form, email: e.target.value })} className=\"w-full px-3 py-2 border rounded\" />\n          </div>\n\n          <div>\n            <label className=\"block text-sm font-semibold text-gray-700 mb-1\">Phone (optional)</label>\n            <input type=\"tel\" value={form.phone} onChange={(e) => setForm({ ...form, phone: e.target.value })} className=\"w-full px-3 py-2 border rounded\" />\n          </div>\n\n          <div>\n            <label className=\"block text-sm font-semibold text-gray-700 mb-1\">I am a</label>\n            <select value={form.type} onChange={(e) => setForm({ ...form, type: e.target.value })} className=\"w-full px-3 py-2 border rounded\">\n              <option value=\"renter\">Looking for a room</option>\n              <option value=\"landlord\">Listing rooms</option>\n            </select>\n          </div>\n\n          <div className=\"flex gap-3 pt-4\">\n            <button onClick={onClose} className=\"flex-1 bg-gray-100 hover:bg-gray-200 py-2 rounded\">Cancel</button>\n            <button onClick={handleSubmit} className=\"flex-1 bg-blue-600 hover:bg-blue-700 text-white py-2 rounded\">Continue</button>\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n}\n\nfunction LocationConsentModal({ onAccept, onDecline }) {\n  return (\n    <div className=\"fixed inset-0 bg-black bg-opacity-60 flex items-center justify-center p-4 z-50\">\n      <div className=\"bg-white rounded-lg max-w-md w-full p-6 shadow-xl\">\n        <div className=\"flex items-center gap-3 mb-4\">\n          <MapPin className=\"w-8 h-8 text-blue-600\" />\n          <h3 className=\"text-xl font-bold text-gray-800\">Location Access</h3>\n        </div>\n        \n        <p className=\"text-gray-600 mb-4\">\n          Room24 would like to access your location to show nearby rental listings. Your location data:\n        </p>\n        \n        <ul className=\"text-sm text-gray-600 mb-6 space-y-2\">\n          <li className=\"flex items-start gap-2\">\n            <span className=\"text-green-600 mt-0.5\"></span>\n            <span>Is only used to calculate distances to listings</span>\n          </li>\n          <li className=\"flex items-start gap-2\">\n            <span className=\"text-green-600 mt-0.5\"></span>\n            <span>Is not stored on our servers</span>\n          </li>\n          <li className=\"flex items-start gap-2\">\n            <span className=\"text-green-600 mt-0.5\"></span>\n            <span>Is not shared with third parties</span>\n          </li>\n        </ul>\n\n        <div className=\"flex gap-3\">\n          <button\n            onClick={onDecline}\n            className=\"flex-1 bg-gray-100 hover:bg-gray-200 text-gray-800 font-semibold py-3 rounded-lg transition\"\n          >\n            Not Now\n          </button>\n          <button\n            onClick={onAccept}\n            className=\"flex-1 bg-blue-600 hover:bg-blue-700 text-white font-semibold py-3 rounded-lg transition\"\n          >\n            Allow\n          </button>\n        </div>\n        \n        <p className=\"text-xs text-gray-500 mt-4 text-center\">\n          You can change this permission anytime in your browser settings.\n        </p>\n      </div>\n    </div>\n  );\n}\n\nfunction BottomNav({ currentView, setCurrentView, userType }) {\n  const navItems = [\n    { id: 'browse', label: 'Browse', icon: Search, show: true },\n    { id: 'add', label: 'List Room', icon: PlusCircle, show: userType === 'landlord' },\n    { id: 'my-listings', label: 'My Rooms', icon: Home, show: userType === 'landlord' },\n    { id: 'profile', label: 'Profile', icon: User, show: true }\n  ];\n\n  return (\n    <div className=\"fixed bottom-0 left-0 right-0 bg-white border-t border-gray-200 shadow-2xl\">\n      <div className=\"max-w-7xl mx-auto flex justify-around\">\n        {navItems\n          .filter(item => item.show)\n          .map(item => {\n            const Icon = item.icon;\n            const isActive = currentView === item.id || (item.id === 'profile' && currentView === 'edit-profile');\n            \n            return (\n              <button\n                key={item.id}\n                onClick={() => setCurrentView(item.id)}\n                className={`flex-1 flex flex-col items-center justify-center py-3 px-2 transition relative border-t-2 ${\n                  isActive\n                    ? 'border-blue-600 text-blue-600 bg-blue-50'\n                    : 'border-transparent text-gray-600 hover:text-gray-800 hover:bg-gray-50'\n                }`}\n              >\n                <div className=\"relative\">\n                  <Icon className=\"w-6 h-6\" />\n                  {item.badge && item.badge > 0 && (\n                    <span className=\"absolute -top-2 -right-2 bg-red-500 text-white text-xs rounded-full w-5 h-5 flex items-center justify-center font-bold\">\n                      {item.badge > 99 ? '99+' : item.badge}\n                    </span>\n                  )}\n                </div>\n                <span className=\"text-xs mt-1 font-medium\">{item.label}</span>\n              </button>\n            );\n          })}\n      </div>\n    </div>\n  );\n}"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}