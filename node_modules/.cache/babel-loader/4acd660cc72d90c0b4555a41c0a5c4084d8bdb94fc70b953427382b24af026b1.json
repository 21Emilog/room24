{"ast":null,"code":"import _objectSpread from\"C:/Users/kutum/Documents/room-rental-platform/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import React,{useState,useEffect,useMemo,useCallback}from'react';import{initFirebase,initAnalytics,requestFcmToken,listenForegroundMessages,trackEvent,fetchListings,addListing,deleteListing,subscribeToListings,isFirestoreEnabled,subscribeToAuthState,getUserProfile,saveUserProfile,initRecaptcha,sendPhoneOTP,verifyPhoneOTP,clearRecaptcha,getLinkedProviders,linkGoogleAccount}from'./firebase';import{Home,PlusCircle,Search,MapPin,X,User,Phone,Mail,Edit,CheckCircle,Heart,Calendar,Bell,AlertTriangle,LogOut,Link2}from'lucide-react';import Header from'./components/Header';import ListingDetailModal from'./components/ListingDetailModal';import Footer from'./components/Footer';import BrowseView from'./components/BrowseView';import PrivacyPolicyModal from'./components/PrivacyPolicyModal';import NotificationBanner from'./components/NotificationBanner';import AnalyticsConsentModal from'./components/AnalyticsConsentModal';import NotificationsPanel from'./components/NotificationsPanel';import PhotoEditor from'./components/PhotoEditor';import OfflineIndicator from'./components/OfflineIndicator';import BackToTop from'./components/BackToTop';import{getNotifications}from'./utils/notificationEngine';import{loadListingTemplate,saveListingTemplate,clearListingTemplate}from'./utils/listingTemplateStorage';import{signUpWithEmail,signInWithEmail,signInWithGoogle,signOut as firebaseSignOut,resetPassword}from'./firebase';import{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";export default function RentalPlatform(){const[currentView,setCurrentView]=useState('browse');const[userType,setUserType]=useState(null);const[previewAsRenter,setPreviewAsRenter]=useState(false);// landlord UI preview toggle\nconst[listings,setListings]=useState([]);const[selectedListing,setSelectedListing]=useState(null);const[users,setUsers]=useState([]);// registry of all users (localStorage 'users')\nconst[searchLocation,setSearchLocation]=useState('');const[priceRange,setPriceRange]=useState([0,10000]);const[selectedAmenities,setSelectedAmenities]=useState([]);const[sortBy,setSortBy]=useState('newest');const[currentUser,setCurrentUser]=useState(null);const[userProfile,setUserProfile]=useState(null);// Extended profile from Firestore\nconst[authLoading,setAuthLoading]=useState(true);// Loading state for auth\nconst[showAuthModal,setShowAuthModal]=useState(false);const[authDefaultType,setAuthDefaultType]=useState('renter');// Mobile menu state moved into Header component\nconst[toast,setToast]=useState(null);const[showPrivacyPolicy,setShowPrivacyPolicy]=useState(false);const[notificationBanner,setNotificationBanner]=useState(null);const[showAnalyticsConsent,setShowAnalyticsConsent]=useState(false);const[showNotificationsPanel,setShowNotificationsPanel]=useState(false);const[unreadCount,setUnreadCount]=useState(0);const openAuthModal=function(){let type=arguments.length>0&&arguments[0]!==undefined?arguments[0]:'renter';setAuthDefaultType(type);setShowAuthModal(true);};// Auth functions to pass to AuthModal\nconst authFunctions={signUp:async function(email,password,displayName){let userTypeParam=arguments.length>3&&arguments[3]!==undefined?arguments[3]:'renter';let phone=arguments.length>4&&arguments[4]!==undefined?arguments[4]:'';const firebaseUser=await signUpWithEmail(email,password,displayName);// Create user profile in Firestore\nconst profileData={email:firebaseUser.email,displayName:displayName||firebaseUser.displayName,userType:userTypeParam,phone,photoURL:firebaseUser.photoURL||'',createdAt:new Date().toISOString(),landlordComplete:userTypeParam==='renter'};await saveUserProfile(firebaseUser.uid,profileData);return firebaseUser;},signIn:async(email,password)=>{return await signInWithEmail(email,password);},signInGoogle:async function(){let userTypeParam=arguments.length>0&&arguments[0]!==undefined?arguments[0]:'renter';const firebaseUser=await signInWithGoogle();// Check if user profile exists\nlet profile=await getUserProfile(firebaseUser.uid);if(!profile){// Create new profile for Google user\nconst profileData={email:firebaseUser.email,displayName:firebaseUser.displayName||'',userType:userTypeParam,phone:firebaseUser.phoneNumber||'',photoURL:firebaseUser.photoURL||'',createdAt:new Date().toISOString(),landlordComplete:userTypeParam==='renter'};await saveUserProfile(firebaseUser.uid,profileData);}return firebaseUser;},sendPasswordReset:async email=>{await resetPassword(email);},sendPhoneOTP:async phoneNumber=>{// Initialize reCAPTCHA if not already done\ninitRecaptcha('phone-sign-in-button');return await sendPhoneOTP(phoneNumber);},verifyPhoneOTP:async function(otpCode){let userTypeParam=arguments.length>1&&arguments[1]!==undefined?arguments[1]:'renter';let displayName=arguments.length>2&&arguments[2]!==undefined?arguments[2]:'';const firebaseUser=await verifyPhoneOTP(otpCode);// Check if user profile exists\nlet profile=await getUserProfile(firebaseUser.uid);if(!profile){// Create new profile for phone user\nconst profileData={email:'',displayName:displayName||firebaseUser.phoneNumber,userType:userTypeParam,phone:firebaseUser.phoneNumber||'',photoURL:'',createdAt:new Date().toISOString(),landlordComplete:userTypeParam==='renter'};await saveUserProfile(firebaseUser.uid,profileData);}return firebaseUser;},clearPhoneAuth:()=>{clearRecaptcha();}};// Update unread notification count\nuseEffect(()=>{const updateUnreadCount=()=>{const notifications=getNotifications();setUnreadCount(notifications.filter(n=>!n.read).length);};updateUnreadCount();const interval=setInterval(updateUnreadCount,5000);// check every 5s\nreturn()=>clearInterval(interval);},[]);useEffect(()=>{loadData();// Initialize Firebase + FCM token fetch (deferred until user interaction if desired)\nconst app=initFirebase();// Set up Firebase Auth listener\nconst unsubscribeAuth=subscribeToAuthState(async firebaseUser=>{if(firebaseUser){setCurrentUser(firebaseUser);// Fetch extended profile from Firestore\ntry{const profile=await getUserProfile(firebaseUser.uid);if(profile){setUserProfile(profile);setUserType(profile.userType||'renter');}}catch(err){console.error('Error fetching user profile:',err);}}else{setCurrentUser(null);setUserProfile(null);setUserType(null);}setAuthLoading(false);});// Set up real-time listener for Firestore listings\nlet unsubscribeListings=null;if(isFirestoreEnabled()){unsubscribeListings=subscribeToListings(firestoreListings=>{if(firestoreListings&&firestoreListings.length>=0){setListings(firestoreListings);// Cache locally for offline access\nlocalStorage.setItem('listings',JSON.stringify(firestoreListings));}});}// Check analytics consent and show modal if not set\nconst analyticsConsent=localStorage.getItem('analytics-consent');if(!analyticsConsent&&process.env.REACT_APP_ENABLE_ANALYTICS==='true'){// Delay modal slightly so UI loads first\nsetTimeout(()=>setShowAnalyticsConsent(true),2000);}else if(analyticsConsent==='yes'){initAnalytics(app);}(async()=>{try{const token=await requestFcmToken();if(token){console.log('Obtained FCM token:',token);trackEvent('fcm_token_obtained');}}catch(e){console.warn('FCM token request failed',e);}})();listenForegroundMessages(payload=>{// Display notification banner instead of toast\nconst notification=(payload===null||payload===void 0?void 0:payload.notification)||{};if(notification.title||notification.body){setNotificationBanner({title:notification.title,body:notification.body});// Auto-dismiss after 8 seconds\nsetTimeout(()=>setNotificationBanner(null),8000);}});// Cleanup: unsubscribe from listeners on unmount\nreturn()=>{if(unsubscribeAuth){unsubscribeAuth();}if(unsubscribeListings){unsubscribeListings();}};},[]);// Guard: if someone navigates to 'add' without landlord auth, prompt to sign in\nuseEffect(()=>{if(authLoading)return;// Wait for auth to load\nif(currentView==='add'){if(!currentUser){openAuthModal('landlord');setCurrentView('browse');}else if(userType!=='landlord'){// Not a landlord - prompt to become one\nopenAuthModal('landlord');setCurrentView('browse');}else if(!(userProfile!==null&&userProfile!==void 0&&userProfile.landlordComplete)){// Landlord but hasn't completed onboarding\nsetCurrentView('landlord-onboarding');}}},[currentView,currentUser,userType,userProfile,authLoading]);const loadData=async()=>{try{// Try to load from Firestore first\nconst firestoreListings=await fetchListings();if(firestoreListings&&firestoreListings.length>0){console.log('Loaded listings from Firestore');setListings(firestoreListings);// Also cache to localStorage for offline access\nlocalStorage.setItem('listings',JSON.stringify(firestoreListings));}else{// Fall back to localStorage\nconst listingsResult=localStorage.getItem('listings');if(listingsResult){console.log('Loaded listings from localStorage (Firestore empty or unavailable)');setListings(JSON.parse(listingsResult));}}const userResult=localStorage.getItem('current-user');const usersResult=localStorage.getItem('users');if(userResult){const user=JSON.parse(userResult);setCurrentUser(user);setUserType(user.type);}if(usersResult){try{const parsed=JSON.parse(usersResult);setUsers(Array.isArray(parsed)?parsed:[]);}catch(e){console.warn('Corrupt users array in storage, resetting');setUsers([]);}}}catch(error){console.log('No existing data found, starting fresh');// Add sample listings for testing the map\nconst sampleListings=[{id:'listing-1',title:'Cozy Room in Soweto',price:2500,location:'Soweto, Johannesburg',description:'Comfortable room with bathroom and kitchen access',photos:[],status:'available',availableDate:new Date().toISOString(),amenities:['WiFi','Kitchen'],landlordId:'landlord-1',landlordName:'John Smith',landlordPhone:'+27 123 456 7890',landlordEmail:'john@example.com',landlordPhoto:'',createdAt:new Date().toISOString()},{id:'listing-2',title:'Modern Apartment in Sandton',price:4500,location:'Sandton, Johannesburg',description:'Luxurious apartment with parking and security',photos:[],status:'available',availableDate:new Date().toISOString(),amenities:['WiFi','Parking','Air Conditioning'],landlordId:'landlord-2',landlordName:'Jane Doe',landlordPhone:'+27 987 654 3210',landlordEmail:'jane@example.com',landlordPhoto:'',createdAt:new Date().toISOString()},{id:'listing-3',title:'Studio in Midrand',price:3200,location:'Midrand, Johannesburg',description:'Spacious studio flat with laundry facilities',photos:[],status:'available',availableDate:new Date().toISOString(),amenities:['Laundry','WiFi'],landlordId:'landlord-3',landlordName:'Mike Johnson',landlordPhone:'+27 555 555 5555',landlordEmail:'mike@example.com',landlordPhoto:'',createdAt:new Date().toISOString()}];setListings(sampleListings);}};// Helper: check for duplicate phone or email in registry (exclude an optional user id)\nconst isDuplicateContact=function(phone,email){let ignoreId=arguments.length>2&&arguments[2]!==undefined?arguments[2]:null;const normalizedPhone=(phone||'').trim();const normalizedEmail=(email||'').trim().toLowerCase();if(!users||users.length===0)return false;return users.some(u=>{if(ignoreId&&u.id===ignoreId)return false;const uPhone=(u.phone||'').trim();const uEmail=(u.email||'').trim().toLowerCase();const phoneMatch=normalizedPhone&&uPhone&&uPhone===normalizedPhone;const emailMatch=normalizedEmail&&uEmail&&uEmail===normalizedEmail;return phoneMatch||emailMatch;});};// Toast notification helper\nconst showToast=function(message){let type=arguments.length>1&&arguments[1]!==undefined?arguments[1]:'info';let title=arguments.length>2&&arguments[2]!==undefined?arguments[2]:'';setToast({message,type,title});setTimeout(()=>setToast(null),5000);};const handleAnalyticsConsentAccept=()=>{localStorage.setItem('analytics-consent','yes');setShowAnalyticsConsent(false);const app=initFirebase();initAnalytics(app);trackEvent('analytics_consent_granted');showToast('Analytics enabled','success','Thank you!');};const handleAnalyticsConsentDecline=()=>{localStorage.setItem('analytics-consent','no');setShowAnalyticsConsent(false);showToast('Analytics disabled','info');};const saveListings=async newListings=>{try{localStorage.setItem('listings',JSON.stringify(newListings));setListings(newListings);// Broadcast to runtime service worker for offline snapshot caching\nif(navigator.serviceWorker&&navigator.serviceWorker.controller){try{navigator.serviceWorker.controller.postMessage({type:'SYNC_LISTINGS',payload:newListings});}catch(_unused){}}}catch(error){console.error('Error saving listings:',error);}};const saveSubscriptions=async subscriptions=>{try{localStorage.setItem('subscriptions',JSON.stringify(subscriptions));}catch(error){console.error('Error saving subscriptions:',error);}};const getSubscriptions=async()=>{try{const res=localStorage.getItem('subscriptions');return res?JSON.parse(res):{};}catch(err){console.error('Error loading subscriptions',err);}return{};};const subscribeToArea=async(userId,area)=>{if(!userId){openAuthModal('renter');return;}if(!area||area.trim()===''){alert('Please enter a location to subscribe to.');return;}try{const subs=await getSubscriptions();subs[userId]=subs[userId]||[];if(!subs[userId].includes(area)){subs[userId].push(area);await saveSubscriptions(subs);alert(\"Subscribed to updates for \".concat(area));}else{alert(\"You are already subscribed to \".concat(area));}}catch(err){console.error('Subscribe failed',err);alert('Could not subscribe. Please try again.');}};const handleProfileSetup=async profileData=>{try{// Duplicate guard\nif(isDuplicateContact(profileData.phone,profileData.email)){showToast('Phone or email already registered','error','Duplicate');return;}const userId=\"user-\".concat(Date.now());const user=_objectSpread(_objectSpread({id:userId,type:userType},profileData),{},{whatsapp:profileData.whatsapp||'',notificationPrefs:{updates:true,marketing:false},createdAt:new Date().toISOString()});localStorage.setItem('current-user',JSON.stringify(user));setCurrentUser(user);// Update users registry\nconst existingUsersRaw=localStorage.getItem('users');let existingUsers=[];if(existingUsersRaw){try{existingUsers=JSON.parse(existingUsersRaw);}catch(_unused2){existingUsers=[];}}existingUsers.push(user);localStorage.setItem('users',JSON.stringify(existingUsers));setUsers(existingUsers);showToast('Profile created successfully!','success','Welcome!');setCurrentView('browse');}catch(error){console.error('Error saving profile:',error);// Still set the user locally even if storage fails\nconst userId=\"user-\".concat(Date.now());const user=_objectSpread(_objectSpread({id:userId,type:userType},profileData),{},{whatsapp:profileData.whatsapp||'',createdAt:new Date().toISOString()});setCurrentUser(user);const existingUsersRaw=localStorage.getItem('users');let existingUsers=[];if(existingUsersRaw){try{existingUsers=JSON.parse(existingUsersRaw);}catch(_unused3){existingUsers=[];}}existingUsers.push(user);try{localStorage.setItem('users',JSON.stringify(existingUsers));}catch(_unused4){}setUsers(existingUsers);showToast('Profile created (data may not be persisted)','error');setCurrentView('browse');}};const handleUpdateProfile=async profileData=>{try{// Duplicate guard (exclude current user id)\nif(isDuplicateContact(profileData.phone,profileData.email,currentUser===null||currentUser===void 0?void 0:currentUser.id)){showToast('Phone or email already used by another account','error','Duplicate');return;}const updatedUser=_objectSpread(_objectSpread({},currentUser),profileData);localStorage.setItem('current-user',JSON.stringify(updatedUser));setCurrentUser(updatedUser);// Update registry entry\nconst existingUsersRaw=localStorage.getItem('users');let existingUsers=[];if(existingUsersRaw){try{existingUsers=JSON.parse(existingUsersRaw);}catch(_unused5){existingUsers=[];}}const idx=existingUsers.findIndex(u=>u.id===updatedUser.id);if(idx!==-1){existingUsers[idx]=updatedUser;}else{existingUsers.push(updatedUser);// ensure presence\n}localStorage.setItem('users',JSON.stringify(existingUsers));setUsers(existingUsers);showToast('Profile updated successfully!','success');setCurrentView('browse');}catch(error){console.error('Error updating profile:',error);const updatedUser=_objectSpread(_objectSpread({},currentUser),profileData);setCurrentUser(updatedUser);const existingUsersRaw=localStorage.getItem('users');let existingUsers=[];if(existingUsersRaw){try{existingUsers=JSON.parse(existingUsersRaw);}catch(_unused6){existingUsers=[];}}const idx=existingUsers.findIndex(u=>u.id===updatedUser.id);if(idx!==-1){existingUsers[idx]=updatedUser;}else{existingUsers.push(updatedUser);}try{localStorage.setItem('users',JSON.stringify(existingUsers));}catch(_unused7){}setUsers(existingUsers);showToast('Profile updated (data may not be persisted)','error');setCurrentView('browse');}};// Sign out using Firebase\nconst handleSignOut=async()=>{try{await firebaseSignOut();setCurrentUser(null);setUserProfile(null);setUserType(null);setCurrentView('browse');showToast('Signed out successfully.','info');}catch(e){console.error('Sign out error:',e);showToast('Error signing out. Please try again.','error');}};const handleCompleteOnboarding=async onboardData=>{try{if(currentUser!==null&&currentUser!==void 0&&currentUser.uid){await saveUserProfile(currentUser.uid,{landlordComplete:true,landlordInfo:onboardData});setUserProfile(prev=>_objectSpread(_objectSpread({},prev),{},{landlordComplete:true,landlordInfo:onboardData}));}setCurrentView('browse');showToast('Profile complete! You can now create listings.','success');}catch(err){console.error('Onboarding save failed',err);setCurrentView('browse');}};const handleAddListing=async listingData=>{var _listingData$latitude,_listingData$longitud;// Combine streetAddress and location into fullAddress for complete address storage\nconst fullAddress=[listingData.streetAddress,listingData.location].filter(Boolean).join(', ');const newListingData={title:listingData.title,price:listingData.price,location:listingData.location,streetAddress:listingData.streetAddress||'',fullAddress:fullAddress||listingData.location||'',// Store complete address\ndescription:listingData.description,photos:listingData.photos||[],status:listingData.status||'available',availableDate:listingData.availableDate||new Date().toISOString(),amenities:listingData.amenities||[],latitude:(_listingData$latitude=listingData.latitude)!==null&&_listingData$latitude!==void 0?_listingData$latitude:null,longitude:(_listingData$longitud=listingData.longitude)!==null&&_listingData$longitud!==void 0?_listingData$longitud:null,paymentMethod:listingData.paymentMethod||'Bank and Cash',premium:!!listingData.premium,// Use Firebase UID for landlordId\nlandlordId:(currentUser===null||currentUser===void 0?void 0:currentUser.uid)||(currentUser===null||currentUser===void 0?void 0:currentUser.id),landlordName:(userProfile===null||userProfile===void 0?void 0:userProfile.displayName)||(currentUser===null||currentUser===void 0?void 0:currentUser.displayName)||'',landlordPhone:(userProfile===null||userProfile===void 0?void 0:userProfile.phone)||'',landlordEmail:(currentUser===null||currentUser===void 0?void 0:currentUser.email)||'',landlordPhoto:(userProfile===null||userProfile===void 0?void 0:userProfile.photoURL)||(currentUser===null||currentUser===void 0?void 0:currentUser.photoURL)||''};try{// Try to save to Firestore first\nconst firestoreId=await addListing(newListingData);if(firestoreId){// Successfully saved to Firestore\nconst newListing=_objectSpread(_objectSpread({},newListingData),{},{id:firestoreId,createdAt:new Date().toISOString()});const updatedListings=[...listings,newListing];setListings(updatedListings);// Also cache locally\nlocalStorage.setItem('listings',JSON.stringify(updatedListings));showToast('Listing created and shared online!','success','Success!');}else{// Firestore not available, save locally only\nconst newListing=_objectSpread(_objectSpread({},newListingData),{},{id:\"listing-\".concat(Date.now()),createdAt:new Date().toISOString()});const updatedListings=[...listings,newListing];await saveListings(updatedListings);showToast('Listing saved locally (offline mode)','info','Saved');}}catch(error){console.error('Error adding listing:',error);// Fall back to local save\nconst newListing=_objectSpread(_objectSpread({},newListingData),{},{id:\"listing-\".concat(Date.now()),createdAt:new Date().toISOString()});const updatedListings=[...listings,newListing];await saveListings(updatedListings);showToast('Listing saved locally','info','Saved');}setCurrentView('browse');// Scroll to top to see new listing\nwindow.scrollTo({top:0,behavior:'smooth'});};// Messaging removed\nconst filteredListings=listings.filter(listing=>{const matchesLocation=!searchLocation||(listing.location||'').toLowerCase().includes(searchLocation.toLowerCase());const price=parseFloat(listing.price);const matchesPrice=price>=priceRange[0]&&price<=priceRange[1];const matchesAmenities=selectedAmenities.length===0||selectedAmenities.every(amenity=>{var _listing$amenities;return(_listing$amenities=listing.amenities)===null||_listing$amenities===void 0?void 0:_listing$amenities.includes(amenity);});return matchesLocation&&matchesPrice&&matchesAmenities;}).sort((a,b)=>{if(a.premium&&!b.premium)return-1;if(!a.premium&&b.premium)return 1;if(sortBy==='newest'){return new Date(b.createdAt)-new Date(a.createdAt);}else if(sortBy==='cheapest'){return parseFloat(a.price)-parseFloat(b.price);}else if(sortBy==='expensive'){return parseFloat(b.price)-parseFloat(a.price);}return 0;});// Allow guests to land on Browse by default. If userType isn't set,\n// show a gentle callout in the header (below) so users can pick a role\n// when they want to post or set up their profile.\nreturn/*#__PURE__*/_jsxs(\"div\",{className:\"min-h-screen bg-gradient-to-b from-slate-50 to-gray-100\",children:[/*#__PURE__*/_jsx(OfflineIndicator,{}),/*#__PURE__*/_jsx(BackToTop,{}),/*#__PURE__*/_jsx(Header,{currentUser:currentUser,previewAsRenter:previewAsRenter,setPreviewAsRenter:setPreviewAsRenter,openAuthModal:openAuthModal,handleSignOut:handleSignOut,setCurrentView:setCurrentView,unreadCount:unreadCount,onOpenNotifications:()=>setShowNotificationsPanel(true)}),notificationBanner&&/*#__PURE__*/_jsx(NotificationBanner,{title:notificationBanner.title,body:notificationBanner.body,onClose:()=>setNotificationBanner(null)}),toast&&/*#__PURE__*/_jsx(\"div\",{className:\"fixed top-20 right-4 z-50 max-w-sm w-full transition-all duration-300 \".concat(toast.type==='error'?'bg-gradient-to-r from-rose-50 to-red-50 border-rose-400':toast.type==='success'?'bg-gradient-to-r from-emerald-50 to-green-50 border-emerald-400':toast.type==='warning'?'bg-gradient-to-r from-amber-50 to-yellow-50 border-amber-400':'bg-gradient-to-r from-sky-50 to-blue-50 border-sky-400',\" border-l-4 rounded-xl shadow-2xl p-4 fade-in backdrop-blur-sm\"),children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-start gap-3\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex-shrink-0 w-8 h-8 rounded-xl flex items-center justify-center shadow-sm \".concat(toast.type==='error'?'bg-rose-500':toast.type==='success'?'bg-emerald-500':toast.type==='warning'?'bg-amber-500':'bg-sky-500'),children:[toast.type==='success'&&/*#__PURE__*/_jsx(CheckCircle,{className:\"w-5 h-5 text-white\"}),toast.type==='error'&&/*#__PURE__*/_jsx(\"span\",{className:\"text-white font-bold text-sm\",children:\"\\u2715\"}),toast.type==='warning'&&/*#__PURE__*/_jsx(\"span\",{className:\"text-white font-bold text-sm\",children:\"!\"}),toast.type==='info'&&/*#__PURE__*/_jsx(\"span\",{className:\"text-white font-bold text-sm\",children:\"i\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex-1 min-w-0\",children:[toast.title&&/*#__PURE__*/_jsx(\"p\",{className:\"font-bold mb-0.5 \".concat(toast.type==='error'?'text-rose-800':toast.type==='success'?'text-emerald-800':toast.type==='warning'?'text-amber-800':'text-sky-800'),children:toast.title}),/*#__PURE__*/_jsx(\"p\",{className:\"text-sm \".concat(toast.type==='error'?'text-rose-700':toast.type==='success'?'text-emerald-700':toast.type==='warning'?'text-amber-700':'text-sky-700'),children:toast.message})]}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>setToast(null),className:\"flex-shrink-0 p-1.5 rounded-lg hover:bg-white/50 transition \".concat(toast.type==='error'?'text-rose-500 hover:text-rose-700':toast.type==='success'?'text-emerald-500 hover:text-emerald-700':toast.type==='warning'?'text-amber-500 hover:text-amber-700':'text-sky-500 hover:text-sky-700'),\"aria-label\":\"Close notification\",children:/*#__PURE__*/_jsx(X,{className:\"w-4 h-4\"})})]})}),/*#__PURE__*/_jsxs(\"div\",{id:\"main-content\",className:\"max-w-7xl mx-auto pb-24 px-4 sm:px-6 lg:px-8\",role:\"main\",children:[currentView==='setup-profile'&&/*#__PURE__*/_jsx(ProfileSetupView,{onSubmit:handleProfileSetup,userType:userType}),currentView==='profile'&&currentUser&&/*#__PURE__*/_jsx(ProfileView,{user:{name:(userProfile===null||userProfile===void 0?void 0:userProfile.displayName)||(currentUser===null||currentUser===void 0?void 0:currentUser.displayName)||'',email:(currentUser===null||currentUser===void 0?void 0:currentUser.email)||'',phone:(userProfile===null||userProfile===void 0?void 0:userProfile.phone)||'',photo:(userProfile===null||userProfile===void 0?void 0:userProfile.photoURL)||(currentUser===null||currentUser===void 0?void 0:currentUser.photoURL)||'',type:(userProfile===null||userProfile===void 0?void 0:userProfile.userType)||userType||'renter',notificationPrefs:(userProfile===null||userProfile===void 0?void 0:userProfile.notificationPrefs)||{updates:true,marketing:false}},onEdit:()=>setCurrentView('edit-profile'),onSignOut:handleSignOut,linkedProviders:getLinkedProviders(),onLinkGoogle:async()=>{await linkGoogleAccount();// Refresh to show updated providers\nwindow.location.reload();},onLinkPhone:()=>{// Open auth modal for phone linking\nshowToast('Phone linking coming soon!','info');},onUpdatePrefs:async prefs=>{if(currentUser!==null&&currentUser!==void 0&&currentUser.uid){try{await saveUserProfile(currentUser.uid,{notificationPrefs:prefs});setUserProfile(prev=>_objectSpread(_objectSpread({},prev),{},{notificationPrefs:prefs}));showToast('Preferences updated','success');}catch(err){console.error('Failed to update prefs:',err);showToast('Failed to update preferences','error');}}}}),currentView==='edit-profile'&&currentUser&&/*#__PURE__*/_jsx(EditProfileView,{user:currentUser,onSubmit:handleUpdateProfile,onCancel:()=>setCurrentView('profile')}),currentView==='landlord-onboarding'&&currentUser&&userType==='landlord'&&/*#__PURE__*/_jsx(LandlordOnboardingView,{onComplete:handleCompleteOnboarding,onCancel:()=>setCurrentView('browse'),currentUser:currentUser}),currentView==='browse'&&/*#__PURE__*/_jsx(BrowseView,{listings:filteredListings,searchLocation:searchLocation,setSearchLocation:setSearchLocation,priceRange:priceRange,setPriceRange:setPriceRange,selectedAmenities:selectedAmenities,setSelectedAmenities:setSelectedAmenities,sortBy:sortBy,setSortBy:setSortBy,onSelectListing:setSelectedListing,setCurrentView:setCurrentView,currentUser:currentUser,onRequireAuth:openAuthModal,subscribeToArea:subscribeToArea,previewMode:previewAsRenter}),currentView==='add'&&/*#__PURE__*/_jsx(AddListingView,{onSubmit:handleAddListing,onCancel:()=>setCurrentView('browse'),currentUser:currentUser,userType:userType,onRequireAuth:openAuthModal,onRequireOnboarding:()=>setCurrentView('landlord-onboarding')}),currentView==='my-listings'&&currentUser&&userType==='landlord'&&/*#__PURE__*/_jsx(MyListingsView,{listings:listings.filter(l=>l.landlordId===currentUser.uid||l.landlordId===currentUser.id),onDelete:async id=>{try{// Try to delete from Firestore first\nconst deleted=await deleteListing(id);if(deleted){showToast('Listing deleted','success');}}catch(error){console.error('Firestore delete failed:',error);}// Also update local state and localStorage\nconst updated=listings.filter(l=>l.id!==id);setListings(updated);localStorage.setItem('listings',JSON.stringify(updated));}}),currentView==='favorites'&&/*#__PURE__*/_jsx(FavoritesView,{listings:listings,onSelectListing:setSelectedListing})]}),selectedListing&&/*#__PURE__*/_jsx(ListingDetailModal,{listing:selectedListing,landlord:{name:selectedListing.landlordName,phone:selectedListing.landlordPhone,email:selectedListing.landlordEmail,photo:selectedListing.landlordPhoto},onClose:()=>setSelectedListing(null),userType:userType,currentUser:currentUser,onRequireAuth:openAuthModal,previewMode:previewAsRenter,showToast:showToast}),showAuthModal&&/*#__PURE__*/_jsx(AuthModal,{defaultType:authDefaultType,onClose:()=>setShowAuthModal(false),onSuccess:()=>{showToast('Signed in successfully!','success','Welcome!');},authFunctions:authFunctions}),/*#__PURE__*/_jsx(BottomNav,{currentView:currentView,setCurrentView:setCurrentView,userType:userType}),showPrivacyPolicy&&/*#__PURE__*/_jsx(PrivacyPolicyModal,{onClose:()=>setShowPrivacyPolicy(false)}),showAnalyticsConsent&&/*#__PURE__*/_jsx(AnalyticsConsentModal,{onAccept:handleAnalyticsConsentAccept,onDecline:handleAnalyticsConsentDecline}),showNotificationsPanel&&/*#__PURE__*/_jsx(NotificationsPanel,{onClose:()=>{setShowNotificationsPanel(false);setUnreadCount(getNotifications().filter(n=>!n.read).length);},onSelectListing:listingId=>{const listing=listings.find(l=>(l.id||\"\".concat(l.title,\"-\").concat(l.createdAt))===listingId);if(listing){setSelectedListing(listing);}setShowNotificationsPanel(false);}}),/*#__PURE__*/_jsx(Footer,{onOpenPrivacy:()=>setShowPrivacyPolicy(true)})]});}function ProfileSetupView(_ref){let{onSubmit,userType}=_ref;const[formData,setFormData]=useState({name:'',phone:'',email:'',whatsapp:'',photo:''});const[errors,setErrors]=useState({});const[touched,setTouched]=useState({});const validateField=function(name,value){let extras=arguments.length>2&&arguments[2]!==undefined?arguments[2]:{};const newErrors=_objectSpread({},errors);switch(name){case'name':if(!value||value.trim().length<2){newErrors.name='Name must be at least 2 characters';}else{delete newErrors.name;}break;case'phone':if(!value||!/^[+]?[-0-9()\\s]{7,}$/.test(value.trim())){newErrors.phone='Enter a valid phone number (min 7 digits)';}else{delete newErrors.phone;}break;case'email':if(!value||!/^[^@\\s]+@[^@\\s]+\\.[^@\\s]+$/.test(value.trim())){newErrors.email='Enter a valid email address';}else{delete newErrors.email;}break;case'photo':if(value==='FILE_TOO_LARGE'){newErrors.photo='Photo is too large (max 2MB)';}else{delete newErrors.photo;}break;default:break;}setErrors(newErrors);};const handlePhotoUpload=e=>{const file=e.target.files[0];if(file){if(file.size>2*1024*1024){// 2MB limit\nsetFormData(_objectSpread(_objectSpread({},formData),{},{photo:''}));validateField('photo','FILE_TOO_LARGE');return;}const reader=new FileReader();reader.onloadend=()=>{setFormData(_objectSpread(_objectSpread({},formData),{},{photo:reader.result}));validateField('photo',reader.result);};reader.readAsDataURL(file);}};const handleSubmit=()=>{// Touch all fields\nconst allTouched={name:true,phone:true,email:true,photo:true};setTouched(allTouched);validateField('name',formData.name);validateField('phone',formData.phone);validateField('email',formData.email);if(Object.keys(errors).length===0&&formData.name&&formData.phone&&formData.email){onSubmit(formData);}};return/*#__PURE__*/_jsx(\"div\",{className:\"p-4 min-h-screen bg-gradient-to-b from-slate-50 to-gray-100 pb-24\",children:/*#__PURE__*/_jsx(\"div\",{className:\"max-w-2xl mx-auto mt-8\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white rounded-2xl shadow-lg border border-gray-100 p-8\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"text-center mb-8\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\"text-3xl font-extrabold text-gray-900 mb-2\",children:\"Complete Your Profile\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-gray-600\",children:\"Help others know who you are\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-6\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"flex justify-center mb-8\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"relative\",children:[formData.photo?/*#__PURE__*/_jsx(\"img\",{src:formData.photo,alt:\"Profile\",className:\"w-32 h-32 rounded-full object-cover border-4 border-blue-200 shadow-lg\"}):/*#__PURE__*/_jsx(\"div\",{className:\"w-32 h-32 rounded-full bg-gradient-to-br from-blue-100 to-blue-200 flex items-center justify-center border-4 border-blue-200 shadow-lg\",children:/*#__PURE__*/_jsx(User,{className:\"w-16 h-16 text-blue-600\"})}),/*#__PURE__*/_jsxs(\"label\",{className:\"absolute bottom-0 right-0 bg-blue-600 hover:bg-blue-700 text-white p-3 rounded-full cursor-pointer shadow-lg transition group\",\"aria-label\":\"Upload profile photo\",children:[/*#__PURE__*/_jsx(Edit,{className:\"w-5 h-5\"}),/*#__PURE__*/_jsx(\"input\",{type:\"file\",accept:\"image/*\",onChange:handlePhotoUpload,className:\"hidden\"})]})]})}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-semibold text-gray-800 mb-2\",children:\"Full Name *\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",required:true,value:formData.name,onChange:e=>{setFormData(_objectSpread(_objectSpread({},formData),{},{name:e.target.value}));if(touched.name)validateField('name',e.target.value);},onBlur:e=>{setTouched(_objectSpread(_objectSpread({},touched),{},{name:true}));validateField('name',e.target.value);},placeholder:\"Enter your full name\",\"aria-invalid\":errors.name?'true':'false',\"aria-describedby\":errors.name?'profile-name-error':undefined,className:\"w-full px-4 py-3 border-2 \".concat(errors.name?'border-red-400':'border-gray-200',\" bg-white text-gray-800 rounded-xl focus:ring-2 focus:ring-teal-400 focus:border-transparent transition placeholder-gray-400\")}),errors.name&&touched.name&&/*#__PURE__*/_jsx(\"p\",{id:\"profile-name-error\",className:\"mt-1 text-xs text-red-600\",children:errors.name})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-semibold text-gray-800 mb-2\",children:\"Phone Number *\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"relative\",children:[/*#__PURE__*/_jsx(Phone,{className:\"absolute left-4 top-3.5 w-5 h-5 text-gray-400\"}),/*#__PURE__*/_jsx(\"input\",{type:\"tel\",required:true,value:formData.phone,onChange:e=>{setFormData(_objectSpread(_objectSpread({},formData),{},{phone:e.target.value}));if(touched.phone)validateField('phone',e.target.value);},onBlur:e=>{setTouched(_objectSpread(_objectSpread({},touched),{},{phone:true}));validateField('phone',e.target.value);},placeholder:\"e.g., +27 12 345 6789\",\"aria-invalid\":errors.phone?'true':'false',\"aria-describedby\":errors.phone?'profile-phone-error':undefined,className:\"w-full pl-11 pr-4 py-3 border-2 \".concat(errors.phone?'border-red-400':'border-gray-200',\" bg-white text-gray-800 rounded-xl focus:ring-2 focus:ring-teal-400 focus:border-transparent transition placeholder-gray-400\")})]}),errors.phone&&touched.phone&&/*#__PURE__*/_jsx(\"p\",{id:\"profile-phone-error\",className:\"mt-1 text-xs text-red-600\",children:errors.phone})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-semibold text-gray-800 mb-2\",children:\"Email Address *\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"relative\",children:[/*#__PURE__*/_jsx(Mail,{className:\"absolute left-4 top-3.5 w-5 h-5 text-gray-400\"}),/*#__PURE__*/_jsx(\"input\",{type:\"email\",required:true,value:formData.email,onChange:e=>{setFormData(_objectSpread(_objectSpread({},formData),{},{email:e.target.value}));if(touched.email)validateField('email',e.target.value);},onBlur:e=>{setTouched(_objectSpread(_objectSpread({},touched),{},{email:true}));validateField('email',e.target.value);},placeholder:\"your.email@example.com\",\"aria-invalid\":errors.email?'true':'false',\"aria-describedby\":errors.email?'profile-email-error':undefined,className:\"w-full pl-11 pr-4 py-3 border-2 \".concat(errors.email?'border-red-400':'border-gray-200',\" bg-white text-gray-800 rounded-xl focus:ring-2 focus:ring-teal-400 focus:border-transparent transition placeholder-gray-400\")})]}),errors.email&&touched.email&&/*#__PURE__*/_jsx(\"p\",{id:\"profile-email-error\",className:\"mt-1 text-xs text-red-600\",children:errors.email})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-semibold text-gray-800 mb-2\",children:\"WhatsApp (optional)\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"relative\",children:[/*#__PURE__*/_jsx(Phone,{className:\"absolute left-4 top-3.5 w-5 h-5 text-gray-400\"}),/*#__PURE__*/_jsx(\"input\",{type:\"tel\",value:formData.whatsapp,onChange:e=>setFormData(_objectSpread(_objectSpread({},formData),{},{whatsapp:e.target.value})),placeholder:\"e.g., +27 71 234 5678\",className:\"w-full pl-11 pr-4 py-3 border-2 border-gray-200 bg-white text-gray-800 rounded-xl focus:ring-2 focus:ring-teal-400 focus:border-transparent transition placeholder-gray-400\"})]}),/*#__PURE__*/_jsx(\"p\",{className:\"text-xs text-gray-500 mt-1\",children:\"Used to create a WhatsApp chat link on your listings.\"})]}),/*#__PURE__*/_jsx(\"button\",{onClick:handleSubmit,className:\"w-full bg-gradient-to-r from-teal-500 to-cyan-500 hover:from-teal-600 hover:to-cyan-600 text-white font-semibold py-3 rounded-xl transition mt-8 shadow-lg hover:shadow-xl\",children:\"Complete Setup\"})]})]})})});}function ProfileView(_ref2){var _user$name,_user$name$charAt;let{user,onEdit,onUpdatePrefs,onSignOut,linkedProviders,onLinkGoogle,onLinkPhone}=_ref2;const prefs=user.notificationPrefs||{updates:true,marketing:false};const[localPrefs,setLocalPrefs]=React.useState(prefs);const[linkingInProgress,setLinkingInProgress]=React.useState(null);const[linkError,setLinkError]=React.useState('');const[linkSuccess,setLinkSuccess]=React.useState('');const togglePref=key=>{const next=_objectSpread(_objectSpread({},localPrefs),{},{[key]:!localPrefs[key]});setLocalPrefs(next);onUpdatePrefs&&onUpdatePrefs(next);};const handleLinkGoogle=async()=>{if(!onLinkGoogle)return;setLinkingInProgress('google');setLinkError('');setLinkSuccess('');try{await onLinkGoogle();setLinkSuccess('Google account linked successfully!');}catch(err){setLinkError(err.message||'Failed to link Google account');}finally{setLinkingInProgress(null);}};const handleLinkPhone=()=>{if(!onLinkPhone)return;onLinkPhone();};const hasGoogle=linkedProviders===null||linkedProviders===void 0?void 0:linkedProviders.includes('google.com');const hasPhone=linkedProviders===null||linkedProviders===void 0?void 0:linkedProviders.includes('phone');const hasPassword=linkedProviders===null||linkedProviders===void 0?void 0:linkedProviders.includes('password');return/*#__PURE__*/_jsxs(\"div\",{className:\"min-h-screen bg-gradient-to-b from-slate-50 to-gray-100 pb-24\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"bg-gradient-to-br from-teal-600 via-teal-500 to-cyan-500 pt-8 pb-20 px-4\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"max-w-xl mx-auto flex justify-between items-start\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\"text-2xl font-bold text-white\",children:\"My Profile\"}),/*#__PURE__*/_jsxs(\"button\",{onClick:onEdit,className:\"bg-white/20 hover:bg-white/30 backdrop-blur-sm text-white px-4 py-2 rounded-xl transition-all duration-200 flex items-center gap-2 border border-white/30\",children:[/*#__PURE__*/_jsx(Edit,{className:\"w-4 h-4\"}),\"Edit\"]})]})}),/*#__PURE__*/_jsx(\"div\",{className:\"px-4 -mt-16\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white rounded-2xl shadow-xl border border-gray-100 p-6 max-w-xl mx-auto\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex flex-col items-center -mt-16 mb-6\",children:[user.photo?/*#__PURE__*/_jsx(\"img\",{src:user.photo,alt:\"Profile\",className:\"w-28 h-28 rounded-2xl object-cover border-4 border-white shadow-lg mb-4\"}):/*#__PURE__*/_jsx(\"div\",{className:\"w-28 h-28 rounded-2xl bg-gradient-to-br from-teal-400 to-cyan-500 flex items-center justify-center border-4 border-white shadow-lg mb-4\",children:/*#__PURE__*/_jsx(\"span\",{className:\"text-4xl font-bold text-white\",children:((_user$name=user.name)===null||_user$name===void 0?void 0:(_user$name$charAt=_user$name.charAt(0))===null||_user$name$charAt===void 0?void 0:_user$name$charAt.toUpperCase())||'U'})}),/*#__PURE__*/_jsx(\"h3\",{className:\"text-2xl font-bold text-gray-900\",children:user.name}),/*#__PURE__*/_jsx(\"span\",{className:\"inline-flex items-center mt-2 px-4 py-1.5 bg-gradient-to-r from-teal-50 to-cyan-50 text-teal-700 rounded-full text-sm font-semibold border border-teal-100\",children:user.type==='landlord'?/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(Home,{className:\"w-4 h-4 mr-1.5\"}),\"Landlord\"]}):/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(User,{className:\"w-4 h-4 mr-1.5\"}),\"Renter\"]})})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-3 mb-6\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"bg-gradient-to-r from-gray-50 to-slate-50 rounded-xl p-4 border border-gray-100 hover:border-gray-200 transition-colors\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"w-11 h-11 bg-gradient-to-br from-teal-100 to-cyan-100 rounded-xl flex items-center justify-center mr-4 shadow-sm\",children:/*#__PURE__*/_jsx(Phone,{className:\"w-5 h-5 text-teal-600\"})}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-xs font-medium text-gray-500 mb-0.5\",children:\"Phone Number\"}),/*#__PURE__*/_jsx(\"p\",{className:\"font-semibold text-gray-800\",children:user.phone})]})]})}),/*#__PURE__*/_jsx(\"div\",{className:\"bg-gradient-to-r from-gray-50 to-slate-50 rounded-xl p-4 border border-gray-100 hover:border-gray-200 transition-colors\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"w-11 h-11 bg-gradient-to-br from-cyan-100 to-blue-100 rounded-xl flex items-center justify-center mr-4 shadow-sm\",children:/*#__PURE__*/_jsx(Mail,{className:\"w-5 h-5 text-cyan-600\"})}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-xs font-medium text-gray-500 mb-0.5\",children:\"Email Address\"}),/*#__PURE__*/_jsx(\"p\",{className:\"font-semibold text-gray-800\",children:user.email})]})]})}),/*#__PURE__*/_jsx(\"div\",{className:\"bg-gradient-to-r from-gray-50 to-slate-50 rounded-xl p-4 border border-gray-100 hover:border-gray-200 transition-colors\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"w-11 h-11 bg-gradient-to-br from-violet-100 to-purple-100 rounded-xl flex items-center justify-center mr-4 shadow-sm\",children:/*#__PURE__*/_jsx(Calendar,{className:\"w-5 h-5 text-violet-600\"})}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-xs font-medium text-gray-500 mb-0.5\",children:\"Member Since\"}),/*#__PURE__*/_jsx(\"p\",{className:\"font-semibold text-gray-800\",children:new Date(user.createdAt).toLocaleDateString('en-ZA',{year:'numeric',month:'long',day:'numeric'})})]})]})})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"bg-gradient-to-br from-teal-50 via-cyan-50 to-sky-50 rounded-xl p-5 border border-teal-100\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center gap-3 mb-4\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"w-10 h-10 bg-gradient-to-br from-teal-500 to-cyan-500 rounded-xl flex items-center justify-center shadow-sm\",children:/*#__PURE__*/_jsx(Bell,{className:\"w-5 h-5 text-white\"})}),/*#__PURE__*/_jsx(\"h4\",{className:\"font-bold text-gray-800\",children:\"Notification Preferences\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-3\",children:[/*#__PURE__*/_jsxs(\"label\",{className:\"flex items-center gap-3 p-3 bg-white rounded-lg border border-gray-100 cursor-pointer hover:border-teal-200 transition-colors\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"checkbox\",checked:localPrefs.updates,onChange:()=>togglePref('updates'),className:\"w-5 h-5 rounded border-gray-300 text-teal-600 focus:ring-teal-500\"}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-sm font-medium text-gray-800\",children:\"Room Alerts\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-xs text-gray-500\",children:\"Get notified about new rooms in your saved areas\"})]})]}),/*#__PURE__*/_jsxs(\"label\",{className:\"flex items-center gap-3 p-3 bg-white rounded-lg border border-gray-100 cursor-pointer hover:border-teal-200 transition-colors\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"checkbox\",checked:localPrefs.marketing,onChange:()=>togglePref('marketing'),className:\"w-5 h-5 rounded border-gray-300 text-teal-600 focus:ring-teal-500\"}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-sm font-medium text-gray-800\",children:\"Tips & Updates\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-xs text-gray-500\",children:\"Occasional features and helpful content\"})]})]})]}),/*#__PURE__*/_jsx(\"p\",{className:\"text-[11px] text-gray-500 mt-3 text-center\",children:\"Changes save automatically \\u2022 You can opt out anytime\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"bg-gradient-to-br from-blue-50 via-indigo-50 to-violet-50 rounded-xl p-5 border border-blue-100 mt-4\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center gap-3 mb-4\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"w-10 h-10 bg-gradient-to-br from-blue-500 to-indigo-500 rounded-xl flex items-center justify-center shadow-sm\",children:/*#__PURE__*/_jsx(Link2,{className:\"w-5 h-5 text-white\"})}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h4\",{className:\"font-bold text-gray-800\",children:\"Linked Accounts\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-xs text-gray-500\",children:\"Connect multiple sign-in methods\"})]})]}),linkSuccess&&/*#__PURE__*/_jsxs(\"div\",{className:\"mb-3 p-3 bg-green-50 border border-green-200 rounded-lg text-green-700 text-sm flex items-center gap-2\",children:[/*#__PURE__*/_jsx(CheckCircle,{className:\"w-4 h-4\"}),linkSuccess]}),linkError&&/*#__PURE__*/_jsxs(\"div\",{className:\"mb-3 p-3 bg-rose-50 border border-rose-200 rounded-lg text-rose-700 text-sm flex items-center gap-2\",children:[/*#__PURE__*/_jsx(AlertTriangle,{className:\"w-4 h-4\"}),linkError]}),/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-2\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between p-3 bg-white rounded-lg border \".concat(hasGoogle?'border-green-200':'border-gray-100'),children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center gap-3\",children:[/*#__PURE__*/_jsxs(\"svg\",{className:\"w-5 h-5\",viewBox:\"0 0 24 24\",children:[/*#__PURE__*/_jsx(\"path\",{fill:\"#4285F4\",d:\"M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z\"}),/*#__PURE__*/_jsx(\"path\",{fill:\"#34A853\",d:\"M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z\"}),/*#__PURE__*/_jsx(\"path\",{fill:\"#FBBC05\",d:\"M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z\"}),/*#__PURE__*/_jsx(\"path\",{fill:\"#EA4335\",d:\"M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z\"})]}),/*#__PURE__*/_jsx(\"span\",{className:\"font-medium text-gray-700\",children:\"Google\"})]}),hasGoogle?/*#__PURE__*/_jsxs(\"span\",{className:\"text-xs font-medium text-green-600 flex items-center gap-1\",children:[/*#__PURE__*/_jsx(CheckCircle,{className:\"w-4 h-4\"}),\" Linked\"]}):/*#__PURE__*/_jsx(\"button\",{onClick:handleLinkGoogle,disabled:linkingInProgress==='google',className:\"text-xs font-medium text-blue-600 hover:text-blue-700 px-3 py-1.5 bg-blue-50 hover:bg-blue-100 rounded-lg transition-colors disabled:opacity-50\",children:linkingInProgress==='google'?'Linking...':'Link'})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between p-3 bg-white rounded-lg border \".concat(hasPhone?'border-green-200':'border-gray-100'),children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center gap-3\",children:[/*#__PURE__*/_jsx(Phone,{className:\"w-5 h-5 text-green-600\"}),/*#__PURE__*/_jsx(\"span\",{className:\"font-medium text-gray-700\",children:\"Phone\"})]}),hasPhone?/*#__PURE__*/_jsxs(\"span\",{className:\"text-xs font-medium text-green-600 flex items-center gap-1\",children:[/*#__PURE__*/_jsx(CheckCircle,{className:\"w-4 h-4\"}),\" Linked\"]}):/*#__PURE__*/_jsx(\"button\",{onClick:handleLinkPhone,className:\"text-xs font-medium text-blue-600 hover:text-blue-700 px-3 py-1.5 bg-blue-50 hover:bg-blue-100 rounded-lg transition-colors\",children:\"Link\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between p-3 bg-white rounded-lg border \".concat(hasPassword?'border-green-200':'border-gray-100'),children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center gap-3\",children:[/*#__PURE__*/_jsx(Mail,{className:\"w-5 h-5 text-blue-600\"}),/*#__PURE__*/_jsx(\"span\",{className:\"font-medium text-gray-700\",children:\"Email & Password\"})]}),hasPassword?/*#__PURE__*/_jsxs(\"span\",{className:\"text-xs font-medium text-green-600 flex items-center gap-1\",children:[/*#__PURE__*/_jsx(CheckCircle,{className:\"w-4 h-4\"}),\" Linked\"]}):/*#__PURE__*/_jsx(\"span\",{className:\"text-xs text-gray-400\",children:\"Coming soon\"})]})]}),/*#__PURE__*/_jsx(\"p\",{className:\"text-[11px] text-gray-500 mt-3 text-center\",children:\"Link accounts to sign in with any method\"})]}),onSignOut&&/*#__PURE__*/_jsxs(\"button\",{onClick:onSignOut,className:\"w-full mt-4 flex items-center justify-center gap-2 px-4 py-3 bg-gray-100 hover:bg-gray-200 text-gray-700 font-semibold rounded-xl transition-colors\",children:[/*#__PURE__*/_jsx(LogOut,{className:\"w-5 h-5\"}),\"Sign Out\"]})]})})]});}function LandlordOnboardingView(_ref3){var _currentUser$name,_currentUser$name$cha;let{onComplete,onCancel,currentUser}=_ref3;const[form,setForm]=useState({businessName:(currentUser===null||currentUser===void 0?void 0:currentUser.name)||'',bankDetails:'',idNumber:'',agree:false});const handleSubmit=()=>{if(!form.businessName||!form.agree){alert('Please provide a display name and agree to the terms.');return;}onComplete(form);};return/*#__PURE__*/_jsxs(\"div\",{className:\"min-h-screen bg-gradient-to-b from-slate-50 to-gray-100 pb-24\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"bg-gradient-to-br from-teal-600 via-teal-500 to-cyan-500 pt-8 pb-16 px-4\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"max-w-2xl mx-auto text-center\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"w-20 h-20 bg-white/20 backdrop-blur-sm rounded-2xl flex items-center justify-center mx-auto mb-4 border border-white/30\",children:/*#__PURE__*/_jsx(\"span\",{className:\"text-4xl font-bold text-white\",children:(currentUser===null||currentUser===void 0?void 0:(_currentUser$name=currentUser.name)===null||_currentUser$name===void 0?void 0:(_currentUser$name$cha=_currentUser$name.charAt(0))===null||_currentUser$name$cha===void 0?void 0:_currentUser$name$cha.toUpperCase())||'L'})}),/*#__PURE__*/_jsxs(\"h2\",{className:\"text-2xl font-bold text-white mb-2\",children:[\"Welcome, \",(currentUser===null||currentUser===void 0?void 0:currentUser.name)||'Landlord',\"!\"]}),/*#__PURE__*/_jsx(\"p\",{className:\"text-teal-100\",children:\"Complete your profile to start listing properties\"})]})}),/*#__PURE__*/_jsx(\"div\",{className:\"px-4 -mt-8\",children:/*#__PURE__*/_jsx(\"div\",{className:\"max-w-2xl mx-auto\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white rounded-2xl shadow-xl border border-gray-100 p-8\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-center gap-2 mb-8\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center gap-2\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"w-8 h-8 bg-teal-600 text-white rounded-full flex items-center justify-center text-sm font-bold\",children:\"1\"}),/*#__PURE__*/_jsx(\"span\",{className:\"text-sm font-medium text-gray-700\",children:\"Profile Details\"})]}),/*#__PURE__*/_jsx(\"div\",{className:\"w-8 h-0.5 bg-gray-200\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center gap-2\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"w-8 h-8 bg-gray-200 text-gray-500 rounded-full flex items-center justify-center text-sm font-bold\",children:\"2\"}),/*#__PURE__*/_jsx(\"span\",{className:\"text-sm text-gray-400\",children:\"Start Listing\"})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-5\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-semibold text-gray-800 mb-2\",children:\"Display Name *\"}),/*#__PURE__*/_jsx(\"input\",{value:form.businessName,onChange:e=>setForm(_objectSpread(_objectSpread({},form),{},{businessName:e.target.value})),className:\"w-full px-4 py-3 border border-gray-200 rounded-xl focus:ring-2 focus:ring-teal-500 focus:border-teal-500 transition-all\",placeholder:\"Your name or business name\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-xs text-gray-500 mt-1.5\",children:\"This name is shown to renters on your listings and messages.\"})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-semibold text-gray-800 mb-2\",children:\"Payment Details (Optional)\"}),/*#__PURE__*/_jsx(\"input\",{value:form.bankDetails,onChange:e=>setForm(_objectSpread(_objectSpread({},form),{},{bankDetails:e.target.value})),placeholder:\"Bank account or preferred payment method\",className:\"w-full px-4 py-3 border border-gray-200 rounded-xl focus:ring-2 focus:ring-teal-500 focus:border-teal-500 transition-all\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-xs text-gray-500 mt-1.5\",children:\"Private - only shown to confirmed renters.\"})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-semibold text-gray-800 mb-2\",children:\"ID Number (Optional)\"}),/*#__PURE__*/_jsx(\"input\",{value:form.idNumber,onChange:e=>setForm(_objectSpread(_objectSpread({},form),{},{idNumber:e.target.value})),className:\"w-full px-4 py-3 border border-gray-200 rounded-xl focus:ring-2 focus:ring-teal-500 focus:border-teal-500 transition-all\",placeholder:\"For verification purposes\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-xs text-gray-500 mt-1.5\",children:\"Verified landlords get a trust badge on their listings.\"})]}),/*#__PURE__*/_jsx(\"div\",{className:\"bg-gradient-to-r from-teal-50 to-cyan-50 rounded-xl p-4 border border-teal-100\",children:/*#__PURE__*/_jsxs(\"label\",{className:\"flex items-start gap-3 cursor-pointer\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"checkbox\",checked:form.agree,onChange:e=>setForm(_objectSpread(_objectSpread({},form),{},{agree:e.target.checked})),className:\"mt-1 w-5 h-5 rounded border-gray-300 text-teal-600 focus:ring-teal-500\"}),/*#__PURE__*/_jsxs(\"span\",{className:\"text-sm text-gray-700\",children:[\"I confirm I am authorised to list these properties and agree to the\",' ',/*#__PURE__*/_jsx(\"button\",{type:\"button\",onClick:e=>e.preventDefault(),className:\"text-teal-600 hover:text-teal-700 font-medium underline\",children:\"terms of service\"}),\".\"]})]})}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex gap-3 pt-4\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:onCancel,className:\"flex-1 bg-gray-100 hover:bg-gray-200 text-gray-700 font-medium py-3.5 rounded-xl transition-colors\",children:\"Cancel\"}),/*#__PURE__*/_jsx(\"button\",{onClick:handleSubmit,className:\"flex-1 bg-gradient-to-r from-teal-600 to-cyan-600 hover:from-teal-700 hover:to-cyan-700 text-white font-semibold py-3.5 rounded-xl transition-all shadow-md hover:shadow-lg\",children:\"Complete & Start Listing\"})]})]})]})})})]});}function EditProfileView(_ref4){let{user,onSubmit,onCancel}=_ref4;const[formData,setFormData]=useState({name:user.name||'',phone:user.phone||'',email:user.email||'',whatsapp:user.whatsapp||'',photo:user.photo||''});const[errors,setErrors]=useState({});const[touched,setTouched]=useState({});const validateField=function(name,value){let extras=arguments.length>2&&arguments[2]!==undefined?arguments[2]:{};const newErrors=_objectSpread({},errors);switch(name){case'name':if(!value||value.trim().length<2){newErrors.name='Name must be at least 2 characters';}else{delete newErrors.name;}break;case'phone':if(!value||!/^[+]?[-0-9()\\s]{7,}$/.test(value.trim())){newErrors.phone='Enter a valid phone number';}else{delete newErrors.phone;}break;case'email':if(!value||!/^[^@\\s]+@[^@\\s]+\\.[^@\\s]+$/.test(value.trim())){newErrors.email='Enter a valid email';}else{delete newErrors.email;}break;default:break;}setErrors(newErrors);};const handlePhotoUpload=e=>{const file=e.target.files[0];if(file){const reader=new FileReader();reader.onloadend=()=>{setFormData(_objectSpread(_objectSpread({},formData),{},{photo:reader.result}));};reader.readAsDataURL(file);}};const handleSubmit=()=>{setTouched({name:true,phone:true,email:true});validateField('name',formData.name);validateField('phone',formData.phone);validateField('email',formData.email);if(Object.keys(errors).length===0&&formData.name&&formData.phone&&formData.email){onSubmit(formData);}};return/*#__PURE__*/_jsx(\"div\",{className:\"p-4 min-h-screen bg-gradient-to-b from-slate-50 to-gray-100 pb-24\",children:/*#__PURE__*/_jsx(\"div\",{className:\"max-w-2xl mx-auto mt-8\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white rounded-2xl shadow-lg border border-gray-100 p-8\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between mb-8\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\"text-3xl font-extrabold text-gray-900\",children:\"Edit Profile\"}),/*#__PURE__*/_jsx(\"button\",{onClick:onCancel,className:\"text-gray-400 hover:text-gray-600 transition\",children:/*#__PURE__*/_jsx(X,{className:\"w-6 h-6\"})})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-6\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"flex justify-center mb-8\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"relative\",children:[formData.photo?/*#__PURE__*/_jsx(\"img\",{src:formData.photo,alt:\"Profile\",className:\"w-32 h-32 rounded-full object-cover border-4 border-blue-200 shadow-lg\"}):/*#__PURE__*/_jsx(\"div\",{className:\"w-32 h-32 rounded-full bg-gradient-to-br from-blue-100 to-blue-200 flex items-center justify-center border-4 border-blue-200 shadow-lg\",children:/*#__PURE__*/_jsx(User,{className:\"w-16 h-16 text-blue-600\"})}),/*#__PURE__*/_jsxs(\"label\",{className:\"absolute bottom-0 right-0 bg-blue-600 hover:bg-blue-700 text-white p-3 rounded-full cursor-pointer shadow-lg transition\",\"aria-label\":\"Upload new profile photo\",children:[/*#__PURE__*/_jsx(Edit,{className:\"w-5 h-5\"}),/*#__PURE__*/_jsx(\"input\",{type:\"file\",accept:\"image/*\",onChange:handlePhotoUpload,className:\"hidden\"})]})]})}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-semibold text-gray-800 mb-2\",children:\"Full Name\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",required:true,value:formData.name,onChange:e=>{setFormData(_objectSpread(_objectSpread({},formData),{},{name:e.target.value}));if(touched.name)validateField('name',e.target.value);},onBlur:e=>{setTouched(_objectSpread(_objectSpread({},touched),{},{name:true}));validateField('name',e.target.value);},\"aria-invalid\":errors.name?'true':'false',\"aria-describedby\":errors.name?'edit-name-error':undefined,className:\"w-full px-4 py-3 border-2 \".concat(errors.name?'border-red-400':'border-gray-200',\" bg-white text-gray-800 rounded-xl focus:ring-2 focus:ring-teal-400 focus:border-transparent transition placeholder-gray-400\")}),errors.name&&touched.name&&/*#__PURE__*/_jsx(\"p\",{id:\"edit-name-error\",className:\"mt-1 text-xs text-red-600\",children:errors.name})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-semibold text-gray-800 mb-2\",children:\"Phone Number\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"relative\",children:[/*#__PURE__*/_jsx(Phone,{className:\"absolute left-4 top-3.5 w-5 h-5 text-gray-400\"}),/*#__PURE__*/_jsx(\"input\",{type:\"tel\",required:true,value:formData.phone,onChange:e=>{setFormData(_objectSpread(_objectSpread({},formData),{},{phone:e.target.value}));if(touched.phone)validateField('phone',e.target.value);},onBlur:e=>{setTouched(_objectSpread(_objectSpread({},touched),{},{phone:true}));validateField('phone',e.target.value);},\"aria-invalid\":errors.phone?'true':'false',\"aria-describedby\":errors.phone?'edit-phone-error':undefined,className:\"w-full pl-11 pr-4 py-3 border-2 \".concat(errors.phone?'border-red-400':'border-gray-200',\" bg-white text-gray-800 rounded-xl focus:ring-2 focus:ring-teal-400 focus:border-transparent transition placeholder-gray-400\")})]}),errors.phone&&touched.phone&&/*#__PURE__*/_jsx(\"p\",{id:\"edit-phone-error\",className:\"mt-1 text-xs text-red-600\",children:errors.phone})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-semibold text-gray-800 mb-2\",children:\"Email Address\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"relative\",children:[/*#__PURE__*/_jsx(Mail,{className:\"absolute left-4 top-3.5 w-5 h-5 text-gray-400\"}),/*#__PURE__*/_jsx(\"input\",{type:\"email\",required:true,value:formData.email,onChange:e=>{setFormData(_objectSpread(_objectSpread({},formData),{},{email:e.target.value}));if(touched.email)validateField('email',e.target.value);},onBlur:e=>{setTouched(_objectSpread(_objectSpread({},touched),{},{email:true}));validateField('email',e.target.value);},\"aria-invalid\":errors.email?'true':'false',\"aria-describedby\":errors.email?'edit-email-error':undefined,className:\"w-full pl-11 pr-4 py-3 border-2 \".concat(errors.email?'border-red-400':'border-gray-200',\" bg-white text-gray-800 rounded-xl focus:ring-2 focus:ring-teal-400 focus:border-transparent transition placeholder-gray-400\")})]}),errors.email&&touched.email&&/*#__PURE__*/_jsx(\"p\",{id:\"edit-email-error\",className:\"mt-1 text-xs text-red-600\",children:errors.email})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-semibold text-gray-800 mb-2\",children:\"WhatsApp (optional)\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"relative\",children:[/*#__PURE__*/_jsx(Phone,{className:\"absolute left-4 top-3.5 w-5 h-5 text-gray-400\"}),/*#__PURE__*/_jsx(\"input\",{type:\"tel\",value:formData.whatsapp,onChange:e=>setFormData(_objectSpread(_objectSpread({},formData),{},{whatsapp:e.target.value})),placeholder:\"e.g., +27 71 234 5678\",className:\"w-full pl-11 pr-4 py-3 border-2 border-gray-200 bg-white text-gray-800 rounded-xl focus:ring-2 focus:ring-teal-400 focus:border-transparent transition placeholder-gray-400\"})]}),/*#__PURE__*/_jsx(\"p\",{className:\"text-xs text-gray-500 mt-1\",children:\"Used to create a WhatsApp chat link on your listings.\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex gap-3 pt-6 border-t border-gray-200\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:onCancel,className:\"flex-1 bg-gray-100 hover:bg-gray-200 text-gray-800 font-semibold py-3 rounded-xl transition\",children:\"Cancel\"}),/*#__PURE__*/_jsx(\"button\",{onClick:handleSubmit,className:\"flex-1 bg-gradient-to-r from-teal-500 to-cyan-500 hover:from-teal-600 hover:to-cyan-600 text-white font-semibold py-3 rounded-xl transition shadow-lg\",children:\"Save Changes\"})]})]})]})})});}/* BrowseView extracted to components/BrowseView.jsx */function FavoritesView(_ref5){let{listings,onSelectListing}=_ref5;const[favorites,setFavorites]=useState([]);useEffect(()=>{try{const rawFavorites=localStorage.getItem('favorites');if(rawFavorites){const arr=JSON.parse(rawFavorites);if(Array.isArray(arr))setFavorites(arr);}}catch(_unused8){}},[]);const toggleFavorite=listingId=>{setFavorites(prev=>{const updated=prev.filter(id=>id!==listingId);try{localStorage.setItem('favorites',JSON.stringify(updated));}catch(_unused9){}return updated;});};const favoriteListings=listings.filter(l=>favorites.includes(l.id));return/*#__PURE__*/_jsx(\"div\",{className:\"p-4 min-h-screen bg-gradient-to-b from-slate-50 to-gray-100 pb-24\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"max-w-7xl mx-auto mt-8\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"mb-8\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center gap-4 mb-3\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"w-14 h-14 bg-gradient-to-br from-rose-100 to-pink-100 rounded-2xl flex items-center justify-center shadow-sm\",children:/*#__PURE__*/_jsx(Heart,{className:\"w-7 h-7 text-rose-500 fill-rose-500\"})}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h2\",{className:\"text-3xl font-extrabold text-gray-900\",children:\"Saved Listings\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-gray-600\",children:favoriteListings.length===0?'Your favorites will appear here':\"\".concat(favoriteListings.length,\" saved \").concat(favoriteListings.length===1?'listing':'listings')})]})]})}),favoriteListings.length===0?/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white rounded-2xl border border-gray-100 shadow-sm p-12 text-center\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"w-24 h-24 bg-gradient-to-br from-rose-50 to-pink-50 rounded-full flex items-center justify-center mx-auto mb-6\",children:/*#__PURE__*/_jsx(Heart,{className:\"w-12 h-12 text-rose-300\"})}),/*#__PURE__*/_jsx(\"h3\",{className:\"text-xl font-bold text-gray-800 mb-2\",children:\"No saved listings yet\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-gray-500 text-sm mb-6 max-w-md mx-auto\",children:\"Browse rooms and tap the heart icon to save your favorites. They'll appear here for easy access.\"})]}):/*#__PURE__*/_jsx(\"div\",{className:\"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6\",children:favoriteListings.map(listing=>{const ListingCard=require('./components/ListingCard').default;return/*#__PURE__*/_jsx(ListingCard,{listing:listing,onClick:()=>onSelectListing(listing),isFavorite:true,onToggleFavorite:toggleFavorite},listing.id);})})]})});}const createDefaultListingForm=()=>({title:'',price:'',location:'',streetAddress:'',description:'',photos:[],status:'available',availableDate:new Date().toISOString().split('T')[0],amenities:[],latitude:null,longitude:null,paymentMethod:'Bank and Cash',roomType:'private',leaseDuration:'7-12',petFriendly:false,genderPreference:'any',premium:false});function AddListingView(_ref6){let{onSubmit,onCancel,currentUser,userType,onRequireAuth,onRequireOnboarding}=_ref6;const GEOCODER_KEY=process.env.REACT_APP_GEOCODER_API_KEY;const GEOCODER_PROVIDER=(process.env.REACT_APP_GEOCODER_PROVIDER||'').toLowerCase();const landlordId=currentUser===null||currentUser===void 0?void 0:currentUser.id;const[formData,setFormData]=useState(()=>{const base=createDefaultListingForm();if(landlordId){const saved=loadListingTemplate(landlordId);if(saved){var _saved$petFriendly,_saved$premium;return _objectSpread(_objectSpread(_objectSpread({},base),saved),{},{amenities:Array.isArray(saved.amenities)?saved.amenities:base.amenities,petFriendly:(_saved$petFriendly=saved.petFriendly)!==null&&_saved$petFriendly!==void 0?_saved$petFriendly:base.petFriendly,premium:(_saved$premium=saved.premium)!==null&&_saved$premium!==void 0?_saved$premium:base.premium,photos:[]});}}return base;});const[geocodingStatus,setGecodingStatus]=useState('');const[errors,setErrors]=useState({});const[showPhotoEditor,setShowPhotoEditor]=useState(false);const reverseGeocodeCacheRef=React.useRef({});const[lastGeocodeSource,setLastGeocodeSource]=useState(null);// 'cached' | 'mapbox' | 'proxy' | 'direct' | 'coords-only' | 'manual-geocode'\nconst[fullAddressInput,setFullAddressInput]=useState('');const[isFullAddressEditing,setIsFullAddressEditing]=useState(false);useEffect(()=>{if(!landlordId)return;const saved=loadListingTemplate(landlordId);if(saved){setFormData(prev=>{var _saved$petFriendly2,_saved$premium2;return _objectSpread(_objectSpread(_objectSpread({},prev),saved),{},{amenities:Array.isArray(saved.amenities)?saved.amenities:[],petFriendly:(_saved$petFriendly2=saved.petFriendly)!==null&&_saved$petFriendly2!==void 0?_saved$petFriendly2:false,premium:(_saved$premium2=saved.premium)!==null&&_saved$premium2!==void 0?_saved$premium2:false,photos:[]});});}else{setFormData(createDefaultListingForm());}},[landlordId]);useEffect(()=>{if(!landlordId||userType!=='landlord')return;saveListingTemplate(landlordId,formData);},[formData,landlordId,userType]);// Warn user before leaving if form has unsaved data\nuseEffect(()=>{var _formData$photos;const hasFormData=formData.title||formData.description||((_formData$photos=formData.photos)===null||_formData$photos===void 0?void 0:_formData$photos.length)>0;const handleBeforeUnload=e=>{if(hasFormData){e.preventDefault();e.returnValue='';return'';}};if(hasFormData){window.addEventListener('beforeunload',handleBeforeUnload);}return()=>{window.removeEventListener('beforeunload',handleBeforeUnload);};},[formData.title,formData.description,formData.photos]);// Helper: fetch with graceful fallbacks when third-party APIs lack CORS headers\nconst corsFallbackTransforms=useMemo(()=>[url=>url.startsWith('https://cors.isomorphic-git.org/')?url:\"https://cors.isomorphic-git.org/\".concat(url),url=>url.startsWith('https://corsproxy.io/?')?url:\"https://corsproxy.io/?\".concat(encodeURIComponent(url))],[]);const fetchWithCorsFallback=useCallback(async function(url){let options=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};const cloneOptions=()=>{const base=_objectSpread({},options);if(options.headers)base.headers=_objectSpread({},options.headers);return base;};const attempt=async targetUrl=>{const resp=await fetch(targetUrl,cloneOptions());if(!resp.ok)throw new Error(\"Request failed with status \".concat(resp.status));return resp;};try{return await attempt(url);}catch(err){var _options$signal;if((_options$signal=options.signal)!==null&&_options$signal!==void 0&&_options$signal.aborted)throw err;let lastError=err;for(const transform of corsFallbackTransforms){try{const proxiedUrl=transform(url);return await attempt(proxiedUrl);}catch(proxyErr){var _options$signal2;lastError=proxyErr;if((_options$signal2=options.signal)!==null&&_options$signal2!==void 0&&_options$signal2.aborted)break;}}throw lastError;}},[corsFallbackTransforms]);// Forward geocode helper for manual address lookups\nconst forwardGeocodeAddress=async query=>{if(!query||query.trim().length<3)return[];// 1. Mapbox (if configured)\nif(GEOCODER_PROVIDER==='mapbox'&&GEOCODER_KEY){try{var _data$features;const resp=await fetch(\"https://api.mapbox.com/geocoding/v5/mapbox.places/\".concat(encodeURIComponent(query),\".json?access_token=\").concat(GEOCODER_KEY,\"&limit=3&country=za&types=address,place,locality\"));const data=await resp.json();if(data!==null&&data!==void 0&&(_data$features=data.features)!==null&&_data$features!==void 0&&_data$features.length){return data.features.map(f=>{var _f$geometry,_f$geometry$coordinat,_f$geometry2,_f$geometry2$coordina;return{lat:f.center?f.center[1]:(_f$geometry=f.geometry)===null||_f$geometry===void 0?void 0:(_f$geometry$coordinat=_f$geometry.coordinates)===null||_f$geometry$coordinat===void 0?void 0:_f$geometry$coordinat[1],lon:f.center?f.center[0]:(_f$geometry2=f.geometry)===null||_f$geometry2===void 0?void 0:(_f$geometry2$coordina=_f$geometry2.coordinates)===null||_f$geometry2$coordina===void 0?void 0:_f$geometry2$coordina[0],label:f.place_name||f.text,source:'mapbox'};}).filter(entry=>typeof entry.lat==='number'&&typeof entry.lon==='number');}}catch(err){console.warn('Mapbox forward geocode failed',err);}}// 2. maps.co (CORS-friendly)\ntry{const mapsResp=await fetch(\"https://geocode.maps.co/search?q=\".concat(encodeURIComponent(query),\"&limit=3\"));if(mapsResp.ok){const mapsData=await mapsResp.json();if(Array.isArray(mapsData)&&mapsData.length){return mapsData.slice(0,3).map(entry=>({lat:parseFloat(entry.lat),lon:parseFloat(entry.lon),label:entry.display_name||entry.name,source:'maps.co'}));}}}catch(mapsErr){console.warn('maps.co forward geocode failed',mapsErr);}// 3. Local proxy (if running)\nconst API_BASE=process.env.REACT_APP_PROXY_BASE||(window.location&&window.location.port==='8443'?'https://localhost:4443':'');if(API_BASE){try{const proxyResp=await fetch(\"\".concat(API_BASE,\"/api/search?q=\").concat(encodeURIComponent(query)));if(proxyResp.ok){const proxyData=await proxyResp.json();if(Array.isArray(proxyData)&&proxyData.length){return proxyData.slice(0,3).map(entry=>({lat:parseFloat(entry.lat),lon:parseFloat(entry.lon),label:entry.display_name,source:API_BASE.includes('localhost')?'local-proxy':'proxy'}));}}}catch(proxyErr){console.warn('Local proxy forward geocode failed',proxyErr);}}// 4. Direct Nominatim fallback (may still be blocked, but last resort)\ntry{const directResp=await fetchWithCorsFallback(\"https://nominatim.openstreetmap.org/search?format=json&addressdetails=1&q=\".concat(encodeURIComponent(query)),{headers:{'User-Agent':'room-rental-platform/1.0 (direct fallback)','Accept':'application/json'}});if(directResp.ok){const directData=await directResp.json();if(Array.isArray(directData)&&directData.length){return directData.slice(0,3).map(entry=>({lat:parseFloat(entry.lat),lon:parseFloat(entry.lon),label:entry.display_name,source:'direct'}));}}}catch(directErr){console.warn('Direct nominatim forward geocode failed',directErr);}return[];};const availableAmenities=['WiFi','Parking','Kitchen','Laundry','Air Conditioning','Heating','TV','Furnished','Pet Friendly','Garden'];const validateField=function(name,value){let extras=arguments.length>2&&arguments[2]!==undefined?arguments[2]:{};const newErrors=_objectSpread({},errors);switch(name){case'title':if(!value||value.trim().length<5){newErrors.title='Title must be at least 5 characters';}else{delete newErrors.title;}break;case'price':if(!value||parseFloat(value)<=0){newErrors.price='Price must be greater than 0';}else if(parseFloat(value)<500){newErrors.price='Price seems too low (minimum R500)';}else if(parseFloat(value)>50000){newErrors.price='Price seems too high (maximum R50,000)';}else{delete newErrors.price;}break;case'location':{var _ref7,_extras$streetAddress,_ref8,_extras$location;const streetText=((_ref7=(_extras$streetAddress=extras.streetAddress)!==null&&_extras$streetAddress!==void 0?_extras$streetAddress:formData.streetAddress)!==null&&_ref7!==void 0?_ref7:'').trim();const areaText=((_ref8=(_extras$location=extras.location)!==null&&_extras$location!==void 0?_extras$location:value)!==null&&_ref8!==void 0?_ref8:'').trim();if(!streetText||streetText.length<3){newErrors.location='Add the street or stand number (e.g., 5170 Molefe St)';}else if(!areaText||areaText.length<3){newErrors.location='Add the suburb, city, and postal code (e.g., Ivory Park, Midrand, 1693)';}else{delete newErrors.location;}break;}case'description':if(value&&value.length>500){newErrors.description='Description is too long (max 500 characters)';}else{delete newErrors.description;}break;default:break;}setErrors(newErrors);};// Load persisted reverse geocode cache\nuseEffect(()=>{try{const raw=localStorage.getItem('reverse-geocode-cache');if(raw){const parsed=JSON.parse(raw);if(parsed&&typeof parsed==='object'){reverseGeocodeCacheRef.current=parsed;}}}catch(e){/* ignore */}},[]);// Geocode address using Nominatim (OpenStreetMap)\nconst geocodeAddress=async()=>{if(!formData.streetAddress){setGecodingStatus('Please enter a street address');return;}setGecodingStatus('Finding coordinates...');try{const fullAddress=\"\".concat(formData.streetAddress,\", \").concat(formData.location,\", South Africa\");const results=await forwardGeocodeAddress(fullAddress);if(results.length>0){const best=results[0];setFormData(_objectSpread(_objectSpread({},formData),{},{latitude:parseFloat(best.lat),longitude:parseFloat(best.lon)}));setGecodingStatus(\"\\u2713 Address found!\");setTimeout(()=>setGecodingStatus(''),2000);setLastGeocodeSource(best.source||'manual-geocode');return;}setGecodingStatus('Address not found. Trying with area only...');const areaResults=await forwardGeocodeAddress(\"\".concat(formData.location,\", South Africa\"));if(areaResults.length>0){const bestArea=areaResults[0];setFormData(_objectSpread(_objectSpread({},formData),{},{latitude:parseFloat(bestArea.lat),longitude:parseFloat(bestArea.lon)}));setGecodingStatus(' Area found!');setTimeout(()=>setGecodingStatus(''),2000);setLastGeocodeSource(bestArea.source||'manual-geocode');}else{setGecodingStatus('Could not find location');}}catch(error){console.error('Geocoding error:',error);setGecodingStatus('Error finding address. Check your connection.');setLastGeocodeSource(null);}};const toggleAmenity=amenity=>{if(formData.amenities.includes(amenity)){setFormData(_objectSpread(_objectSpread({},formData),{},{amenities:formData.amenities.filter(a=>a!==amenity)}));}else{setFormData(_objectSpread(_objectSpread({},formData),{},{amenities:[...formData.amenities,amenity]}));}};const[isSubmitting,setIsSubmitting]=useState(false);const handleSubmit=async()=>{// Enforce auth and onboarding checks before allowing submission\nif(!currentUser){onRequireAuth&&onRequireAuth('landlord');return;}if(userType!=='landlord'){// prompt to become landlord\nonRequireAuth&&onRequireAuth('landlord');return;}if(!currentUser.landlordComplete){// send to onboarding\nonRequireOnboarding&&onRequireOnboarding();return;}// Validate all fields\nvalidateField('title',formData.title);validateField('price',formData.price);validateField('location',formData.location,{location:formData.location,streetAddress:formData.streetAddress});validateField('description',formData.description);if(!formData.title||formData.title.trim().length<5){setErrors(prev=>_objectSpread(_objectSpread({},prev),{},{title:'Title must be at least 5 characters'}));return;}if(!formData.price||parseFloat(formData.price)<=0){setErrors(prev=>_objectSpread(_objectSpread({},prev),{},{price:'Price must be greater than 0'}));return;}if(!formData.location||formData.location.trim().length<3){setErrors(prev=>_objectSpread(_objectSpread({},prev),{},{location:'Location is required'}));return;}if(Object.keys(errors).length>0){return;}setIsSubmitting(true);try{await onSubmit(formData);}finally{setIsSubmitting(false);}};const googleMapsQuery=[formData.streetAddress,formData.location,'South Africa'].filter(Boolean).join(', ');const googleMapsUrl=googleMapsQuery?\"https://www.google.com/maps/search/?api=1&query=\".concat(encodeURIComponent(googleMapsQuery)):'';const combinedFormAddress=[formData.streetAddress,formData.location].map(part=>(part||'').trim()).filter(Boolean).join(', ');useEffect(()=>{if(isFullAddressEditing)return;setFullAddressInput(prev=>prev===combinedFormAddress?prev:combinedFormAddress);},[combinedFormAddress,isFullAddressEditing]);const handleFullAddressChange=value=>{setFullAddressInput(value);if(!value||value.length<3){setFormData(prev=>_objectSpread(_objectSpread({},prev),{},{streetAddress:'',location:''}));validateField('location','');return;}const parts=value.split(',').map(part=>part.trim()).filter(Boolean);if(parts.length===0){setFormData(prev=>_objectSpread(_objectSpread({},prev),{},{streetAddress:'',location:''}));validateField('location','');return;}let street=parts[0]||'';let derivedLocation=parts.slice(1).join(', ');if(!derivedLocation){const words=street.split(/\\s+/).filter(Boolean);if(words.length>=4){// Guess that the last few tokens describe the suburb/city/postal portion.\nconst locationWordCount=Math.min(4,Math.ceil(words.length/2));derivedLocation=words.slice(-locationWordCount).join(' ');street=words.slice(0,words.length-locationWordCount).join(' ');}else{derivedLocation=street;}}setFormData(prev=>_objectSpread(_objectSpread({},prev),{},{streetAddress:street,location:derivedLocation}));validateField('location',derivedLocation||street,{location:derivedLocation,streetAddress:street});};const handleResetSavedTemplate=()=>{if(!landlordId)return;clearListingTemplate(landlordId);const blank=createDefaultListingForm();setFormData(blank);setFullAddressInput('');};return/*#__PURE__*/_jsx(\"div\",{className:\"p-4 bg-gradient-to-b from-slate-50 to-gray-100 min-h-screen pb-24\",children:/*#__PURE__*/_jsx(\"div\",{className:\"max-w-3xl mx-auto mt-8\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white rounded-2xl shadow-lg border border-gray-100 p-8\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between mb-6\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\"text-3xl font-extrabold text-gray-900\",children:\"Post a Room\"}),/*#__PURE__*/_jsx(\"button\",{onClick:onCancel,className:\"text-gray-400 hover:text-gray-600 transition-colors p-2 rounded-full hover:bg-gray-100\",children:/*#__PURE__*/_jsx(X,{className:\"w-6 h-6\"})})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"mb-8\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-between items-center mb-2\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"text-sm font-medium text-gray-600\",children:\"Form Progress\"}),/*#__PURE__*/_jsx(\"span\",{className:\"text-sm font-semibold text-teal-600\",children:(()=>{let completed=0;const total=5;if(formData.title&&formData.title.trim().length>=5)completed++;if(formData.price&&parseFloat(formData.price)>=500)completed++;if(formData.streetAddress&&formData.location)completed++;if(formData.description&&formData.description.length>=10)completed++;if(formData.photos&&formData.photos.length>0)completed++;return\"\".concat(completed,\"/\").concat(total,\" completed\");})()})]}),/*#__PURE__*/_jsx(\"div\",{className:\"h-2 bg-gray-100 rounded-full overflow-hidden\",children:/*#__PURE__*/_jsx(\"div\",{className:\"h-full bg-gradient-to-r from-teal-500 to-cyan-500 rounded-full transition-all duration-500\",style:{width:\"\".concat((()=>{let completed=0;if(formData.title&&formData.title.trim().length>=5)completed++;if(formData.price&&parseFloat(formData.price)>=500)completed++;if(formData.streetAddress&&formData.location)completed++;if(formData.description&&formData.description.length>=10)completed++;if(formData.photos&&formData.photos.length>0)completed++;return completed/5*100;})(),\"%\")}})})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-6\",children:[(currentUser===null||currentUser===void 0?void 0:currentUser.type)==='landlord'&&/*#__PURE__*/_jsxs(\"div\",{className:\"bg-gradient-to-r from-teal-50 to-cyan-50 border border-teal-200 text-teal-800 text-sm rounded-xl p-4 flex items-start gap-3\",children:[/*#__PURE__*/_jsx(CheckCircle,{className:\"w-5 h-5 text-teal-600 mt-0.5\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-2\",children:[/*#__PURE__*/_jsx(\"p\",{children:\"We remember your latest listing details (address, price, and more) so you only need to upload fresh photos next time. Update any field below and we'll save it automatically.\"}),/*#__PURE__*/_jsx(\"button\",{type:\"button\",onClick:handleResetSavedTemplate,className:\"text-xs font-semibold text-teal-700 underline hover:text-teal-900 transition-colors\",children:\"Reset saved info\"})]})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsxs(\"label\",{className:\"block text-sm font-semibold text-gray-800 mb-2\",children:[\"Room Title *\",formData.title&&formData.title.trim().length>=5&&!errors.title&&/*#__PURE__*/_jsx(\"span\",{className:\"ml-2 text-green-600 text-xs\",children:\"\\u2713 Looks good\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"relative\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"text\",required:true,value:formData.title,onChange:e=>{setFormData(_objectSpread(_objectSpread({},formData),{},{title:e.target.value}));validateField('title',e.target.value);},onBlur:e=>validateField('title',e.target.value),placeholder:\"e.g., Cozy backroom with private bathroom\",className:\"w-full px-4 py-3 pr-10 border-2 \".concat(errors.title?'border-red-400 bg-red-50':formData.title&&formData.title.trim().length>=5?'border-teal-400 bg-teal-50/30':'border-gray-200',\" text-gray-800 rounded-xl focus:ring-2 \").concat(errors.title?'focus:ring-red-400':'focus:ring-teal-400',\" focus:border-transparent transition-all placeholder-gray-400\")}),formData.title&&formData.title.trim().length>=5&&!errors.title&&/*#__PURE__*/_jsx(CheckCircle,{className:\"absolute right-3 top-1/2 -translate-y-1/2 w-5 h-5 text-teal-600\"})]}),errors.title&&/*#__PURE__*/_jsxs(\"p\",{className:\"text-red-500 text-xs mt-1 flex items-center gap-1\",children:[/*#__PURE__*/_jsx(\"span\",{children:\"\\u26A0\"}),\" \",errors.title]})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsxs(\"label\",{className:\"block text-sm font-semibold text-gray-800 mb-2\",children:[\"Monthly Price (R) *\",formData.price&&parseFloat(formData.price)>=500&&parseFloat(formData.price)<=50000&&!errors.price&&/*#__PURE__*/_jsx(\"span\",{className:\"ml-2 text-green-600 text-xs\",children:\"\\u2713 Valid price\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"relative\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"absolute left-4 top-1/2 -translate-y-1/2 text-gray-500 font-medium\",children:\"R\"}),/*#__PURE__*/_jsx(\"input\",{type:\"number\",required:true,value:formData.price,onChange:e=>{setFormData(_objectSpread(_objectSpread({},formData),{},{price:e.target.value}));validateField('price',e.target.value);},onBlur:e=>validateField('price',e.target.value),placeholder:\"2500\",min:\"500\",max:\"50000\",className:\"w-full pl-10 pr-4 py-3 border-2 \".concat(errors.price?'border-red-400 bg-red-50':formData.price&&parseFloat(formData.price)>=500&&parseFloat(formData.price)<=50000?'border-teal-400 bg-teal-50/30':'border-gray-200',\" text-gray-800 rounded-xl focus:ring-2 \").concat(errors.price?'focus:ring-red-400':'focus:ring-teal-400',\" focus:border-transparent transition-all placeholder-gray-400\")}),formData.price&&parseFloat(formData.price)>=500&&parseFloat(formData.price)<=50000&&!errors.price&&/*#__PURE__*/_jsx(CheckCircle,{className:\"absolute right-3 top-1/2 -translate-y-1/2 w-5 h-5 text-teal-600\"})]}),errors.price&&/*#__PURE__*/_jsxs(\"p\",{className:\"text-red-500 text-xs mt-1 flex items-center gap-1\",children:[/*#__PURE__*/_jsx(\"span\",{children:\"\\u26A0\"}),\" \",errors.price]}),!errors.price&&formData.price&&/*#__PURE__*/_jsx(\"p\",{className:\"text-gray-500 text-xs mt-1\",children:\"Suggested range: R500 - R50,000 per month\"})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-semibold text-gray-800 mb-1\",children:\"Full South African Address *\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-xs text-gray-500 mb-2\",children:\"Example: 5170 Molefe St, Ivory Park, Midrand, 1693\"}),/*#__PURE__*/_jsx(\"textarea\",{required:true,rows:\"2\",value:fullAddressInput,onChange:e=>handleFullAddressChange(e.target.value),onFocus:()=>setIsFullAddressEditing(true),onBlur:e=>{setIsFullAddressEditing(false);handleFullAddressChange(e.target.value);},placeholder:\"Type the full street + suburb + city + postal code\",className:\"w-full px-4 py-3 border-2 \".concat(errors.location?'border-red-400':'border-gray-200',\" bg-white text-gray-800 rounded-xl focus:ring-2 \").concat(errors.location?'focus:ring-red-400':'focus:ring-teal-400',\" focus:border-transparent transition placeholder-gray-400\")}),errors.location&&/*#__PURE__*/_jsx(\"p\",{className:\"text-red-500 text-xs mt-1\",\"aria-live\":\"assertive\",children:errors.location}),!errors.location&&/*#__PURE__*/_jsx(\"p\",{className:\"text-gray-500 text-xs mt-1\",children:\"Include the street/stand number plus suburb, city, and postal code. Commas are optional; we will split it for you.\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"bg-gradient-to-br from-teal-50 to-cyan-50 border-2 border-teal-200 rounded-xl p-6\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-start gap-3 mb-4\",children:[/*#__PURE__*/_jsx(MapPin,{className:\"w-6 h-6 text-teal-600 flex-shrink-0 mt-1\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex-1\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"text-lg font-semibold text-gray-800 mb-1\",children:\"Confirm Your Address\"}),/*#__PURE__*/_jsxs(\"p\",{className:\"text-sm text-gray-600\",children:[\"Type the exact street + suburb above, then tap \",/*#__PURE__*/_jsx(\"strong\",{children:\"Look Up Address\"}),\" if you\\x110d like us to fetch coordinates for your Google Maps preview.\"]})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex flex-wrap gap-3 items-start\",children:[/*#__PURE__*/_jsxs(\"button\",{type:\"button\",onClick:geocodeAddress,className:\"w-full md:w-auto bg-white hover:bg-gray-50 text-gray-700 border-2 border-gray-300 px-6 py-3 rounded-lg text-sm font-semibold transition flex items-center justify-center gap-2\",children:[/*#__PURE__*/_jsx(MapPin,{className:\"w-4 h-4\"}),\"Look Up Address\"]}),/*#__PURE__*/_jsxs(\"div\",{className:\"text-sm flex-1 min-w-[220px]\",children:[geocodingStatus&&/*#__PURE__*/_jsxs(\"span\",{className:\"\".concat(geocodingStatus.startsWith('')?'text-green-600 font-semibold':geocodingStatus.startsWith('')?'text-amber-600':'text-gray-700',\" flex items-center gap-1\"),children:[geocodingStatus.startsWith('')&&/*#__PURE__*/_jsx(CheckCircle,{className:\"w-4 h-4\"}),geocodingStatus,lastGeocodeSource==='cached'&&/*#__PURE__*/_jsx(\"span\",{className:\"ml-2 inline-block px-2 py-1 text-[10px] rounded bg-purple-100 text-purple-600 font-semibold\",children:\"CACHED\"}),lastGeocodeSource==='mapbox'&&/*#__PURE__*/_jsx(\"span\",{className:\"ml-2 inline-block px-2 py-1 text-[10px] rounded bg-blue-100 text-blue-600 font-semibold\",children:\"MAPBOX\"}),lastGeocodeSource==='maps.co'&&/*#__PURE__*/_jsx(\"span\",{className:\"ml-2 inline-block px-2 py-1 text-[10px] rounded bg-indigo-100 text-indigo-600 font-semibold\",children:\"MAPS.CO\"}),lastGeocodeSource==='proxy'&&/*#__PURE__*/_jsx(\"span\",{className:\"ml-2 inline-block px-2 py-1 text-[10px] rounded bg-green-100 text-green-600 font-semibold\",children:\"PROXY\"}),lastGeocodeSource==='direct'&&/*#__PURE__*/_jsx(\"span\",{className:\"ml-2 inline-block px-2 py-1 text-[10px] rounded bg-yellow-100 text-yellow-700 font-semibold\",children:\"FALLBACK\"})]}),formData.latitude&&formData.longitude&&!geocodingStatus&&/*#__PURE__*/_jsxs(\"span\",{className:\"text-green-600 font-semibold flex items-center gap-1\",children:[/*#__PURE__*/_jsx(CheckCircle,{className:\"w-4 h-4\"}),\"Coordinates saved: \",formData.latitude.toFixed(4),\", \",formData.longitude.toFixed(4),lastGeocodeSource==='cached'&&/*#__PURE__*/_jsx(\"span\",{className:\"ml-2 inline-block px-2 py-1 text-[10px] rounded bg-purple-100 text-purple-600 font-semibold\",children:\"CACHED\"}),lastGeocodeSource==='maps.co'&&/*#__PURE__*/_jsx(\"span\",{className:\"ml-2 inline-block px-2 py-1 text-[10px] rounded bg-indigo-100 text-indigo-600 font-semibold\",children:\"MAPS.CO\"})]}),googleMapsUrl&&/*#__PURE__*/_jsxs(\"div\",{className:\"mt-3 bg-white border border-gray-200 rounded-lg p-3 text-xs text-gray-600\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"block text-gray-800 font-semibold mb-1\",children:\"Preview this address\"}),/*#__PURE__*/_jsxs(\"a\",{href:googleMapsUrl,target:\"_blank\",rel:\"noopener noreferrer\",className:\"inline-flex items-center gap-2 text-teal-700 font-semibold hover:text-teal-900 underline\",children:[/*#__PURE__*/_jsx(MapPin,{className:\"w-3 h-3\"}),\" Open in Google Maps\"]}),/*#__PURE__*/_jsx(\"span\",{className:\"block mt-2 text-[11px] text-gray-500\",children:\"Renters will see the same button under your listing.\"})]})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"mt-4 text-sm text-gray-600 bg-white border border-dashed border-gray-300 rounded-lg p-4\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"font-semibold text-gray-800 mb-1\",children:\"Manual address confirmed\"}),/*#__PURE__*/_jsx(\"p\",{children:\"We now rely on the address you type here. Use Google Maps above if you want to double-check directions.\"})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"grid grid-cols-1 md:grid-cols-2 gap-4\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-semibold text-gray-800 mb-2\",children:\"Status\"}),/*#__PURE__*/_jsxs(\"select\",{value:formData.status,onChange:e=>setFormData(_objectSpread(_objectSpread({},formData),{},{status:e.target.value})),className:\"w-full px-4 py-3 border-2 border-gray-200 bg-white text-gray-800 rounded-xl focus:ring-2 focus:ring-teal-400 focus:border-transparent transition\",children:[/*#__PURE__*/_jsx(\"option\",{value:\"available\",children:\"Available\"}),/*#__PURE__*/_jsx(\"option\",{value:\"rented\",children:\"Rented\"})]})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-semibold text-gray-800 mb-2\",children:\"Available Date\"}),/*#__PURE__*/_jsx(\"input\",{type:\"date\",value:formData.availableDate,onChange:e=>setFormData(_objectSpread(_objectSpread({},formData),{},{availableDate:e.target.value})),className:\"w-full px-4 py-3 border-2 border-gray-200 bg-white text-gray-800 rounded-xl focus:ring-2 focus:ring-teal-400 focus:border-transparent transition\"})]})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-semibold text-gray-800 mb-2\",children:\"Payment Method\"}),/*#__PURE__*/_jsxs(\"select\",{value:formData.paymentMethod,onChange:e=>setFormData(_objectSpread(_objectSpread({},formData),{},{paymentMethod:e.target.value})),className:\"w-full px-4 py-3 border-2 border-gray-200 bg-white text-gray-800 rounded-xl focus:ring-2 focus:ring-teal-400 focus:border-transparent transition\",children:[/*#__PURE__*/_jsx(\"option\",{value:\"Bank and Cash\",children:\"Bank and Cash\"}),/*#__PURE__*/_jsx(\"option\",{value:\"Cash Only\",children:\"Cash Only\"}),/*#__PURE__*/_jsx(\"option\",{value:\"Bank Only\",children:\"Bank Only\"})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"grid grid-cols-1 md:grid-cols-2 gap-4\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-semibold text-gray-800 mb-2\",children:\"Room Type\"}),/*#__PURE__*/_jsxs(\"select\",{value:formData.roomType,onChange:e=>setFormData(_objectSpread(_objectSpread({},formData),{},{roomType:e.target.value})),className:\"w-full px-4 py-3 border-2 border-gray-200 bg-white text-gray-800 rounded-xl focus:ring-2 focus:ring-teal-400 focus:border-transparent transition\",children:[/*#__PURE__*/_jsx(\"option\",{value:\"private\",children:\"Private Room\"}),/*#__PURE__*/_jsx(\"option\",{value:\"shared\",children:\"Shared Room\"})]})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-semibold text-gray-800 mb-2\",children:\"Lease Duration (months)\"}),/*#__PURE__*/_jsxs(\"select\",{value:formData.leaseDuration,onChange:e=>setFormData(_objectSpread(_objectSpread({},formData),{},{leaseDuration:e.target.value})),className:\"w-full px-4 py-3 border-2 border-gray-200 bg-white text-gray-800 rounded-xl focus:ring-2 focus:ring-teal-400 focus:border-transparent transition\",children:[/*#__PURE__*/_jsx(\"option\",{value:\"1-3\",children:\"1-3 months\"}),/*#__PURE__*/_jsx(\"option\",{value:\"4-6\",children:\"4-6 months\"}),/*#__PURE__*/_jsx(\"option\",{value:\"7-12\",children:\"7-12 months\"}),/*#__PURE__*/_jsx(\"option\",{value:\"12+\",children:\"12+ months\"})]})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"grid grid-cols-1 md:grid-cols-2 gap-4\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center gap-3\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"checkbox\",checked:formData.petFriendly,onChange:e=>setFormData(_objectSpread(_objectSpread({},formData),{},{petFriendly:e.target.checked})),id:\"petFriendly\",className:\"w-5 h-5 text-teal-600 border-gray-300 rounded focus:ring-teal-500\"}),/*#__PURE__*/_jsx(\"label\",{htmlFor:\"petFriendly\",className:\"text-sm font-medium text-gray-700\",children:\"\\uD83D\\uDC3E Pet Friendly\"})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-semibold text-gray-800 mb-2\",children:\"Gender Preference\"}),/*#__PURE__*/_jsxs(\"select\",{value:formData.genderPreference,onChange:e=>setFormData(_objectSpread(_objectSpread({},formData),{},{genderPreference:e.target.value})),className:\"w-full px-4 py-3 border-2 border-gray-200 bg-white text-gray-800 rounded-xl focus:ring-2 focus:ring-teal-400 focus:border-transparent transition\",children:[/*#__PURE__*/_jsx(\"option\",{value:\"any\",children:\"Any\"}),/*#__PURE__*/_jsx(\"option\",{value:\"male\",children:\"Male Only\"}),/*#__PURE__*/_jsx(\"option\",{value:\"female\",children:\"Female Only\"})]})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center gap-3\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"checkbox\",checked:!!formData.premium,onChange:e=>setFormData(_objectSpread(_objectSpread({},formData),{},{premium:e.target.checked})),id:\"premiumFlag\"}),/*#__PURE__*/_jsx(\"label\",{htmlFor:\"premiumFlag\",className:\"text-sm font-medium text-gray-700\",children:\"Premium listing (highlight & priority sorting)\"})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsxs(\"label\",{className:\"block text-sm font-semibold text-gray-800 mb-2\",children:[\"Description\",formData.description&&/*#__PURE__*/_jsxs(\"span\",{className:\"ml-2 text-xs \".concat(formData.description.length>500?'text-red-500':'text-gray-500'),children:[\"(\",formData.description.length,\"/500 characters)\"]})]}),/*#__PURE__*/_jsx(\"textarea\",{value:formData.description,onChange:e=>{setFormData(_objectSpread(_objectSpread({},formData),{},{description:e.target.value}));validateField('description',e.target.value);},onBlur:e=>validateField('description',e.target.value),placeholder:\"Describe the room, amenities, rules, and any other details...\",rows:\"4\",className:\"w-full px-4 py-3 border-2 \".concat(errors.description?'border-red-400':'border-gray-200',\" bg-white text-gray-800 rounded-xl focus:ring-2 \").concat(errors.description?'focus:ring-red-400':'focus:ring-teal-400',\" focus:border-transparent transition placeholder-gray-400\")}),errors.description&&/*#__PURE__*/_jsx(\"p\",{className:\"text-red-500 text-xs mt-1\",children:errors.description})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-semibold text-gray-800 mb-3\",children:\"Amenities\"}),/*#__PURE__*/_jsx(\"div\",{className:\"grid grid-cols-2 md:grid-cols-3 gap-2\",children:availableAmenities.map(amenity=>/*#__PURE__*/_jsx(\"button\",{type:\"button\",onClick:()=>toggleAmenity(amenity),className:\"px-4 py-2.5 rounded-xl text-sm font-medium transition-all \".concat(formData.amenities.includes(amenity)?'bg-gradient-to-r from-teal-500 to-cyan-500 text-white shadow-md':'bg-gray-100 text-gray-700 border-2 border-gray-200 hover:border-teal-300 hover:bg-teal-50'),children:amenity},amenity))})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-semibold text-gray-800 mb-2\",children:\"Photos (Max 5)\"}),/*#__PURE__*/_jsx(\"div\",{className:\"relative border-2 border-dashed border-gray-300 bg-gradient-to-br from-gray-50 to-slate-50 rounded-xl p-6 hover:border-teal-400 hover:bg-teal-50/30 transition-all duration-300 cursor-pointer group\",onClick:()=>setShowPhotoEditor(true),children:/*#__PURE__*/_jsxs(\"div\",{className:\"text-center\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"w-16 h-16 bg-gradient-to-br from-teal-100 to-cyan-100 rounded-2xl flex items-center justify-center mx-auto mb-3 group-hover:scale-110 transition-transform duration-300\",children:/*#__PURE__*/_jsx(\"span\",{className:\"text-3xl\",children:\"\\uD83D\\uDCF7\"})}),/*#__PURE__*/_jsx(\"p\",{className:\"text-gray-700 font-semibold mb-1\",children:formData.photos.length===0?'Add Photos':\"\".concat(formData.photos.length,\"/5 Photos Added\")}),/*#__PURE__*/_jsx(\"p\",{className:\"text-xs text-gray-500\",children:\"Click to upload \\u2022 JPG, PNG up to 5MB each\"}),formData.photos.length===0&&/*#__PURE__*/_jsx(\"p\",{className:\"text-xs text-teal-600 mt-2 font-medium\",children:\"Tip: Listings with photos get 3x more views!\"})]})}),formData.photos.length>0&&/*#__PURE__*/_jsx(\"div\",{className:\"mt-4 grid grid-cols-2 md:grid-cols-3 gap-3\",children:formData.photos.map((photo,index)=>/*#__PURE__*/_jsxs(\"div\",{className:\"relative group\",children:[index===0&&/*#__PURE__*/_jsx(\"div\",{className:\"absolute top-2 left-2 bg-gradient-to-r from-teal-500 to-cyan-500 text-white text-xs px-2 py-1 rounded-full font-semibold z-10\",children:\"Cover\"}),/*#__PURE__*/_jsx(\"img\",{src:photo,alt:\"Preview \".concat(index+1),className:\"w-full h-32 object-cover rounded-xl border-2 border-gray-200 shadow-sm\"})]},index))}),/*#__PURE__*/_jsx(\"button\",{type:\"button\",onClick:()=>setShowPhotoEditor(true),className:\"mt-3 text-sm text-teal-600 hover:text-teal-700 font-medium\",children:formData.photos.length>0?' Edit Photos':''})]}),showPhotoEditor&&/*#__PURE__*/_jsx(PhotoEditor,{photos:formData.photos,onPhotosChange:newPhotos=>setFormData(_objectSpread(_objectSpread({},formData),{},{photos:newPhotos})),onClose:()=>setShowPhotoEditor(false),maxPhotos:5}),/*#__PURE__*/_jsxs(\"div\",{className:\"border-t border-gray-200 pt-6\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:handleSubmit,disabled:isSubmitting||Object.keys(errors).length>0,className:\"w-full font-semibold py-3.5 rounded-xl transition-all shadow-lg relative \".concat(isSubmitting||Object.keys(errors).length>0?'bg-gray-400 cursor-not-allowed':'bg-gradient-to-r from-teal-500 to-cyan-500 hover:from-teal-600 hover:to-cyan-600 text-white hover:shadow-xl hover:shadow-teal-500/25'),children:isSubmitting?/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"span\",{className:\"opacity-0\",children:\"Post Room\"}),/*#__PURE__*/_jsx(\"div\",{className:\"absolute inset-0 flex items-center justify-center\",children:/*#__PURE__*/_jsx(\"div\",{className:\"w-5 h-5 border-2 border-white border-t-transparent rounded-full animate-spin\"})})]}):'Post Room'}),Object.keys(errors).length>0&&/*#__PURE__*/_jsx(\"p\",{className:\"text-red-500 text-xs mt-2 text-center\",children:\"Please fix the errors above before submitting\"})]})]})]})})});}// MessagesView removed - using direct contact instead\nfunction MyListingsView(_ref9){let{listings,onDelete}=_ref9;return/*#__PURE__*/_jsx(\"div\",{className:\"p-4 min-h-screen bg-gradient-to-b from-slate-50 to-gray-100 pb-24\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"max-w-7xl mx-auto mt-8\",children:[listings.length>0&&/*#__PURE__*/_jsx(\"div\",{className:\"mb-6 bg-gradient-to-r from-amber-50 to-orange-50 border border-amber-200 rounded-2xl p-4 shadow-sm\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-start gap-3\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"w-10 h-10 bg-amber-100 rounded-xl flex items-center justify-center flex-shrink-0\",children:/*#__PURE__*/_jsx(AlertTriangle,{className:\"w-5 h-5 text-amber-600\"})}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h3\",{className:\"font-semibold text-amber-800 mb-1\",children:\"Found a tenant?\"}),/*#__PURE__*/_jsxs(\"p\",{className:\"text-amber-700 text-sm leading-relaxed\",children:[\"Remember to \",/*#__PURE__*/_jsx(\"span\",{className:\"font-medium\",children:\"delete your listing\"}),\" once you've found a tenant. This will stop new calls and messages from other renters looking at your ad.\"]})]})]})}),/*#__PURE__*/_jsx(\"div\",{className:\"mb-8\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center gap-4 mb-3\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"w-14 h-14 bg-gradient-to-br from-teal-100 to-cyan-100 rounded-2xl flex items-center justify-center shadow-sm\",children:/*#__PURE__*/_jsx(Home,{className:\"w-7 h-7 text-teal-600\"})}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h2\",{className:\"text-3xl font-extrabold text-gray-900\",children:\"My Listings\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-gray-600\",children:listings.length===0?'Your properties will appear here':\"\".concat(listings.length,\" active \").concat(listings.length===1?'listing':'listings')})]})]})}),listings.length===0?/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white rounded-2xl border border-gray-100 shadow-sm p-12 text-center\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"w-24 h-24 bg-gradient-to-br from-teal-50 to-cyan-50 rounded-full flex items-center justify-center mx-auto mb-6\",children:/*#__PURE__*/_jsx(Home,{className:\"w-12 h-12 text-teal-400\"})}),/*#__PURE__*/_jsx(\"h3\",{className:\"text-xl font-bold text-gray-800 mb-2\",children:\"No Listings Yet\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-gray-500 text-sm mb-6 max-w-md mx-auto\",children:\"Start earning by posting your first room. It only takes a few minutes!\"}),/*#__PURE__*/_jsxs(\"button\",{onClick:()=>window.location.hash='#add',className:\"inline-flex items-center gap-2 bg-gradient-to-r from-teal-600 to-cyan-600 hover:from-teal-700 hover:to-cyan-700 text-white font-semibold px-6 py-3 rounded-xl transition-all shadow-md hover:shadow-lg\",children:[/*#__PURE__*/_jsx(PlusCircle,{className:\"w-5 h-5\"}),\"Post Your First Room\"]})]}):/*#__PURE__*/_jsx(\"div\",{className:\"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6\",children:listings.map(listing=>{var _listing$price;return/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white rounded-2xl shadow-sm border border-gray-100 overflow-hidden hover:shadow-md transition-shadow\",children:[listing.photos&&listing.photos.length>0&&/*#__PURE__*/_jsxs(\"div\",{className:\"relative\",children:[/*#__PURE__*/_jsx(\"img\",{src:listing.photos[0],alt:\"Room\",className:\"w-full h-48 object-cover\"}),listing.photos.length>1&&/*#__PURE__*/_jsxs(\"div\",{className:\"absolute top-3 right-3 bg-black/60 backdrop-blur-sm text-white px-2.5 py-1 rounded-full text-xs font-medium\",children:[listing.photos.length,\" photos\"]}),/*#__PURE__*/_jsx(\"div\",{className:\"absolute top-3 left-3 px-2.5 py-1 rounded-full text-xs font-semibold \".concat(listing.status==='available'?'bg-emerald-500 text-white':'bg-gray-500 text-white'),children:listing.status==='available'?'Active':'Rented'})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"p-5\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"font-bold text-lg text-gray-900 mb-1 line-clamp-1\",children:listing.title}),/*#__PURE__*/_jsxs(\"div\",{className:\"text-teal-600 font-bold text-xl mb-2\",children:[\"R\",(_listing$price=listing.price)===null||_listing$price===void 0?void 0:_listing$price.toLocaleString(),\"/month\"]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center text-gray-500 text-sm mb-4\",children:[/*#__PURE__*/_jsx(MapPin,{className:\"w-4 h-4 mr-1.5 text-gray-400\"}),/*#__PURE__*/_jsx(\"span\",{className:\"line-clamp-1\",children:listing.location})]}),/*#__PURE__*/_jsx(\"div\",{className:\"flex gap-2\",children:/*#__PURE__*/_jsx(\"button\",{onClick:()=>onDelete(listing.id),className:\"flex-1 bg-red-50 hover:bg-red-100 text-red-600 font-medium py-2.5 rounded-xl transition-colors text-sm\",children:\"Delete\"})})]})]},listing.id);})})]})});}// Inline message box component with validation for listing detail view\n// ListingInlineMessageBox removed\n// ConversationModal removed\nfunction AuthModal(_ref0){let{defaultType='renter',onClose,onSuccess,authFunctions}=_ref0;const[mode,setMode]=useState('signin');// 'signin', 'signup', 'reset', 'phone', 'phone-verify'\nconst[form,setForm]=useState({name:'',phone:'',email:'',password:'',confirmPassword:'',otp:'',type:defaultType});const[errors,setErrors]=useState({});const[isSubmitting,setIsSubmitting]=useState(false);const[authError,setAuthError]=useState('');const[resetSent,setResetSent]=useState(false);const[otpSent,setOtpSent]=useState(false);const[phoneFormatted,setPhoneFormatted]=useState('');const validateForm=()=>{const newErrors={};if(mode==='phone'){if(!form.phone||form.phone.trim().length<9){newErrors.phone='Please enter a valid phone number';}}else if(mode==='phone-verify'){if(!form.otp||form.otp.length!==6){newErrors.otp='Please enter the 6-digit code';}}else{if(mode==='signup'){if(!form.name||form.name.trim().length<2){newErrors.name='Name must be at least 2 characters';}}if(!form.email||!/^[^\\s@]+@[^\\s@]+\\.[^\\s@]+$/.test(form.email)){newErrors.email='Please enter a valid email address';}if(mode!=='reset'){if(!form.password||form.password.length<6){newErrors.password='Password must be at least 6 characters';}}if(mode==='signup'&&form.password!==form.confirmPassword){newErrors.confirmPassword='Passwords do not match';}}setErrors(newErrors);return Object.keys(newErrors).length===0;};const handleSubmit=async()=>{if(!validateForm())return;setIsSubmitting(true);setAuthError('');try{if(mode==='signup'){await authFunctions.signUp(form.email,form.password,form.name,form.type,form.phone);onSuccess===null||onSuccess===void 0?void 0:onSuccess();onClose();}else if(mode==='signin'){await authFunctions.signIn(form.email,form.password);onSuccess===null||onSuccess===void 0?void 0:onSuccess();onClose();}else if(mode==='reset'){await authFunctions.sendPasswordReset(form.email);setResetSent(true);}else if(mode==='phone'){// Send OTP\nconst result=await authFunctions.sendPhoneOTP(form.phone);setPhoneFormatted(result.formattedNumber);setOtpSent(true);setMode('phone-verify');}else if(mode==='phone-verify'){// Verify OTP\nawait authFunctions.verifyPhoneOTP(form.otp,form.type,form.name);onSuccess===null||onSuccess===void 0?void 0:onSuccess();onClose();}}catch(err){console.error('Auth error:',err);let errorMessage='An error occurred. Please try again.';if(err.code==='auth/invalid-phone-number'){errorMessage='Invalid phone number format. Please use format: 0XX XXX XXXX';}else if(err.code==='auth/too-many-requests'){errorMessage='Too many attempts. Please try again later.';}else if(err.code==='auth/invalid-verification-code'){errorMessage='Invalid code. Please check and try again.';}else if(err.code==='auth/code-expired'){errorMessage='Code expired. Please request a new one.';}else if(err.message){errorMessage=err.message;}setAuthError(errorMessage);}finally{setIsSubmitting(false);}};const handleGoogleSignIn=async()=>{setIsSubmitting(true);setAuthError('');try{await authFunctions.signInGoogle(form.type);onSuccess===null||onSuccess===void 0?void 0:onSuccess();onClose();}catch(err){setAuthError(err.message||'Google sign-in failed. Please try again.');}finally{setIsSubmitting(false);}};const startPhoneAuth=()=>{setMode('phone');setAuthError('');setOtpSent(false);};return/*#__PURE__*/_jsx(\"div\",{className:\"fixed inset-0 bg-gray-900/60 backdrop-blur-sm flex items-start sm:items-center justify-center p-4 pt-16 sm:pt-4 z-50 overflow-y-auto\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white rounded-2xl w-full max-w-md p-8 my-auto shadow-2xl fade-in border border-gray-100\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-start justify-between mb-6\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center gap-2 mb-2\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"w-10 h-10 bg-gradient-to-br from-teal-500 to-cyan-500 rounded-xl flex items-center justify-center shadow-lg\",children:/*#__PURE__*/_jsx(Home,{className:\"w-5 h-5 text-white\"})}),/*#__PURE__*/_jsxs(\"span\",{className:\"text-xl font-extrabold\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"bg-gradient-to-r from-teal-600 to-cyan-600 bg-clip-text text-transparent\",children:\"Room\"}),/*#__PURE__*/_jsx(\"span\",{className:\"text-rose-500\",children:\"24\"})]})]}),/*#__PURE__*/_jsxs(\"h3\",{className:\"text-xl font-bold text-gray-900 mt-4\",children:[mode==='signin'&&'Welcome back!',mode==='signup'&&'Create your account',mode==='reset'&&'Reset password',mode==='phone'&&'Sign in with phone',mode==='phone-verify'&&'Enter verification code']}),/*#__PURE__*/_jsxs(\"p\",{className:\"text-sm text-gray-500 mt-1\",children:[mode==='signin'&&'Sign in to continue',mode==='signup'&&'Join Room24 today',mode==='reset'&&\"We'll send you a reset link\",mode==='phone'&&\"We'll send you a verification code\",mode==='phone-verify'&&\"Code sent to \".concat(phoneFormatted)]})]}),/*#__PURE__*/_jsx(\"button\",{onClick:onClose,className:\"p-2 text-gray-400 hover:text-gray-600 hover:bg-gray-100 rounded-xl transition-colors\",children:/*#__PURE__*/_jsx(X,{className:\"w-5 h-5\"})})]}),authError&&/*#__PURE__*/_jsxs(\"div\",{className:\"mb-4 p-3 bg-rose-50 border border-rose-200 rounded-xl text-rose-700 text-sm flex items-center gap-2\",children:[/*#__PURE__*/_jsx(AlertTriangle,{className:\"w-4 h-4 flex-shrink-0\"}),authError]}),resetSent&&/*#__PURE__*/_jsxs(\"div\",{className:\"mb-4 p-3 bg-green-50 border border-green-200 rounded-xl text-green-700 text-sm flex items-center gap-2\",children:[/*#__PURE__*/_jsx(CheckCircle,{className:\"w-4 h-4 flex-shrink-0\"}),\"Password reset email sent! Check your inbox.\"]}),/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-4\",children:[mode==='phone-verify'&&/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-semibold text-gray-700 mb-2\",children:\"Verification Code *\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",inputMode:\"numeric\",maxLength:6,value:form.otp,onChange:e=>{const val=e.target.value.replace(/\\D/g,'').slice(0,6);setForm(_objectSpread(_objectSpread({},form),{},{otp:val}));setErrors(_objectSpread(_objectSpread({},errors),{},{otp:''}));setAuthError('');},className:\"w-full px-4 py-4 border-2 rounded-xl transition-all focus:ring-2 focus:ring-teal-100 focus:border-teal-500 text-center text-2xl font-bold tracking-[0.5em] \".concat(errors.otp?'border-rose-400 bg-rose-50':'border-gray-200 hover:border-gray-300'),placeholder:\"000000\",autoFocus:true}),errors.otp&&/*#__PURE__*/_jsxs(\"p\",{className:\"text-rose-500 text-xs mt-1.5 flex items-center gap-1\",children:[/*#__PURE__*/_jsx(\"span\",{children:\"\\u26A0\"}),errors.otp]})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-semibold text-gray-700 mb-2\",children:\"Your Name *\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",value:form.name,onChange:e=>{setForm(_objectSpread(_objectSpread({},form),{},{name:e.target.value}));setErrors(_objectSpread(_objectSpread({},errors),{},{name:''}));},className:\"w-full px-4 py-3 border-2 border-gray-200 hover:border-gray-300 rounded-xl transition-all focus:ring-2 focus:ring-teal-100 focus:border-teal-500\",placeholder:\"John Doe\"})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-semibold text-gray-700 mb-2\",children:\"I am a\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"grid grid-cols-2 gap-3\",children:[/*#__PURE__*/_jsxs(\"button\",{type:\"button\",onClick:()=>setForm(_objectSpread(_objectSpread({},form),{},{type:'renter'})),className:\"p-3 rounded-xl border-2 transition-all flex flex-col items-center gap-1 \".concat(form.type==='renter'?'border-teal-500 bg-gradient-to-br from-teal-50 to-cyan-50 text-teal-700 shadow-md':'border-gray-200 hover:border-gray-300 text-gray-600 hover:bg-gray-50'),children:[/*#__PURE__*/_jsx(Search,{className:\"w-5 h-5 \".concat(form.type==='renter'?'text-teal-500':'')}),/*#__PURE__*/_jsx(\"span\",{className:\"text-xs font-semibold\",children:\"Looking for a room\"})]}),/*#__PURE__*/_jsxs(\"button\",{type:\"button\",onClick:()=>setForm(_objectSpread(_objectSpread({},form),{},{type:'landlord'})),className:\"p-3 rounded-xl border-2 transition-all flex flex-col items-center gap-1 \".concat(form.type==='landlord'?'border-rose-500 bg-gradient-to-br from-rose-50 to-pink-50 text-rose-700 shadow-md':'border-gray-200 hover:border-gray-300 text-gray-600 hover:bg-gray-50'),children:[/*#__PURE__*/_jsx(Home,{className:\"w-5 h-5 \".concat(form.type==='landlord'?'text-rose-500':'')}),/*#__PURE__*/_jsx(\"span\",{className:\"text-xs font-semibold\",children:\"Listing rooms\"})]})]})]}),/*#__PURE__*/_jsx(\"button\",{type:\"button\",onClick:()=>{setMode('phone');setOtpSent(false);setForm(_objectSpread(_objectSpread({},form),{},{otp:''}));},className:\"text-sm text-teal-600 hover:text-teal-700 font-medium\",children:\"\\u2190 Change phone number\"})]}),mode==='phone'&&/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-semibold text-gray-700 mb-2\",children:\"Phone Number *\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex gap-2\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"flex items-center px-3 bg-gray-100 border-2 border-gray-200 rounded-xl text-gray-600 font-medium\",children:\"\\uD83C\\uDDFF\\uD83C\\uDDE6 +27\"}),/*#__PURE__*/_jsx(\"input\",{type:\"tel\",value:form.phone,onChange:e=>{setForm(_objectSpread(_objectSpread({},form),{},{phone:e.target.value}));setErrors(_objectSpread(_objectSpread({},errors),{},{phone:''}));setAuthError('');},className:\"flex-1 px-4 py-3 border-2 rounded-xl transition-all focus:ring-2 focus:ring-teal-100 focus:border-teal-500 \".concat(errors.phone?'border-rose-400 bg-rose-50':'border-gray-200 hover:border-gray-300'),placeholder:\"72 123 4567\",autoFocus:true})]}),errors.phone&&/*#__PURE__*/_jsxs(\"p\",{className:\"text-rose-500 text-xs mt-1.5 flex items-center gap-1\",children:[/*#__PURE__*/_jsx(\"span\",{children:\"\\u26A0\"}),errors.phone]}),/*#__PURE__*/_jsx(\"p\",{className:\"text-xs text-gray-500 mt-2\",children:\"We'll send you an SMS with a verification code\"})]}),/*#__PURE__*/_jsx(\"button\",{type:\"button\",onClick:()=>{setMode('signin');setAuthError('');},className:\"text-sm text-teal-600 hover:text-teal-700 font-medium\",children:\"\\u2190 Use email instead\"})]}),(mode==='signin'||mode==='signup')&&/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsxs(\"div\",{className:\"grid grid-cols-2 gap-3\",children:[/*#__PURE__*/_jsxs(\"button\",{type:\"button\",onClick:handleGoogleSignIn,disabled:isSubmitting,className:\"flex items-center justify-center gap-2 px-4 py-3 border-2 border-gray-200 hover:border-gray-300 rounded-xl transition-all hover:bg-gray-50 font-medium text-gray-700\",children:[/*#__PURE__*/_jsxs(\"svg\",{className:\"w-5 h-5\",viewBox:\"0 0 24 24\",children:[/*#__PURE__*/_jsx(\"path\",{fill:\"#4285F4\",d:\"M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z\"}),/*#__PURE__*/_jsx(\"path\",{fill:\"#34A853\",d:\"M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z\"}),/*#__PURE__*/_jsx(\"path\",{fill:\"#FBBC05\",d:\"M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z\"}),/*#__PURE__*/_jsx(\"path\",{fill:\"#EA4335\",d:\"M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z\"})]}),\"Google\"]}),/*#__PURE__*/_jsxs(\"button\",{type:\"button\",onClick:startPhoneAuth,disabled:isSubmitting,className:\"flex items-center justify-center gap-2 px-4 py-3 border-2 border-gray-200 hover:border-gray-300 rounded-xl transition-all hover:bg-gray-50 font-medium text-gray-700\",children:[/*#__PURE__*/_jsx(Phone,{className:\"w-5 h-5 text-green-600\"}),\"Phone\"]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"relative\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"absolute inset-0 flex items-center\",children:/*#__PURE__*/_jsx(\"div\",{className:\"w-full border-t border-gray-200\"})}),/*#__PURE__*/_jsx(\"div\",{className:\"relative flex justify-center text-sm\",children:/*#__PURE__*/_jsx(\"span\",{className:\"px-4 bg-white text-gray-500\",children:\"or use email\"})})]})]}),mode==='reset'&&/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-semibold text-gray-700 mb-2\",children:\"Email *\"}),/*#__PURE__*/_jsx(\"input\",{type:\"email\",value:form.email,onChange:e=>{setForm(_objectSpread(_objectSpread({},form),{},{email:e.target.value}));setErrors(_objectSpread(_objectSpread({},errors),{},{email:''}));setAuthError('');},className:\"w-full px-4 py-3 border-2 rounded-xl transition-all focus:ring-2 focus:ring-teal-100 focus:border-teal-500 \".concat(errors.email?'border-rose-400 bg-rose-50':'border-gray-200 hover:border-gray-300'),placeholder:\"john@example.com\"}),errors.email&&/*#__PURE__*/_jsxs(\"p\",{className:\"text-rose-500 text-xs mt-1.5 flex items-center gap-1\",children:[/*#__PURE__*/_jsx(\"span\",{children:\"\\u26A0\"}),errors.email]})]}),(mode==='signin'||mode==='signup')&&/*#__PURE__*/_jsxs(_Fragment,{children:[mode==='signup'&&/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-semibold text-gray-700 mb-2\",children:\"Full name *\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",value:form.name,onChange:e=>{setForm(_objectSpread(_objectSpread({},form),{},{name:e.target.value}));setErrors(_objectSpread(_objectSpread({},errors),{},{name:''}));},className:\"w-full px-4 py-3 border-2 rounded-xl transition-all focus:ring-2 focus:ring-teal-100 focus:border-teal-500 \".concat(errors.name?'border-rose-400 bg-rose-50':'border-gray-200 hover:border-gray-300'),placeholder:\"John Doe\"}),errors.name&&/*#__PURE__*/_jsxs(\"p\",{className:\"text-rose-500 text-xs mt-1.5 flex items-center gap-1\",children:[/*#__PURE__*/_jsx(\"span\",{children:\"\\u26A0\"}),errors.name]})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-semibold text-gray-700 mb-2\",children:\"Email *\"}),/*#__PURE__*/_jsx(\"input\",{type:\"email\",value:form.email,onChange:e=>{setForm(_objectSpread(_objectSpread({},form),{},{email:e.target.value}));setErrors(_objectSpread(_objectSpread({},errors),{},{email:''}));setAuthError('');},className:\"w-full px-4 py-3 border-2 rounded-xl transition-all focus:ring-2 focus:ring-teal-100 focus:border-teal-500 \".concat(errors.email?'border-rose-400 bg-rose-50':'border-gray-200 hover:border-gray-300'),placeholder:\"john@example.com\"}),errors.email&&/*#__PURE__*/_jsxs(\"p\",{className:\"text-rose-500 text-xs mt-1.5 flex items-center gap-1\",children:[/*#__PURE__*/_jsx(\"span\",{children:\"\\u26A0\"}),errors.email]})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-semibold text-gray-700 mb-2\",children:\"Password *\"}),/*#__PURE__*/_jsx(\"input\",{type:\"password\",value:form.password,onChange:e=>{setForm(_objectSpread(_objectSpread({},form),{},{password:e.target.value}));setErrors(_objectSpread(_objectSpread({},errors),{},{password:''}));setAuthError('');},className:\"w-full px-4 py-3 border-2 rounded-xl transition-all focus:ring-2 focus:ring-teal-100 focus:border-teal-500 \".concat(errors.password?'border-rose-400 bg-rose-50':'border-gray-200 hover:border-gray-300'),placeholder:\"\\u2022\\u2022\\u2022\\u2022\\u2022\\u2022\\u2022\\u2022\"}),errors.password&&/*#__PURE__*/_jsxs(\"p\",{className:\"text-rose-500 text-xs mt-1.5 flex items-center gap-1\",children:[/*#__PURE__*/_jsx(\"span\",{children:\"\\u26A0\"}),errors.password]})]}),mode==='signup'&&/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-semibold text-gray-700 mb-2\",children:\"Confirm Password *\"}),/*#__PURE__*/_jsx(\"input\",{type:\"password\",value:form.confirmPassword,onChange:e=>{setForm(_objectSpread(_objectSpread({},form),{},{confirmPassword:e.target.value}));setErrors(_objectSpread(_objectSpread({},errors),{},{confirmPassword:''}));},className:\"w-full px-4 py-3 border-2 rounded-xl transition-all focus:ring-2 focus:ring-teal-100 focus:border-teal-500 \".concat(errors.confirmPassword?'border-rose-400 bg-rose-50':'border-gray-200 hover:border-gray-300'),placeholder:\"\\u2022\\u2022\\u2022\\u2022\\u2022\\u2022\\u2022\\u2022\"}),errors.confirmPassword&&/*#__PURE__*/_jsxs(\"p\",{className:\"text-rose-500 text-xs mt-1.5 flex items-center gap-1\",children:[/*#__PURE__*/_jsx(\"span\",{children:\"\\u26A0\"}),errors.confirmPassword]})]}),mode==='signup'&&/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsxs(\"label\",{className:\"block text-sm font-semibold text-gray-700 mb-2\",children:[\"Phone \",/*#__PURE__*/_jsx(\"span\",{className:\"text-gray-400 font-normal\",children:\"(optional)\"})]}),/*#__PURE__*/_jsx(\"input\",{type:\"tel\",value:form.phone,onChange:e=>setForm(_objectSpread(_objectSpread({},form),{},{phone:e.target.value})),className:\"w-full px-4 py-3 border-2 border-gray-200 hover:border-gray-300 rounded-xl transition-all focus:ring-2 focus:ring-teal-100 focus:border-teal-500\",placeholder:\"+27 12 345 6789\"})]}),mode==='signup'&&/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-semibold text-gray-700 mb-2\",children:\"I am a\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"grid grid-cols-2 gap-3\",children:[/*#__PURE__*/_jsxs(\"button\",{type:\"button\",onClick:()=>setForm(_objectSpread(_objectSpread({},form),{},{type:'renter'})),className:\"p-3 rounded-xl border-2 transition-all flex flex-col items-center gap-1 \".concat(form.type==='renter'?'border-teal-500 bg-gradient-to-br from-teal-50 to-cyan-50 text-teal-700 shadow-md':'border-gray-200 hover:border-gray-300 text-gray-600 hover:bg-gray-50'),children:[/*#__PURE__*/_jsx(Search,{className:\"w-5 h-5 \".concat(form.type==='renter'?'text-teal-500':'')}),/*#__PURE__*/_jsx(\"span\",{className:\"text-xs font-semibold\",children:\"Looking for a room\"})]}),/*#__PURE__*/_jsxs(\"button\",{type:\"button\",onClick:()=>setForm(_objectSpread(_objectSpread({},form),{},{type:'landlord'})),className:\"p-3 rounded-xl border-2 transition-all flex flex-col items-center gap-1 \".concat(form.type==='landlord'?'border-rose-500 bg-gradient-to-br from-rose-50 to-pink-50 text-rose-700 shadow-md':'border-gray-200 hover:border-gray-300 text-gray-600 hover:bg-gray-50'),children:[/*#__PURE__*/_jsx(Home,{className:\"w-5 h-5 \".concat(form.type==='landlord'?'text-rose-500':'')}),/*#__PURE__*/_jsx(\"span\",{className:\"text-xs font-semibold\",children:\"Listing rooms\"})]})]})]}),mode==='signin'&&/*#__PURE__*/_jsx(\"button\",{type:\"button\",onClick:()=>{setMode('reset');setAuthError('');setResetSent(false);},className:\"text-sm text-teal-600 hover:text-teal-700 font-medium\",children:\"Forgot your password?\"})]}),/*#__PURE__*/_jsx(\"button\",{id:\"phone-sign-in-button\",onClick:handleSubmit,disabled:isSubmitting,className:\"w-full font-bold py-3 rounded-xl transition-all relative \".concat(isSubmitting?'bg-teal-400 cursor-not-allowed':'bg-gradient-to-r from-teal-500 to-cyan-500 hover:from-teal-600 hover:to-cyan-600 text-white shadow-lg hover:shadow-xl hover:shadow-teal-500/25'),children:isSubmitting?/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"span\",{className:\"opacity-0\",children:\"Submit\"}),/*#__PURE__*/_jsx(\"div\",{className:\"absolute inset-0 flex items-center justify-center\",children:/*#__PURE__*/_jsx(\"div\",{className:\"w-5 h-5 border-2 border-white border-t-transparent rounded-full animate-spin\"})})]}):/*#__PURE__*/_jsxs(_Fragment,{children:[mode==='signin'&&'Sign In',mode==='signup'&&'Create Account',mode==='reset'&&'Send Reset Link',mode==='phone'&&'Send Verification Code',mode==='phone-verify'&&'Verify & Sign In']})}),/*#__PURE__*/_jsx(\"div\",{id:\"recaptcha-container\",className:\"flex justify-center\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"text-center text-sm text-gray-600\",children:[mode==='signin'&&/*#__PURE__*/_jsxs(_Fragment,{children:[\"Don't have an account?\",' ',/*#__PURE__*/_jsx(\"button\",{onClick:()=>{setMode('signup');setAuthError('');},className:\"text-teal-600 hover:text-teal-700 font-semibold\",children:\"Sign up\"})]}),mode==='signup'&&/*#__PURE__*/_jsxs(_Fragment,{children:[\"Already have an account?\",' ',/*#__PURE__*/_jsx(\"button\",{onClick:()=>{setMode('signin');setAuthError('');},className:\"text-teal-600 hover:text-teal-700 font-semibold\",children:\"Sign in\"})]}),mode==='reset'&&/*#__PURE__*/_jsx(\"button\",{onClick:()=>{setMode('signin');setAuthError('');setResetSent(false);},className:\"text-teal-600 hover:text-teal-700 font-semibold\",children:\"\\u2190 Back to sign in\"}),(mode==='phone'||mode==='phone-verify')&&/*#__PURE__*/_jsx(\"button\",{onClick:()=>{setMode('signin');setAuthError('');setOtpSent(false);},className:\"text-teal-600 hover:text-teal-700 font-semibold\",children:\"\\u2190 Back to sign in\"})]})]}),/*#__PURE__*/_jsxs(\"p\",{className:\"text-xs text-gray-400 text-center mt-6\",children:[\"By continuing, you agree to our \",/*#__PURE__*/_jsx(\"button\",{className:\"text-teal-600 hover:underline\",children:\"Terms of Service\"}),\" and \",/*#__PURE__*/_jsx(\"button\",{className:\"text-teal-600 hover:underline\",children:\"Privacy Policy\"})]})]})});}function BottomNav(_ref1){let{currentView,setCurrentView,userType}=_ref1;const navItems=[{id:'browse',label:'Browse',icon:/*#__PURE__*/_jsx(Search,{className:\"w-5 h-5\"}),activeColor:'teal'},{id:'add',label:'List',icon:/*#__PURE__*/_jsx(PlusCircle,{className:\"w-5 h-5\"}),requiresLandlord:true,activeColor:'rose'},{id:'favorites',label:'Saved',icon:/*#__PURE__*/_jsx(Heart,{className:\"w-5 h-5\"}),activeColor:'rose'},{id:'profile',label:'Profile',icon:/*#__PURE__*/_jsx(User,{className:\"w-5 h-5\"}),activeColor:'blue'}];return/*#__PURE__*/_jsx(\"div\",{className:\"fixed bottom-0 left-0 right-0 bg-white/95 backdrop-blur-md border-t border-gray-100 px-4 py-2 z-20 md:hidden safe-area-bottom\",children:/*#__PURE__*/_jsx(\"div\",{className:\"grid grid-cols-4 gap-1 max-w-md mx-auto\",children:navItems.map(item=>{const disabled=item.requiresLandlord&&userType!=='landlord';const isActive=currentView===item.id;const colorClasses={teal:'text-teal-600 bg-teal-50',rose:'text-rose-600 bg-rose-50',blue:'text-blue-600 bg-blue-50'};return/*#__PURE__*/_jsxs(\"button\",{type:\"button\",disabled:disabled,onClick:()=>!disabled&&setCurrentView(item.id),className:\"flex flex-col items-center gap-0.5 py-2 px-1 rounded-xl transition-all duration-200 \".concat(disabled?'opacity-40 cursor-not-allowed':'active:scale-95',\" \").concat(isActive?\"\".concat(colorClasses[item.activeColor],\" font-semibold\"):'text-gray-400 hover:text-gray-600 hover:bg-gray-50'),children:[/*#__PURE__*/_jsx(\"span\",{className:\"transition-transform duration-200 \".concat(isActive?'scale-110':''),children:item.icon}),/*#__PURE__*/_jsx(\"span\",{className:\"text-[10px] font-medium\",children:item.label})]},item.id);})})});}","map":{"version":3,"names":["React","useState","useEffect","useMemo","useCallback","initFirebase","initAnalytics","requestFcmToken","listenForegroundMessages","trackEvent","fetchListings","addListing","deleteListing","subscribeToListings","isFirestoreEnabled","subscribeToAuthState","getUserProfile","saveUserProfile","initRecaptcha","sendPhoneOTP","verifyPhoneOTP","clearRecaptcha","getLinkedProviders","linkGoogleAccount","Home","PlusCircle","Search","MapPin","X","User","Phone","Mail","Edit","CheckCircle","Heart","Calendar","Bell","AlertTriangle","LogOut","Link2","Header","ListingDetailModal","Footer","BrowseView","PrivacyPolicyModal","NotificationBanner","AnalyticsConsentModal","NotificationsPanel","PhotoEditor","OfflineIndicator","BackToTop","getNotifications","loadListingTemplate","saveListingTemplate","clearListingTemplate","signUpWithEmail","signInWithEmail","signInWithGoogle","signOut","firebaseSignOut","resetPassword","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","RentalPlatform","currentView","setCurrentView","userType","setUserType","previewAsRenter","setPreviewAsRenter","listings","setListings","selectedListing","setSelectedListing","users","setUsers","searchLocation","setSearchLocation","priceRange","setPriceRange","selectedAmenities","setSelectedAmenities","sortBy","setSortBy","currentUser","setCurrentUser","userProfile","setUserProfile","authLoading","setAuthLoading","showAuthModal","setShowAuthModal","authDefaultType","setAuthDefaultType","toast","setToast","showPrivacyPolicy","setShowPrivacyPolicy","notificationBanner","setNotificationBanner","showAnalyticsConsent","setShowAnalyticsConsent","showNotificationsPanel","setShowNotificationsPanel","unreadCount","setUnreadCount","openAuthModal","type","arguments","length","undefined","authFunctions","signUp","email","password","displayName","userTypeParam","phone","firebaseUser","profileData","photoURL","createdAt","Date","toISOString","landlordComplete","uid","signIn","signInGoogle","profile","phoneNumber","sendPasswordReset","otpCode","clearPhoneAuth","updateUnreadCount","notifications","filter","n","read","interval","setInterval","clearInterval","loadData","app","unsubscribeAuth","err","console","error","unsubscribeListings","firestoreListings","localStorage","setItem","JSON","stringify","analyticsConsent","getItem","process","env","REACT_APP_ENABLE_ANALYTICS","setTimeout","token","log","e","warn","payload","notification","title","body","listingsResult","parse","userResult","usersResult","user","parsed","Array","isArray","sampleListings","id","price","location","description","photos","status","availableDate","amenities","landlordId","landlordName","landlordPhone","landlordEmail","landlordPhoto","isDuplicateContact","ignoreId","normalizedPhone","trim","normalizedEmail","toLowerCase","some","u","uPhone","uEmail","phoneMatch","emailMatch","showToast","message","handleAnalyticsConsentAccept","handleAnalyticsConsentDecline","saveListings","newListings","navigator","serviceWorker","controller","postMessage","_unused","saveSubscriptions","subscriptions","getSubscriptions","res","subscribeToArea","userId","area","alert","subs","includes","push","concat","handleProfileSetup","now","_objectSpread","whatsapp","notificationPrefs","updates","marketing","existingUsersRaw","existingUsers","_unused2","_unused3","_unused4","handleUpdateProfile","updatedUser","_unused5","idx","findIndex","_unused6","_unused7","handleSignOut","handleCompleteOnboarding","onboardData","landlordInfo","prev","handleAddListing","listingData","_listingData$latitude","_listingData$longitud","fullAddress","streetAddress","Boolean","join","newListingData","latitude","longitude","paymentMethod","premium","firestoreId","newListing","updatedListings","window","scrollTo","top","behavior","filteredListings","listing","matchesLocation","parseFloat","matchesPrice","matchesAmenities","every","amenity","_listing$amenities","sort","a","b","className","children","onOpenNotifications","onClose","onClick","role","ProfileSetupView","onSubmit","ProfileView","name","photo","onEdit","onSignOut","linkedProviders","onLinkGoogle","reload","onLinkPhone","onUpdatePrefs","prefs","EditProfileView","onCancel","LandlordOnboardingView","onComplete","onSelectListing","onRequireAuth","previewMode","AddListingView","onRequireOnboarding","MyListingsView","l","onDelete","deleted","updated","FavoritesView","landlord","AuthModal","defaultType","onSuccess","BottomNav","onAccept","onDecline","listingId","find","onOpenPrivacy","_ref","formData","setFormData","errors","setErrors","touched","setTouched","validateField","value","extras","newErrors","test","handlePhotoUpload","file","target","files","size","reader","FileReader","onloadend","result","readAsDataURL","handleSubmit","allTouched","Object","keys","src","alt","accept","onChange","required","onBlur","placeholder","_ref2","_user$name","_user$name$charAt","localPrefs","setLocalPrefs","linkingInProgress","setLinkingInProgress","linkError","setLinkError","linkSuccess","setLinkSuccess","togglePref","key","next","handleLinkGoogle","handleLinkPhone","hasGoogle","hasPhone","hasPassword","charAt","toUpperCase","toLocaleDateString","year","month","day","checked","viewBox","fill","d","disabled","_ref3","_currentUser$name","_currentUser$name$cha","form","setForm","businessName","bankDetails","idNumber","agree","preventDefault","_ref4","_ref5","favorites","setFavorites","rawFavorites","arr","_unused8","toggleFavorite","_unused9","favoriteListings","map","ListingCard","require","default","isFavorite","onToggleFavorite","createDefaultListingForm","split","roomType","leaseDuration","petFriendly","genderPreference","_ref6","GEOCODER_KEY","REACT_APP_GEOCODER_API_KEY","GEOCODER_PROVIDER","REACT_APP_GEOCODER_PROVIDER","base","saved","_saved$petFriendly","_saved$premium","geocodingStatus","setGecodingStatus","showPhotoEditor","setShowPhotoEditor","reverseGeocodeCacheRef","useRef","lastGeocodeSource","setLastGeocodeSource","fullAddressInput","setFullAddressInput","isFullAddressEditing","setIsFullAddressEditing","_saved$petFriendly2","_saved$premium2","_formData$photos","hasFormData","handleBeforeUnload","returnValue","addEventListener","removeEventListener","corsFallbackTransforms","url","startsWith","encodeURIComponent","fetchWithCorsFallback","options","cloneOptions","headers","attempt","targetUrl","resp","fetch","ok","Error","_options$signal","signal","aborted","lastError","transform","proxiedUrl","proxyErr","_options$signal2","forwardGeocodeAddress","query","_data$features","data","json","features","f","_f$geometry","_f$geometry$coordinat","_f$geometry2","_f$geometry2$coordina","lat","center","geometry","coordinates","lon","label","place_name","text","source","entry","mapsResp","mapsData","slice","display_name","mapsErr","API_BASE","REACT_APP_PROXY_BASE","port","proxyResp","proxyData","directResp","directData","directErr","availableAmenities","_ref7","_extras$streetAddress","_ref8","_extras$location","streetText","areaText","raw","current","geocodeAddress","results","best","areaResults","bestArea","toggleAmenity","isSubmitting","setIsSubmitting","googleMapsQuery","googleMapsUrl","combinedFormAddress","part","handleFullAddressChange","parts","street","derivedLocation","words","locationWordCount","Math","min","ceil","handleResetSavedTemplate","blank","completed","total","style","width","max","rows","onFocus","toFixed","href","rel","htmlFor","index","onPhotosChange","newPhotos","maxPhotos","_ref9","hash","_listing$price","toLocaleString","_ref0","mode","setMode","confirmPassword","otp","authError","setAuthError","resetSent","setResetSent","otpSent","setOtpSent","phoneFormatted","setPhoneFormatted","validateForm","formattedNumber","errorMessage","code","handleGoogleSignIn","startPhoneAuth","inputMode","maxLength","val","replace","autoFocus","_ref1","navItems","icon","activeColor","requiresLandlord","item","isActive","colorClasses","teal","rose","blue"],"sources":["C:/Users/kutum/Documents/room-rental-platform/src/App.js"],"sourcesContent":["import React, { useState, useEffect, useMemo, useCallback } from 'react';\nimport { initFirebase, initAnalytics, requestFcmToken, listenForegroundMessages, trackEvent, fetchListings, addListing, deleteListing, subscribeToListings, isFirestoreEnabled, subscribeToAuthState, getUserProfile, saveUserProfile, initRecaptcha, sendPhoneOTP, verifyPhoneOTP, clearRecaptcha, getLinkedProviders, linkGoogleAccount } from './firebase';\nimport { Home, PlusCircle, Search, MapPin, X, User, Phone, Mail, Edit, CheckCircle, Heart, Calendar, Bell, AlertTriangle, LogOut, Link2 } from 'lucide-react';\nimport Header from './components/Header';\nimport ListingDetailModal from './components/ListingDetailModal';\nimport Footer from './components/Footer';\nimport BrowseView from './components/BrowseView';\nimport PrivacyPolicyModal from './components/PrivacyPolicyModal';\nimport NotificationBanner from './components/NotificationBanner';\nimport AnalyticsConsentModal from './components/AnalyticsConsentModal';\nimport NotificationsPanel from './components/NotificationsPanel';\nimport PhotoEditor from './components/PhotoEditor';\nimport OfflineIndicator from './components/OfflineIndicator';\nimport BackToTop from './components/BackToTop';\nimport { getNotifications } from './utils/notificationEngine';\nimport { loadListingTemplate, saveListingTemplate, clearListingTemplate } from './utils/listingTemplateStorage';\nimport { \n  signUpWithEmail, \n  signInWithEmail, \n  signInWithGoogle, \n  signOut as firebaseSignOut, \n  resetPassword \n} from './firebase';\n\nexport default function RentalPlatform() {\n  const [currentView, setCurrentView] = useState('browse');\n  const [userType, setUserType] = useState(null);\n  const [previewAsRenter, setPreviewAsRenter] = useState(false); // landlord UI preview toggle\n  const [listings, setListings] = useState([]);\n  const [selectedListing, setSelectedListing] = useState(null);\n  const [users, setUsers] = useState([]); // registry of all users (localStorage 'users')\n  const [searchLocation, setSearchLocation] = useState('');\n  const [priceRange, setPriceRange] = useState([0, 10000]);\n  const [selectedAmenities, setSelectedAmenities] = useState([]);\n  const [sortBy, setSortBy] = useState('newest');\n  const [currentUser, setCurrentUser] = useState(null);\n  const [userProfile, setUserProfile] = useState(null); // Extended profile from Firestore\n  const [authLoading, setAuthLoading] = useState(true); // Loading state for auth\n  const [showAuthModal, setShowAuthModal] = useState(false);\n  const [authDefaultType, setAuthDefaultType] = useState('renter');\n  // Mobile menu state moved into Header component\n  const [toast, setToast] = useState(null);\n  const [showPrivacyPolicy, setShowPrivacyPolicy] = useState(false);\n  const [notificationBanner, setNotificationBanner] = useState(null);\n  const [showAnalyticsConsent, setShowAnalyticsConsent] = useState(false);\n  const [showNotificationsPanel, setShowNotificationsPanel] = useState(false);\n  const [unreadCount, setUnreadCount] = useState(0);\n\n  const openAuthModal = (type = 'renter') => {\n    setAuthDefaultType(type);\n    setShowAuthModal(true);\n  };\n\n  // Auth functions to pass to AuthModal\n  const authFunctions = {\n    signUp: async (email, password, displayName, userTypeParam = 'renter', phone = '') => {\n      const firebaseUser = await signUpWithEmail(email, password, displayName);\n      \n      // Create user profile in Firestore\n      const profileData = {\n        email: firebaseUser.email,\n        displayName: displayName || firebaseUser.displayName,\n        userType: userTypeParam,\n        phone,\n        photoURL: firebaseUser.photoURL || '',\n        createdAt: new Date().toISOString(),\n        landlordComplete: userTypeParam === 'renter',\n      };\n      \n      await saveUserProfile(firebaseUser.uid, profileData);\n      return firebaseUser;\n    },\n    signIn: async (email, password) => {\n      return await signInWithEmail(email, password);\n    },\n    signInGoogle: async (userTypeParam = 'renter') => {\n      const firebaseUser = await signInWithGoogle();\n      \n      // Check if user profile exists\n      let profile = await getUserProfile(firebaseUser.uid);\n      \n      if (!profile) {\n        // Create new profile for Google user\n        const profileData = {\n          email: firebaseUser.email,\n          displayName: firebaseUser.displayName || '',\n          userType: userTypeParam,\n          phone: firebaseUser.phoneNumber || '',\n          photoURL: firebaseUser.photoURL || '',\n          createdAt: new Date().toISOString(),\n          landlordComplete: userTypeParam === 'renter',\n        };\n        \n        await saveUserProfile(firebaseUser.uid, profileData);\n      }\n      \n      return firebaseUser;\n    },\n    sendPasswordReset: async (email) => {\n      await resetPassword(email);\n    },\n    sendPhoneOTP: async (phoneNumber) => {\n      // Initialize reCAPTCHA if not already done\n      initRecaptcha('phone-sign-in-button');\n      return await sendPhoneOTP(phoneNumber);\n    },\n    verifyPhoneOTP: async (otpCode, userTypeParam = 'renter', displayName = '') => {\n      const firebaseUser = await verifyPhoneOTP(otpCode);\n      \n      // Check if user profile exists\n      let profile = await getUserProfile(firebaseUser.uid);\n      \n      if (!profile) {\n        // Create new profile for phone user\n        const profileData = {\n          email: '',\n          displayName: displayName || firebaseUser.phoneNumber,\n          userType: userTypeParam,\n          phone: firebaseUser.phoneNumber || '',\n          photoURL: '',\n          createdAt: new Date().toISOString(),\n          landlordComplete: userTypeParam === 'renter',\n        };\n        \n        await saveUserProfile(firebaseUser.uid, profileData);\n      }\n      \n      return firebaseUser;\n    },\n    clearPhoneAuth: () => {\n      clearRecaptcha();\n    }\n  };\n\n  // Update unread notification count\n  useEffect(() => {\n    const updateUnreadCount = () => {\n      const notifications = getNotifications();\n      setUnreadCount(notifications.filter(n => !n.read).length);\n    };\n    updateUnreadCount();\n    const interval = setInterval(updateUnreadCount, 5000); // check every 5s\n    return () => clearInterval(interval);\n  }, []);\n  \n\n  useEffect(() => {\n    loadData();\n    // Initialize Firebase + FCM token fetch (deferred until user interaction if desired)\n    const app = initFirebase();\n    \n    // Set up Firebase Auth listener\n    const unsubscribeAuth = subscribeToAuthState(async (firebaseUser) => {\n      if (firebaseUser) {\n        setCurrentUser(firebaseUser);\n        // Fetch extended profile from Firestore\n        try {\n          const profile = await getUserProfile(firebaseUser.uid);\n          if (profile) {\n            setUserProfile(profile);\n            setUserType(profile.userType || 'renter');\n          }\n        } catch (err) {\n          console.error('Error fetching user profile:', err);\n        }\n      } else {\n        setCurrentUser(null);\n        setUserProfile(null);\n        setUserType(null);\n      }\n      setAuthLoading(false);\n    });\n    \n    // Set up real-time listener for Firestore listings\n    let unsubscribeListings = null;\n    if (isFirestoreEnabled()) {\n      unsubscribeListings = subscribeToListings((firestoreListings) => {\n        if (firestoreListings && firestoreListings.length >= 0) {\n          setListings(firestoreListings);\n          // Cache locally for offline access\n          localStorage.setItem('listings', JSON.stringify(firestoreListings));\n        }\n      });\n    }\n    \n    // Check analytics consent and show modal if not set\n    const analyticsConsent = localStorage.getItem('analytics-consent');\n    if (!analyticsConsent && process.env.REACT_APP_ENABLE_ANALYTICS === 'true') {\n      // Delay modal slightly so UI loads first\n      setTimeout(() => setShowAnalyticsConsent(true), 2000);\n    } else if (analyticsConsent === 'yes') {\n      initAnalytics(app);\n    }\n\n    (async () => {\n      try {\n        const token = await requestFcmToken();\n        if (token) {\n          console.log('Obtained FCM token:', token);\n          trackEvent('fcm_token_obtained');\n        }\n      } catch (e) {\n        console.warn('FCM token request failed', e);\n      }\n    })();\n    \n    listenForegroundMessages((payload) => {\n      // Display notification banner instead of toast\n      const notification = payload?.notification || {};\n      if (notification.title || notification.body) {\n        setNotificationBanner({\n          title: notification.title,\n          body: notification.body\n        });\n        // Auto-dismiss after 8 seconds\n        setTimeout(() => setNotificationBanner(null), 8000);\n      }\n    });\n    \n    // Cleanup: unsubscribe from listeners on unmount\n    return () => {\n      if (unsubscribeAuth) {\n        unsubscribeAuth();\n      }\n      if (unsubscribeListings) {\n        unsubscribeListings();\n      }\n    };\n  }, []);\n\n  // Guard: if someone navigates to 'add' without landlord auth, prompt to sign in\n  useEffect(() => {\n    if (authLoading) return; // Wait for auth to load\n    \n    if (currentView === 'add') {\n      if (!currentUser) {\n        openAuthModal('landlord');\n        setCurrentView('browse');\n      } else if (userType !== 'landlord') {\n        // Not a landlord - prompt to become one\n        openAuthModal('landlord');\n        setCurrentView('browse');\n      } else if (!userProfile?.landlordComplete) {\n        // Landlord but hasn't completed onboarding\n        setCurrentView('landlord-onboarding');\n      }\n    }\n  }, [currentView, currentUser, userType, userProfile, authLoading]);\n\n  const loadData = async () => {\n    try {\n      // Try to load from Firestore first\n      const firestoreListings = await fetchListings();\n      if (firestoreListings && firestoreListings.length > 0) {\n        console.log('Loaded listings from Firestore');\n        setListings(firestoreListings);\n        // Also cache to localStorage for offline access\n        localStorage.setItem('listings', JSON.stringify(firestoreListings));\n      } else {\n        // Fall back to localStorage\n        const listingsResult = localStorage.getItem('listings');\n        if (listingsResult) {\n          console.log('Loaded listings from localStorage (Firestore empty or unavailable)');\n          setListings(JSON.parse(listingsResult));\n        }\n      }\n      \n      const userResult = localStorage.getItem('current-user');\n      const usersResult = localStorage.getItem('users');\n      if (userResult) {\n        const user = JSON.parse(userResult);\n        setCurrentUser(user);\n        setUserType(user.type);\n      }\n      if (usersResult) {\n        try {\n          const parsed = JSON.parse(usersResult);\n          setUsers(Array.isArray(parsed) ? parsed : []);\n        } catch (e) {\n          console.warn('Corrupt users array in storage, resetting');\n          setUsers([]);\n        }\n      }\n    } catch (error) {\n      console.log('No existing data found, starting fresh');\n      // Add sample listings for testing the map\n      const sampleListings = [\n        {\n          id: 'listing-1',\n          title: 'Cozy Room in Soweto',\n          price: 2500,\n          location: 'Soweto, Johannesburg',\n          description: 'Comfortable room with bathroom and kitchen access',\n          photos: [],\n          status: 'available',\n          availableDate: new Date().toISOString(),\n          amenities: ['WiFi', 'Kitchen'],\n          landlordId: 'landlord-1',\n          landlordName: 'John Smith',\n          landlordPhone: '+27 123 456 7890',\n          landlordEmail: 'john@example.com',\n          landlordPhoto: '',\n          createdAt: new Date().toISOString()\n        },\n        {\n          id: 'listing-2',\n          title: 'Modern Apartment in Sandton',\n          price: 4500,\n          location: 'Sandton, Johannesburg',\n          description: 'Luxurious apartment with parking and security',\n          photos: [],\n          status: 'available',\n          availableDate: new Date().toISOString(),\n          amenities: ['WiFi', 'Parking', 'Air Conditioning'],\n          landlordId: 'landlord-2',\n          landlordName: 'Jane Doe',\n          landlordPhone: '+27 987 654 3210',\n          landlordEmail: 'jane@example.com',\n          landlordPhoto: '',\n          createdAt: new Date().toISOString()\n        },\n        {\n          id: 'listing-3',\n          title: 'Studio in Midrand',\n          price: 3200,\n          location: 'Midrand, Johannesburg',\n          description: 'Spacious studio flat with laundry facilities',\n          photos: [],\n          status: 'available',\n          availableDate: new Date().toISOString(),\n          amenities: ['Laundry', 'WiFi'],\n          landlordId: 'landlord-3',\n          landlordName: 'Mike Johnson',\n          landlordPhone: '+27 555 555 5555',\n          landlordEmail: 'mike@example.com',\n          landlordPhoto: '',\n          createdAt: new Date().toISOString()\n        }\n      ];\n      setListings(sampleListings);\n    }\n  };\n\n  // Helper: check for duplicate phone or email in registry (exclude an optional user id)\n  const isDuplicateContact = (phone, email, ignoreId = null) => {\n    const normalizedPhone = (phone || '').trim();\n    const normalizedEmail = (email || '').trim().toLowerCase();\n    if (!users || users.length === 0) return false;\n    return users.some(u => {\n      if (ignoreId && u.id === ignoreId) return false;\n      const uPhone = (u.phone || '').trim();\n      const uEmail = (u.email || '').trim().toLowerCase();\n      const phoneMatch = normalizedPhone && uPhone && uPhone === normalizedPhone;\n      const emailMatch = normalizedEmail && uEmail && uEmail === normalizedEmail;\n      return phoneMatch || emailMatch;\n    });\n  };\n\n  // Toast notification helper\n  const showToast = (message, type = 'info', title = '') => {\n    setToast({ message, type, title });\n    setTimeout(() => setToast(null), 5000);\n  };\n\n  const handleAnalyticsConsentAccept = () => {\n    localStorage.setItem('analytics-consent', 'yes');\n    setShowAnalyticsConsent(false);\n    const app = initFirebase();\n    initAnalytics(app);\n    trackEvent('analytics_consent_granted');\n    showToast('Analytics enabled', 'success', 'Thank you!');\n  };\n\n  const handleAnalyticsConsentDecline = () => {\n    localStorage.setItem('analytics-consent', 'no');\n    setShowAnalyticsConsent(false);\n    showToast('Analytics disabled', 'info');\n  };\n\n  const saveListings = async (newListings) => {\n    try {\n      localStorage.setItem('listings', JSON.stringify(newListings));\n      setListings(newListings);\n      // Broadcast to runtime service worker for offline snapshot caching\n      if (navigator.serviceWorker && navigator.serviceWorker.controller) {\n        try { navigator.serviceWorker.controller.postMessage({ type: 'SYNC_LISTINGS', payload: newListings }); } catch {}\n      }\n    } catch (error) {\n      console.error('Error saving listings:', error);\n    }\n  };\n\n  const saveSubscriptions = async (subscriptions) => {\n    try {\n      localStorage.setItem('subscriptions', JSON.stringify(subscriptions));\n    } catch (error) {\n      console.error('Error saving subscriptions:', error);\n    }\n  };\n\n  const getSubscriptions = async () => {\n    try {\n      const res = localStorage.getItem('subscriptions');\n      return res ? JSON.parse(res) : {};\n    } catch (err) {\n      console.error('Error loading subscriptions', err);\n    }\n    return {};\n  };\n\n  const subscribeToArea = async (userId, area) => {\n    if (!userId) {\n      openAuthModal('renter');\n      return;\n    }\n    if (!area || area.trim() === '') {\n      alert('Please enter a location to subscribe to.');\n      return;\n    }\n    try {\n      const subs = await getSubscriptions();\n      subs[userId] = subs[userId] || [];\n      if (!subs[userId].includes(area)) {\n        subs[userId].push(area);\n        await saveSubscriptions(subs);\n        alert(`Subscribed to updates for ${area}`);\n      } else {\n        alert(`You are already subscribed to ${area}`);\n      }\n    } catch (err) {\n      console.error('Subscribe failed', err);\n      alert('Could not subscribe. Please try again.');\n    }\n  };\n\n  \n\nconst handleProfileSetup = async (profileData) => {\n  try {\n    // Duplicate guard\n    if (isDuplicateContact(profileData.phone, profileData.email)) {\n      showToast('Phone or email already registered', 'error', 'Duplicate');\n      return;\n    }\n    const userId = `user-${Date.now()}`;\n    const user = { \n      id: userId, \n      type: userType, \n      ...profileData,\n      whatsapp: profileData.whatsapp || '',\n      notificationPrefs: { updates: true, marketing: false },\n      createdAt: new Date().toISOString()\n    };\n    \n    localStorage.setItem('current-user', JSON.stringify(user));\n    setCurrentUser(user);\n    // Update users registry\n    const existingUsersRaw = localStorage.getItem('users');\n    let existingUsers = [];\n    if (existingUsersRaw) {\n      try { existingUsers = JSON.parse(existingUsersRaw); } catch { existingUsers = []; }\n    }\n    existingUsers.push(user);\n    localStorage.setItem('users', JSON.stringify(existingUsers));\n    setUsers(existingUsers);\n    showToast('Profile created successfully!', 'success', 'Welcome!');\n    setCurrentView('browse');\n  } catch (error) {\n    console.error('Error saving profile:', error);\n    // Still set the user locally even if storage fails\n    const userId = `user-${Date.now()}`;\n    const user = { \n      id: userId, \n      type: userType, \n      ...profileData,\n      whatsapp: profileData.whatsapp || '',\n      createdAt: new Date().toISOString()\n    };\n    setCurrentUser(user);\n    const existingUsersRaw = localStorage.getItem('users');\n    let existingUsers = [];\n    if (existingUsersRaw) {\n      try { existingUsers = JSON.parse(existingUsersRaw); } catch { existingUsers = []; }\n    }\n    existingUsers.push(user);\n    try { localStorage.setItem('users', JSON.stringify(existingUsers)); } catch {}\n    setUsers(existingUsers);\n    showToast('Profile created (data may not be persisted)', 'error');\n    setCurrentView('browse');\n  }\n};\n\nconst handleUpdateProfile = async (profileData) => {\n  try {\n    // Duplicate guard (exclude current user id)\n    if (isDuplicateContact(profileData.phone, profileData.email, currentUser?.id)) {\n      showToast('Phone or email already used by another account', 'error', 'Duplicate');\n      return;\n    }\n    const updatedUser = { ...currentUser, ...profileData };\n    \n    localStorage.setItem('current-user', JSON.stringify(updatedUser));\n    setCurrentUser(updatedUser);\n    // Update registry entry\n    const existingUsersRaw = localStorage.getItem('users');\n    let existingUsers = [];\n    if (existingUsersRaw) {\n      try { existingUsers = JSON.parse(existingUsersRaw); } catch { existingUsers = []; }\n    }\n    const idx = existingUsers.findIndex(u => u.id === updatedUser.id);\n    if (idx !== -1) {\n      existingUsers[idx] = updatedUser;\n    } else {\n      existingUsers.push(updatedUser); // ensure presence\n    }\n    localStorage.setItem('users', JSON.stringify(existingUsers));\n    setUsers(existingUsers);\n    showToast('Profile updated successfully!', 'success');\n    setCurrentView('browse');\n  } catch (error) {\n    console.error('Error updating profile:', error);\n    const updatedUser = { ...currentUser, ...profileData };\n    setCurrentUser(updatedUser);\n    const existingUsersRaw = localStorage.getItem('users');\n    let existingUsers = [];\n    if (existingUsersRaw) {\n      try { existingUsers = JSON.parse(existingUsersRaw); } catch { existingUsers = []; }\n    }\n    const idx = existingUsers.findIndex(u => u.id === updatedUser.id);\n    if (idx !== -1) {\n      existingUsers[idx] = updatedUser;\n    } else {\n      existingUsers.push(updatedUser);\n    }\n    try { localStorage.setItem('users', JSON.stringify(existingUsers)); } catch {}\n    setUsers(existingUsers);\n    showToast('Profile updated (data may not be persisted)', 'error');\n    setCurrentView('browse');\n  }\n};\n\n// Sign out using Firebase\nconst handleSignOut = async () => {\n  try {\n    await firebaseSignOut();\n    setCurrentUser(null);\n    setUserProfile(null);\n    setUserType(null);\n    setCurrentView('browse');\n    showToast('Signed out successfully.', 'info');\n  } catch (e) {\n    console.error('Sign out error:', e);\n    showToast('Error signing out. Please try again.', 'error');\n  }\n};\n\nconst handleCompleteOnboarding = async (onboardData) => {\n  try {\n    if (currentUser?.uid) {\n      await saveUserProfile(currentUser.uid, { \n        landlordComplete: true, \n        landlordInfo: onboardData \n      });\n      setUserProfile(prev => ({ ...prev, landlordComplete: true, landlordInfo: onboardData }));\n    }\n    setCurrentView('browse');\n    showToast('Profile complete! You can now create listings.', 'success');\n  } catch (err) {\n    console.error('Onboarding save failed', err);\n    setCurrentView('browse');\n  }\n};\n\nconst handleAddListing = async (listingData) => {\n  // Combine streetAddress and location into fullAddress for complete address storage\n  const fullAddress = [listingData.streetAddress, listingData.location]\n    .filter(Boolean)\n    .join(', ');\n  \n  const newListingData = {\n    title: listingData.title,\n    price: listingData.price,\n    location: listingData.location,\n    streetAddress: listingData.streetAddress || '',\n    fullAddress: fullAddress || listingData.location || '', // Store complete address\n    description: listingData.description,\n    photos: listingData.photos || [],\n    status: listingData.status || 'available',\n    availableDate: listingData.availableDate || new Date().toISOString(),\n    amenities: listingData.amenities || [],\n    latitude: listingData.latitude ?? null,\n    longitude: listingData.longitude ?? null,\n    paymentMethod: listingData.paymentMethod || 'Bank and Cash',\n    premium: !!listingData.premium,\n    // Use Firebase UID for landlordId\n    landlordId: currentUser?.uid || currentUser?.id,\n    landlordName: userProfile?.displayName || currentUser?.displayName || '',\n    landlordPhone: userProfile?.phone || '',\n    landlordEmail: currentUser?.email || '',\n    landlordPhoto: userProfile?.photoURL || currentUser?.photoURL || '',\n  };\n\n  try {\n    // Try to save to Firestore first\n    const firestoreId = await addListing(newListingData);\n    if (firestoreId) {\n      // Successfully saved to Firestore\n      const newListing = { ...newListingData, id: firestoreId, createdAt: new Date().toISOString() };\n      const updatedListings = [...listings, newListing];\n      setListings(updatedListings);\n      // Also cache locally\n      localStorage.setItem('listings', JSON.stringify(updatedListings));\n      showToast('Listing created and shared online!', 'success', 'Success!');\n    } else {\n      // Firestore not available, save locally only\n      const newListing = { ...newListingData, id: `listing-${Date.now()}`, createdAt: new Date().toISOString() };\n      const updatedListings = [...listings, newListing];\n      await saveListings(updatedListings);\n      showToast('Listing saved locally (offline mode)', 'info', 'Saved');\n    }\n  } catch (error) {\n    console.error('Error adding listing:', error);\n    // Fall back to local save\n    const newListing = { ...newListingData, id: `listing-${Date.now()}`, createdAt: new Date().toISOString() };\n    const updatedListings = [...listings, newListing];\n    await saveListings(updatedListings);\n    showToast('Listing saved locally', 'info', 'Saved');\n  }\n  \n  setCurrentView('browse');\n  // Scroll to top to see new listing\n  window.scrollTo({ top: 0, behavior: 'smooth' });\n};\n\n  // Messaging removed\n\nconst filteredListings = listings\n  .filter(listing => {\n    const matchesLocation = !searchLocation || \n      (listing.location || '').toLowerCase().includes(searchLocation.toLowerCase());\n    const price = parseFloat(listing.price);\n    const matchesPrice = price >= priceRange[0] && price <= priceRange[1];\n    const matchesAmenities = selectedAmenities.length === 0 || \n      selectedAmenities.every(amenity => listing.amenities?.includes(amenity));\n\n    return matchesLocation && matchesPrice && matchesAmenities;\n  })\n  .sort((a, b) => {\n    if (a.premium && !b.premium) return -1;\n    if (!a.premium && b.premium) return 1;\n    if (sortBy === 'newest') {\n      return new Date(b.createdAt) - new Date(a.createdAt);\n    } else if (sortBy === 'cheapest') {\n      return parseFloat(a.price) - parseFloat(b.price);\n    } else if (sortBy === 'expensive') {\n      return parseFloat(b.price) - parseFloat(a.price);\n    }\n    return 0;\n  });\n\n  // Allow guests to land on Browse by default. If userType isn't set,\n  // show a gentle callout in the header (below) so users can pick a role\n  // when they want to post or set up their profile.\n\n  return (\n    <div className=\"min-h-screen bg-gradient-to-b from-slate-50 to-gray-100\">\n      {/* Offline Indicator */}\n      <OfflineIndicator />\n      \n      {/* Back to Top Button */}\n      <BackToTop />\n      \n      <Header\n        currentUser={currentUser}\n        previewAsRenter={previewAsRenter}\n        setPreviewAsRenter={setPreviewAsRenter}\n        openAuthModal={openAuthModal}\n        handleSignOut={handleSignOut}\n        setCurrentView={setCurrentView}\n        unreadCount={unreadCount}\n        onOpenNotifications={() => setShowNotificationsPanel(true)}\n      />\n\n      {/* Notification Banner (Push Notifications) */}\n      {notificationBanner && (\n        <NotificationBanner\n          title={notificationBanner.title}\n          body={notificationBanner.body}\n          onClose={() => setNotificationBanner(null)}\n        />\n      )}\n\n      {/* Toast Notification */}\n      {toast && (\n        <div className={`fixed top-20 right-4 z-50 max-w-sm w-full transition-all duration-300 ${\n          toast.type === 'error' ? 'bg-gradient-to-r from-rose-50 to-red-50 border-rose-400' :\n          toast.type === 'success' ? 'bg-gradient-to-r from-emerald-50 to-green-50 border-emerald-400' :\n          toast.type === 'warning' ? 'bg-gradient-to-r from-amber-50 to-yellow-50 border-amber-400' :\n          'bg-gradient-to-r from-sky-50 to-blue-50 border-sky-400'\n        } border-l-4 rounded-xl shadow-2xl p-4 fade-in backdrop-blur-sm`}>\n          <div className=\"flex items-start gap-3\">\n            <div className={`flex-shrink-0 w-8 h-8 rounded-xl flex items-center justify-center shadow-sm ${\n              toast.type === 'error' ? 'bg-rose-500' :\n              toast.type === 'success' ? 'bg-emerald-500' :\n              toast.type === 'warning' ? 'bg-amber-500' :\n              'bg-sky-500'\n            }`}>\n              {toast.type === 'success' && <CheckCircle className=\"w-5 h-5 text-white\" />}\n              {toast.type === 'error' && <span className=\"text-white font-bold text-sm\"></span>}\n              {toast.type === 'warning' && <span className=\"text-white font-bold text-sm\">!</span>}\n              {toast.type === 'info' && <span className=\"text-white font-bold text-sm\">i</span>}\n            </div>\n            <div className=\"flex-1 min-w-0\">\n              {toast.title && <p className={`font-bold mb-0.5 ${\n                toast.type === 'error' ? 'text-rose-800' :\n                toast.type === 'success' ? 'text-emerald-800' :\n                toast.type === 'warning' ? 'text-amber-800' :\n                'text-sky-800'\n              }`}>{toast.title}</p>}\n              <p className={`text-sm ${\n                toast.type === 'error' ? 'text-rose-700' :\n                toast.type === 'success' ? 'text-emerald-700' :\n                toast.type === 'warning' ? 'text-amber-700' :\n                'text-sky-700'\n              }`}>{toast.message}</p>\n            </div>\n            <button \n              onClick={() => setToast(null)}\n              className={`flex-shrink-0 p-1.5 rounded-lg hover:bg-white/50 transition ${\n                toast.type === 'error' ? 'text-rose-500 hover:text-rose-700' :\n                toast.type === 'success' ? 'text-emerald-500 hover:text-emerald-700' :\n                toast.type === 'warning' ? 'text-amber-500 hover:text-amber-700' :\n                'text-sky-500 hover:text-sky-700'\n              }`}\n              aria-label=\"Close notification\"\n            >\n              <X className=\"w-4 h-4\" />\n            </button>\n          </div>\n        </div>\n      )}\n\n      <div id=\"main-content\" className=\"max-w-7xl mx-auto pb-24 px-4 sm:px-6 lg:px-8\" role=\"main\">\n        {currentView === 'setup-profile' && (\n          <ProfileSetupView onSubmit={handleProfileSetup} userType={userType} />\n        )}\n\n        {currentView === 'profile' && currentUser && (\n          <ProfileView \n            user={{\n              name: userProfile?.displayName || currentUser?.displayName || '',\n              email: currentUser?.email || '',\n              phone: userProfile?.phone || '',\n              photo: userProfile?.photoURL || currentUser?.photoURL || '',\n              type: userProfile?.userType || userType || 'renter',\n              notificationPrefs: userProfile?.notificationPrefs || { updates: true, marketing: false },\n            }}\n            onEdit={() => setCurrentView('edit-profile')} \n            onSignOut={handleSignOut}\n            linkedProviders={getLinkedProviders()}\n            onLinkGoogle={async () => {\n              await linkGoogleAccount();\n              // Refresh to show updated providers\n              window.location.reload();\n            }}\n            onLinkPhone={() => {\n              // Open auth modal for phone linking\n              showToast('Phone linking coming soon!', 'info');\n            }}\n            onUpdatePrefs={async (prefs) => {\n              if (currentUser?.uid) {\n                try {\n                  await saveUserProfile(currentUser.uid, { notificationPrefs: prefs });\n                  setUserProfile(prev => ({ ...prev, notificationPrefs: prefs }));\n                  showToast('Preferences updated', 'success');\n                } catch (err) {\n                  console.error('Failed to update prefs:', err);\n                  showToast('Failed to update preferences', 'error');\n                }\n              }\n            }}\n          />\n        )}\n\n        {currentView === 'edit-profile' && currentUser && (\n          <EditProfileView user={currentUser} onSubmit={handleUpdateProfile} onCancel={() => setCurrentView('profile')} />\n        )}\n\n        {currentView === 'landlord-onboarding' && currentUser && userType === 'landlord' && (\n          <LandlordOnboardingView onComplete={handleCompleteOnboarding} onCancel={() => setCurrentView('browse')} currentUser={currentUser} />\n        )}\n\n        {currentView === 'browse' && (\n                    <BrowseView \n                      listings={filteredListings}\n                      searchLocation={searchLocation}\n                      setSearchLocation={setSearchLocation}\n                      priceRange={priceRange}\n                      setPriceRange={setPriceRange}\n                      selectedAmenities={selectedAmenities}\n                      setSelectedAmenities={setSelectedAmenities}\n                      sortBy={sortBy}\n                      setSortBy={setSortBy}\n                      onSelectListing={setSelectedListing}\n                      setCurrentView={setCurrentView}\n                      currentUser={currentUser}\n                      onRequireAuth={openAuthModal}\n                      subscribeToArea={subscribeToArea}\n                      previewMode={previewAsRenter}\n                    />\n        )}\n\n        {/* Messages view removed */}\n\n        {currentView === 'add' && (\n          <AddListingView\n            onSubmit={handleAddListing}\n            onCancel={() => setCurrentView('browse')}\n            currentUser={currentUser}\n            userType={userType}\n            onRequireAuth={openAuthModal}\n            onRequireOnboarding={() => setCurrentView('landlord-onboarding')}\n          />\n        )}\n\n        {currentView === 'my-listings' && currentUser && userType === 'landlord' && (\n          <MyListingsView \n            listings={listings.filter(l => l.landlordId === currentUser.uid || l.landlordId === currentUser.id)}\n            onDelete={async (id) => {\n              try {\n                // Try to delete from Firestore first\n                const deleted = await deleteListing(id);\n                if (deleted) {\n                  showToast('Listing deleted', 'success');\n                }\n              } catch (error) {\n                console.error('Firestore delete failed:', error);\n              }\n              // Also update local state and localStorage\n              const updated = listings.filter(l => l.id !== id);\n              setListings(updated);\n              localStorage.setItem('listings', JSON.stringify(updated));\n            }}\n          />\n        )}\n\n        {currentView === 'favorites' && (\n          <FavoritesView\n            listings={listings}\n            onSelectListing={setSelectedListing}\n          />\n        )}\n      </div>\n\n      {selectedListing && (\n        <ListingDetailModal \n          listing={selectedListing}\n          landlord={{\n            name: selectedListing.landlordName,\n            phone: selectedListing.landlordPhone,\n            email: selectedListing.landlordEmail,\n            photo: selectedListing.landlordPhoto\n          }}\n          onClose={() => setSelectedListing(null)}\n          userType={userType}\n          currentUser={currentUser}\n          onRequireAuth={openAuthModal}\n          previewMode={previewAsRenter}\n          showToast={showToast}\n        />\n      )}\n\n      {/* Conversation modal removed */}\n\n      {showAuthModal && (\n        <AuthModal\n          defaultType={authDefaultType}\n          onClose={() => setShowAuthModal(false)}\n          onSuccess={() => {\n            showToast('Signed in successfully!', 'success', 'Welcome!');\n          }}\n          authFunctions={authFunctions}\n        />\n      )}\n\n      <BottomNav \n        currentView={currentView}\n        setCurrentView={setCurrentView}\n        userType={userType}\n      />\n\n      {showPrivacyPolicy && (\n        <PrivacyPolicyModal onClose={() => setShowPrivacyPolicy(false)} />\n      )}\n\n      {showAnalyticsConsent && (\n        <AnalyticsConsentModal\n          onAccept={handleAnalyticsConsentAccept}\n          onDecline={handleAnalyticsConsentDecline}\n        />\n      )}\n\n      {showNotificationsPanel && (\n        <NotificationsPanel\n          onClose={() => {\n            setShowNotificationsPanel(false);\n            setUnreadCount(getNotifications().filter(n => !n.read).length);\n          }}\n          onSelectListing={(listingId) => {\n            const listing = listings.find(l => (l.id || `${l.title}-${l.createdAt}`) === listingId);\n            if (listing) {\n              setSelectedListing(listing);\n            }\n            setShowNotificationsPanel(false);\n          }}\n        />\n      )}\n\n      <Footer onOpenPrivacy={() => setShowPrivacyPolicy(true)} />\n    </div>\n  );\n}\n\n\n\nfunction ProfileSetupView({ onSubmit, userType }) {\n  const [formData, setFormData] = useState({\n    name: '',\n    phone: '',\n    email: '',\n    whatsapp: '',\n    photo: ''\n  });\n  const [errors, setErrors] = useState({});\n  const [touched, setTouched] = useState({});\n\n  const validateField = (name, value, extras = {}) => {\n    const newErrors = { ...errors };\n    switch (name) {\n      case 'name':\n        if (!value || value.trim().length < 2) {\n          newErrors.name = 'Name must be at least 2 characters';\n        } else {\n          delete newErrors.name;\n        }\n        break;\n      case 'phone':\n        if (!value || !/^[+]?[-0-9()\\s]{7,}$/.test(value.trim())) {\n          newErrors.phone = 'Enter a valid phone number (min 7 digits)';\n        } else {\n          delete newErrors.phone;\n        }\n        break;\n      case 'email':\n        if (!value || !/^[^@\\s]+@[^@\\s]+\\.[^@\\s]+$/.test(value.trim())) {\n          newErrors.email = 'Enter a valid email address';\n        } else {\n          delete newErrors.email;\n        }\n        break;\n      case 'photo':\n        if (value === 'FILE_TOO_LARGE') {\n          newErrors.photo = 'Photo is too large (max 2MB)';\n        } else {\n          delete newErrors.photo;\n        }\n        break;\n      default:\n        break;\n    }\n    setErrors(newErrors);\n  };\n\n  const handlePhotoUpload = (e) => {\n    const file = e.target.files[0];\n    if (file) {\n      if (file.size > 2 * 1024 * 1024) { // 2MB limit\n        setFormData({ ...formData, photo: '' });\n        validateField('photo', 'FILE_TOO_LARGE');\n        return;\n      }\n      const reader = new FileReader();\n      reader.onloadend = () => {\n        setFormData({ ...formData, photo: reader.result });\n        validateField('photo', reader.result);\n      };\n      reader.readAsDataURL(file);\n    }\n  };\n\n  const handleSubmit = () => {\n    // Touch all fields\n    const allTouched = { name: true, phone: true, email: true, photo: true };\n    setTouched(allTouched);\n    validateField('name', formData.name);\n    validateField('phone', formData.phone);\n    validateField('email', formData.email);\n    if (Object.keys(errors).length === 0 && formData.name && formData.phone && formData.email) {\n      onSubmit(formData);\n    }\n  };\n\n  return (\n    <div className=\"p-4 min-h-screen bg-gradient-to-b from-slate-50 to-gray-100 pb-24\">\n      <div className=\"max-w-2xl mx-auto mt-8\">\n        <div className=\"bg-white rounded-2xl shadow-lg border border-gray-100 p-8\">\n          <div className=\"text-center mb-8\">\n            <h2 className=\"text-3xl font-extrabold text-gray-900 mb-2\">Complete Your Profile</h2>\n            <p className=\"text-gray-600\">Help others know who you are</p>\n          </div>\n\n          <div className=\"space-y-6\">\n            {/* Photo Upload */}\n            <div className=\"flex justify-center mb-8\">\n              <div className=\"relative\">\n                {formData.photo ? (\n                  <img \n                    src={formData.photo} \n                    alt=\"Profile\" \n                    className=\"w-32 h-32 rounded-full object-cover border-4 border-blue-200 shadow-lg\" \n                  />\n                ) : (\n                  <div className=\"w-32 h-32 rounded-full bg-gradient-to-br from-blue-100 to-blue-200 flex items-center justify-center border-4 border-blue-200 shadow-lg\">\n                    <User className=\"w-16 h-16 text-blue-600\" />\n                  </div>\n                )}\n                <label className=\"absolute bottom-0 right-0 bg-blue-600 hover:bg-blue-700 text-white p-3 rounded-full cursor-pointer shadow-lg transition group\" aria-label=\"Upload profile photo\">\n                  <Edit className=\"w-5 h-5\" />\n                  <input\n                    type=\"file\"\n                    accept=\"image/*\"\n                    onChange={handlePhotoUpload}\n                    className=\"hidden\"\n                  />\n                </label>\n              </div>\n            </div>\n\n            {/* Form Fields */}\n            <div>\n              <label className=\"block text-sm font-semibold text-gray-800 mb-2\">Full Name *</label>\n              <input\n                type=\"text\"\n                required\n                value={formData.name}\n                onChange={(e) => { setFormData({ ...formData, name: e.target.value }); if (touched.name) validateField('name', e.target.value); }}\n                onBlur={(e) => { setTouched({ ...touched, name: true }); validateField('name', e.target.value); }}\n                placeholder=\"Enter your full name\"\n                aria-invalid={errors.name ? 'true' : 'false'}\n                aria-describedby={errors.name ? 'profile-name-error' : undefined}\n                className={`w-full px-4 py-3 border-2 ${errors.name ? 'border-red-400' : 'border-gray-200'} bg-white text-gray-800 rounded-xl focus:ring-2 focus:ring-teal-400 focus:border-transparent transition placeholder-gray-400`}\n              />\n              {errors.name && touched.name && <p id=\"profile-name-error\" className=\"mt-1 text-xs text-red-600\">{errors.name}</p>}\n            </div>\n\n            <div>\n              <label className=\"block text-sm font-semibold text-gray-800 mb-2\">Phone Number *</label>\n              <div className=\"relative\">\n                <Phone className=\"absolute left-4 top-3.5 w-5 h-5 text-gray-400\" />\n                <input\n                  type=\"tel\"\n                  required\n                  value={formData.phone}\n                  onChange={(e) => { setFormData({ ...formData, phone: e.target.value }); if (touched.phone) validateField('phone', e.target.value); }}\n                  onBlur={(e) => { setTouched({ ...touched, phone: true }); validateField('phone', e.target.value); }}\n                  placeholder=\"e.g., +27 12 345 6789\"\n                  aria-invalid={errors.phone ? 'true' : 'false'}\n                  aria-describedby={errors.phone ? 'profile-phone-error' : undefined}\n                  className={`w-full pl-11 pr-4 py-3 border-2 ${errors.phone ? 'border-red-400' : 'border-gray-200'} bg-white text-gray-800 rounded-xl focus:ring-2 focus:ring-teal-400 focus:border-transparent transition placeholder-gray-400`}\n                />\n              </div>\n              {errors.phone && touched.phone && <p id=\"profile-phone-error\" className=\"mt-1 text-xs text-red-600\">{errors.phone}</p>}\n            </div>\n\n            <div>\n              <label className=\"block text-sm font-semibold text-gray-800 mb-2\">Email Address *</label>\n              <div className=\"relative\">\n                <Mail className=\"absolute left-4 top-3.5 w-5 h-5 text-gray-400\" />\n                <input\n                  type=\"email\"\n                  required\n                  value={formData.email}\n                  onChange={(e) => { setFormData({ ...formData, email: e.target.value }); if (touched.email) validateField('email', e.target.value); }}\n                  onBlur={(e) => { setTouched({ ...touched, email: true }); validateField('email', e.target.value); }}\n                  placeholder=\"your.email@example.com\"\n                  aria-invalid={errors.email ? 'true' : 'false'}\n                  aria-describedby={errors.email ? 'profile-email-error' : undefined}\n                  className={`w-full pl-11 pr-4 py-3 border-2 ${errors.email ? 'border-red-400' : 'border-gray-200'} bg-white text-gray-800 rounded-xl focus:ring-2 focus:ring-teal-400 focus:border-transparent transition placeholder-gray-400`}\n                />\n              </div>\n              {errors.email && touched.email && <p id=\"profile-email-error\" className=\"mt-1 text-xs text-red-600\">{errors.email}</p>}\n            </div>\n\n            <div>\n              <label className=\"block text-sm font-semibold text-gray-800 mb-2\">WhatsApp (optional)</label>\n              <div className=\"relative\">\n                <Phone className=\"absolute left-4 top-3.5 w-5 h-5 text-gray-400\" />\n                <input\n                  type=\"tel\"\n                  value={formData.whatsapp}\n                  onChange={(e) => setFormData({ ...formData, whatsapp: e.target.value })}\n                  placeholder=\"e.g., +27 71 234 5678\"\n                  className=\"w-full pl-11 pr-4 py-3 border-2 border-gray-200 bg-white text-gray-800 rounded-xl focus:ring-2 focus:ring-teal-400 focus:border-transparent transition placeholder-gray-400\"\n                />\n              </div>\n              <p className=\"text-xs text-gray-500 mt-1\">Used to create a WhatsApp chat link on your listings.</p>\n            </div>\n\n            {/* Submit Button */}\n            <button\n              onClick={handleSubmit}\n              className=\"w-full bg-gradient-to-r from-teal-500 to-cyan-500 hover:from-teal-600 hover:to-cyan-600 text-white font-semibold py-3 rounded-xl transition mt-8 shadow-lg hover:shadow-xl\"\n            >\n              Complete Setup\n            </button>\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n}\n\nfunction ProfileView({ user, onEdit, onUpdatePrefs, onSignOut, linkedProviders, onLinkGoogle, onLinkPhone }) {\n  const prefs = user.notificationPrefs || { updates: true, marketing: false };\n  const [localPrefs, setLocalPrefs] = React.useState(prefs);\n  const [linkingInProgress, setLinkingInProgress] = React.useState(null);\n  const [linkError, setLinkError] = React.useState('');\n  const [linkSuccess, setLinkSuccess] = React.useState('');\n\n  const togglePref = (key) => {\n    const next = { ...localPrefs, [key]: !localPrefs[key] };\n    setLocalPrefs(next);\n    onUpdatePrefs && onUpdatePrefs(next);\n  };\n\n  const handleLinkGoogle = async () => {\n    if (!onLinkGoogle) return;\n    setLinkingInProgress('google');\n    setLinkError('');\n    setLinkSuccess('');\n    try {\n      await onLinkGoogle();\n      setLinkSuccess('Google account linked successfully!');\n    } catch (err) {\n      setLinkError(err.message || 'Failed to link Google account');\n    } finally {\n      setLinkingInProgress(null);\n    }\n  };\n\n  const handleLinkPhone = () => {\n    if (!onLinkPhone) return;\n    onLinkPhone();\n  };\n\n  const hasGoogle = linkedProviders?.includes('google.com');\n  const hasPhone = linkedProviders?.includes('phone');\n  const hasPassword = linkedProviders?.includes('password');\n\n  return (\n    <div className=\"min-h-screen bg-gradient-to-b from-slate-50 to-gray-100 pb-24\">\n      {/* Profile Header with Gradient */}\n      <div className=\"bg-gradient-to-br from-teal-600 via-teal-500 to-cyan-500 pt-8 pb-20 px-4\">\n        <div className=\"max-w-xl mx-auto flex justify-between items-start\">\n          <h2 className=\"text-2xl font-bold text-white\">My Profile</h2>\n          <button\n            onClick={onEdit}\n            className=\"bg-white/20 hover:bg-white/30 backdrop-blur-sm text-white px-4 py-2 rounded-xl transition-all duration-200 flex items-center gap-2 border border-white/30\"\n          >\n            <Edit className=\"w-4 h-4\" />\n            Edit\n          </button>\n        </div>\n      </div>\n\n      {/* Profile Card - Overlapping Header */}\n      <div className=\"px-4 -mt-16\">\n        <div className=\"bg-white rounded-2xl shadow-xl border border-gray-100 p-6 max-w-xl mx-auto\">\n          {/* Avatar & Name */}\n          <div className=\"flex flex-col items-center -mt-16 mb-6\">\n            {user.photo ? (\n              <img \n                src={user.photo} \n                alt=\"Profile\" \n                className=\"w-28 h-28 rounded-2xl object-cover border-4 border-white shadow-lg mb-4\" \n              />\n            ) : (\n              <div className=\"w-28 h-28 rounded-2xl bg-gradient-to-br from-teal-400 to-cyan-500 flex items-center justify-center border-4 border-white shadow-lg mb-4\">\n                <span className=\"text-4xl font-bold text-white\">\n                  {user.name?.charAt(0)?.toUpperCase() || 'U'}\n                </span>\n              </div>\n            )}\n            <h3 className=\"text-2xl font-bold text-gray-900\">{user.name}</h3>\n            <span className=\"inline-flex items-center mt-2 px-4 py-1.5 bg-gradient-to-r from-teal-50 to-cyan-50 text-teal-700 rounded-full text-sm font-semibold border border-teal-100\">\n              {user.type === 'landlord' ? (\n                <>\n                  <Home className=\"w-4 h-4 mr-1.5\" />\n                  Landlord\n                </>\n              ) : (\n                <>\n                  <User className=\"w-4 h-4 mr-1.5\" />\n                  Renter\n                </>\n              )}\n            </span>\n          </div>\n\n          {/* Contact Info Cards */}\n          <div className=\"space-y-3 mb-6\">\n            <div className=\"bg-gradient-to-r from-gray-50 to-slate-50 rounded-xl p-4 border border-gray-100 hover:border-gray-200 transition-colors\">\n              <div className=\"flex items-center\">\n                <div className=\"w-11 h-11 bg-gradient-to-br from-teal-100 to-cyan-100 rounded-xl flex items-center justify-center mr-4 shadow-sm\">\n                  <Phone className=\"w-5 h-5 text-teal-600\" />\n                </div>\n                <div>\n                  <p className=\"text-xs font-medium text-gray-500 mb-0.5\">Phone Number</p>\n                  <p className=\"font-semibold text-gray-800\">{user.phone}</p>\n                </div>\n              </div>\n            </div>\n\n            <div className=\"bg-gradient-to-r from-gray-50 to-slate-50 rounded-xl p-4 border border-gray-100 hover:border-gray-200 transition-colors\">\n              <div className=\"flex items-center\">\n                <div className=\"w-11 h-11 bg-gradient-to-br from-cyan-100 to-blue-100 rounded-xl flex items-center justify-center mr-4 shadow-sm\">\n                  <Mail className=\"w-5 h-5 text-cyan-600\" />\n                </div>\n                <div>\n                  <p className=\"text-xs font-medium text-gray-500 mb-0.5\">Email Address</p>\n                  <p className=\"font-semibold text-gray-800\">{user.email}</p>\n                </div>\n              </div>\n            </div>\n\n            <div className=\"bg-gradient-to-r from-gray-50 to-slate-50 rounded-xl p-4 border border-gray-100 hover:border-gray-200 transition-colors\">\n              <div className=\"flex items-center\">\n                <div className=\"w-11 h-11 bg-gradient-to-br from-violet-100 to-purple-100 rounded-xl flex items-center justify-center mr-4 shadow-sm\">\n                  <Calendar className=\"w-5 h-5 text-violet-600\" />\n                </div>\n                <div>\n                  <p className=\"text-xs font-medium text-gray-500 mb-0.5\">Member Since</p>\n                  <p className=\"font-semibold text-gray-800\">\n                    {new Date(user.createdAt).toLocaleDateString('en-ZA', { \n                      year: 'numeric', \n                      month: 'long', \n                      day: 'numeric' \n                    })}\n                  </p>\n                </div>\n              </div>\n            </div>\n          </div>\n\n          {/* Notification Preferences */}\n          <div className=\"bg-gradient-to-br from-teal-50 via-cyan-50 to-sky-50 rounded-xl p-5 border border-teal-100\">\n            <div className=\"flex items-center gap-3 mb-4\">\n              <div className=\"w-10 h-10 bg-gradient-to-br from-teal-500 to-cyan-500 rounded-xl flex items-center justify-center shadow-sm\">\n                <Bell className=\"w-5 h-5 text-white\" />\n              </div>\n              <h4 className=\"font-bold text-gray-800\">Notification Preferences</h4>\n            </div>\n            <div className=\"space-y-3\">\n              <label className=\"flex items-center gap-3 p-3 bg-white rounded-lg border border-gray-100 cursor-pointer hover:border-teal-200 transition-colors\">\n                <input\n                  type=\"checkbox\"\n                  checked={localPrefs.updates}\n                  onChange={() => togglePref('updates')}\n                  className=\"w-5 h-5 rounded border-gray-300 text-teal-600 focus:ring-teal-500\"\n                />\n                <div>\n                  <p className=\"text-sm font-medium text-gray-800\">Room Alerts</p>\n                  <p className=\"text-xs text-gray-500\">Get notified about new rooms in your saved areas</p>\n                </div>\n              </label>\n              <label className=\"flex items-center gap-3 p-3 bg-white rounded-lg border border-gray-100 cursor-pointer hover:border-teal-200 transition-colors\">\n                <input\n                  type=\"checkbox\"\n                  checked={localPrefs.marketing}\n                  onChange={() => togglePref('marketing')}\n                  className=\"w-5 h-5 rounded border-gray-300 text-teal-600 focus:ring-teal-500\"\n                />\n                <div>\n                  <p className=\"text-sm font-medium text-gray-800\">Tips & Updates</p>\n                  <p className=\"text-xs text-gray-500\">Occasional features and helpful content</p>\n                </div>\n              </label>\n            </div>\n            <p className=\"text-[11px] text-gray-500 mt-3 text-center\">Changes save automatically  You can opt out anytime</p>\n          </div>\n\n          {/* Account Linking Section */}\n          <div className=\"bg-gradient-to-br from-blue-50 via-indigo-50 to-violet-50 rounded-xl p-5 border border-blue-100 mt-4\">\n            <div className=\"flex items-center gap-3 mb-4\">\n              <div className=\"w-10 h-10 bg-gradient-to-br from-blue-500 to-indigo-500 rounded-xl flex items-center justify-center shadow-sm\">\n                <Link2 className=\"w-5 h-5 text-white\" />\n              </div>\n              <div>\n                <h4 className=\"font-bold text-gray-800\">Linked Accounts</h4>\n                <p className=\"text-xs text-gray-500\">Connect multiple sign-in methods</p>\n              </div>\n            </div>\n\n            {/* Success/Error Messages */}\n            {linkSuccess && (\n              <div className=\"mb-3 p-3 bg-green-50 border border-green-200 rounded-lg text-green-700 text-sm flex items-center gap-2\">\n                <CheckCircle className=\"w-4 h-4\" />\n                {linkSuccess}\n              </div>\n            )}\n            {linkError && (\n              <div className=\"mb-3 p-3 bg-rose-50 border border-rose-200 rounded-lg text-rose-700 text-sm flex items-center gap-2\">\n                <AlertTriangle className=\"w-4 h-4\" />\n                {linkError}\n              </div>\n            )}\n\n            <div className=\"space-y-2\">\n              {/* Google */}\n              <div className={`flex items-center justify-between p-3 bg-white rounded-lg border ${hasGoogle ? 'border-green-200' : 'border-gray-100'}`}>\n                <div className=\"flex items-center gap-3\">\n                  <svg className=\"w-5 h-5\" viewBox=\"0 0 24 24\">\n                    <path fill=\"#4285F4\" d=\"M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z\"/>\n                    <path fill=\"#34A853\" d=\"M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z\"/>\n                    <path fill=\"#FBBC05\" d=\"M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z\"/>\n                    <path fill=\"#EA4335\" d=\"M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z\"/>\n                  </svg>\n                  <span className=\"font-medium text-gray-700\">Google</span>\n                </div>\n                {hasGoogle ? (\n                  <span className=\"text-xs font-medium text-green-600 flex items-center gap-1\">\n                    <CheckCircle className=\"w-4 h-4\" /> Linked\n                  </span>\n                ) : (\n                  <button\n                    onClick={handleLinkGoogle}\n                    disabled={linkingInProgress === 'google'}\n                    className=\"text-xs font-medium text-blue-600 hover:text-blue-700 px-3 py-1.5 bg-blue-50 hover:bg-blue-100 rounded-lg transition-colors disabled:opacity-50\"\n                  >\n                    {linkingInProgress === 'google' ? 'Linking...' : 'Link'}\n                  </button>\n                )}\n              </div>\n\n              {/* Phone */}\n              <div className={`flex items-center justify-between p-3 bg-white rounded-lg border ${hasPhone ? 'border-green-200' : 'border-gray-100'}`}>\n                <div className=\"flex items-center gap-3\">\n                  <Phone className=\"w-5 h-5 text-green-600\" />\n                  <span className=\"font-medium text-gray-700\">Phone</span>\n                </div>\n                {hasPhone ? (\n                  <span className=\"text-xs font-medium text-green-600 flex items-center gap-1\">\n                    <CheckCircle className=\"w-4 h-4\" /> Linked\n                  </span>\n                ) : (\n                  <button\n                    onClick={handleLinkPhone}\n                    className=\"text-xs font-medium text-blue-600 hover:text-blue-700 px-3 py-1.5 bg-blue-50 hover:bg-blue-100 rounded-lg transition-colors\"\n                  >\n                    Link\n                  </button>\n                )}\n              </div>\n\n              {/* Email/Password */}\n              <div className={`flex items-center justify-between p-3 bg-white rounded-lg border ${hasPassword ? 'border-green-200' : 'border-gray-100'}`}>\n                <div className=\"flex items-center gap-3\">\n                  <Mail className=\"w-5 h-5 text-blue-600\" />\n                  <span className=\"font-medium text-gray-700\">Email & Password</span>\n                </div>\n                {hasPassword ? (\n                  <span className=\"text-xs font-medium text-green-600 flex items-center gap-1\">\n                    <CheckCircle className=\"w-4 h-4\" /> Linked\n                  </span>\n                ) : (\n                  <span className=\"text-xs text-gray-400\">Coming soon</span>\n                )}\n              </div>\n            </div>\n\n            <p className=\"text-[11px] text-gray-500 mt-3 text-center\">Link accounts to sign in with any method</p>\n          </div>\n\n          {/* Sign Out Button */}\n          {onSignOut && (\n            <button\n              onClick={onSignOut}\n              className=\"w-full mt-4 flex items-center justify-center gap-2 px-4 py-3 bg-gray-100 hover:bg-gray-200 text-gray-700 font-semibold rounded-xl transition-colors\"\n            >\n              <LogOut className=\"w-5 h-5\" />\n              Sign Out\n            </button>\n          )}\n        </div>\n      </div>\n    </div>\n  );\n}\n\nfunction LandlordOnboardingView({ onComplete, onCancel, currentUser }) {\n  const [form, setForm] = useState({ businessName: currentUser?.name || '', bankDetails: '', idNumber: '', agree: false });\n\n  const handleSubmit = () => {\n    if (!form.businessName || !form.agree) {\n      alert('Please provide a display name and agree to the terms.');\n      return;\n    }\n    onComplete(form);\n  };\n\n  return (\n    <div className=\"min-h-screen bg-gradient-to-b from-slate-50 to-gray-100 pb-24\">\n      {/* Header Banner */}\n      <div className=\"bg-gradient-to-br from-teal-600 via-teal-500 to-cyan-500 pt-8 pb-16 px-4\">\n        <div className=\"max-w-2xl mx-auto text-center\">\n          <div className=\"w-20 h-20 bg-white/20 backdrop-blur-sm rounded-2xl flex items-center justify-center mx-auto mb-4 border border-white/30\">\n            <span className=\"text-4xl font-bold text-white\">\n              {currentUser?.name?.charAt(0)?.toUpperCase() || 'L'}\n            </span>\n          </div>\n          <h2 className=\"text-2xl font-bold text-white mb-2\">Welcome, {currentUser?.name || 'Landlord'}!</h2>\n          <p className=\"text-teal-100\">Complete your profile to start listing properties</p>\n        </div>\n      </div>\n\n      {/* Form Card */}\n      <div className=\"px-4 -mt-8\">\n        <div className=\"max-w-2xl mx-auto\">\n          <div className=\"bg-white rounded-2xl shadow-xl border border-gray-100 p-8\">\n            {/* Progress Steps */}\n            <div className=\"flex items-center justify-center gap-2 mb-8\">\n              <div className=\"flex items-center gap-2\">\n                <div className=\"w-8 h-8 bg-teal-600 text-white rounded-full flex items-center justify-center text-sm font-bold\">1</div>\n                <span className=\"text-sm font-medium text-gray-700\">Profile Details</span>\n              </div>\n              <div className=\"w-8 h-0.5 bg-gray-200\"></div>\n              <div className=\"flex items-center gap-2\">\n                <div className=\"w-8 h-8 bg-gray-200 text-gray-500 rounded-full flex items-center justify-center text-sm font-bold\">2</div>\n                <span className=\"text-sm text-gray-400\">Start Listing</span>\n              </div>\n            </div>\n\n            <div className=\"space-y-5\">\n              <div>\n                <label className=\"block text-sm font-semibold text-gray-800 mb-2\">Display Name *</label>\n                <input \n                  value={form.businessName} \n                  onChange={(e) => setForm({ ...form, businessName: e.target.value })} \n                  className=\"w-full px-4 py-3 border border-gray-200 rounded-xl focus:ring-2 focus:ring-teal-500 focus:border-teal-500 transition-all\" \n                  placeholder=\"Your name or business name\"\n                />\n                <p className=\"text-xs text-gray-500 mt-1.5\">This name is shown to renters on your listings and messages.</p>\n              </div>\n\n              <div>\n                <label className=\"block text-sm font-semibold text-gray-800 mb-2\">Payment Details (Optional)</label>\n                <input \n                  value={form.bankDetails} \n                  onChange={(e) => setForm({ ...form, bankDetails: e.target.value })} \n                  placeholder=\"Bank account or preferred payment method\" \n                  className=\"w-full px-4 py-3 border border-gray-200 rounded-xl focus:ring-2 focus:ring-teal-500 focus:border-teal-500 transition-all\" \n                />\n                <p className=\"text-xs text-gray-500 mt-1.5\">Private - only shown to confirmed renters.</p>\n              </div>\n\n              <div>\n                <label className=\"block text-sm font-semibold text-gray-800 mb-2\">ID Number (Optional)</label>\n                <input \n                  value={form.idNumber} \n                  onChange={(e) => setForm({ ...form, idNumber: e.target.value })} \n                  className=\"w-full px-4 py-3 border border-gray-200 rounded-xl focus:ring-2 focus:ring-teal-500 focus:border-teal-500 transition-all\" \n                  placeholder=\"For verification purposes\"\n                />\n                <p className=\"text-xs text-gray-500 mt-1.5\">Verified landlords get a trust badge on their listings.</p>\n              </div>\n\n              <div className=\"bg-gradient-to-r from-teal-50 to-cyan-50 rounded-xl p-4 border border-teal-100\">\n                <label className=\"flex items-start gap-3 cursor-pointer\">\n                  <input \n                    type=\"checkbox\" \n                    checked={form.agree} \n                    onChange={(e) => setForm({ ...form, agree: e.target.checked })} \n                    className=\"mt-1 w-5 h-5 rounded border-gray-300 text-teal-600 focus:ring-teal-500\"\n                  />\n                  <span className=\"text-sm text-gray-700\">\n                    I confirm I am authorised to list these properties and agree to the{' '}\n                    <button type=\"button\" onClick={(e) => e.preventDefault()} className=\"text-teal-600 hover:text-teal-700 font-medium underline\">\n                      terms of service\n                    </button>.\n                  </span>\n                </label>\n              </div>\n\n              <div className=\"flex gap-3 pt-4\">\n                <button \n                  onClick={onCancel} \n                  className=\"flex-1 bg-gray-100 hover:bg-gray-200 text-gray-700 font-medium py-3.5 rounded-xl transition-colors\"\n                >\n                  Cancel\n                </button>\n                <button \n                  onClick={handleSubmit} \n                  className=\"flex-1 bg-gradient-to-r from-teal-600 to-cyan-600 hover:from-teal-700 hover:to-cyan-700 text-white font-semibold py-3.5 rounded-xl transition-all shadow-md hover:shadow-lg\"\n                >\n                  Complete & Start Listing\n                </button>\n              </div>\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n}\n\nfunction EditProfileView({ user, onSubmit, onCancel }) {\n  const [formData, setFormData] = useState({\n    name: user.name || '',\n    phone: user.phone || '',\n    email: user.email || '',\n    whatsapp: user.whatsapp || '',\n    photo: user.photo || ''\n  });\n  const [errors, setErrors] = useState({});\n  const [touched, setTouched] = useState({});\n\n  const validateField = (name, value, extras = {}) => {\n    const newErrors = { ...errors };\n    switch (name) {\n      case 'name':\n        if (!value || value.trim().length < 2) {\n          newErrors.name = 'Name must be at least 2 characters';\n        } else {\n          delete newErrors.name;\n        }\n        break;\n      case 'phone':\n        if (!value || !/^[+]?[-0-9()\\s]{7,}$/.test(value.trim())) {\n          newErrors.phone = 'Enter a valid phone number';\n        } else {\n          delete newErrors.phone;\n        }\n        break;\n      case 'email':\n        if (!value || !/^[^@\\s]+@[^@\\s]+\\.[^@\\s]+$/.test(value.trim())) {\n          newErrors.email = 'Enter a valid email';\n        } else {\n          delete newErrors.email;\n        }\n        break;\n      default:\n        break;\n    }\n    setErrors(newErrors);\n  };\n\n  const handlePhotoUpload = (e) => {\n    const file = e.target.files[0];\n    if (file) {\n      const reader = new FileReader();\n      reader.onloadend = () => {\n        setFormData({ ...formData, photo: reader.result });\n      };\n      reader.readAsDataURL(file);\n    }\n  };\n\n  const handleSubmit = () => {\n    setTouched({ name: true, phone: true, email: true });\n    validateField('name', formData.name);\n    validateField('phone', formData.phone);\n    validateField('email', formData.email);\n    if (Object.keys(errors).length === 0 && formData.name && formData.phone && formData.email) {\n      onSubmit(formData);\n    }\n  };\n\n  return (\n    <div className=\"p-4 min-h-screen bg-gradient-to-b from-slate-50 to-gray-100 pb-24\">\n      <div className=\"max-w-2xl mx-auto mt-8\">\n        <div className=\"bg-white rounded-2xl shadow-lg border border-gray-100 p-8\">\n          <div className=\"flex items-center justify-between mb-8\">\n            <h2 className=\"text-3xl font-extrabold text-gray-900\">Edit Profile</h2>\n            <button onClick={onCancel} className=\"text-gray-400 hover:text-gray-600 transition\">\n              <X className=\"w-6 h-6\" />\n            </button>\n          </div>\n\n          <div className=\"space-y-6\">\n            {/* Photo Upload */}\n            <div className=\"flex justify-center mb-8\">\n              <div className=\"relative\">\n                {formData.photo ? (\n                  <img src={formData.photo} alt=\"Profile\" className=\"w-32 h-32 rounded-full object-cover border-4 border-blue-200 shadow-lg\" />\n                ) : (\n                  <div className=\"w-32 h-32 rounded-full bg-gradient-to-br from-blue-100 to-blue-200 flex items-center justify-center border-4 border-blue-200 shadow-lg\">\n                    <User className=\"w-16 h-16 text-blue-600\" />\n                  </div>\n                )}\n                <label className=\"absolute bottom-0 right-0 bg-blue-600 hover:bg-blue-700 text-white p-3 rounded-full cursor-pointer shadow-lg transition\" aria-label=\"Upload new profile photo\">\n                  <Edit className=\"w-5 h-5\" />\n                  <input\n                    type=\"file\"\n                    accept=\"image/*\"\n                    onChange={handlePhotoUpload}\n                    className=\"hidden\"\n                  />\n                </label>\n              </div>\n            </div>\n\n            {/* Form Fields */}\n            <div>\n              <label className=\"block text-sm font-semibold text-gray-800 mb-2\">Full Name</label>\n              <input\n                type=\"text\"\n                required\n                value={formData.name}\n                onChange={(e) => { setFormData({ ...formData, name: e.target.value }); if (touched.name) validateField('name', e.target.value); }}\n                onBlur={(e) => { setTouched({ ...touched, name: true }); validateField('name', e.target.value); }}\n                aria-invalid={errors.name ? 'true' : 'false'}\n                aria-describedby={errors.name ? 'edit-name-error' : undefined}\n                className={`w-full px-4 py-3 border-2 ${errors.name ? 'border-red-400' : 'border-gray-200'} bg-white text-gray-800 rounded-xl focus:ring-2 focus:ring-teal-400 focus:border-transparent transition placeholder-gray-400`}\n              />\n              {errors.name && touched.name && <p id=\"edit-name-error\" className=\"mt-1 text-xs text-red-600\">{errors.name}</p>}\n            </div>\n\n            <div>\n              <label className=\"block text-sm font-semibold text-gray-800 mb-2\">Phone Number</label>\n              <div className=\"relative\">\n                <Phone className=\"absolute left-4 top-3.5 w-5 h-5 text-gray-400\" />\n                <input\n                  type=\"tel\"\n                  required\n                  value={formData.phone}\n                  onChange={(e) => { setFormData({ ...formData, phone: e.target.value }); if (touched.phone) validateField('phone', e.target.value); }}\n                  onBlur={(e) => { setTouched({ ...touched, phone: true }); validateField('phone', e.target.value); }}\n                  aria-invalid={errors.phone ? 'true' : 'false'}\n                  aria-describedby={errors.phone ? 'edit-phone-error' : undefined}\n                  className={`w-full pl-11 pr-4 py-3 border-2 ${errors.phone ? 'border-red-400' : 'border-gray-200'} bg-white text-gray-800 rounded-xl focus:ring-2 focus:ring-teal-400 focus:border-transparent transition placeholder-gray-400`}\n                />\n              </div>\n              {errors.phone && touched.phone && <p id=\"edit-phone-error\" className=\"mt-1 text-xs text-red-600\">{errors.phone}</p>}\n            </div>\n\n            <div>\n              <label className=\"block text-sm font-semibold text-gray-800 mb-2\">Email Address</label>\n              <div className=\"relative\">\n                <Mail className=\"absolute left-4 top-3.5 w-5 h-5 text-gray-400\" />\n                <input\n                  type=\"email\"\n                  required\n                  value={formData.email}\n                  onChange={(e) => { setFormData({ ...formData, email: e.target.value }); if (touched.email) validateField('email', e.target.value); }}\n                  onBlur={(e) => { setTouched({ ...touched, email: true }); validateField('email', e.target.value); }}\n                  aria-invalid={errors.email ? 'true' : 'false'}\n                  aria-describedby={errors.email ? 'edit-email-error' : undefined}\n                  className={`w-full pl-11 pr-4 py-3 border-2 ${errors.email ? 'border-red-400' : 'border-gray-200'} bg-white text-gray-800 rounded-xl focus:ring-2 focus:ring-teal-400 focus:border-transparent transition placeholder-gray-400`}\n                />\n              </div>\n              {errors.email && touched.email && <p id=\"edit-email-error\" className=\"mt-1 text-xs text-red-600\">{errors.email}</p>}\n            </div>\n\n            <div>\n              <label className=\"block text-sm font-semibold text-gray-800 mb-2\">WhatsApp (optional)</label>\n              <div className=\"relative\">\n                <Phone className=\"absolute left-4 top-3.5 w-5 h-5 text-gray-400\" />\n                <input\n                  type=\"tel\"\n                  value={formData.whatsapp}\n                  onChange={(e) => setFormData({ ...formData, whatsapp: e.target.value })}\n                  placeholder=\"e.g., +27 71 234 5678\"\n                  className=\"w-full pl-11 pr-4 py-3 border-2 border-gray-200 bg-white text-gray-800 rounded-xl focus:ring-2 focus:ring-teal-400 focus:border-transparent transition placeholder-gray-400\"\n                />\n              </div>\n              <p className=\"text-xs text-gray-500 mt-1\">Used to create a WhatsApp chat link on your listings.</p>\n            </div>\n\n            {/* Action Buttons */}\n            <div className=\"flex gap-3 pt-6 border-t border-gray-200\">\n              <button\n                onClick={onCancel}\n                className=\"flex-1 bg-gray-100 hover:bg-gray-200 text-gray-800 font-semibold py-3 rounded-xl transition\"\n              >\n                Cancel\n              </button>\n              <button\n                onClick={handleSubmit}\n                className=\"flex-1 bg-gradient-to-r from-teal-500 to-cyan-500 hover:from-teal-600 hover:to-cyan-600 text-white font-semibold py-3 rounded-xl transition shadow-lg\"\n              >\n                Save Changes\n              </button>\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n}\n\n/* BrowseView extracted to components/BrowseView.jsx */\n\nfunction FavoritesView({ listings, onSelectListing }) {\n  const [favorites, setFavorites] = useState([]);\n\n  useEffect(() => {\n    try {\n      const rawFavorites = localStorage.getItem('favorites');\n      if (rawFavorites) {\n        const arr = JSON.parse(rawFavorites);\n        if (Array.isArray(arr)) setFavorites(arr);\n      }\n    } catch {}\n  }, []);\n\n  const toggleFavorite = (listingId) => {\n    setFavorites(prev => {\n      const updated = prev.filter(id => id !== listingId);\n      try {\n        localStorage.setItem('favorites', JSON.stringify(updated));\n      } catch {}\n      return updated;\n    });\n  };\n\n  const favoriteListings = listings.filter(l => favorites.includes(l.id));\n\n  return (\n    <div className=\"p-4 min-h-screen bg-gradient-to-b from-slate-50 to-gray-100 pb-24\">\n      <div className=\"max-w-7xl mx-auto mt-8\">\n        <div className=\"mb-8\">\n          <div className=\"flex items-center gap-4 mb-3\">\n            <div className=\"w-14 h-14 bg-gradient-to-br from-rose-100 to-pink-100 rounded-2xl flex items-center justify-center shadow-sm\">\n              <Heart className=\"w-7 h-7 text-rose-500 fill-rose-500\" />\n            </div>\n            <div>\n              <h2 className=\"text-3xl font-extrabold text-gray-900\">Saved Listings</h2>\n              <p className=\"text-gray-600\">\n                {favoriteListings.length === 0\n                  ? 'Your favorites will appear here'\n                  : `${favoriteListings.length} saved ${favoriteListings.length === 1 ? 'listing' : 'listings'}`}\n              </p>\n            </div>\n          </div>\n        </div>\n\n        {favoriteListings.length === 0 ? (\n          <div className=\"bg-white rounded-2xl border border-gray-100 shadow-sm p-12 text-center\">\n            <div className=\"w-24 h-24 bg-gradient-to-br from-rose-50 to-pink-50 rounded-full flex items-center justify-center mx-auto mb-6\">\n              <Heart className=\"w-12 h-12 text-rose-300\" />\n            </div>\n            <h3 className=\"text-xl font-bold text-gray-800 mb-2\">No saved listings yet</h3>\n            <p className=\"text-gray-500 text-sm mb-6 max-w-md mx-auto\">\n              Browse rooms and tap the heart icon to save your favorites. They'll appear here for easy access.\n            </p>\n          </div>\n        ) : (\n          <div className=\"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6\">\n            {favoriteListings.map(listing => {\n              const ListingCard = require('./components/ListingCard').default;\n              return (\n                <ListingCard\n                  key={listing.id}\n                  listing={listing}\n                  onClick={() => onSelectListing(listing)}\n                  isFavorite={true}\n                  onToggleFavorite={toggleFavorite}\n                />\n              );\n            })}\n          </div>\n        )}\n      </div>\n    </div>\n  );\n}\n\nconst createDefaultListingForm = () => ({\n  title: '',\n  price: '',\n  location: '',\n  streetAddress: '',\n  description: '',\n  photos: [],\n  status: 'available',\n  availableDate: new Date().toISOString().split('T')[0],\n  amenities: [],\n  latitude: null,\n  longitude: null,\n  paymentMethod: 'Bank and Cash',\n  roomType: 'private',\n  leaseDuration: '7-12',\n  petFriendly: false,\n  genderPreference: 'any',\n  premium: false\n});\n\nfunction AddListingView({ onSubmit, onCancel, currentUser, userType, onRequireAuth, onRequireOnboarding }) {\n  const GEOCODER_KEY = process.env.REACT_APP_GEOCODER_API_KEY;\n  const GEOCODER_PROVIDER = (process.env.REACT_APP_GEOCODER_PROVIDER || '').toLowerCase();\n\n  const landlordId = currentUser?.id;\n  const [formData, setFormData] = useState(() => {\n    const base = createDefaultListingForm();\n    if (landlordId) {\n      const saved = loadListingTemplate(landlordId);\n      if (saved) {\n        return {\n          ...base,\n          ...saved,\n          amenities: Array.isArray(saved.amenities) ? saved.amenities : base.amenities,\n          petFriendly: saved.petFriendly ?? base.petFriendly,\n          premium: saved.premium ?? base.premium,\n          photos: []\n        };\n      }\n    }\n    return base;\n  });\n  const [geocodingStatus, setGecodingStatus] = useState('');\n  const [errors, setErrors] = useState({});\n  const [showPhotoEditor, setShowPhotoEditor] = useState(false);\n  const reverseGeocodeCacheRef = React.useRef({});\n  const [lastGeocodeSource, setLastGeocodeSource] = useState(null); // 'cached' | 'mapbox' | 'proxy' | 'direct' | 'coords-only' | 'manual-geocode'\n  const [fullAddressInput, setFullAddressInput] = useState('');\n  const [isFullAddressEditing, setIsFullAddressEditing] = useState(false);\n\n  useEffect(() => {\n    if (!landlordId) return;\n    const saved = loadListingTemplate(landlordId);\n    if (saved) {\n      setFormData(prev => ({\n        ...prev,\n        ...saved,\n        amenities: Array.isArray(saved.amenities) ? saved.amenities : [],\n        petFriendly: saved.petFriendly ?? false,\n        premium: saved.premium ?? false,\n        photos: []\n      }));\n    } else {\n      setFormData(createDefaultListingForm());\n    }\n  }, [landlordId]);\n\n  useEffect(() => {\n    if (!landlordId || userType !== 'landlord') return;\n    saveListingTemplate(landlordId, formData);\n  }, [formData, landlordId, userType]);\n\n  // Warn user before leaving if form has unsaved data\n  useEffect(() => {\n    const hasFormData = formData.title || formData.description || formData.photos?.length > 0;\n    \n    const handleBeforeUnload = (e) => {\n      if (hasFormData) {\n        e.preventDefault();\n        e.returnValue = '';\n        return '';\n      }\n    };\n    \n    if (hasFormData) {\n      window.addEventListener('beforeunload', handleBeforeUnload);\n    }\n    \n    return () => {\n      window.removeEventListener('beforeunload', handleBeforeUnload);\n    };\n  }, [formData.title, formData.description, formData.photos]);\n\n  // Helper: fetch with graceful fallbacks when third-party APIs lack CORS headers\n  const corsFallbackTransforms = useMemo(() => [\n    (url) => url.startsWith('https://cors.isomorphic-git.org/') ? url : `https://cors.isomorphic-git.org/${url}`,\n    (url) => url.startsWith('https://corsproxy.io/?') ? url : `https://corsproxy.io/?${encodeURIComponent(url)}`\n  ], []);\n\n  const fetchWithCorsFallback = useCallback(async (url, options = {}) => {\n    const cloneOptions = () => {\n      const base = { ...options };\n      if (options.headers) base.headers = { ...options.headers };\n      return base;\n    };\n\n    const attempt = async (targetUrl) => {\n      const resp = await fetch(targetUrl, cloneOptions());\n      if (!resp.ok) throw new Error(`Request failed with status ${resp.status}`);\n      return resp;\n    };\n\n    try {\n      return await attempt(url);\n    } catch (err) {\n      if (options.signal?.aborted) throw err;\n      let lastError = err;\n      for (const transform of corsFallbackTransforms) {\n        try {\n          const proxiedUrl = transform(url);\n          return await attempt(proxiedUrl);\n        } catch (proxyErr) {\n          lastError = proxyErr;\n          if (options.signal?.aborted) break;\n        }\n      }\n      throw lastError;\n    }\n  }, [corsFallbackTransforms]);\n\n  // Forward geocode helper for manual address lookups\n  const forwardGeocodeAddress = async (query) => {\n    if (!query || query.trim().length < 3) return [];\n\n    // 1. Mapbox (if configured)\n    if (GEOCODER_PROVIDER === 'mapbox' && GEOCODER_KEY) {\n      try {\n        const resp = await fetch(`https://api.mapbox.com/geocoding/v5/mapbox.places/${encodeURIComponent(query)}.json?access_token=${GEOCODER_KEY}&limit=3&country=za&types=address,place,locality`);\n        const data = await resp.json();\n        if (data?.features?.length) {\n          return data.features.map(f => ({\n            lat: f.center ? f.center[1] : f.geometry?.coordinates?.[1],\n            lon: f.center ? f.center[0] : f.geometry?.coordinates?.[0],\n            label: f.place_name || f.text,\n            source: 'mapbox'\n          })).filter(entry => typeof entry.lat === 'number' && typeof entry.lon === 'number');\n        }\n      } catch (err) {\n        console.warn('Mapbox forward geocode failed', err);\n      }\n    }\n\n    // 2. maps.co (CORS-friendly)\n    try {\n      const mapsResp = await fetch(`https://geocode.maps.co/search?q=${encodeURIComponent(query)}&limit=3`);\n      if (mapsResp.ok) {\n        const mapsData = await mapsResp.json();\n        if (Array.isArray(mapsData) && mapsData.length) {\n          return mapsData.slice(0, 3).map(entry => ({\n            lat: parseFloat(entry.lat),\n            lon: parseFloat(entry.lon),\n            label: entry.display_name || entry.name,\n            source: 'maps.co'\n          }));\n        }\n      }\n    } catch (mapsErr) {\n      console.warn('maps.co forward geocode failed', mapsErr);\n    }\n\n    // 3. Local proxy (if running)\n    const API_BASE = (process.env.REACT_APP_PROXY_BASE || (window.location && window.location.port === '8443' ? 'https://localhost:4443' : ''));\n    if (API_BASE) {\n      try {\n        const proxyResp = await fetch(`${API_BASE}/api/search?q=${encodeURIComponent(query)}`);\n        if (proxyResp.ok) {\n          const proxyData = await proxyResp.json();\n          if (Array.isArray(proxyData) && proxyData.length) {\n            return proxyData.slice(0, 3).map(entry => ({\n              lat: parseFloat(entry.lat),\n              lon: parseFloat(entry.lon),\n              label: entry.display_name,\n              source: API_BASE.includes('localhost') ? 'local-proxy' : 'proxy'\n            }));\n          }\n        }\n      } catch (proxyErr) {\n        console.warn('Local proxy forward geocode failed', proxyErr);\n      }\n    }\n\n    // 4. Direct Nominatim fallback (may still be blocked, but last resort)\n    try {\n      const directResp = await fetchWithCorsFallback(`https://nominatim.openstreetmap.org/search?format=json&addressdetails=1&q=${encodeURIComponent(query)}`, {\n        headers: {\n          'User-Agent': 'room-rental-platform/1.0 (direct fallback)',\n          'Accept': 'application/json'\n        }\n      });\n      if (directResp.ok) {\n        const directData = await directResp.json();\n        if (Array.isArray(directData) && directData.length) {\n          return directData.slice(0, 3).map(entry => ({\n            lat: parseFloat(entry.lat),\n            lon: parseFloat(entry.lon),\n            label: entry.display_name,\n            source: 'direct'\n          }));\n        }\n      }\n    } catch (directErr) {\n      console.warn('Direct nominatim forward geocode failed', directErr);\n    }\n\n    return [];\n  };\n\n  const availableAmenities = [\n    'WiFi', 'Parking', 'Kitchen', 'Laundry', 'Air Conditioning', \n    'Heating', 'TV', 'Furnished', 'Pet Friendly', 'Garden'\n  ];\n\n  const validateField = (name, value, extras = {}) => {\n    const newErrors = { ...errors };\n    \n    switch (name) {\n      case 'title':\n        if (!value || value.trim().length < 5) {\n          newErrors.title = 'Title must be at least 5 characters';\n        } else {\n          delete newErrors.title;\n        }\n        break;\n      case 'price':\n        if (!value || parseFloat(value) <= 0) {\n          newErrors.price = 'Price must be greater than 0';\n        } else if (parseFloat(value) < 500) {\n          newErrors.price = 'Price seems too low (minimum R500)';\n        } else if (parseFloat(value) > 50000) {\n          newErrors.price = 'Price seems too high (maximum R50,000)';\n        } else {\n          delete newErrors.price;\n        }\n        break;\n      case 'location': {\n        const streetText = (extras.streetAddress ?? formData.streetAddress ?? '').trim();\n        const areaText = (extras.location ?? value ?? '').trim();\n        if (!streetText || streetText.length < 3) {\n          newErrors.location = 'Add the street or stand number (e.g., 5170 Molefe St)';\n        } else if (!areaText || areaText.length < 3) {\n          newErrors.location = 'Add the suburb, city, and postal code (e.g., Ivory Park, Midrand, 1693)';\n        } else {\n          delete newErrors.location;\n        }\n        break;\n      }\n      case 'description':\n        if (value && value.length > 500) {\n          newErrors.description = 'Description is too long (max 500 characters)';\n        } else {\n          delete newErrors.description;\n        }\n        break;\n      default:\n        break;\n    }\n    \n    setErrors(newErrors);\n  };\n\n  \n\n  // Load persisted reverse geocode cache\n  useEffect(() => {\n    try {\n      const raw = localStorage.getItem('reverse-geocode-cache');\n      if (raw) {\n        const parsed = JSON.parse(raw);\n        if (parsed && typeof parsed === 'object') {\n          reverseGeocodeCacheRef.current = parsed;\n        }\n      }\n    } catch (e) { /* ignore */ }\n  }, []);\n\n  // Geocode address using Nominatim (OpenStreetMap)\n  const geocodeAddress = async () => {\n    if (!formData.streetAddress) {\n      setGecodingStatus('Please enter a street address');\n      return;\n    }\n    \n    setGecodingStatus('Finding coordinates...');\n    try {\n      const fullAddress = `${formData.streetAddress}, ${formData.location}, South Africa`;\n      const results = await forwardGeocodeAddress(fullAddress);\n\n      if (results.length > 0) {\n        const best = results[0];\n        setFormData({ \n          ...formData, \n          latitude: parseFloat(best.lat), \n          longitude: parseFloat(best.lon) \n        });\n        setGecodingStatus(` Address found!`);\n        setTimeout(() => setGecodingStatus(''), 2000);\n        setLastGeocodeSource(best.source || 'manual-geocode');\n        return;\n      }\n\n      setGecodingStatus('Address not found. Trying with area only...');\n      const areaResults = await forwardGeocodeAddress(`${formData.location}, South Africa`);\n      if (areaResults.length > 0) {\n        const bestArea = areaResults[0];\n        setFormData({ \n          ...formData, \n          latitude: parseFloat(bestArea.lat), \n          longitude: parseFloat(bestArea.lon) \n        });\n        setGecodingStatus(' Area found!');\n        setTimeout(() => setGecodingStatus(''), 2000);\n        setLastGeocodeSource(bestArea.source || 'manual-geocode');\n      } else {\n        setGecodingStatus('Could not find location');\n      }\n    } catch (error) {\n      console.error('Geocoding error:', error);\n      setGecodingStatus('Error finding address. Check your connection.');\n      setLastGeocodeSource(null);\n    }\n  };\n\n  const toggleAmenity = (amenity) => {\n    if (formData.amenities.includes(amenity)) {\n      setFormData({ ...formData, amenities: formData.amenities.filter(a => a !== amenity) });\n    } else {\n      setFormData({ ...formData, amenities: [...formData.amenities, amenity] });\n    }\n  };\n\n  const [isSubmitting, setIsSubmitting] = useState(false);\n\n  const handleSubmit = async () => {\n    // Enforce auth and onboarding checks before allowing submission\n    if (!currentUser) {\n      onRequireAuth && onRequireAuth('landlord');\n      return;\n    }\n    if (userType !== 'landlord') {\n      // prompt to become landlord\n      onRequireAuth && onRequireAuth('landlord');\n      return;\n    }\n    if (!currentUser.landlordComplete) {\n      // send to onboarding\n      onRequireOnboarding && onRequireOnboarding();\n      return;\n    }\n\n    // Validate all fields\n    validateField('title', formData.title);\n    validateField('price', formData.price);\n    validateField('location', formData.location, {\n      location: formData.location,\n      streetAddress: formData.streetAddress\n    });\n    validateField('description', formData.description);\n\n    if (!formData.title || formData.title.trim().length < 5) {\n      setErrors(prev => ({ ...prev, title: 'Title must be at least 5 characters' }));\n      return;\n    }\n    if (!formData.price || parseFloat(formData.price) <= 0) {\n      setErrors(prev => ({ ...prev, price: 'Price must be greater than 0' }));\n      return;\n    }\n    if (!formData.location || formData.location.trim().length < 3) {\n      setErrors(prev => ({ ...prev, location: 'Location is required' }));\n      return;\n    }\n    if (Object.keys(errors).length > 0) {\n      return;\n    }\n\n    setIsSubmitting(true);\n    try {\n      await onSubmit(formData);\n    } finally {\n      setIsSubmitting(false);\n    }\n  };\n\n  const googleMapsQuery = [formData.streetAddress, formData.location, 'South Africa']\n    .filter(Boolean)\n    .join(', ');\n  const googleMapsUrl = googleMapsQuery\n    ? `https://www.google.com/maps/search/?api=1&query=${encodeURIComponent(googleMapsQuery)}`\n    : '';\n  const combinedFormAddress = [formData.streetAddress, formData.location]\n    .map(part => (part || '').trim())\n    .filter(Boolean)\n    .join(', ');\n\n  useEffect(() => {\n    if (isFullAddressEditing) return;\n    setFullAddressInput(prev => (prev === combinedFormAddress ? prev : combinedFormAddress));\n  }, [combinedFormAddress, isFullAddressEditing]);\n\n  const handleFullAddressChange = (value) => {\n    setFullAddressInput(value);\n    if (!value || value.length < 3) {\n      setFormData(prev => ({ ...prev, streetAddress: '', location: '' }));\n      validateField('location', '');\n      return;\n    }\n\n    const parts = value\n      .split(',')\n      .map(part => part.trim())\n      .filter(Boolean);\n\n    if (parts.length === 0) {\n      setFormData(prev => ({ ...prev, streetAddress: '', location: '' }));\n      validateField('location', '');\n      return;\n    }\n\n    let street = parts[0] || '';\n    let derivedLocation = parts.slice(1).join(', ');\n\n    if (!derivedLocation) {\n      const words = street.split(/\\s+/).filter(Boolean);\n      if (words.length >= 4) {\n        // Guess that the last few tokens describe the suburb/city/postal portion.\n        const locationWordCount = Math.min(4, Math.ceil(words.length / 2));\n        derivedLocation = words.slice(-locationWordCount).join(' ');\n        street = words.slice(0, words.length - locationWordCount).join(' ');\n      } else {\n        derivedLocation = street;\n      }\n    }\n\n    setFormData(prev => ({\n      ...prev,\n      streetAddress: street,\n      location: derivedLocation\n    }));\n    validateField('location', derivedLocation || street, {\n      location: derivedLocation,\n      streetAddress: street\n    });\n  };\n\n  const handleResetSavedTemplate = () => {\n    if (!landlordId) return;\n    clearListingTemplate(landlordId);\n    const blank = createDefaultListingForm();\n    setFormData(blank);\n    setFullAddressInput('');\n  };\n\n  return (\n    <div className=\"p-4 bg-gradient-to-b from-slate-50 to-gray-100 min-h-screen pb-24\">\n      <div className=\"max-w-3xl mx-auto mt-8\">\n        <div className=\"bg-white rounded-2xl shadow-lg border border-gray-100 p-8\">\n          <div className=\"flex items-center justify-between mb-6\">\n            <h2 className=\"text-3xl font-extrabold text-gray-900\">Post a Room</h2>\n            <button onClick={onCancel} className=\"text-gray-400 hover:text-gray-600 transition-colors p-2 rounded-full hover:bg-gray-100\">\n              <X className=\"w-6 h-6\" />\n            </button>\n          </div>\n\n          {/* Progress Indicator */}\n          <div className=\"mb-8\">\n            <div className=\"flex justify-between items-center mb-2\">\n              <span className=\"text-sm font-medium text-gray-600\">Form Progress</span>\n              <span className=\"text-sm font-semibold text-teal-600\">\n                {(() => {\n                  let completed = 0;\n                  const total = 5;\n                  if (formData.title && formData.title.trim().length >= 5) completed++;\n                  if (formData.price && parseFloat(formData.price) >= 500) completed++;\n                  if (formData.streetAddress && formData.location) completed++;\n                  if (formData.description && formData.description.length >= 10) completed++;\n                  if (formData.photos && formData.photos.length > 0) completed++;\n                  return `${completed}/${total} completed`;\n                })()}\n              </span>\n            </div>\n            <div className=\"h-2 bg-gray-100 rounded-full overflow-hidden\">\n              <div \n                className=\"h-full bg-gradient-to-r from-teal-500 to-cyan-500 rounded-full transition-all duration-500\"\n                style={{\n                  width: `${(() => {\n                    let completed = 0;\n                    if (formData.title && formData.title.trim().length >= 5) completed++;\n                    if (formData.price && parseFloat(formData.price) >= 500) completed++;\n                    if (formData.streetAddress && formData.location) completed++;\n                    if (formData.description && formData.description.length >= 10) completed++;\n                    if (formData.photos && formData.photos.length > 0) completed++;\n                    return (completed / 5) * 100;\n                  })()}%`\n                }}\n              />\n            </div>\n          </div>\n\n          <div className=\"space-y-6\">\n            {currentUser?.type === 'landlord' && (\n              <div className=\"bg-gradient-to-r from-teal-50 to-cyan-50 border border-teal-200 text-teal-800 text-sm rounded-xl p-4 flex items-start gap-3\">\n                <CheckCircle className=\"w-5 h-5 text-teal-600 mt-0.5\" />\n                <div className=\"space-y-2\">\n                  <p>\n                    We remember your latest listing details (address, price, and more) so you only need to upload fresh photos next time.\n                    Update any field below and we'll save it automatically.\n                  </p>\n                  <button\n                    type=\"button\"\n                    onClick={handleResetSavedTemplate}\n                    className=\"text-xs font-semibold text-teal-700 underline hover:text-teal-900 transition-colors\"\n                  >\n                    Reset saved info\n                  </button>\n                </div>\n              </div>\n            )}\n            {/* Title */}\n            <div>\n              <label className=\"block text-sm font-semibold text-gray-800 mb-2\">\n                Room Title *\n                {formData.title && formData.title.trim().length >= 5 && !errors.title && (\n                  <span className=\"ml-2 text-green-600 text-xs\"> Looks good</span>\n                )}\n              </label>\n              <div className=\"relative\">\n                <input\n                  type=\"text\"\n                  required\n                  value={formData.title}\n                  onChange={(e) => {\n                    setFormData({ ...formData, title: e.target.value });\n                    validateField('title', e.target.value);\n                  }}\n                  onBlur={(e) => validateField('title', e.target.value)}\n                  placeholder=\"e.g., Cozy backroom with private bathroom\"\n                  className={`w-full px-4 py-3 pr-10 border-2 ${\n                    errors.title ? 'border-red-400 bg-red-50' : \n                    formData.title && formData.title.trim().length >= 5 ? 'border-teal-400 bg-teal-50/30' : \n                    'border-gray-200'\n                  } text-gray-800 rounded-xl focus:ring-2 ${\n                    errors.title ? 'focus:ring-red-400' : 'focus:ring-teal-400'\n                  } focus:border-transparent transition-all placeholder-gray-400`}\n                />\n                {formData.title && formData.title.trim().length >= 5 && !errors.title && (\n                  <CheckCircle className=\"absolute right-3 top-1/2 -translate-y-1/2 w-5 h-5 text-teal-600\" />\n                )}\n              </div>\n              {errors.title && <p className=\"text-red-500 text-xs mt-1 flex items-center gap-1\"><span></span> {errors.title}</p>}\n            </div>\n\n            {/* Price */}\n            <div>\n              <label className=\"block text-sm font-semibold text-gray-800 mb-2\">\n                Monthly Price (R) *\n                {formData.price && parseFloat(formData.price) >= 500 && parseFloat(formData.price) <= 50000 && !errors.price && (\n                  <span className=\"ml-2 text-green-600 text-xs\"> Valid price</span>\n                )}\n              </label>\n              <div className=\"relative\">\n                <span className=\"absolute left-4 top-1/2 -translate-y-1/2 text-gray-500 font-medium\">R</span>\n                <input\n                  type=\"number\"\n                  required\n                  value={formData.price}\n                  onChange={(e) => {\n                    setFormData({ ...formData, price: e.target.value });\n                    validateField('price', e.target.value);\n                  }}\n                  onBlur={(e) => validateField('price', e.target.value)}\n                  placeholder=\"2500\"\n                  min=\"500\"\n                  max=\"50000\"\n                  className={`w-full pl-10 pr-4 py-3 border-2 ${\n                    errors.price ? 'border-red-400 bg-red-50' : \n                    formData.price && parseFloat(formData.price) >= 500 && parseFloat(formData.price) <= 50000 ? 'border-teal-400 bg-teal-50/30' : \n                    'border-gray-200'\n                  } text-gray-800 rounded-xl focus:ring-2 ${\n                    errors.price ? 'focus:ring-red-400' : 'focus:ring-teal-400'\n                  } focus:border-transparent transition-all placeholder-gray-400`}\n                />\n                {formData.price && parseFloat(formData.price) >= 500 && parseFloat(formData.price) <= 50000 && !errors.price && (\n                  <CheckCircle className=\"absolute right-3 top-1/2 -translate-y-1/2 w-5 h-5 text-teal-600\" />\n                )}\n              </div>\n              {errors.price && <p className=\"text-red-500 text-xs mt-1 flex items-center gap-1\"><span></span> {errors.price}</p>}\n              {!errors.price && formData.price && (\n                <p className=\"text-gray-500 text-xs mt-1\">Suggested range: R500 - R50,000 per month</p>\n              )}\n            </div>\n\n            {/* Full Address */}\n            <div>\n              <label className=\"block text-sm font-semibold text-gray-800 mb-1\">Full South African Address *</label>\n              <p className=\"text-xs text-gray-500 mb-2\">Example: 5170 Molefe St, Ivory Park, Midrand, 1693</p>\n              <textarea\n                required\n                rows=\"2\"\n                value={fullAddressInput}\n                onChange={(e) => handleFullAddressChange(e.target.value)}\n                onFocus={() => setIsFullAddressEditing(true)}\n                onBlur={(e) => { setIsFullAddressEditing(false); handleFullAddressChange(e.target.value); }}\n                placeholder=\"Type the full street + suburb + city + postal code\"\n                className={`w-full px-4 py-3 border-2 ${errors.location ? 'border-red-400' : 'border-gray-200'} bg-white text-gray-800 rounded-xl focus:ring-2 ${errors.location ? 'focus:ring-red-400' : 'focus:ring-teal-400'} focus:border-transparent transition placeholder-gray-400`}\n              />\n              {errors.location && <p className=\"text-red-500 text-xs mt-1\" aria-live=\"assertive\">{errors.location}</p>}\n              {!errors.location && (\n                <p className=\"text-gray-500 text-xs mt-1\">\n                  Include the street/stand number plus suburb, city, and postal code. Commas are optional; we will split it for you.\n                </p>\n              )}\n            </div>\n\n            {/* Geocode Section - Manual confirmation only */}\n            <div className=\"bg-gradient-to-br from-teal-50 to-cyan-50 border-2 border-teal-200 rounded-xl p-6\">\n              <div className=\"flex items-start gap-3 mb-4\">\n                <MapPin className=\"w-6 h-6 text-teal-600 flex-shrink-0 mt-1\" />\n                <div className=\"flex-1\">\n                  <h3 className=\"text-lg font-semibold text-gray-800 mb-1\">Confirm Your Address</h3>\n                  <p className=\"text-sm text-gray-600\">\n                    Type the exact street + suburb above, then tap <strong>Look Up Address</strong> if you\u00110d like us to fetch coordinates for your Google Maps preview.\n                  </p>\n                </div>\n              </div>\n\n              <div className=\"flex flex-wrap gap-3 items-start\">\n                <button\n                  type=\"button\"\n                  onClick={geocodeAddress}\n                  className=\"w-full md:w-auto bg-white hover:bg-gray-50 text-gray-700 border-2 border-gray-300 px-6 py-3 rounded-lg text-sm font-semibold transition flex items-center justify-center gap-2\"\n                >\n                  <MapPin className=\"w-4 h-4\" />\n                  Look Up Address\n                </button>\n\n                <div className=\"text-sm flex-1 min-w-[220px]\">\n                  {geocodingStatus && (\n                    <span className={`${geocodingStatus.startsWith('') ? 'text-green-600 font-semibold' : geocodingStatus.startsWith('') ? 'text-amber-600' : 'text-gray-700'} flex items-center gap-1`}>\n                      {geocodingStatus.startsWith('') && <CheckCircle className=\"w-4 h-4\" />}\n                      {geocodingStatus}\n                      {lastGeocodeSource === 'cached' && (\n                        <span className=\"ml-2 inline-block px-2 py-1 text-[10px] rounded bg-purple-100 text-purple-600 font-semibold\">CACHED</span>\n                      )}\n                      {lastGeocodeSource === 'mapbox' && (\n                        <span className=\"ml-2 inline-block px-2 py-1 text-[10px] rounded bg-blue-100 text-blue-600 font-semibold\">MAPBOX</span>\n                      )}\n                      {lastGeocodeSource === 'maps.co' && (\n                        <span className=\"ml-2 inline-block px-2 py-1 text-[10px] rounded bg-indigo-100 text-indigo-600 font-semibold\">MAPS.CO</span>\n                      )}\n                      {lastGeocodeSource === 'proxy' && (\n                        <span className=\"ml-2 inline-block px-2 py-1 text-[10px] rounded bg-green-100 text-green-600 font-semibold\">PROXY</span>\n                      )}\n                      {lastGeocodeSource === 'direct' && (\n                        <span className=\"ml-2 inline-block px-2 py-1 text-[10px] rounded bg-yellow-100 text-yellow-700 font-semibold\">FALLBACK</span>\n                      )}\n                    </span>\n                  )}\n                  {formData.latitude && formData.longitude && !geocodingStatus && (\n                    <span className=\"text-green-600 font-semibold flex items-center gap-1\">\n                      <CheckCircle className=\"w-4 h-4\" />\n                      Coordinates saved: {formData.latitude.toFixed(4)}, {formData.longitude.toFixed(4)}\n                      {lastGeocodeSource === 'cached' && (\n                        <span className=\"ml-2 inline-block px-2 py-1 text-[10px] rounded bg-purple-100 text-purple-600 font-semibold\">CACHED</span>\n                      )}\n                      {lastGeocodeSource === 'maps.co' && (\n                        <span className=\"ml-2 inline-block px-2 py-1 text-[10px] rounded bg-indigo-100 text-indigo-600 font-semibold\">MAPS.CO</span>\n                      )}\n                    </span>\n                  )}\n                  {googleMapsUrl && (\n                    <div className=\"mt-3 bg-white border border-gray-200 rounded-lg p-3 text-xs text-gray-600\">\n                      <span className=\"block text-gray-800 font-semibold mb-1\">Preview this address</span>\n                      <a\n                        href={googleMapsUrl}\n                        target=\"_blank\"\n                        rel=\"noopener noreferrer\"\n                        className=\"inline-flex items-center gap-2 text-teal-700 font-semibold hover:text-teal-900 underline\"\n                      >\n                        <MapPin className=\"w-3 h-3\" /> Open in Google Maps\n                      </a>\n                      <span className=\"block mt-2 text-[11px] text-gray-500\">Renters will see the same button under your listing.</span>\n                    </div>\n                  )}\n                </div>\n              </div>\n              <div className=\"mt-4 text-sm text-gray-600 bg-white border border-dashed border-gray-300 rounded-lg p-4\">\n                <p className=\"font-semibold text-gray-800 mb-1\">Manual address confirmed</p>\n                <p>We now rely on the address you type here. Use Google Maps above if you want to double-check directions.</p>\n              </div>\n            </div>\n\n            {/* Status and Available Date - Two columns */}\n            <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n              <div>\n                <label className=\"block text-sm font-semibold text-gray-800 mb-2\">Status</label>\n                <select\n                  value={formData.status}\n                  onChange={(e) => setFormData({ ...formData, status: e.target.value })}\n                  className=\"w-full px-4 py-3 border-2 border-gray-200 bg-white text-gray-800 rounded-xl focus:ring-2 focus:ring-teal-400 focus:border-transparent transition\"\n                >\n                  <option value=\"available\">Available</option>\n                  <option value=\"rented\">Rented</option>\n                </select>\n              </div>\n\n              <div>\n                <label className=\"block text-sm font-semibold text-gray-800 mb-2\">Available Date</label>\n                <input\n                  type=\"date\"\n                  value={formData.availableDate}\n                  onChange={(e) => setFormData({ ...formData, availableDate: e.target.value })}\n                  className=\"w-full px-4 py-3 border-2 border-gray-200 bg-white text-gray-800 rounded-xl focus:ring-2 focus:ring-teal-400 focus:border-transparent transition\"\n                />\n              </div>\n            </div>\n\n            {/* Payment Method */}\n            <div>\n              <label className=\"block text-sm font-semibold text-gray-800 mb-2\">Payment Method</label>\n              <select\n                value={formData.paymentMethod}\n                onChange={(e) => setFormData({ ...formData, paymentMethod: e.target.value })}\n                className=\"w-full px-4 py-3 border-2 border-gray-200 bg-white text-gray-800 rounded-xl focus:ring-2 focus:ring-teal-400 focus:border-transparent transition\"\n              >\n                <option value=\"Bank and Cash\">Bank and Cash</option>\n                <option value=\"Cash Only\">Cash Only</option>\n                <option value=\"Bank Only\">Bank Only</option>\n              </select>\n            </div>\n\n            {/* Room Type and Lease Duration - Two columns */}\n            <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n              <div>\n                <label className=\"block text-sm font-semibold text-gray-800 mb-2\">Room Type</label>\n                <select\n                  value={formData.roomType}\n                  onChange={(e) => setFormData({ ...formData, roomType: e.target.value })}\n                  className=\"w-full px-4 py-3 border-2 border-gray-200 bg-white text-gray-800 rounded-xl focus:ring-2 focus:ring-teal-400 focus:border-transparent transition\"\n                >\n                  <option value=\"private\">Private Room</option>\n                  <option value=\"shared\">Shared Room</option>\n                </select>\n              </div>\n\n              <div>\n                <label className=\"block text-sm font-semibold text-gray-800 mb-2\">Lease Duration (months)</label>\n                <select\n                  value={formData.leaseDuration}\n                  onChange={(e) => setFormData({ ...formData, leaseDuration: e.target.value })}\n                  className=\"w-full px-4 py-3 border-2 border-gray-200 bg-white text-gray-800 rounded-xl focus:ring-2 focus:ring-teal-400 focus:border-transparent transition\"\n                >\n                  <option value=\"1-3\">1-3 months</option>\n                  <option value=\"4-6\">4-6 months</option>\n                  <option value=\"7-12\">7-12 months</option>\n                  <option value=\"12+\">12+ months</option>\n                </select>\n              </div>\n            </div>\n\n            {/* Pet Friendly and Gender Preference */}\n            <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n              <div className=\"flex items-center gap-3\">\n                <input\n                  type=\"checkbox\"\n                  checked={formData.petFriendly}\n                  onChange={(e) => setFormData({ ...formData, petFriendly: e.target.checked })}\n                  id=\"petFriendly\"\n                  className=\"w-5 h-5 text-teal-600 border-gray-300 rounded focus:ring-teal-500\"\n                />\n                <label htmlFor=\"petFriendly\" className=\"text-sm font-medium text-gray-700\">\n                   Pet Friendly\n                </label>\n              </div>\n\n              <div>\n                <label className=\"block text-sm font-semibold text-gray-800 mb-2\">Gender Preference</label>\n                <select\n                  value={formData.genderPreference}\n                  onChange={(e) => setFormData({ ...formData, genderPreference: e.target.value })}\n                  className=\"w-full px-4 py-3 border-2 border-gray-200 bg-white text-gray-800 rounded-xl focus:ring-2 focus:ring-teal-400 focus:border-transparent transition\"\n                >\n                  <option value=\"any\">Any</option>\n                  <option value=\"male\">Male Only</option>\n                  <option value=\"female\">Female Only</option>\n                </select>\n              </div>\n            </div>\n\n            {/* Premium Flag */}\n            <div className=\"flex items-center gap-3\">\n              <input\n                type=\"checkbox\"\n                checked={!!formData.premium}\n                onChange={(e) => setFormData({ ...formData, premium: e.target.checked })}\n                id=\"premiumFlag\"\n              />\n              <label htmlFor=\"premiumFlag\" className=\"text-sm font-medium text-gray-700\">\n                Premium listing (highlight & priority sorting)\n              </label>\n            </div>\n\n            {/* Description */}\n            <div>\n              <label className=\"block text-sm font-semibold text-gray-800 mb-2\">\n                Description \n                {formData.description && (\n                  <span className={`ml-2 text-xs ${formData.description.length > 500 ? 'text-red-500' : 'text-gray-500'}`}>\n                    ({formData.description.length}/500 characters)\n                  </span>\n                )}\n              </label>\n              <textarea\n                value={formData.description}\n                onChange={(e) => {\n                  setFormData({ ...formData, description: e.target.value });\n                  validateField('description', e.target.value);\n                }}\n                onBlur={(e) => validateField('description', e.target.value)}\n                placeholder=\"Describe the room, amenities, rules, and any other details...\"\n                rows=\"4\"\n                className={`w-full px-4 py-3 border-2 ${errors.description ? 'border-red-400' : 'border-gray-200'} bg-white text-gray-800 rounded-xl focus:ring-2 ${errors.description ? 'focus:ring-red-400' : 'focus:ring-teal-400'} focus:border-transparent transition placeholder-gray-400`}\n              />\n              {errors.description && <p className=\"text-red-500 text-xs mt-1\">{errors.description}</p>}\n            </div>\n\n            {/* Amenities */}\n            <div>\n              <label className=\"block text-sm font-semibold text-gray-800 mb-3\">Amenities</label>\n              <div className=\"grid grid-cols-2 md:grid-cols-3 gap-2\">\n                {availableAmenities.map(amenity => (\n                  <button\n                    key={amenity}\n                    type=\"button\"\n                    onClick={() => toggleAmenity(amenity)}\n                    className={`px-4 py-2.5 rounded-xl text-sm font-medium transition-all ${\n                      formData.amenities.includes(amenity)\n                        ? 'bg-gradient-to-r from-teal-500 to-cyan-500 text-white shadow-md'\n                        : 'bg-gray-100 text-gray-700 border-2 border-gray-200 hover:border-teal-300 hover:bg-teal-50'\n                    }`}\n                  >\n                    {amenity}\n                  </button>\n                ))}\n              </div>\n            </div>\n\n            {/* Photos */}\n            <div>\n              <label className=\"block text-sm font-semibold text-gray-800 mb-2\">Photos (Max 5)</label>\n              <div \n                className=\"relative border-2 border-dashed border-gray-300 bg-gradient-to-br from-gray-50 to-slate-50 rounded-xl p-6 hover:border-teal-400 hover:bg-teal-50/30 transition-all duration-300 cursor-pointer group\"\n                onClick={() => setShowPhotoEditor(true)}\n              >\n                <div className=\"text-center\">\n                  <div className=\"w-16 h-16 bg-gradient-to-br from-teal-100 to-cyan-100 rounded-2xl flex items-center justify-center mx-auto mb-3 group-hover:scale-110 transition-transform duration-300\">\n                    <span className=\"text-3xl\"></span>\n                  </div>\n                  <p className=\"text-gray-700 font-semibold mb-1\">\n                    {formData.photos.length === 0 ? 'Add Photos' : `${formData.photos.length}/5 Photos Added`}\n                  </p>\n                  <p className=\"text-xs text-gray-500\">\n                    Click to upload  JPG, PNG up to 5MB each\n                  </p>\n                  {formData.photos.length === 0 && (\n                    <p className=\"text-xs text-teal-600 mt-2 font-medium\">\n                      Tip: Listings with photos get 3x more views!\n                    </p>\n                  )}\n                </div>\n              </div>\n              {formData.photos.length > 0 && (\n                <div className=\"mt-4 grid grid-cols-2 md:grid-cols-3 gap-3\">\n                  {formData.photos.map((photo, index) => (\n                    <div key={index} className=\"relative group\">\n                      {index === 0 && (\n                        <div className=\"absolute top-2 left-2 bg-gradient-to-r from-teal-500 to-cyan-500 text-white text-xs px-2 py-1 rounded-full font-semibold z-10\">\n                          Cover\n                        </div>\n                      )}\n                      <img \n                        src={photo} \n                        alt={`Preview ${index + 1}`} \n                        className=\"w-full h-32 object-cover rounded-xl border-2 border-gray-200 shadow-sm\" \n                      />\n                    </div>\n                  ))}\n                </div>\n              )}\n              <button\n                type=\"button\"\n                onClick={() => setShowPhotoEditor(true)}\n                className=\"mt-3 text-sm text-teal-600 hover:text-teal-700 font-medium\"\n              >\n                {formData.photos.length > 0 ? ' Edit Photos' : ''}\n              </button>\n            </div>\n\n            {showPhotoEditor && (\n              <PhotoEditor\n                photos={formData.photos}\n                onPhotosChange={(newPhotos) => setFormData({ ...formData, photos: newPhotos })}\n                onClose={() => setShowPhotoEditor(false)}\n                maxPhotos={5}\n              />\n            )}\n\n            {/* Submit Button */}\n            <div className=\"border-t border-gray-200 pt-6\">\n              <button\n                onClick={handleSubmit}\n                disabled={isSubmitting || Object.keys(errors).length > 0}\n                className={`w-full font-semibold py-3.5 rounded-xl transition-all shadow-lg relative ${\n                  isSubmitting || Object.keys(errors).length > 0\n                    ? 'bg-gray-400 cursor-not-allowed'\n                    : 'bg-gradient-to-r from-teal-500 to-cyan-500 hover:from-teal-600 hover:to-cyan-600 text-white hover:shadow-xl hover:shadow-teal-500/25'\n                }`}\n              >\n                {isSubmitting ? (\n                  <>\n                    <span className=\"opacity-0\">Post Room</span>\n                    <div className=\"absolute inset-0 flex items-center justify-center\">\n                      <div className=\"w-5 h-5 border-2 border-white border-t-transparent rounded-full animate-spin\" />\n                    </div>\n                  </>\n                ) : (\n                  'Post Room'\n                )}\n              </button>\n              {Object.keys(errors).length > 0 && (\n                <p className=\"text-red-500 text-xs mt-2 text-center\">Please fix the errors above before submitting</p>\n              )}\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n}\n\n// MessagesView removed - using direct contact instead\n\nfunction MyListingsView({ listings, onDelete }) {\n  return (\n    <div className=\"p-4 min-h-screen bg-gradient-to-b from-slate-50 to-gray-100 pb-24\">\n      <div className=\"max-w-7xl mx-auto mt-8\">\n        {/* Landlord reminder banner */}\n        {listings.length > 0 && (\n          <div className=\"mb-6 bg-gradient-to-r from-amber-50 to-orange-50 border border-amber-200 rounded-2xl p-4 shadow-sm\">\n            <div className=\"flex items-start gap-3\">\n              <div className=\"w-10 h-10 bg-amber-100 rounded-xl flex items-center justify-center flex-shrink-0\">\n                <AlertTriangle className=\"w-5 h-5 text-amber-600\" />\n              </div>\n              <div>\n                <h3 className=\"font-semibold text-amber-800 mb-1\">Found a tenant?</h3>\n                <p className=\"text-amber-700 text-sm leading-relaxed\">\n                  Remember to <span className=\"font-medium\">delete your listing</span> once you've found a tenant. \n                  This will stop new calls and messages from other renters looking at your ad.\n                </p>\n              </div>\n            </div>\n          </div>\n        )}\n\n        <div className=\"mb-8\">\n          <div className=\"flex items-center gap-4 mb-3\">\n            <div className=\"w-14 h-14 bg-gradient-to-br from-teal-100 to-cyan-100 rounded-2xl flex items-center justify-center shadow-sm\">\n              <Home className=\"w-7 h-7 text-teal-600\" />\n            </div>\n            <div>\n              <h2 className=\"text-3xl font-extrabold text-gray-900\">My Listings</h2>\n              <p className=\"text-gray-600\">\n                {listings.length === 0\n                  ? 'Your properties will appear here'\n                  : `${listings.length} active ${listings.length === 1 ? 'listing' : 'listings'}`}\n              </p>\n            </div>\n          </div>\n        </div>\n\n        {listings.length === 0 ? (\n          <div className=\"bg-white rounded-2xl border border-gray-100 shadow-sm p-12 text-center\">\n            <div className=\"w-24 h-24 bg-gradient-to-br from-teal-50 to-cyan-50 rounded-full flex items-center justify-center mx-auto mb-6\">\n              <Home className=\"w-12 h-12 text-teal-400\" />\n            </div>\n            <h3 className=\"text-xl font-bold text-gray-800 mb-2\">No Listings Yet</h3>\n            <p className=\"text-gray-500 text-sm mb-6 max-w-md mx-auto\">\n              Start earning by posting your first room. It only takes a few minutes!\n            </p>\n            <button\n              onClick={() => window.location.hash = '#add'}\n              className=\"inline-flex items-center gap-2 bg-gradient-to-r from-teal-600 to-cyan-600 hover:from-teal-700 hover:to-cyan-700 text-white font-semibold px-6 py-3 rounded-xl transition-all shadow-md hover:shadow-lg\"\n            >\n              <PlusCircle className=\"w-5 h-5\" />\n              Post Your First Room\n            </button>\n          </div>\n        ) : (\n          <div className=\"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6\">\n            {listings.map(listing => (\n              <div key={listing.id} className=\"bg-white rounded-2xl shadow-sm border border-gray-100 overflow-hidden hover:shadow-md transition-shadow\">\n                {listing.photos && listing.photos.length > 0 && (\n                  <div className=\"relative\">\n                    <img src={listing.photos[0]} alt=\"Room\" className=\"w-full h-48 object-cover\" />\n                    {listing.photos.length > 1 && (\n                      <div className=\"absolute top-3 right-3 bg-black/60 backdrop-blur-sm text-white px-2.5 py-1 rounded-full text-xs font-medium\">\n                        {listing.photos.length} photos\n                      </div>\n                    )}\n                    <div className={`absolute top-3 left-3 px-2.5 py-1 rounded-full text-xs font-semibold ${\n                      listing.status === 'available' \n                        ? 'bg-emerald-500 text-white' \n                        : 'bg-gray-500 text-white'\n                    }`}>\n                      {listing.status === 'available' ? 'Active' : 'Rented'}\n                    </div>\n                  </div>\n                )}\n                <div className=\"p-5\">\n                  <h3 className=\"font-bold text-lg text-gray-900 mb-1 line-clamp-1\">{listing.title}</h3>\n                  <div className=\"text-teal-600 font-bold text-xl mb-2\">R{listing.price?.toLocaleString()}/month</div>\n                  <div className=\"flex items-center text-gray-500 text-sm mb-4\">\n                    <MapPin className=\"w-4 h-4 mr-1.5 text-gray-400\" />\n                    <span className=\"line-clamp-1\">{listing.location}</span>\n                  </div>\n                  <div className=\"flex gap-2\">\n                    <button\n                      onClick={() => onDelete(listing.id)}\n                      className=\"flex-1 bg-red-50 hover:bg-red-100 text-red-600 font-medium py-2.5 rounded-xl transition-colors text-sm\"\n                    >\n                      Delete\n                    </button>\n                  </div>\n                </div>\n              </div>\n            ))}\n          </div>\n        )}\n      </div>\n    </div>\n  );\n}\n\n\n// Inline message box component with validation for listing detail view\n// ListingInlineMessageBox removed\n\n// ConversationModal removed\n\nfunction AuthModal({ defaultType = 'renter', onClose, onSuccess, authFunctions }) {\n  const [mode, setMode] = useState('signin'); // 'signin', 'signup', 'reset', 'phone', 'phone-verify'\n  const [form, setForm] = useState({ \n    name: '', \n    phone: '', \n    email: '', \n    password: '',\n    confirmPassword: '',\n    otp: '',\n    type: defaultType \n  });\n  const [errors, setErrors] = useState({});\n  const [isSubmitting, setIsSubmitting] = useState(false);\n  const [authError, setAuthError] = useState('');\n  const [resetSent, setResetSent] = useState(false);\n  const [otpSent, setOtpSent] = useState(false);\n  const [phoneFormatted, setPhoneFormatted] = useState('');\n\n  const validateForm = () => {\n    const newErrors = {};\n    \n    if (mode === 'phone') {\n      if (!form.phone || form.phone.trim().length < 9) {\n        newErrors.phone = 'Please enter a valid phone number';\n      }\n    } else if (mode === 'phone-verify') {\n      if (!form.otp || form.otp.length !== 6) {\n        newErrors.otp = 'Please enter the 6-digit code';\n      }\n    } else {\n      if (mode === 'signup') {\n        if (!form.name || form.name.trim().length < 2) {\n          newErrors.name = 'Name must be at least 2 characters';\n        }\n      }\n      \n      if (!form.email || !/^[^\\s@]+@[^\\s@]+\\.[^\\s@]+$/.test(form.email)) {\n        newErrors.email = 'Please enter a valid email address';\n      }\n      \n      if (mode !== 'reset') {\n        if (!form.password || form.password.length < 6) {\n          newErrors.password = 'Password must be at least 6 characters';\n        }\n      }\n      \n      if (mode === 'signup' && form.password !== form.confirmPassword) {\n        newErrors.confirmPassword = 'Passwords do not match';\n      }\n    }\n    \n    setErrors(newErrors);\n    return Object.keys(newErrors).length === 0;\n  };\n\n  const handleSubmit = async () => {\n    if (!validateForm()) return;\n    setIsSubmitting(true);\n    setAuthError('');\n    \n    try {\n      if (mode === 'signup') {\n        await authFunctions.signUp(form.email, form.password, form.name, form.type, form.phone);\n        onSuccess?.();\n        onClose();\n      } else if (mode === 'signin') {\n        await authFunctions.signIn(form.email, form.password);\n        onSuccess?.();\n        onClose();\n      } else if (mode === 'reset') {\n        await authFunctions.sendPasswordReset(form.email);\n        setResetSent(true);\n      } else if (mode === 'phone') {\n        // Send OTP\n        const result = await authFunctions.sendPhoneOTP(form.phone);\n        setPhoneFormatted(result.formattedNumber);\n        setOtpSent(true);\n        setMode('phone-verify');\n      } else if (mode === 'phone-verify') {\n        // Verify OTP\n        await authFunctions.verifyPhoneOTP(form.otp, form.type, form.name);\n        onSuccess?.();\n        onClose();\n      }\n    } catch (err) {\n      console.error('Auth error:', err);\n      let errorMessage = 'An error occurred. Please try again.';\n      if (err.code === 'auth/invalid-phone-number') {\n        errorMessage = 'Invalid phone number format. Please use format: 0XX XXX XXXX';\n      } else if (err.code === 'auth/too-many-requests') {\n        errorMessage = 'Too many attempts. Please try again later.';\n      } else if (err.code === 'auth/invalid-verification-code') {\n        errorMessage = 'Invalid code. Please check and try again.';\n      } else if (err.code === 'auth/code-expired') {\n        errorMessage = 'Code expired. Please request a new one.';\n      } else if (err.message) {\n        errorMessage = err.message;\n      }\n      setAuthError(errorMessage);\n    } finally {\n      setIsSubmitting(false);\n    }\n  };\n\n  const handleGoogleSignIn = async () => {\n    setIsSubmitting(true);\n    setAuthError('');\n    \n    try {\n      await authFunctions.signInGoogle(form.type);\n      onSuccess?.();\n      onClose();\n    } catch (err) {\n      setAuthError(err.message || 'Google sign-in failed. Please try again.');\n    } finally {\n      setIsSubmitting(false);\n    }\n  };\n\n  const startPhoneAuth = () => {\n    setMode('phone');\n    setAuthError('');\n    setOtpSent(false);\n  };\n\n  return (\n    <div className=\"fixed inset-0 bg-gray-900/60 backdrop-blur-sm flex items-start sm:items-center justify-center p-4 pt-16 sm:pt-4 z-50 overflow-y-auto\">\n      <div className=\"bg-white rounded-2xl w-full max-w-md p-8 my-auto shadow-2xl fade-in border border-gray-100\">\n        {/* Header */}\n        <div className=\"flex items-start justify-between mb-6\">\n          <div>\n            <div className=\"flex items-center gap-2 mb-2\">\n              <div className=\"w-10 h-10 bg-gradient-to-br from-teal-500 to-cyan-500 rounded-xl flex items-center justify-center shadow-lg\">\n                <Home className=\"w-5 h-5 text-white\" />\n              </div>\n              <span className=\"text-xl font-extrabold\">\n                <span className=\"bg-gradient-to-r from-teal-600 to-cyan-600 bg-clip-text text-transparent\">Room</span>\n                <span className=\"text-rose-500\">24</span>\n              </span>\n            </div>\n            <h3 className=\"text-xl font-bold text-gray-900 mt-4\">\n              {mode === 'signin' && 'Welcome back!'}\n              {mode === 'signup' && 'Create your account'}\n              {mode === 'reset' && 'Reset password'}\n              {mode === 'phone' && 'Sign in with phone'}\n              {mode === 'phone-verify' && 'Enter verification code'}\n            </h3>\n            <p className=\"text-sm text-gray-500 mt-1\">\n              {mode === 'signin' && 'Sign in to continue'}\n              {mode === 'signup' && 'Join Room24 today'}\n              {mode === 'reset' && \"We'll send you a reset link\"}\n              {mode === 'phone' && \"We'll send you a verification code\"}\n              {mode === 'phone-verify' && `Code sent to ${phoneFormatted}`}\n            </p>\n          </div>\n          <button \n            onClick={onClose} \n            className=\"p-2 text-gray-400 hover:text-gray-600 hover:bg-gray-100 rounded-xl transition-colors\"\n          >\n            <X className=\"w-5 h-5\" />\n          </button>\n        </div>\n\n        {/* Auth Error */}\n        {authError && (\n          <div className=\"mb-4 p-3 bg-rose-50 border border-rose-200 rounded-xl text-rose-700 text-sm flex items-center gap-2\">\n            <AlertTriangle className=\"w-4 h-4 flex-shrink-0\" />\n            {authError}\n          </div>\n        )}\n\n        {/* Reset Success Message */}\n        {resetSent && (\n          <div className=\"mb-4 p-3 bg-green-50 border border-green-200 rounded-xl text-green-700 text-sm flex items-center gap-2\">\n            <CheckCircle className=\"w-4 h-4 flex-shrink-0\" />\n            Password reset email sent! Check your inbox.\n          </div>\n        )}\n\n        <div className=\"space-y-4\">\n          {/* Phone OTP Verification Mode */}\n          {mode === 'phone-verify' && (\n            <>\n              <div>\n                <label className=\"block text-sm font-semibold text-gray-700 mb-2\">Verification Code *</label>\n                <input \n                  type=\"text\" \n                  inputMode=\"numeric\"\n                  maxLength={6}\n                  value={form.otp} \n                  onChange={(e) => { \n                    const val = e.target.value.replace(/\\D/g, '').slice(0, 6);\n                    setForm({ ...form, otp: val }); \n                    setErrors({ ...errors, otp: '' }); \n                    setAuthError(''); \n                  }}\n                  className={`w-full px-4 py-4 border-2 rounded-xl transition-all focus:ring-2 focus:ring-teal-100 focus:border-teal-500 text-center text-2xl font-bold tracking-[0.5em] ${\n                    errors.otp ? 'border-rose-400 bg-rose-50' : 'border-gray-200 hover:border-gray-300'\n                  }`}\n                  placeholder=\"000000\"\n                  autoFocus\n                />\n                {errors.otp && <p className=\"text-rose-500 text-xs mt-1.5 flex items-center gap-1\"><span></span>{errors.otp}</p>}\n              </div>\n\n              {/* Name for new phone users */}\n              <div>\n                <label className=\"block text-sm font-semibold text-gray-700 mb-2\">Your Name *</label>\n                <input \n                  type=\"text\" \n                  value={form.name} \n                  onChange={(e) => { setForm({ ...form, name: e.target.value }); setErrors({ ...errors, name: '' }); }}\n                  className=\"w-full px-4 py-3 border-2 border-gray-200 hover:border-gray-300 rounded-xl transition-all focus:ring-2 focus:ring-teal-100 focus:border-teal-500\"\n                  placeholder=\"John Doe\"\n                />\n              </div>\n\n              {/* User Type for new phone users */}\n              <div>\n                <label className=\"block text-sm font-semibold text-gray-700 mb-2\">I am a</label>\n                <div className=\"grid grid-cols-2 gap-3\">\n                  <button\n                    type=\"button\"\n                    onClick={() => setForm({ ...form, type: 'renter' })}\n                    className={`p-3 rounded-xl border-2 transition-all flex flex-col items-center gap-1 ${\n                      form.type === 'renter' \n                        ? 'border-teal-500 bg-gradient-to-br from-teal-50 to-cyan-50 text-teal-700 shadow-md' \n                        : 'border-gray-200 hover:border-gray-300 text-gray-600 hover:bg-gray-50'\n                    }`}\n                  >\n                    <Search className={`w-5 h-5 ${form.type === 'renter' ? 'text-teal-500' : ''}`} />\n                    <span className=\"text-xs font-semibold\">Looking for a room</span>\n                  </button>\n                  <button\n                    type=\"button\"\n                    onClick={() => setForm({ ...form, type: 'landlord' })}\n                    className={`p-3 rounded-xl border-2 transition-all flex flex-col items-center gap-1 ${\n                      form.type === 'landlord' \n                        ? 'border-rose-500 bg-gradient-to-br from-rose-50 to-pink-50 text-rose-700 shadow-md' \n                        : 'border-gray-200 hover:border-gray-300 text-gray-600 hover:bg-gray-50'\n                    }`}\n                  >\n                    <Home className={`w-5 h-5 ${form.type === 'landlord' ? 'text-rose-500' : ''}`} />\n                    <span className=\"text-xs font-semibold\">Listing rooms</span>\n                  </button>\n                </div>\n              </div>\n\n              <button\n                type=\"button\"\n                onClick={() => { setMode('phone'); setOtpSent(false); setForm({ ...form, otp: '' }); }}\n                className=\"text-sm text-teal-600 hover:text-teal-700 font-medium\"\n              >\n                 Change phone number\n              </button>\n            </>\n          )}\n\n          {/* Phone Entry Mode */}\n          {mode === 'phone' && (\n            <>\n              <div>\n                <label className=\"block text-sm font-semibold text-gray-700 mb-2\">Phone Number *</label>\n                <div className=\"flex gap-2\">\n                  <div className=\"flex items-center px-3 bg-gray-100 border-2 border-gray-200 rounded-xl text-gray-600 font-medium\">\n                     +27\n                  </div>\n                  <input \n                    type=\"tel\" \n                    value={form.phone} \n                    onChange={(e) => { \n                      setForm({ ...form, phone: e.target.value }); \n                      setErrors({ ...errors, phone: '' }); \n                      setAuthError(''); \n                    }}\n                    className={`flex-1 px-4 py-3 border-2 rounded-xl transition-all focus:ring-2 focus:ring-teal-100 focus:border-teal-500 ${\n                      errors.phone ? 'border-rose-400 bg-rose-50' : 'border-gray-200 hover:border-gray-300'\n                    }`}\n                    placeholder=\"72 123 4567\"\n                    autoFocus\n                  />\n                </div>\n                {errors.phone && <p className=\"text-rose-500 text-xs mt-1.5 flex items-center gap-1\"><span></span>{errors.phone}</p>}\n                <p className=\"text-xs text-gray-500 mt-2\">We'll send you an SMS with a verification code</p>\n              </div>\n\n              <button\n                type=\"button\"\n                onClick={() => { setMode('signin'); setAuthError(''); }}\n                className=\"text-sm text-teal-600 hover:text-teal-700 font-medium\"\n              >\n                 Use email instead\n              </button>\n            </>\n          )}\n\n          {/* Google & Phone Sign In Buttons */}\n          {(mode === 'signin' || mode === 'signup') && (\n            <>\n              <div className=\"grid grid-cols-2 gap-3\">\n                <button\n                  type=\"button\"\n                  onClick={handleGoogleSignIn}\n                  disabled={isSubmitting}\n                  className=\"flex items-center justify-center gap-2 px-4 py-3 border-2 border-gray-200 hover:border-gray-300 rounded-xl transition-all hover:bg-gray-50 font-medium text-gray-700\"\n                >\n                  <svg className=\"w-5 h-5\" viewBox=\"0 0 24 24\">\n                    <path fill=\"#4285F4\" d=\"M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z\"/>\n                    <path fill=\"#34A853\" d=\"M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z\"/>\n                    <path fill=\"#FBBC05\" d=\"M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z\"/>\n                    <path fill=\"#EA4335\" d=\"M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z\"/>\n                  </svg>\n                  Google\n                </button>\n\n                <button\n                  type=\"button\"\n                  onClick={startPhoneAuth}\n                  disabled={isSubmitting}\n                  className=\"flex items-center justify-center gap-2 px-4 py-3 border-2 border-gray-200 hover:border-gray-300 rounded-xl transition-all hover:bg-gray-50 font-medium text-gray-700\"\n                >\n                  <Phone className=\"w-5 h-5 text-green-600\" />\n                  Phone\n                </button>\n              </div>\n\n              <div className=\"relative\">\n                <div className=\"absolute inset-0 flex items-center\">\n                  <div className=\"w-full border-t border-gray-200\"></div>\n                </div>\n                <div className=\"relative flex justify-center text-sm\">\n                  <span className=\"px-4 bg-white text-gray-500\">or use email</span>\n                </div>\n              </div>\n            </>\n          )}\n\n          {/* Reset Mode */}\n          {mode === 'reset' && (\n            <div>\n              <label className=\"block text-sm font-semibold text-gray-700 mb-2\">Email *</label>\n              <input \n                type=\"email\" \n                value={form.email} \n                onChange={(e) => { setForm({ ...form, email: e.target.value }); setErrors({ ...errors, email: '' }); setAuthError(''); }}\n                className={`w-full px-4 py-3 border-2 rounded-xl transition-all focus:ring-2 focus:ring-teal-100 focus:border-teal-500 ${\n                  errors.email ? 'border-rose-400 bg-rose-50' : 'border-gray-200 hover:border-gray-300'\n                }`}\n                placeholder=\"john@example.com\"\n              />\n              {errors.email && <p className=\"text-rose-500 text-xs mt-1.5 flex items-center gap-1\"><span></span>{errors.email}</p>}\n            </div>\n          )}\n\n          {/* Email/Password Form (signin/signup) */}\n          {(mode === 'signin' || mode === 'signup') && (\n            <>\n              {/* Name (signup only) */}\n              {mode === 'signup' && (\n                <div>\n                  <label className=\"block text-sm font-semibold text-gray-700 mb-2\">Full name *</label>\n                  <input \n                    type=\"text\" \n                    value={form.name} \n                    onChange={(e) => { setForm({ ...form, name: e.target.value }); setErrors({ ...errors, name: '' }); }}\n                    className={`w-full px-4 py-3 border-2 rounded-xl transition-all focus:ring-2 focus:ring-teal-100 focus:border-teal-500 ${\n                      errors.name ? 'border-rose-400 bg-rose-50' : 'border-gray-200 hover:border-gray-300'\n                    }`}\n                    placeholder=\"John Doe\"\n                  />\n                  {errors.name && <p className=\"text-rose-500 text-xs mt-1.5 flex items-center gap-1\"><span></span>{errors.name}</p>}\n                </div>\n              )}\n\n              {/* Email */}\n              <div>\n                <label className=\"block text-sm font-semibold text-gray-700 mb-2\">Email *</label>\n                <input \n                  type=\"email\" \n                  value={form.email} \n                  onChange={(e) => { setForm({ ...form, email: e.target.value }); setErrors({ ...errors, email: '' }); setAuthError(''); }}\n                  className={`w-full px-4 py-3 border-2 rounded-xl transition-all focus:ring-2 focus:ring-teal-100 focus:border-teal-500 ${\n                    errors.email ? 'border-rose-400 bg-rose-50' : 'border-gray-200 hover:border-gray-300'\n                  }`}\n                  placeholder=\"john@example.com\"\n                />\n                {errors.email && <p className=\"text-rose-500 text-xs mt-1.5 flex items-center gap-1\"><span></span>{errors.email}</p>}\n              </div>\n\n              {/* Password */}\n              <div>\n                <label className=\"block text-sm font-semibold text-gray-700 mb-2\">Password *</label>\n                <input \n                  type=\"password\" \n                  value={form.password} \n                  onChange={(e) => { setForm({ ...form, password: e.target.value }); setErrors({ ...errors, password: '' }); setAuthError(''); }}\n                  className={`w-full px-4 py-3 border-2 rounded-xl transition-all focus:ring-2 focus:ring-teal-100 focus:border-teal-500 ${\n                    errors.password ? 'border-rose-400 bg-rose-50' : 'border-gray-200 hover:border-gray-300'\n                  }`}\n                  placeholder=\"\"\n                />\n                {errors.password && <p className=\"text-rose-500 text-xs mt-1.5 flex items-center gap-1\"><span></span>{errors.password}</p>}\n              </div>\n\n              {/* Confirm Password (signup only) */}\n              {mode === 'signup' && (\n                <div>\n                  <label className=\"block text-sm font-semibold text-gray-700 mb-2\">Confirm Password *</label>\n                  <input \n                    type=\"password\" \n                    value={form.confirmPassword} \n                    onChange={(e) => { setForm({ ...form, confirmPassword: e.target.value }); setErrors({ ...errors, confirmPassword: '' }); }}\n                    className={`w-full px-4 py-3 border-2 rounded-xl transition-all focus:ring-2 focus:ring-teal-100 focus:border-teal-500 ${\n                      errors.confirmPassword ? 'border-rose-400 bg-rose-50' : 'border-gray-200 hover:border-gray-300'\n                    }`}\n                    placeholder=\"\"\n                  />\n                  {errors.confirmPassword && <p className=\"text-rose-500 text-xs mt-1.5 flex items-center gap-1\"><span></span>{errors.confirmPassword}</p>}\n                </div>\n              )}\n\n              {/* Phone (signup only) */}\n              {mode === 'signup' && (\n                <div>\n                  <label className=\"block text-sm font-semibold text-gray-700 mb-2\">\n                    Phone <span className=\"text-gray-400 font-normal\">(optional)</span>\n                  </label>\n                  <input \n                    type=\"tel\" \n                    value={form.phone} \n                    onChange={(e) => setForm({ ...form, phone: e.target.value })}\n                    className=\"w-full px-4 py-3 border-2 border-gray-200 hover:border-gray-300 rounded-xl transition-all focus:ring-2 focus:ring-teal-100 focus:border-teal-500\"\n                    placeholder=\"+27 12 345 6789\"\n                  />\n                </div>\n              )}\n\n              {/* User Type (signup only) */}\n              {mode === 'signup' && (\n                <div>\n                  <label className=\"block text-sm font-semibold text-gray-700 mb-2\">I am a</label>\n                  <div className=\"grid grid-cols-2 gap-3\">\n                    <button\n                      type=\"button\"\n                      onClick={() => setForm({ ...form, type: 'renter' })}\n                      className={`p-3 rounded-xl border-2 transition-all flex flex-col items-center gap-1 ${\n                        form.type === 'renter' \n                          ? 'border-teal-500 bg-gradient-to-br from-teal-50 to-cyan-50 text-teal-700 shadow-md' \n                          : 'border-gray-200 hover:border-gray-300 text-gray-600 hover:bg-gray-50'\n                      }`}\n                    >\n                      <Search className={`w-5 h-5 ${form.type === 'renter' ? 'text-teal-500' : ''}`} />\n                      <span className=\"text-xs font-semibold\">Looking for a room</span>\n                    </button>\n                    <button\n                      type=\"button\"\n                      onClick={() => setForm({ ...form, type: 'landlord' })}\n                      className={`p-3 rounded-xl border-2 transition-all flex flex-col items-center gap-1 ${\n                        form.type === 'landlord' \n                          ? 'border-rose-500 bg-gradient-to-br from-rose-50 to-pink-50 text-rose-700 shadow-md' \n                          : 'border-gray-200 hover:border-gray-300 text-gray-600 hover:bg-gray-50'\n                      }`}\n                    >\n                      <Home className={`w-5 h-5 ${form.type === 'landlord' ? 'text-rose-500' : ''}`} />\n                      <span className=\"text-xs font-semibold\">Listing rooms</span>\n                    </button>\n                  </div>\n                </div>\n              )}\n\n              {/* Forgot Password Link (signin only) */}\n              {mode === 'signin' && (\n                <button\n                  type=\"button\"\n                  onClick={() => { setMode('reset'); setAuthError(''); setResetSent(false); }}\n                  className=\"text-sm text-teal-600 hover:text-teal-700 font-medium\"\n                >\n                  Forgot your password?\n                </button>\n              )}\n            </>\n          )}\n\n          {/* Submit Button */}\n          <button \n            id=\"phone-sign-in-button\"\n            onClick={handleSubmit}\n            disabled={isSubmitting}\n            className={`w-full font-bold py-3 rounded-xl transition-all relative ${\n              isSubmitting \n                ? 'bg-teal-400 cursor-not-allowed' \n                : 'bg-gradient-to-r from-teal-500 to-cyan-500 hover:from-teal-600 hover:to-cyan-600 text-white shadow-lg hover:shadow-xl hover:shadow-teal-500/25'\n            }`}\n          >\n            {isSubmitting ? (\n              <>\n                <span className=\"opacity-0\">Submit</span>\n                <div className=\"absolute inset-0 flex items-center justify-center\">\n                  <div className=\"w-5 h-5 border-2 border-white border-t-transparent rounded-full animate-spin\" />\n                </div>\n              </>\n            ) : (\n              <>\n                {mode === 'signin' && 'Sign In'}\n                {mode === 'signup' && 'Create Account'}\n                {mode === 'reset' && 'Send Reset Link'}\n                {mode === 'phone' && 'Send Verification Code'}\n                {mode === 'phone-verify' && 'Verify & Sign In'}\n              </>\n            )}\n          </button>\n\n          {/* reCAPTCHA container for phone auth */}\n          <div id=\"recaptcha-container\" className=\"flex justify-center\"></div>\n\n          {/* Toggle Mode */}\n          <div className=\"text-center text-sm text-gray-600\">\n            {mode === 'signin' && (\n              <>\n                Don't have an account?{' '}\n                <button \n                  onClick={() => { setMode('signup'); setAuthError(''); }} \n                  className=\"text-teal-600 hover:text-teal-700 font-semibold\"\n                >\n                  Sign up\n                </button>\n              </>\n            )}\n            {mode === 'signup' && (\n              <>\n                Already have an account?{' '}\n                <button \n                  onClick={() => { setMode('signin'); setAuthError(''); }} \n                  className=\"text-teal-600 hover:text-teal-700 font-semibold\"\n                >\n                  Sign in\n                </button>\n              </>\n            )}\n            {mode === 'reset' && (\n              <button \n                onClick={() => { setMode('signin'); setAuthError(''); setResetSent(false); }} \n                className=\"text-teal-600 hover:text-teal-700 font-semibold\"\n              >\n                 Back to sign in\n              </button>\n            )}\n            {(mode === 'phone' || mode === 'phone-verify') && (\n              <button \n                onClick={() => { setMode('signin'); setAuthError(''); setOtpSent(false); }} \n                className=\"text-teal-600 hover:text-teal-700 font-semibold\"\n              >\n                 Back to sign in\n              </button>\n            )}\n          </div>\n        </div>\n\n        {/* Footer */}\n        <p className=\"text-xs text-gray-400 text-center mt-6\">\n          By continuing, you agree to our <button className=\"text-teal-600 hover:underline\">Terms of Service</button> and <button className=\"text-teal-600 hover:underline\">Privacy Policy</button>\n        </p>\n      </div>\n    </div>\n  );\n}\n\nfunction BottomNav({ currentView, setCurrentView, userType }) {\n  const navItems = [\n    { id: 'browse', label: 'Browse', icon: <Search className=\"w-5 h-5\" />, activeColor: 'teal' },\n    { id: 'add', label: 'List', icon: <PlusCircle className=\"w-5 h-5\" />, requiresLandlord: true, activeColor: 'rose' },\n    { id: 'favorites', label: 'Saved', icon: <Heart className=\"w-5 h-5\" />, activeColor: 'rose' },\n    { id: 'profile', label: 'Profile', icon: <User className=\"w-5 h-5\" />, activeColor: 'blue' }\n  ];\n\n  return (\n    <div className=\"fixed bottom-0 left-0 right-0 bg-white/95 backdrop-blur-md border-t border-gray-100 px-4 py-2 z-20 md:hidden safe-area-bottom\">\n      <div className=\"grid grid-cols-4 gap-1 max-w-md mx-auto\">\n        {navItems.map(item => {\n          const disabled = item.requiresLandlord && userType !== 'landlord';\n          const isActive = currentView === item.id;\n          const colorClasses = {\n            teal: 'text-teal-600 bg-teal-50',\n            rose: 'text-rose-600 bg-rose-50',\n            blue: 'text-blue-600 bg-blue-50'\n          };\n          return (\n            <button\n              key={item.id}\n              type=\"button\"\n              disabled={disabled}\n              onClick={() => !disabled && setCurrentView(item.id)}\n              className={`flex flex-col items-center gap-0.5 py-2 px-1 rounded-xl transition-all duration-200 ${\n                disabled \n                  ? 'opacity-40 cursor-not-allowed' \n                  : 'active:scale-95'\n              } ${\n                isActive \n                  ? `${colorClasses[item.activeColor]} font-semibold` \n                  : 'text-gray-400 hover:text-gray-600 hover:bg-gray-50'\n              }`}\n            >\n              <span className={`transition-transform duration-200 ${isActive ? 'scale-110' : ''}`}>\n                {item.icon}\n              </span>\n              <span className=\"text-[10px] font-medium\">{item.label}</span>\n            </button>\n          );\n        })}\n      </div>\n    </div>\n  );\n}"],"mappings":"kIAAA,MAAO,CAAAA,KAAK,EAAIC,QAAQ,CAAEC,SAAS,CAAEC,OAAO,CAAEC,WAAW,KAAQ,OAAO,CACxE,OAASC,YAAY,CAAEC,aAAa,CAAEC,eAAe,CAAEC,wBAAwB,CAAEC,UAAU,CAAEC,aAAa,CAAEC,UAAU,CAAEC,aAAa,CAAEC,mBAAmB,CAAEC,kBAAkB,CAAEC,oBAAoB,CAAEC,cAAc,CAAEC,eAAe,CAAEC,aAAa,CAAEC,YAAY,CAAEC,cAAc,CAAEC,cAAc,CAAEC,kBAAkB,CAAEC,iBAAiB,KAAQ,YAAY,CAC7V,OAASC,IAAI,CAAEC,UAAU,CAAEC,MAAM,CAAEC,MAAM,CAAEC,CAAC,CAAEC,IAAI,CAAEC,KAAK,CAAEC,IAAI,CAAEC,IAAI,CAAEC,WAAW,CAAEC,KAAK,CAAEC,QAAQ,CAAEC,IAAI,CAAEC,aAAa,CAAEC,MAAM,CAAEC,KAAK,KAAQ,cAAc,CAC7J,MAAO,CAAAC,MAAM,KAAM,qBAAqB,CACxC,MAAO,CAAAC,kBAAkB,KAAM,iCAAiC,CAChE,MAAO,CAAAC,MAAM,KAAM,qBAAqB,CACxC,MAAO,CAAAC,UAAU,KAAM,yBAAyB,CAChD,MAAO,CAAAC,kBAAkB,KAAM,iCAAiC,CAChE,MAAO,CAAAC,kBAAkB,KAAM,iCAAiC,CAChE,MAAO,CAAAC,qBAAqB,KAAM,oCAAoC,CACtE,MAAO,CAAAC,kBAAkB,KAAM,iCAAiC,CAChE,MAAO,CAAAC,WAAW,KAAM,0BAA0B,CAClD,MAAO,CAAAC,gBAAgB,KAAM,+BAA+B,CAC5D,MAAO,CAAAC,SAAS,KAAM,wBAAwB,CAC9C,OAASC,gBAAgB,KAAQ,4BAA4B,CAC7D,OAASC,mBAAmB,CAAEC,mBAAmB,CAAEC,oBAAoB,KAAQ,gCAAgC,CAC/G,OACEC,eAAe,CACfC,eAAe,CACfC,gBAAgB,CAChBC,OAAO,GAAI,CAAAC,eAAe,CAC1BC,aAAa,KACR,YAAY,CAAC,OAAAC,GAAA,IAAAC,IAAA,CAAAC,IAAA,IAAAC,KAAA,CAAAC,QAAA,IAAAC,SAAA,yBAEpB,cAAe,SAAS,CAAAC,cAAcA,CAAA,CAAG,CACvC,KAAM,CAACC,WAAW,CAAEC,cAAc,CAAC,CAAGpE,QAAQ,CAAC,QAAQ,CAAC,CACxD,KAAM,CAACqE,QAAQ,CAAEC,WAAW,CAAC,CAAGtE,QAAQ,CAAC,IAAI,CAAC,CAC9C,KAAM,CAACuE,eAAe,CAAEC,kBAAkB,CAAC,CAAGxE,QAAQ,CAAC,KAAK,CAAC,CAAE;AAC/D,KAAM,CAACyE,QAAQ,CAAEC,WAAW,CAAC,CAAG1E,QAAQ,CAAC,EAAE,CAAC,CAC5C,KAAM,CAAC2E,eAAe,CAAEC,kBAAkB,CAAC,CAAG5E,QAAQ,CAAC,IAAI,CAAC,CAC5D,KAAM,CAAC6E,KAAK,CAAEC,QAAQ,CAAC,CAAG9E,QAAQ,CAAC,EAAE,CAAC,CAAE;AACxC,KAAM,CAAC+E,cAAc,CAAEC,iBAAiB,CAAC,CAAGhF,QAAQ,CAAC,EAAE,CAAC,CACxD,KAAM,CAACiF,UAAU,CAAEC,aAAa,CAAC,CAAGlF,QAAQ,CAAC,CAAC,CAAC,CAAE,KAAK,CAAC,CAAC,CACxD,KAAM,CAACmF,iBAAiB,CAAEC,oBAAoB,CAAC,CAAGpF,QAAQ,CAAC,EAAE,CAAC,CAC9D,KAAM,CAACqF,MAAM,CAAEC,SAAS,CAAC,CAAGtF,QAAQ,CAAC,QAAQ,CAAC,CAC9C,KAAM,CAACuF,WAAW,CAAEC,cAAc,CAAC,CAAGxF,QAAQ,CAAC,IAAI,CAAC,CACpD,KAAM,CAACyF,WAAW,CAAEC,cAAc,CAAC,CAAG1F,QAAQ,CAAC,IAAI,CAAC,CAAE;AACtD,KAAM,CAAC2F,WAAW,CAAEC,cAAc,CAAC,CAAG5F,QAAQ,CAAC,IAAI,CAAC,CAAE;AACtD,KAAM,CAAC6F,aAAa,CAAEC,gBAAgB,CAAC,CAAG9F,QAAQ,CAAC,KAAK,CAAC,CACzD,KAAM,CAAC+F,eAAe,CAAEC,kBAAkB,CAAC,CAAGhG,QAAQ,CAAC,QAAQ,CAAC,CAChE;AACA,KAAM,CAACiG,KAAK,CAAEC,QAAQ,CAAC,CAAGlG,QAAQ,CAAC,IAAI,CAAC,CACxC,KAAM,CAACmG,iBAAiB,CAAEC,oBAAoB,CAAC,CAAGpG,QAAQ,CAAC,KAAK,CAAC,CACjE,KAAM,CAACqG,kBAAkB,CAAEC,qBAAqB,CAAC,CAAGtG,QAAQ,CAAC,IAAI,CAAC,CAClE,KAAM,CAACuG,oBAAoB,CAAEC,uBAAuB,CAAC,CAAGxG,QAAQ,CAAC,KAAK,CAAC,CACvE,KAAM,CAACyG,sBAAsB,CAAEC,yBAAyB,CAAC,CAAG1G,QAAQ,CAAC,KAAK,CAAC,CAC3E,KAAM,CAAC2G,WAAW,CAAEC,cAAc,CAAC,CAAG5G,QAAQ,CAAC,CAAC,CAAC,CAEjD,KAAM,CAAA6G,aAAa,CAAG,QAAAA,CAAA,CAAqB,IAApB,CAAAC,IAAI,CAAAC,SAAA,CAAAC,MAAA,IAAAD,SAAA,MAAAE,SAAA,CAAAF,SAAA,IAAG,QAAQ,CACpCf,kBAAkB,CAACc,IAAI,CAAC,CACxBhB,gBAAgB,CAAC,IAAI,CAAC,CACxB,CAAC,CAED;AACA,KAAM,CAAAoB,aAAa,CAAG,CACpBC,MAAM,CAAE,cAAAA,CAAOC,KAAK,CAAEC,QAAQ,CAAEC,WAAW,CAA2C,IAAzC,CAAAC,aAAa,CAAAR,SAAA,CAAAC,MAAA,IAAAD,SAAA,MAAAE,SAAA,CAAAF,SAAA,IAAG,QAAQ,IAAE,CAAAS,KAAK,CAAAT,SAAA,CAAAC,MAAA,IAAAD,SAAA,MAAAE,SAAA,CAAAF,SAAA,IAAG,EAAE,CAC/E,KAAM,CAAAU,YAAY,CAAG,KAAM,CAAAnE,eAAe,CAAC8D,KAAK,CAAEC,QAAQ,CAAEC,WAAW,CAAC,CAExE;AACA,KAAM,CAAAI,WAAW,CAAG,CAClBN,KAAK,CAAEK,YAAY,CAACL,KAAK,CACzBE,WAAW,CAAEA,WAAW,EAAIG,YAAY,CAACH,WAAW,CACpDjD,QAAQ,CAAEkD,aAAa,CACvBC,KAAK,CACLG,QAAQ,CAAEF,YAAY,CAACE,QAAQ,EAAI,EAAE,CACrCC,SAAS,CAAE,GAAI,CAAAC,IAAI,CAAC,CAAC,CAACC,WAAW,CAAC,CAAC,CACnCC,gBAAgB,CAAER,aAAa,GAAK,QACtC,CAAC,CAED,KAAM,CAAAvG,eAAe,CAACyG,YAAY,CAACO,GAAG,CAAEN,WAAW,CAAC,CACpD,MAAO,CAAAD,YAAY,CACrB,CAAC,CACDQ,MAAM,CAAE,KAAAA,CAAOb,KAAK,CAAEC,QAAQ,GAAK,CACjC,MAAO,MAAM,CAAA9D,eAAe,CAAC6D,KAAK,CAAEC,QAAQ,CAAC,CAC/C,CAAC,CACDa,YAAY,CAAE,cAAAA,CAAA,CAAoC,IAA7B,CAAAX,aAAa,CAAAR,SAAA,CAAAC,MAAA,IAAAD,SAAA,MAAAE,SAAA,CAAAF,SAAA,IAAG,QAAQ,CAC3C,KAAM,CAAAU,YAAY,CAAG,KAAM,CAAAjE,gBAAgB,CAAC,CAAC,CAE7C;AACA,GAAI,CAAA2E,OAAO,CAAG,KAAM,CAAApH,cAAc,CAAC0G,YAAY,CAACO,GAAG,CAAC,CAEpD,GAAI,CAACG,OAAO,CAAE,CACZ;AACA,KAAM,CAAAT,WAAW,CAAG,CAClBN,KAAK,CAAEK,YAAY,CAACL,KAAK,CACzBE,WAAW,CAAEG,YAAY,CAACH,WAAW,EAAI,EAAE,CAC3CjD,QAAQ,CAAEkD,aAAa,CACvBC,KAAK,CAAEC,YAAY,CAACW,WAAW,EAAI,EAAE,CACrCT,QAAQ,CAAEF,YAAY,CAACE,QAAQ,EAAI,EAAE,CACrCC,SAAS,CAAE,GAAI,CAAAC,IAAI,CAAC,CAAC,CAACC,WAAW,CAAC,CAAC,CACnCC,gBAAgB,CAAER,aAAa,GAAK,QACtC,CAAC,CAED,KAAM,CAAAvG,eAAe,CAACyG,YAAY,CAACO,GAAG,CAAEN,WAAW,CAAC,CACtD,CAEA,MAAO,CAAAD,YAAY,CACrB,CAAC,CACDY,iBAAiB,CAAE,KAAO,CAAAjB,KAAK,EAAK,CAClC,KAAM,CAAAzD,aAAa,CAACyD,KAAK,CAAC,CAC5B,CAAC,CACDlG,YAAY,CAAE,KAAO,CAAAkH,WAAW,EAAK,CACnC;AACAnH,aAAa,CAAC,sBAAsB,CAAC,CACrC,MAAO,MAAM,CAAAC,YAAY,CAACkH,WAAW,CAAC,CACxC,CAAC,CACDjH,cAAc,CAAE,cAAAA,CAAOmH,OAAO,CAAiD,IAA/C,CAAAf,aAAa,CAAAR,SAAA,CAAAC,MAAA,IAAAD,SAAA,MAAAE,SAAA,CAAAF,SAAA,IAAG,QAAQ,IAAE,CAAAO,WAAW,CAAAP,SAAA,CAAAC,MAAA,IAAAD,SAAA,MAAAE,SAAA,CAAAF,SAAA,IAAG,EAAE,CACxE,KAAM,CAAAU,YAAY,CAAG,KAAM,CAAAtG,cAAc,CAACmH,OAAO,CAAC,CAElD;AACA,GAAI,CAAAH,OAAO,CAAG,KAAM,CAAApH,cAAc,CAAC0G,YAAY,CAACO,GAAG,CAAC,CAEpD,GAAI,CAACG,OAAO,CAAE,CACZ;AACA,KAAM,CAAAT,WAAW,CAAG,CAClBN,KAAK,CAAE,EAAE,CACTE,WAAW,CAAEA,WAAW,EAAIG,YAAY,CAACW,WAAW,CACpD/D,QAAQ,CAAEkD,aAAa,CACvBC,KAAK,CAAEC,YAAY,CAACW,WAAW,EAAI,EAAE,CACrCT,QAAQ,CAAE,EAAE,CACZC,SAAS,CAAE,GAAI,CAAAC,IAAI,CAAC,CAAC,CAACC,WAAW,CAAC,CAAC,CACnCC,gBAAgB,CAAER,aAAa,GAAK,QACtC,CAAC,CAED,KAAM,CAAAvG,eAAe,CAACyG,YAAY,CAACO,GAAG,CAAEN,WAAW,CAAC,CACtD,CAEA,MAAO,CAAAD,YAAY,CACrB,CAAC,CACDc,cAAc,CAAEA,CAAA,GAAM,CACpBnH,cAAc,CAAC,CAAC,CAClB,CACF,CAAC,CAED;AACAnB,SAAS,CAAC,IAAM,CACd,KAAM,CAAAuI,iBAAiB,CAAGA,CAAA,GAAM,CAC9B,KAAM,CAAAC,aAAa,CAAGvF,gBAAgB,CAAC,CAAC,CACxC0D,cAAc,CAAC6B,aAAa,CAACC,MAAM,CAACC,CAAC,EAAI,CAACA,CAAC,CAACC,IAAI,CAAC,CAAC5B,MAAM,CAAC,CAC3D,CAAC,CACDwB,iBAAiB,CAAC,CAAC,CACnB,KAAM,CAAAK,QAAQ,CAAGC,WAAW,CAACN,iBAAiB,CAAE,IAAI,CAAC,CAAE;AACvD,MAAO,IAAMO,aAAa,CAACF,QAAQ,CAAC,CACtC,CAAC,CAAE,EAAE,CAAC,CAGN5I,SAAS,CAAC,IAAM,CACd+I,QAAQ,CAAC,CAAC,CACV;AACA,KAAM,CAAAC,GAAG,CAAG7I,YAAY,CAAC,CAAC,CAE1B;AACA,KAAM,CAAA8I,eAAe,CAAGpI,oBAAoB,CAAC,KAAO,CAAA2G,YAAY,EAAK,CACnE,GAAIA,YAAY,CAAE,CAChBjC,cAAc,CAACiC,YAAY,CAAC,CAC5B;AACA,GAAI,CACF,KAAM,CAAAU,OAAO,CAAG,KAAM,CAAApH,cAAc,CAAC0G,YAAY,CAACO,GAAG,CAAC,CACtD,GAAIG,OAAO,CAAE,CACXzC,cAAc,CAACyC,OAAO,CAAC,CACvB7D,WAAW,CAAC6D,OAAO,CAAC9D,QAAQ,EAAI,QAAQ,CAAC,CAC3C,CACF,CAAE,MAAO8E,GAAG,CAAE,CACZC,OAAO,CAACC,KAAK,CAAC,8BAA8B,CAAEF,GAAG,CAAC,CACpD,CACF,CAAC,IAAM,CACL3D,cAAc,CAAC,IAAI,CAAC,CACpBE,cAAc,CAAC,IAAI,CAAC,CACpBpB,WAAW,CAAC,IAAI,CAAC,CACnB,CACAsB,cAAc,CAAC,KAAK,CAAC,CACvB,CAAC,CAAC,CAEF;AACA,GAAI,CAAA0D,mBAAmB,CAAG,IAAI,CAC9B,GAAIzI,kBAAkB,CAAC,CAAC,CAAE,CACxByI,mBAAmB,CAAG1I,mBAAmB,CAAE2I,iBAAiB,EAAK,CAC/D,GAAIA,iBAAiB,EAAIA,iBAAiB,CAACvC,MAAM,EAAI,CAAC,CAAE,CACtDtC,WAAW,CAAC6E,iBAAiB,CAAC,CAC9B;AACAC,YAAY,CAACC,OAAO,CAAC,UAAU,CAAEC,IAAI,CAACC,SAAS,CAACJ,iBAAiB,CAAC,CAAC,CACrE,CACF,CAAC,CAAC,CACJ,CAEA;AACA,KAAM,CAAAK,gBAAgB,CAAGJ,YAAY,CAACK,OAAO,CAAC,mBAAmB,CAAC,CAClE,GAAI,CAACD,gBAAgB,EAAIE,OAAO,CAACC,GAAG,CAACC,0BAA0B,GAAK,MAAM,CAAE,CAC1E;AACAC,UAAU,CAAC,IAAMzD,uBAAuB,CAAC,IAAI,CAAC,CAAE,IAAI,CAAC,CACvD,CAAC,IAAM,IAAIoD,gBAAgB,GAAK,KAAK,CAAE,CACrCvJ,aAAa,CAAC4I,GAAG,CAAC,CACpB,CAEA,CAAC,SAAY,CACX,GAAI,CACF,KAAM,CAAAiB,KAAK,CAAG,KAAM,CAAA5J,eAAe,CAAC,CAAC,CACrC,GAAI4J,KAAK,CAAE,CACTd,OAAO,CAACe,GAAG,CAAC,qBAAqB,CAAED,KAAK,CAAC,CACzC1J,UAAU,CAAC,oBAAoB,CAAC,CAClC,CACF,CAAE,MAAO4J,CAAC,CAAE,CACVhB,OAAO,CAACiB,IAAI,CAAC,0BAA0B,CAAED,CAAC,CAAC,CAC7C,CACF,CAAC,EAAE,CAAC,CAEJ7J,wBAAwB,CAAE+J,OAAO,EAAK,CACpC;AACA,KAAM,CAAAC,YAAY,CAAG,CAAAD,OAAO,SAAPA,OAAO,iBAAPA,OAAO,CAAEC,YAAY,GAAI,CAAC,CAAC,CAChD,GAAIA,YAAY,CAACC,KAAK,EAAID,YAAY,CAACE,IAAI,CAAE,CAC3CnE,qBAAqB,CAAC,CACpBkE,KAAK,CAAED,YAAY,CAACC,KAAK,CACzBC,IAAI,CAAEF,YAAY,CAACE,IACrB,CAAC,CAAC,CACF;AACAR,UAAU,CAAC,IAAM3D,qBAAqB,CAAC,IAAI,CAAC,CAAE,IAAI,CAAC,CACrD,CACF,CAAC,CAAC,CAEF;AACA,MAAO,IAAM,CACX,GAAI4C,eAAe,CAAE,CACnBA,eAAe,CAAC,CAAC,CACnB,CACA,GAAII,mBAAmB,CAAE,CACvBA,mBAAmB,CAAC,CAAC,CACvB,CACF,CAAC,CACH,CAAC,CAAE,EAAE,CAAC,CAEN;AACArJ,SAAS,CAAC,IAAM,CACd,GAAI0F,WAAW,CAAE,OAAQ;AAEzB,GAAIxB,WAAW,GAAK,KAAK,CAAE,CACzB,GAAI,CAACoB,WAAW,CAAE,CAChBsB,aAAa,CAAC,UAAU,CAAC,CACzBzC,cAAc,CAAC,QAAQ,CAAC,CAC1B,CAAC,IAAM,IAAIC,QAAQ,GAAK,UAAU,CAAE,CAClC;AACAwC,aAAa,CAAC,UAAU,CAAC,CACzBzC,cAAc,CAAC,QAAQ,CAAC,CAC1B,CAAC,IAAM,IAAI,EAACqB,WAAW,SAAXA,WAAW,WAAXA,WAAW,CAAEsC,gBAAgB,EAAE,CACzC;AACA3D,cAAc,CAAC,qBAAqB,CAAC,CACvC,CACF,CACF,CAAC,CAAE,CAACD,WAAW,CAAEoB,WAAW,CAAElB,QAAQ,CAAEoB,WAAW,CAAEE,WAAW,CAAC,CAAC,CAElE,KAAM,CAAAqD,QAAQ,CAAG,KAAAA,CAAA,GAAY,CAC3B,GAAI,CACF;AACA,KAAM,CAAAO,iBAAiB,CAAG,KAAM,CAAA9I,aAAa,CAAC,CAAC,CAC/C,GAAI8I,iBAAiB,EAAIA,iBAAiB,CAACvC,MAAM,CAAG,CAAC,CAAE,CACrDoC,OAAO,CAACe,GAAG,CAAC,gCAAgC,CAAC,CAC7CzF,WAAW,CAAC6E,iBAAiB,CAAC,CAC9B;AACAC,YAAY,CAACC,OAAO,CAAC,UAAU,CAAEC,IAAI,CAACC,SAAS,CAACJ,iBAAiB,CAAC,CAAC,CACrE,CAAC,IAAM,CACL;AACA,KAAM,CAAAmB,cAAc,CAAGlB,YAAY,CAACK,OAAO,CAAC,UAAU,CAAC,CACvD,GAAIa,cAAc,CAAE,CAClBtB,OAAO,CAACe,GAAG,CAAC,oEAAoE,CAAC,CACjFzF,WAAW,CAACgF,IAAI,CAACiB,KAAK,CAACD,cAAc,CAAC,CAAC,CACzC,CACF,CAEA,KAAM,CAAAE,UAAU,CAAGpB,YAAY,CAACK,OAAO,CAAC,cAAc,CAAC,CACvD,KAAM,CAAAgB,WAAW,CAAGrB,YAAY,CAACK,OAAO,CAAC,OAAO,CAAC,CACjD,GAAIe,UAAU,CAAE,CACd,KAAM,CAAAE,IAAI,CAAGpB,IAAI,CAACiB,KAAK,CAACC,UAAU,CAAC,CACnCpF,cAAc,CAACsF,IAAI,CAAC,CACpBxG,WAAW,CAACwG,IAAI,CAAChE,IAAI,CAAC,CACxB,CACA,GAAI+D,WAAW,CAAE,CACf,GAAI,CACF,KAAM,CAAAE,MAAM,CAAGrB,IAAI,CAACiB,KAAK,CAACE,WAAW,CAAC,CACtC/F,QAAQ,CAACkG,KAAK,CAACC,OAAO,CAACF,MAAM,CAAC,CAAGA,MAAM,CAAG,EAAE,CAAC,CAC/C,CAAE,MAAOX,CAAC,CAAE,CACVhB,OAAO,CAACiB,IAAI,CAAC,2CAA2C,CAAC,CACzDvF,QAAQ,CAAC,EAAE,CAAC,CACd,CACF,CACF,CAAE,MAAOuE,KAAK,CAAE,CACdD,OAAO,CAACe,GAAG,CAAC,wCAAwC,CAAC,CACrD;AACA,KAAM,CAAAe,cAAc,CAAG,CACrB,CACEC,EAAE,CAAE,WAAW,CACfX,KAAK,CAAE,qBAAqB,CAC5BY,KAAK,CAAE,IAAI,CACXC,QAAQ,CAAE,sBAAsB,CAChCC,WAAW,CAAE,mDAAmD,CAChEC,MAAM,CAAE,EAAE,CACVC,MAAM,CAAE,WAAW,CACnBC,aAAa,CAAE,GAAI,CAAA5D,IAAI,CAAC,CAAC,CAACC,WAAW,CAAC,CAAC,CACvC4D,SAAS,CAAE,CAAC,MAAM,CAAE,SAAS,CAAC,CAC9BC,UAAU,CAAE,YAAY,CACxBC,YAAY,CAAE,YAAY,CAC1BC,aAAa,CAAE,kBAAkB,CACjCC,aAAa,CAAE,kBAAkB,CACjCC,aAAa,CAAE,EAAE,CACjBnE,SAAS,CAAE,GAAI,CAAAC,IAAI,CAAC,CAAC,CAACC,WAAW,CAAC,CACpC,CAAC,CACD,CACEqD,EAAE,CAAE,WAAW,CACfX,KAAK,CAAE,6BAA6B,CACpCY,KAAK,CAAE,IAAI,CACXC,QAAQ,CAAE,uBAAuB,CACjCC,WAAW,CAAE,+CAA+C,CAC5DC,MAAM,CAAE,EAAE,CACVC,MAAM,CAAE,WAAW,CACnBC,aAAa,CAAE,GAAI,CAAA5D,IAAI,CAAC,CAAC,CAACC,WAAW,CAAC,CAAC,CACvC4D,SAAS,CAAE,CAAC,MAAM,CAAE,SAAS,CAAE,kBAAkB,CAAC,CAClDC,UAAU,CAAE,YAAY,CACxBC,YAAY,CAAE,UAAU,CACxBC,aAAa,CAAE,kBAAkB,CACjCC,aAAa,CAAE,kBAAkB,CACjCC,aAAa,CAAE,EAAE,CACjBnE,SAAS,CAAE,GAAI,CAAAC,IAAI,CAAC,CAAC,CAACC,WAAW,CAAC,CACpC,CAAC,CACD,CACEqD,EAAE,CAAE,WAAW,CACfX,KAAK,CAAE,mBAAmB,CAC1BY,KAAK,CAAE,IAAI,CACXC,QAAQ,CAAE,uBAAuB,CACjCC,WAAW,CAAE,8CAA8C,CAC3DC,MAAM,CAAE,EAAE,CACVC,MAAM,CAAE,WAAW,CACnBC,aAAa,CAAE,GAAI,CAAA5D,IAAI,CAAC,CAAC,CAACC,WAAW,CAAC,CAAC,CACvC4D,SAAS,CAAE,CAAC,SAAS,CAAE,MAAM,CAAC,CAC9BC,UAAU,CAAE,YAAY,CACxBC,YAAY,CAAE,cAAc,CAC5BC,aAAa,CAAE,kBAAkB,CACjCC,aAAa,CAAE,kBAAkB,CACjCC,aAAa,CAAE,EAAE,CACjBnE,SAAS,CAAE,GAAI,CAAAC,IAAI,CAAC,CAAC,CAACC,WAAW,CAAC,CACpC,CAAC,CACF,CACDpD,WAAW,CAACwG,cAAc,CAAC,CAC7B,CACF,CAAC,CAED;AACA,KAAM,CAAAc,kBAAkB,CAAG,QAAAA,CAACxE,KAAK,CAAEJ,KAAK,CAAsB,IAApB,CAAA6E,QAAQ,CAAAlF,SAAA,CAAAC,MAAA,IAAAD,SAAA,MAAAE,SAAA,CAAAF,SAAA,IAAG,IAAI,CACvD,KAAM,CAAAmF,eAAe,CAAG,CAAC1E,KAAK,EAAI,EAAE,EAAE2E,IAAI,CAAC,CAAC,CAC5C,KAAM,CAAAC,eAAe,CAAG,CAAChF,KAAK,EAAI,EAAE,EAAE+E,IAAI,CAAC,CAAC,CAACE,WAAW,CAAC,CAAC,CAC1D,GAAI,CAACxH,KAAK,EAAIA,KAAK,CAACmC,MAAM,GAAK,CAAC,CAAE,MAAO,MAAK,CAC9C,MAAO,CAAAnC,KAAK,CAACyH,IAAI,CAACC,CAAC,EAAI,CACrB,GAAIN,QAAQ,EAAIM,CAAC,CAACpB,EAAE,GAAKc,QAAQ,CAAE,MAAO,MAAK,CAC/C,KAAM,CAAAO,MAAM,CAAG,CAACD,CAAC,CAAC/E,KAAK,EAAI,EAAE,EAAE2E,IAAI,CAAC,CAAC,CACrC,KAAM,CAAAM,MAAM,CAAG,CAACF,CAAC,CAACnF,KAAK,EAAI,EAAE,EAAE+E,IAAI,CAAC,CAAC,CAACE,WAAW,CAAC,CAAC,CACnD,KAAM,CAAAK,UAAU,CAAGR,eAAe,EAAIM,MAAM,EAAIA,MAAM,GAAKN,eAAe,CAC1E,KAAM,CAAAS,UAAU,CAAGP,eAAe,EAAIK,MAAM,EAAIA,MAAM,GAAKL,eAAe,CAC1E,MAAO,CAAAM,UAAU,EAAIC,UAAU,CACjC,CAAC,CAAC,CACJ,CAAC,CAED;AACA,KAAM,CAAAC,SAAS,CAAG,QAAAA,CAACC,OAAO,CAAgC,IAA9B,CAAA/F,IAAI,CAAAC,SAAA,CAAAC,MAAA,IAAAD,SAAA,MAAAE,SAAA,CAAAF,SAAA,IAAG,MAAM,IAAE,CAAAyD,KAAK,CAAAzD,SAAA,CAAAC,MAAA,IAAAD,SAAA,MAAAE,SAAA,CAAAF,SAAA,IAAG,EAAE,CACnDb,QAAQ,CAAC,CAAE2G,OAAO,CAAE/F,IAAI,CAAE0D,KAAM,CAAC,CAAC,CAClCP,UAAU,CAAC,IAAM/D,QAAQ,CAAC,IAAI,CAAC,CAAE,IAAI,CAAC,CACxC,CAAC,CAED,KAAM,CAAA4G,4BAA4B,CAAGA,CAAA,GAAM,CACzCtD,YAAY,CAACC,OAAO,CAAC,mBAAmB,CAAE,KAAK,CAAC,CAChDjD,uBAAuB,CAAC,KAAK,CAAC,CAC9B,KAAM,CAAAyC,GAAG,CAAG7I,YAAY,CAAC,CAAC,CAC1BC,aAAa,CAAC4I,GAAG,CAAC,CAClBzI,UAAU,CAAC,2BAA2B,CAAC,CACvCoM,SAAS,CAAC,mBAAmB,CAAE,SAAS,CAAE,YAAY,CAAC,CACzD,CAAC,CAED,KAAM,CAAAG,6BAA6B,CAAGA,CAAA,GAAM,CAC1CvD,YAAY,CAACC,OAAO,CAAC,mBAAmB,CAAE,IAAI,CAAC,CAC/CjD,uBAAuB,CAAC,KAAK,CAAC,CAC9BoG,SAAS,CAAC,oBAAoB,CAAE,MAAM,CAAC,CACzC,CAAC,CAED,KAAM,CAAAI,YAAY,CAAG,KAAO,CAAAC,WAAW,EAAK,CAC1C,GAAI,CACFzD,YAAY,CAACC,OAAO,CAAC,UAAU,CAAEC,IAAI,CAACC,SAAS,CAACsD,WAAW,CAAC,CAAC,CAC7DvI,WAAW,CAACuI,WAAW,CAAC,CACxB;AACA,GAAIC,SAAS,CAACC,aAAa,EAAID,SAAS,CAACC,aAAa,CAACC,UAAU,CAAE,CACjE,GAAI,CAAEF,SAAS,CAACC,aAAa,CAACC,UAAU,CAACC,WAAW,CAAC,CAAEvG,IAAI,CAAE,eAAe,CAAEwD,OAAO,CAAE2C,WAAY,CAAC,CAAC,CAAE,CAAE,MAAAK,OAAA,CAAM,CAAC,CAClH,CACF,CAAE,MAAOjE,KAAK,CAAE,CACdD,OAAO,CAACC,KAAK,CAAC,wBAAwB,CAAEA,KAAK,CAAC,CAChD,CACF,CAAC,CAED,KAAM,CAAAkE,iBAAiB,CAAG,KAAO,CAAAC,aAAa,EAAK,CACjD,GAAI,CACFhE,YAAY,CAACC,OAAO,CAAC,eAAe,CAAEC,IAAI,CAACC,SAAS,CAAC6D,aAAa,CAAC,CAAC,CACtE,CAAE,MAAOnE,KAAK,CAAE,CACdD,OAAO,CAACC,KAAK,CAAC,6BAA6B,CAAEA,KAAK,CAAC,CACrD,CACF,CAAC,CAED,KAAM,CAAAoE,gBAAgB,CAAG,KAAAA,CAAA,GAAY,CACnC,GAAI,CACF,KAAM,CAAAC,GAAG,CAAGlE,YAAY,CAACK,OAAO,CAAC,eAAe,CAAC,CACjD,MAAO,CAAA6D,GAAG,CAAGhE,IAAI,CAACiB,KAAK,CAAC+C,GAAG,CAAC,CAAG,CAAC,CAAC,CACnC,CAAE,MAAOvE,GAAG,CAAE,CACZC,OAAO,CAACC,KAAK,CAAC,6BAA6B,CAAEF,GAAG,CAAC,CACnD,CACA,MAAO,CAAC,CAAC,CACX,CAAC,CAED,KAAM,CAAAwE,eAAe,CAAG,KAAAA,CAAOC,MAAM,CAAEC,IAAI,GAAK,CAC9C,GAAI,CAACD,MAAM,CAAE,CACX/G,aAAa,CAAC,QAAQ,CAAC,CACvB,OACF,CACA,GAAI,CAACgH,IAAI,EAAIA,IAAI,CAAC1B,IAAI,CAAC,CAAC,GAAK,EAAE,CAAE,CAC/B2B,KAAK,CAAC,0CAA0C,CAAC,CACjD,OACF,CACA,GAAI,CACF,KAAM,CAAAC,IAAI,CAAG,KAAM,CAAAN,gBAAgB,CAAC,CAAC,CACrCM,IAAI,CAACH,MAAM,CAAC,CAAGG,IAAI,CAACH,MAAM,CAAC,EAAI,EAAE,CACjC,GAAI,CAACG,IAAI,CAACH,MAAM,CAAC,CAACI,QAAQ,CAACH,IAAI,CAAC,CAAE,CAChCE,IAAI,CAACH,MAAM,CAAC,CAACK,IAAI,CAACJ,IAAI,CAAC,CACvB,KAAM,CAAAN,iBAAiB,CAACQ,IAAI,CAAC,CAC7BD,KAAK,8BAAAI,MAAA,CAA8BL,IAAI,CAAE,CAAC,CAC5C,CAAC,IAAM,CACLC,KAAK,kCAAAI,MAAA,CAAkCL,IAAI,CAAE,CAAC,CAChD,CACF,CAAE,MAAO1E,GAAG,CAAE,CACZC,OAAO,CAACC,KAAK,CAAC,kBAAkB,CAAEF,GAAG,CAAC,CACtC2E,KAAK,CAAC,wCAAwC,CAAC,CACjD,CACF,CAAC,CAIH,KAAM,CAAAK,kBAAkB,CAAG,KAAO,CAAAzG,WAAW,EAAK,CAChD,GAAI,CACF;AACA,GAAIsE,kBAAkB,CAACtE,WAAW,CAACF,KAAK,CAAEE,WAAW,CAACN,KAAK,CAAC,CAAE,CAC5DwF,SAAS,CAAC,mCAAmC,CAAE,OAAO,CAAE,WAAW,CAAC,CACpE,OACF,CACA,KAAM,CAAAgB,MAAM,SAAAM,MAAA,CAAWrG,IAAI,CAACuG,GAAG,CAAC,CAAC,CAAE,CACnC,KAAM,CAAAtD,IAAI,CAAAuD,aAAA,CAAAA,aAAA,EACRlD,EAAE,CAAEyC,MAAM,CACV9G,IAAI,CAAEzC,QAAQ,EACXqD,WAAW,MACd4G,QAAQ,CAAE5G,WAAW,CAAC4G,QAAQ,EAAI,EAAE,CACpCC,iBAAiB,CAAE,CAAEC,OAAO,CAAE,IAAI,CAAEC,SAAS,CAAE,KAAM,CAAC,CACtD7G,SAAS,CAAE,GAAI,CAAAC,IAAI,CAAC,CAAC,CAACC,WAAW,CAAC,CAAC,EACpC,CAED0B,YAAY,CAACC,OAAO,CAAC,cAAc,CAAEC,IAAI,CAACC,SAAS,CAACmB,IAAI,CAAC,CAAC,CAC1DtF,cAAc,CAACsF,IAAI,CAAC,CACpB;AACA,KAAM,CAAA4D,gBAAgB,CAAGlF,YAAY,CAACK,OAAO,CAAC,OAAO,CAAC,CACtD,GAAI,CAAA8E,aAAa,CAAG,EAAE,CACtB,GAAID,gBAAgB,CAAE,CACpB,GAAI,CAAEC,aAAa,CAAGjF,IAAI,CAACiB,KAAK,CAAC+D,gBAAgB,CAAC,CAAE,CAAE,MAAAE,QAAA,CAAM,CAAED,aAAa,CAAG,EAAE,CAAE,CACpF,CACAA,aAAa,CAACV,IAAI,CAACnD,IAAI,CAAC,CACxBtB,YAAY,CAACC,OAAO,CAAC,OAAO,CAAEC,IAAI,CAACC,SAAS,CAACgF,aAAa,CAAC,CAAC,CAC5D7J,QAAQ,CAAC6J,aAAa,CAAC,CACvB/B,SAAS,CAAC,+BAA+B,CAAE,SAAS,CAAE,UAAU,CAAC,CACjExI,cAAc,CAAC,QAAQ,CAAC,CAC1B,CAAE,MAAOiF,KAAK,CAAE,CACdD,OAAO,CAACC,KAAK,CAAC,uBAAuB,CAAEA,KAAK,CAAC,CAC7C;AACA,KAAM,CAAAuE,MAAM,SAAAM,MAAA,CAAWrG,IAAI,CAACuG,GAAG,CAAC,CAAC,CAAE,CACnC,KAAM,CAAAtD,IAAI,CAAAuD,aAAA,CAAAA,aAAA,EACRlD,EAAE,CAAEyC,MAAM,CACV9G,IAAI,CAAEzC,QAAQ,EACXqD,WAAW,MACd4G,QAAQ,CAAE5G,WAAW,CAAC4G,QAAQ,EAAI,EAAE,CACpC1G,SAAS,CAAE,GAAI,CAAAC,IAAI,CAAC,CAAC,CAACC,WAAW,CAAC,CAAC,EACpC,CACDtC,cAAc,CAACsF,IAAI,CAAC,CACpB,KAAM,CAAA4D,gBAAgB,CAAGlF,YAAY,CAACK,OAAO,CAAC,OAAO,CAAC,CACtD,GAAI,CAAA8E,aAAa,CAAG,EAAE,CACtB,GAAID,gBAAgB,CAAE,CACpB,GAAI,CAAEC,aAAa,CAAGjF,IAAI,CAACiB,KAAK,CAAC+D,gBAAgB,CAAC,CAAE,CAAE,MAAAG,QAAA,CAAM,CAAEF,aAAa,CAAG,EAAE,CAAE,CACpF,CACAA,aAAa,CAACV,IAAI,CAACnD,IAAI,CAAC,CACxB,GAAI,CAAEtB,YAAY,CAACC,OAAO,CAAC,OAAO,CAAEC,IAAI,CAACC,SAAS,CAACgF,aAAa,CAAC,CAAC,CAAE,CAAE,MAAAG,QAAA,CAAM,CAAC,CAC7EhK,QAAQ,CAAC6J,aAAa,CAAC,CACvB/B,SAAS,CAAC,6CAA6C,CAAE,OAAO,CAAC,CACjExI,cAAc,CAAC,QAAQ,CAAC,CAC1B,CACF,CAAC,CAED,KAAM,CAAA2K,mBAAmB,CAAG,KAAO,CAAArH,WAAW,EAAK,CACjD,GAAI,CACF;AACA,GAAIsE,kBAAkB,CAACtE,WAAW,CAACF,KAAK,CAAEE,WAAW,CAACN,KAAK,CAAE7B,WAAW,SAAXA,WAAW,iBAAXA,WAAW,CAAE4F,EAAE,CAAC,CAAE,CAC7EyB,SAAS,CAAC,gDAAgD,CAAE,OAAO,CAAE,WAAW,CAAC,CACjF,OACF,CACA,KAAM,CAAAoC,WAAW,CAAAX,aAAA,CAAAA,aAAA,IAAQ9I,WAAW,EAAKmC,WAAW,CAAE,CAEtD8B,YAAY,CAACC,OAAO,CAAC,cAAc,CAAEC,IAAI,CAACC,SAAS,CAACqF,WAAW,CAAC,CAAC,CACjExJ,cAAc,CAACwJ,WAAW,CAAC,CAC3B;AACA,KAAM,CAAAN,gBAAgB,CAAGlF,YAAY,CAACK,OAAO,CAAC,OAAO,CAAC,CACtD,GAAI,CAAA8E,aAAa,CAAG,EAAE,CACtB,GAAID,gBAAgB,CAAE,CACpB,GAAI,CAAEC,aAAa,CAAGjF,IAAI,CAACiB,KAAK,CAAC+D,gBAAgB,CAAC,CAAE,CAAE,MAAAO,QAAA,CAAM,CAAEN,aAAa,CAAG,EAAE,CAAE,CACpF,CACA,KAAM,CAAAO,GAAG,CAAGP,aAAa,CAACQ,SAAS,CAAC5C,CAAC,EAAIA,CAAC,CAACpB,EAAE,GAAK6D,WAAW,CAAC7D,EAAE,CAAC,CACjE,GAAI+D,GAAG,GAAK,CAAC,CAAC,CAAE,CACdP,aAAa,CAACO,GAAG,CAAC,CAAGF,WAAW,CAClC,CAAC,IAAM,CACLL,aAAa,CAACV,IAAI,CAACe,WAAW,CAAC,CAAE;AACnC,CACAxF,YAAY,CAACC,OAAO,CAAC,OAAO,CAAEC,IAAI,CAACC,SAAS,CAACgF,aAAa,CAAC,CAAC,CAC5D7J,QAAQ,CAAC6J,aAAa,CAAC,CACvB/B,SAAS,CAAC,+BAA+B,CAAE,SAAS,CAAC,CACrDxI,cAAc,CAAC,QAAQ,CAAC,CAC1B,CAAE,MAAOiF,KAAK,CAAE,CACdD,OAAO,CAACC,KAAK,CAAC,yBAAyB,CAAEA,KAAK,CAAC,CAC/C,KAAM,CAAA2F,WAAW,CAAAX,aAAA,CAAAA,aAAA,IAAQ9I,WAAW,EAAKmC,WAAW,CAAE,CACtDlC,cAAc,CAACwJ,WAAW,CAAC,CAC3B,KAAM,CAAAN,gBAAgB,CAAGlF,YAAY,CAACK,OAAO,CAAC,OAAO,CAAC,CACtD,GAAI,CAAA8E,aAAa,CAAG,EAAE,CACtB,GAAID,gBAAgB,CAAE,CACpB,GAAI,CAAEC,aAAa,CAAGjF,IAAI,CAACiB,KAAK,CAAC+D,gBAAgB,CAAC,CAAE,CAAE,MAAAU,QAAA,CAAM,CAAET,aAAa,CAAG,EAAE,CAAE,CACpF,CACA,KAAM,CAAAO,GAAG,CAAGP,aAAa,CAACQ,SAAS,CAAC5C,CAAC,EAAIA,CAAC,CAACpB,EAAE,GAAK6D,WAAW,CAAC7D,EAAE,CAAC,CACjE,GAAI+D,GAAG,GAAK,CAAC,CAAC,CAAE,CACdP,aAAa,CAACO,GAAG,CAAC,CAAGF,WAAW,CAClC,CAAC,IAAM,CACLL,aAAa,CAACV,IAAI,CAACe,WAAW,CAAC,CACjC,CACA,GAAI,CAAExF,YAAY,CAACC,OAAO,CAAC,OAAO,CAAEC,IAAI,CAACC,SAAS,CAACgF,aAAa,CAAC,CAAC,CAAE,CAAE,MAAAU,QAAA,CAAM,CAAC,CAC7EvK,QAAQ,CAAC6J,aAAa,CAAC,CACvB/B,SAAS,CAAC,6CAA6C,CAAE,OAAO,CAAC,CACjExI,cAAc,CAAC,QAAQ,CAAC,CAC1B,CACF,CAAC,CAED;AACA,KAAM,CAAAkL,aAAa,CAAG,KAAAA,CAAA,GAAY,CAChC,GAAI,CACF,KAAM,CAAA5L,eAAe,CAAC,CAAC,CACvB8B,cAAc,CAAC,IAAI,CAAC,CACpBE,cAAc,CAAC,IAAI,CAAC,CACpBpB,WAAW,CAAC,IAAI,CAAC,CACjBF,cAAc,CAAC,QAAQ,CAAC,CACxBwI,SAAS,CAAC,0BAA0B,CAAE,MAAM,CAAC,CAC/C,CAAE,MAAOxC,CAAC,CAAE,CACVhB,OAAO,CAACC,KAAK,CAAC,iBAAiB,CAAEe,CAAC,CAAC,CACnCwC,SAAS,CAAC,sCAAsC,CAAE,OAAO,CAAC,CAC5D,CACF,CAAC,CAED,KAAM,CAAA2C,wBAAwB,CAAG,KAAO,CAAAC,WAAW,EAAK,CACtD,GAAI,CACF,GAAIjK,WAAW,SAAXA,WAAW,WAAXA,WAAW,CAAEyC,GAAG,CAAE,CACpB,KAAM,CAAAhH,eAAe,CAACuE,WAAW,CAACyC,GAAG,CAAE,CACrCD,gBAAgB,CAAE,IAAI,CACtB0H,YAAY,CAAED,WAChB,CAAC,CAAC,CACF9J,cAAc,CAACgK,IAAI,EAAArB,aAAA,CAAAA,aAAA,IAAUqB,IAAI,MAAE3H,gBAAgB,CAAE,IAAI,CAAE0H,YAAY,CAAED,WAAW,EAAG,CAAC,CAC1F,CACApL,cAAc,CAAC,QAAQ,CAAC,CACxBwI,SAAS,CAAC,gDAAgD,CAAE,SAAS,CAAC,CACxE,CAAE,MAAOzD,GAAG,CAAE,CACZC,OAAO,CAACC,KAAK,CAAC,wBAAwB,CAAEF,GAAG,CAAC,CAC5C/E,cAAc,CAAC,QAAQ,CAAC,CAC1B,CACF,CAAC,CAED,KAAM,CAAAuL,gBAAgB,CAAG,KAAO,CAAAC,WAAW,EAAK,KAAAC,qBAAA,CAAAC,qBAAA,CAC9C;AACA,KAAM,CAAAC,WAAW,CAAG,CAACH,WAAW,CAACI,aAAa,CAAEJ,WAAW,CAACvE,QAAQ,CAAC,CAClE3C,MAAM,CAACuH,OAAO,CAAC,CACfC,IAAI,CAAC,IAAI,CAAC,CAEb,KAAM,CAAAC,cAAc,CAAG,CACrB3F,KAAK,CAAEoF,WAAW,CAACpF,KAAK,CACxBY,KAAK,CAAEwE,WAAW,CAACxE,KAAK,CACxBC,QAAQ,CAAEuE,WAAW,CAACvE,QAAQ,CAC9B2E,aAAa,CAAEJ,WAAW,CAACI,aAAa,EAAI,EAAE,CAC9CD,WAAW,CAAEA,WAAW,EAAIH,WAAW,CAACvE,QAAQ,EAAI,EAAE,CAAE;AACxDC,WAAW,CAAEsE,WAAW,CAACtE,WAAW,CACpCC,MAAM,CAAEqE,WAAW,CAACrE,MAAM,EAAI,EAAE,CAChCC,MAAM,CAAEoE,WAAW,CAACpE,MAAM,EAAI,WAAW,CACzCC,aAAa,CAAEmE,WAAW,CAACnE,aAAa,EAAI,GAAI,CAAA5D,IAAI,CAAC,CAAC,CAACC,WAAW,CAAC,CAAC,CACpE4D,SAAS,CAAEkE,WAAW,CAAClE,SAAS,EAAI,EAAE,CACtC0E,QAAQ,EAAAP,qBAAA,CAAED,WAAW,CAACQ,QAAQ,UAAAP,qBAAA,UAAAA,qBAAA,CAAI,IAAI,CACtCQ,SAAS,EAAAP,qBAAA,CAAEF,WAAW,CAACS,SAAS,UAAAP,qBAAA,UAAAA,qBAAA,CAAI,IAAI,CACxCQ,aAAa,CAAEV,WAAW,CAACU,aAAa,EAAI,eAAe,CAC3DC,OAAO,CAAE,CAAC,CAACX,WAAW,CAACW,OAAO,CAC9B;AACA5E,UAAU,CAAE,CAAApG,WAAW,SAAXA,WAAW,iBAAXA,WAAW,CAAEyC,GAAG,IAAIzC,WAAW,SAAXA,WAAW,iBAAXA,WAAW,CAAE4F,EAAE,EAC/CS,YAAY,CAAE,CAAAnG,WAAW,SAAXA,WAAW,iBAAXA,WAAW,CAAE6B,WAAW,IAAI/B,WAAW,SAAXA,WAAW,iBAAXA,WAAW,CAAE+B,WAAW,GAAI,EAAE,CACxEuE,aAAa,CAAE,CAAApG,WAAW,SAAXA,WAAW,iBAAXA,WAAW,CAAE+B,KAAK,GAAI,EAAE,CACvCsE,aAAa,CAAE,CAAAvG,WAAW,SAAXA,WAAW,iBAAXA,WAAW,CAAE6B,KAAK,GAAI,EAAE,CACvC2E,aAAa,CAAE,CAAAtG,WAAW,SAAXA,WAAW,iBAAXA,WAAW,CAAEkC,QAAQ,IAAIpC,WAAW,SAAXA,WAAW,iBAAXA,WAAW,CAAEoC,QAAQ,GAAI,EACnE,CAAC,CAED,GAAI,CACF;AACA,KAAM,CAAA6I,WAAW,CAAG,KAAM,CAAA9P,UAAU,CAACyP,cAAc,CAAC,CACpD,GAAIK,WAAW,CAAE,CACf;AACA,KAAM,CAAAC,UAAU,CAAApC,aAAA,CAAAA,aAAA,IAAQ8B,cAAc,MAAEhF,EAAE,CAAEqF,WAAW,CAAE5I,SAAS,CAAE,GAAI,CAAAC,IAAI,CAAC,CAAC,CAACC,WAAW,CAAC,CAAC,EAAE,CAC9F,KAAM,CAAA4I,eAAe,CAAG,CAAC,GAAGjM,QAAQ,CAAEgM,UAAU,CAAC,CACjD/L,WAAW,CAACgM,eAAe,CAAC,CAC5B;AACAlH,YAAY,CAACC,OAAO,CAAC,UAAU,CAAEC,IAAI,CAACC,SAAS,CAAC+G,eAAe,CAAC,CAAC,CACjE9D,SAAS,CAAC,oCAAoC,CAAE,SAAS,CAAE,UAAU,CAAC,CACxE,CAAC,IAAM,CACL;AACA,KAAM,CAAA6D,UAAU,CAAApC,aAAA,CAAAA,aAAA,IAAQ8B,cAAc,MAAEhF,EAAE,YAAA+C,MAAA,CAAarG,IAAI,CAACuG,GAAG,CAAC,CAAC,CAAE,CAAExG,SAAS,CAAE,GAAI,CAAAC,IAAI,CAAC,CAAC,CAACC,WAAW,CAAC,CAAC,EAAE,CAC1G,KAAM,CAAA4I,eAAe,CAAG,CAAC,GAAGjM,QAAQ,CAAEgM,UAAU,CAAC,CACjD,KAAM,CAAAzD,YAAY,CAAC0D,eAAe,CAAC,CACnC9D,SAAS,CAAC,sCAAsC,CAAE,MAAM,CAAE,OAAO,CAAC,CACpE,CACF,CAAE,MAAOvD,KAAK,CAAE,CACdD,OAAO,CAACC,KAAK,CAAC,uBAAuB,CAAEA,KAAK,CAAC,CAC7C;AACA,KAAM,CAAAoH,UAAU,CAAApC,aAAA,CAAAA,aAAA,IAAQ8B,cAAc,MAAEhF,EAAE,YAAA+C,MAAA,CAAarG,IAAI,CAACuG,GAAG,CAAC,CAAC,CAAE,CAAExG,SAAS,CAAE,GAAI,CAAAC,IAAI,CAAC,CAAC,CAACC,WAAW,CAAC,CAAC,EAAE,CAC1G,KAAM,CAAA4I,eAAe,CAAG,CAAC,GAAGjM,QAAQ,CAAEgM,UAAU,CAAC,CACjD,KAAM,CAAAzD,YAAY,CAAC0D,eAAe,CAAC,CACnC9D,SAAS,CAAC,uBAAuB,CAAE,MAAM,CAAE,OAAO,CAAC,CACrD,CAEAxI,cAAc,CAAC,QAAQ,CAAC,CACxB;AACAuM,MAAM,CAACC,QAAQ,CAAC,CAAEC,GAAG,CAAE,CAAC,CAAEC,QAAQ,CAAE,QAAS,CAAC,CAAC,CACjD,CAAC,CAEC;AAEF,KAAM,CAAAC,gBAAgB,CAAGtM,QAAQ,CAC9BiE,MAAM,CAACsI,OAAO,EAAI,CACjB,KAAM,CAAAC,eAAe,CAAG,CAAClM,cAAc,EACrC,CAACiM,OAAO,CAAC3F,QAAQ,EAAI,EAAE,EAAEgB,WAAW,CAAC,CAAC,CAAC2B,QAAQ,CAACjJ,cAAc,CAACsH,WAAW,CAAC,CAAC,CAAC,CAC/E,KAAM,CAAAjB,KAAK,CAAG8F,UAAU,CAACF,OAAO,CAAC5F,KAAK,CAAC,CACvC,KAAM,CAAA+F,YAAY,CAAG/F,KAAK,EAAInG,UAAU,CAAC,CAAC,CAAC,EAAImG,KAAK,EAAInG,UAAU,CAAC,CAAC,CAAC,CACrE,KAAM,CAAAmM,gBAAgB,CAAGjM,iBAAiB,CAAC6B,MAAM,GAAK,CAAC,EACrD7B,iBAAiB,CAACkM,KAAK,CAACC,OAAO,OAAAC,kBAAA,QAAAA,kBAAA,CAAIP,OAAO,CAACtF,SAAS,UAAA6F,kBAAA,iBAAjBA,kBAAA,CAAmBvD,QAAQ,CAACsD,OAAO,CAAC,GAAC,CAE1E,MAAO,CAAAL,eAAe,EAAIE,YAAY,EAAIC,gBAAgB,CAC5D,CAAC,CAAC,CACDI,IAAI,CAAC,CAACC,CAAC,CAAEC,CAAC,GAAK,CACd,GAAID,CAAC,CAAClB,OAAO,EAAI,CAACmB,CAAC,CAACnB,OAAO,CAAE,MAAO,CAAC,CAAC,CACtC,GAAI,CAACkB,CAAC,CAAClB,OAAO,EAAImB,CAAC,CAACnB,OAAO,CAAE,MAAO,EAAC,CACrC,GAAIlL,MAAM,GAAK,QAAQ,CAAE,CACvB,MAAO,IAAI,CAAAwC,IAAI,CAAC6J,CAAC,CAAC9J,SAAS,CAAC,CAAG,GAAI,CAAAC,IAAI,CAAC4J,CAAC,CAAC7J,SAAS,CAAC,CACtD,CAAC,IAAM,IAAIvC,MAAM,GAAK,UAAU,CAAE,CAChC,MAAO,CAAA6L,UAAU,CAACO,CAAC,CAACrG,KAAK,CAAC,CAAG8F,UAAU,CAACQ,CAAC,CAACtG,KAAK,CAAC,CAClD,CAAC,IAAM,IAAI/F,MAAM,GAAK,WAAW,CAAE,CACjC,MAAO,CAAA6L,UAAU,CAACQ,CAAC,CAACtG,KAAK,CAAC,CAAG8F,UAAU,CAACO,CAAC,CAACrG,KAAK,CAAC,CAClD,CACA,MAAO,EAAC,CACV,CAAC,CAAC,CAEF;AACA;AACA;AAEA,mBACErH,KAAA,QAAK4N,SAAS,CAAC,yDAAyD,CAAAC,QAAA,eAEtE/N,IAAA,CAACb,gBAAgB,GAAE,CAAC,cAGpBa,IAAA,CAACZ,SAAS,GAAE,CAAC,cAEbY,IAAA,CAACtB,MAAM,EACLgD,WAAW,CAAEA,WAAY,CACzBhB,eAAe,CAAEA,eAAgB,CACjCC,kBAAkB,CAAEA,kBAAmB,CACvCqC,aAAa,CAAEA,aAAc,CAC7ByI,aAAa,CAAEA,aAAc,CAC7BlL,cAAc,CAAEA,cAAe,CAC/BuC,WAAW,CAAEA,WAAY,CACzBkL,mBAAmB,CAAEA,CAAA,GAAMnL,yBAAyB,CAAC,IAAI,CAAE,CAC5D,CAAC,CAGDL,kBAAkB,eACjBxC,IAAA,CAACjB,kBAAkB,EACjB4H,KAAK,CAAEnE,kBAAkB,CAACmE,KAAM,CAChCC,IAAI,CAAEpE,kBAAkB,CAACoE,IAAK,CAC9BqH,OAAO,CAAEA,CAAA,GAAMxL,qBAAqB,CAAC,IAAI,CAAE,CAC5C,CACF,CAGAL,KAAK,eACJpC,IAAA,QAAK8N,SAAS,0EAAAzD,MAAA,CACZjI,KAAK,CAACa,IAAI,GAAK,OAAO,CAAG,yDAAyD,CAClFb,KAAK,CAACa,IAAI,GAAK,SAAS,CAAG,iEAAiE,CAC5Fb,KAAK,CAACa,IAAI,GAAK,SAAS,CAAG,8DAA8D,CACzF,wDAAwD,kEACO,CAAA8K,QAAA,cAC/D7N,KAAA,QAAK4N,SAAS,CAAC,wBAAwB,CAAAC,QAAA,eACrC7N,KAAA,QAAK4N,SAAS,gFAAAzD,MAAA,CACZjI,KAAK,CAACa,IAAI,GAAK,OAAO,CAAG,aAAa,CACtCb,KAAK,CAACa,IAAI,GAAK,SAAS,CAAG,gBAAgB,CAC3Cb,KAAK,CAACa,IAAI,GAAK,SAAS,CAAG,cAAc,CACzC,YAAY,CACX,CAAA8K,QAAA,EACA3L,KAAK,CAACa,IAAI,GAAK,SAAS,eAAIjD,IAAA,CAAC7B,WAAW,EAAC2P,SAAS,CAAC,oBAAoB,CAAE,CAAC,CAC1E1L,KAAK,CAACa,IAAI,GAAK,OAAO,eAAIjD,IAAA,SAAM8N,SAAS,CAAC,8BAA8B,CAAAC,QAAA,CAAC,QAAC,CAAM,CAAC,CACjF3L,KAAK,CAACa,IAAI,GAAK,SAAS,eAAIjD,IAAA,SAAM8N,SAAS,CAAC,8BAA8B,CAAAC,QAAA,CAAC,GAAC,CAAM,CAAC,CACnF3L,KAAK,CAACa,IAAI,GAAK,MAAM,eAAIjD,IAAA,SAAM8N,SAAS,CAAC,8BAA8B,CAAAC,QAAA,CAAC,GAAC,CAAM,CAAC,EAC9E,CAAC,cACN7N,KAAA,QAAK4N,SAAS,CAAC,gBAAgB,CAAAC,QAAA,EAC5B3L,KAAK,CAACuE,KAAK,eAAI3G,IAAA,MAAG8N,SAAS,qBAAAzD,MAAA,CAC1BjI,KAAK,CAACa,IAAI,GAAK,OAAO,CAAG,eAAe,CACxCb,KAAK,CAACa,IAAI,GAAK,SAAS,CAAG,kBAAkB,CAC7Cb,KAAK,CAACa,IAAI,GAAK,SAAS,CAAG,gBAAgB,CAC3C,cAAc,CACb,CAAA8K,QAAA,CAAE3L,KAAK,CAACuE,KAAK,CAAI,CAAC,cACrB3G,IAAA,MAAG8N,SAAS,YAAAzD,MAAA,CACVjI,KAAK,CAACa,IAAI,GAAK,OAAO,CAAG,eAAe,CACxCb,KAAK,CAACa,IAAI,GAAK,SAAS,CAAG,kBAAkB,CAC7Cb,KAAK,CAACa,IAAI,GAAK,SAAS,CAAG,gBAAgB,CAC3C,cAAc,CACb,CAAA8K,QAAA,CAAE3L,KAAK,CAAC4G,OAAO,CAAI,CAAC,EACpB,CAAC,cACNhJ,IAAA,WACEkO,OAAO,CAAEA,CAAA,GAAM7L,QAAQ,CAAC,IAAI,CAAE,CAC9ByL,SAAS,gEAAAzD,MAAA,CACPjI,KAAK,CAACa,IAAI,GAAK,OAAO,CAAG,mCAAmC,CAC5Db,KAAK,CAACa,IAAI,GAAK,SAAS,CAAG,yCAAyC,CACpEb,KAAK,CAACa,IAAI,GAAK,SAAS,CAAG,qCAAqC,CAChE,iCAAiC,CAChC,CACH,aAAW,oBAAoB,CAAA8K,QAAA,cAE/B/N,IAAA,CAAClC,CAAC,EAACgQ,SAAS,CAAC,SAAS,CAAE,CAAC,CACnB,CAAC,EACN,CAAC,CACH,CACN,cAED5N,KAAA,QAAKoH,EAAE,CAAC,cAAc,CAACwG,SAAS,CAAC,8CAA8C,CAACK,IAAI,CAAC,MAAM,CAAAJ,QAAA,EACxFzN,WAAW,GAAK,eAAe,eAC9BN,IAAA,CAACoO,gBAAgB,EAACC,QAAQ,CAAE/D,kBAAmB,CAAC9J,QAAQ,CAAEA,QAAS,CAAE,CACtE,CAEAF,WAAW,GAAK,SAAS,EAAIoB,WAAW,eACvC1B,IAAA,CAACsO,WAAW,EACVrH,IAAI,CAAE,CACJsH,IAAI,CAAE,CAAA3M,WAAW,SAAXA,WAAW,iBAAXA,WAAW,CAAE6B,WAAW,IAAI/B,WAAW,SAAXA,WAAW,iBAAXA,WAAW,CAAE+B,WAAW,GAAI,EAAE,CAChEF,KAAK,CAAE,CAAA7B,WAAW,SAAXA,WAAW,iBAAXA,WAAW,CAAE6B,KAAK,GAAI,EAAE,CAC/BI,KAAK,CAAE,CAAA/B,WAAW,SAAXA,WAAW,iBAAXA,WAAW,CAAE+B,KAAK,GAAI,EAAE,CAC/B6K,KAAK,CAAE,CAAA5M,WAAW,SAAXA,WAAW,iBAAXA,WAAW,CAAEkC,QAAQ,IAAIpC,WAAW,SAAXA,WAAW,iBAAXA,WAAW,CAAEoC,QAAQ,GAAI,EAAE,CAC3Db,IAAI,CAAE,CAAArB,WAAW,SAAXA,WAAW,iBAAXA,WAAW,CAAEpB,QAAQ,GAAIA,QAAQ,EAAI,QAAQ,CACnDkK,iBAAiB,CAAE,CAAA9I,WAAW,SAAXA,WAAW,iBAAXA,WAAW,CAAE8I,iBAAiB,GAAI,CAAEC,OAAO,CAAE,IAAI,CAAEC,SAAS,CAAE,KAAM,CACzF,CAAE,CACF6D,MAAM,CAAEA,CAAA,GAAMlO,cAAc,CAAC,cAAc,CAAE,CAC7CmO,SAAS,CAAEjD,aAAc,CACzBkD,eAAe,CAAEnR,kBAAkB,CAAC,CAAE,CACtCoR,YAAY,CAAE,KAAAA,CAAA,GAAY,CACxB,KAAM,CAAAnR,iBAAiB,CAAC,CAAC,CACzB;AACAqP,MAAM,CAACtF,QAAQ,CAACqH,MAAM,CAAC,CAAC,CAC1B,CAAE,CACFC,WAAW,CAAEA,CAAA,GAAM,CACjB;AACA/F,SAAS,CAAC,4BAA4B,CAAE,MAAM,CAAC,CACjD,CAAE,CACFgG,aAAa,CAAE,KAAO,CAAAC,KAAK,EAAK,CAC9B,GAAItN,WAAW,SAAXA,WAAW,WAAXA,WAAW,CAAEyC,GAAG,CAAE,CACpB,GAAI,CACF,KAAM,CAAAhH,eAAe,CAACuE,WAAW,CAACyC,GAAG,CAAE,CAAEuG,iBAAiB,CAAEsE,KAAM,CAAC,CAAC,CACpEnN,cAAc,CAACgK,IAAI,EAAArB,aAAA,CAAAA,aAAA,IAAUqB,IAAI,MAAEnB,iBAAiB,CAAEsE,KAAK,EAAG,CAAC,CAC/DjG,SAAS,CAAC,qBAAqB,CAAE,SAAS,CAAC,CAC7C,CAAE,MAAOzD,GAAG,CAAE,CACZC,OAAO,CAACC,KAAK,CAAC,yBAAyB,CAAEF,GAAG,CAAC,CAC7CyD,SAAS,CAAC,8BAA8B,CAAE,OAAO,CAAC,CACpD,CACF,CACF,CAAE,CACH,CACF,CAEAzI,WAAW,GAAK,cAAc,EAAIoB,WAAW,eAC5C1B,IAAA,CAACiP,eAAe,EAAChI,IAAI,CAAEvF,WAAY,CAAC2M,QAAQ,CAAEnD,mBAAoB,CAACgE,QAAQ,CAAEA,CAAA,GAAM3O,cAAc,CAAC,SAAS,CAAE,CAAE,CAChH,CAEAD,WAAW,GAAK,qBAAqB,EAAIoB,WAAW,EAAIlB,QAAQ,GAAK,UAAU,eAC9ER,IAAA,CAACmP,sBAAsB,EAACC,UAAU,CAAE1D,wBAAyB,CAACwD,QAAQ,CAAEA,CAAA,GAAM3O,cAAc,CAAC,QAAQ,CAAE,CAACmB,WAAW,CAAEA,WAAY,CAAE,CACpI,CAEApB,WAAW,GAAK,QAAQ,eACbN,IAAA,CAACnB,UAAU,EACT+B,QAAQ,CAAEsM,gBAAiB,CAC3BhM,cAAc,CAAEA,cAAe,CAC/BC,iBAAiB,CAAEA,iBAAkB,CACrCC,UAAU,CAAEA,UAAW,CACvBC,aAAa,CAAEA,aAAc,CAC7BC,iBAAiB,CAAEA,iBAAkB,CACrCC,oBAAoB,CAAEA,oBAAqB,CAC3CC,MAAM,CAAEA,MAAO,CACfC,SAAS,CAAEA,SAAU,CACrB4N,eAAe,CAAEtO,kBAAmB,CACpCR,cAAc,CAAEA,cAAe,CAC/BmB,WAAW,CAAEA,WAAY,CACzB4N,aAAa,CAAEtM,aAAc,CAC7B8G,eAAe,CAAEA,eAAgB,CACjCyF,WAAW,CAAE7O,eAAgB,CAC9B,CACZ,CAIAJ,WAAW,GAAK,KAAK,eACpBN,IAAA,CAACwP,cAAc,EACbnB,QAAQ,CAAEvC,gBAAiB,CAC3BoD,QAAQ,CAAEA,CAAA,GAAM3O,cAAc,CAAC,QAAQ,CAAE,CACzCmB,WAAW,CAAEA,WAAY,CACzBlB,QAAQ,CAAEA,QAAS,CACnB8O,aAAa,CAAEtM,aAAc,CAC7ByM,mBAAmB,CAAEA,CAAA,GAAMlP,cAAc,CAAC,qBAAqB,CAAE,CAClE,CACF,CAEAD,WAAW,GAAK,aAAa,EAAIoB,WAAW,EAAIlB,QAAQ,GAAK,UAAU,eACtER,IAAA,CAAC0P,cAAc,EACb9O,QAAQ,CAAEA,QAAQ,CAACiE,MAAM,CAAC8K,CAAC,EAAIA,CAAC,CAAC7H,UAAU,GAAKpG,WAAW,CAACyC,GAAG,EAAIwL,CAAC,CAAC7H,UAAU,GAAKpG,WAAW,CAAC4F,EAAE,CAAE,CACpGsI,QAAQ,CAAE,KAAO,CAAAtI,EAAE,EAAK,CACtB,GAAI,CACF;AACA,KAAM,CAAAuI,OAAO,CAAG,KAAM,CAAA/S,aAAa,CAACwK,EAAE,CAAC,CACvC,GAAIuI,OAAO,CAAE,CACX9G,SAAS,CAAC,iBAAiB,CAAE,SAAS,CAAC,CACzC,CACF,CAAE,MAAOvD,KAAK,CAAE,CACdD,OAAO,CAACC,KAAK,CAAC,0BAA0B,CAAEA,KAAK,CAAC,CAClD,CACA;AACA,KAAM,CAAAsK,OAAO,CAAGlP,QAAQ,CAACiE,MAAM,CAAC8K,CAAC,EAAIA,CAAC,CAACrI,EAAE,GAAKA,EAAE,CAAC,CACjDzG,WAAW,CAACiP,OAAO,CAAC,CACpBnK,YAAY,CAACC,OAAO,CAAC,UAAU,CAAEC,IAAI,CAACC,SAAS,CAACgK,OAAO,CAAC,CAAC,CAC3D,CAAE,CACH,CACF,CAEAxP,WAAW,GAAK,WAAW,eAC1BN,IAAA,CAAC+P,aAAa,EACZnP,QAAQ,CAAEA,QAAS,CACnByO,eAAe,CAAEtO,kBAAmB,CACrC,CACF,EACE,CAAC,CAELD,eAAe,eACdd,IAAA,CAACrB,kBAAkB,EACjBwO,OAAO,CAAErM,eAAgB,CACzBkP,QAAQ,CAAE,CACRzB,IAAI,CAAEzN,eAAe,CAACiH,YAAY,CAClCpE,KAAK,CAAE7C,eAAe,CAACkH,aAAa,CACpCzE,KAAK,CAAEzC,eAAe,CAACmH,aAAa,CACpCuG,KAAK,CAAE1N,eAAe,CAACoH,aACzB,CAAE,CACF+F,OAAO,CAAEA,CAAA,GAAMlN,kBAAkB,CAAC,IAAI,CAAE,CACxCP,QAAQ,CAAEA,QAAS,CACnBkB,WAAW,CAAEA,WAAY,CACzB4N,aAAa,CAAEtM,aAAc,CAC7BuM,WAAW,CAAE7O,eAAgB,CAC7BqI,SAAS,CAAEA,SAAU,CACtB,CACF,CAIA/G,aAAa,eACZhC,IAAA,CAACiQ,SAAS,EACRC,WAAW,CAAEhO,eAAgB,CAC7B+L,OAAO,CAAEA,CAAA,GAAMhM,gBAAgB,CAAC,KAAK,CAAE,CACvCkO,SAAS,CAAEA,CAAA,GAAM,CACfpH,SAAS,CAAC,yBAAyB,CAAE,SAAS,CAAE,UAAU,CAAC,CAC7D,CAAE,CACF1F,aAAa,CAAEA,aAAc,CAC9B,CACF,cAEDrD,IAAA,CAACoQ,SAAS,EACR9P,WAAW,CAAEA,WAAY,CACzBC,cAAc,CAAEA,cAAe,CAC/BC,QAAQ,CAAEA,QAAS,CACpB,CAAC,CAED8B,iBAAiB,eAChBtC,IAAA,CAAClB,kBAAkB,EAACmP,OAAO,CAAEA,CAAA,GAAM1L,oBAAoB,CAAC,KAAK,CAAE,CAAE,CAClE,CAEAG,oBAAoB,eACnB1C,IAAA,CAAChB,qBAAqB,EACpBqR,QAAQ,CAAEpH,4BAA6B,CACvCqH,SAAS,CAAEpH,6BAA8B,CAC1C,CACF,CAEAtG,sBAAsB,eACrB5C,IAAA,CAACf,kBAAkB,EACjBgP,OAAO,CAAEA,CAAA,GAAM,CACbpL,yBAAyB,CAAC,KAAK,CAAC,CAChCE,cAAc,CAAC1D,gBAAgB,CAAC,CAAC,CAACwF,MAAM,CAACC,CAAC,EAAI,CAACA,CAAC,CAACC,IAAI,CAAC,CAAC5B,MAAM,CAAC,CAChE,CAAE,CACFkM,eAAe,CAAGkB,SAAS,EAAK,CAC9B,KAAM,CAAApD,OAAO,CAAGvM,QAAQ,CAAC4P,IAAI,CAACb,CAAC,EAAI,CAACA,CAAC,CAACrI,EAAE,KAAA+C,MAAA,CAAOsF,CAAC,CAAChJ,KAAK,MAAA0D,MAAA,CAAIsF,CAAC,CAAC5L,SAAS,CAAE,IAAMwM,SAAS,CAAC,CACvF,GAAIpD,OAAO,CAAE,CACXpM,kBAAkB,CAACoM,OAAO,CAAC,CAC7B,CACAtK,yBAAyB,CAAC,KAAK,CAAC,CAClC,CAAE,CACH,CACF,cAED7C,IAAA,CAACpB,MAAM,EAAC6R,aAAa,CAAEA,CAAA,GAAMlO,oBAAoB,CAAC,IAAI,CAAE,CAAE,CAAC,EACxD,CAAC,CAEV,CAIA,QAAS,CAAA6L,gBAAgBA,CAAAsC,IAAA,CAAyB,IAAxB,CAAErC,QAAQ,CAAE7N,QAAS,CAAC,CAAAkQ,IAAA,CAC9C,KAAM,CAACC,QAAQ,CAAEC,WAAW,CAAC,CAAGzU,QAAQ,CAAC,CACvCoS,IAAI,CAAE,EAAE,CACR5K,KAAK,CAAE,EAAE,CACTJ,KAAK,CAAE,EAAE,CACTkH,QAAQ,CAAE,EAAE,CACZ+D,KAAK,CAAE,EACT,CAAC,CAAC,CACF,KAAM,CAACqC,MAAM,CAAEC,SAAS,CAAC,CAAG3U,QAAQ,CAAC,CAAC,CAAC,CAAC,CACxC,KAAM,CAAC4U,OAAO,CAAEC,UAAU,CAAC,CAAG7U,QAAQ,CAAC,CAAC,CAAC,CAAC,CAE1C,KAAM,CAAA8U,aAAa,CAAG,QAAAA,CAAC1C,IAAI,CAAE2C,KAAK,CAAkB,IAAhB,CAAAC,MAAM,CAAAjO,SAAA,CAAAC,MAAA,IAAAD,SAAA,MAAAE,SAAA,CAAAF,SAAA,IAAG,CAAC,CAAC,CAC7C,KAAM,CAAAkO,SAAS,CAAA5G,aAAA,IAAQqG,MAAM,CAAE,CAC/B,OAAQtC,IAAI,EACV,IAAK,MAAM,CACT,GAAI,CAAC2C,KAAK,EAAIA,KAAK,CAAC5I,IAAI,CAAC,CAAC,CAACnF,MAAM,CAAG,CAAC,CAAE,CACrCiO,SAAS,CAAC7C,IAAI,CAAG,oCAAoC,CACvD,CAAC,IAAM,CACL,MAAO,CAAA6C,SAAS,CAAC7C,IAAI,CACvB,CACA,MACF,IAAK,OAAO,CACV,GAAI,CAAC2C,KAAK,EAAI,CAAC,sBAAsB,CAACG,IAAI,CAACH,KAAK,CAAC5I,IAAI,CAAC,CAAC,CAAC,CAAE,CACxD8I,SAAS,CAACzN,KAAK,CAAG,2CAA2C,CAC/D,CAAC,IAAM,CACL,MAAO,CAAAyN,SAAS,CAACzN,KAAK,CACxB,CACA,MACF,IAAK,OAAO,CACV,GAAI,CAACuN,KAAK,EAAI,CAAC,4BAA4B,CAACG,IAAI,CAACH,KAAK,CAAC5I,IAAI,CAAC,CAAC,CAAC,CAAE,CAC9D8I,SAAS,CAAC7N,KAAK,CAAG,6BAA6B,CACjD,CAAC,IAAM,CACL,MAAO,CAAA6N,SAAS,CAAC7N,KAAK,CACxB,CACA,MACF,IAAK,OAAO,CACV,GAAI2N,KAAK,GAAK,gBAAgB,CAAE,CAC9BE,SAAS,CAAC5C,KAAK,CAAG,8BAA8B,CAClD,CAAC,IAAM,CACL,MAAO,CAAA4C,SAAS,CAAC5C,KAAK,CACxB,CACA,MACF,QACE,MACJ,CACAsC,SAAS,CAACM,SAAS,CAAC,CACtB,CAAC,CAED,KAAM,CAAAE,iBAAiB,CAAI/K,CAAC,EAAK,CAC/B,KAAM,CAAAgL,IAAI,CAAGhL,CAAC,CAACiL,MAAM,CAACC,KAAK,CAAC,CAAC,CAAC,CAC9B,GAAIF,IAAI,CAAE,CACR,GAAIA,IAAI,CAACG,IAAI,CAAG,CAAC,CAAG,IAAI,CAAG,IAAI,CAAE,CAAE;AACjCd,WAAW,CAAApG,aAAA,CAAAA,aAAA,IAAMmG,QAAQ,MAAEnC,KAAK,CAAE,EAAE,EAAE,CAAC,CACvCyC,aAAa,CAAC,OAAO,CAAE,gBAAgB,CAAC,CACxC,OACF,CACA,KAAM,CAAAU,MAAM,CAAG,GAAI,CAAAC,UAAU,CAAC,CAAC,CAC/BD,MAAM,CAACE,SAAS,CAAG,IAAM,CACvBjB,WAAW,CAAApG,aAAA,CAAAA,aAAA,IAAMmG,QAAQ,MAAEnC,KAAK,CAAEmD,MAAM,CAACG,MAAM,EAAE,CAAC,CAClDb,aAAa,CAAC,OAAO,CAAEU,MAAM,CAACG,MAAM,CAAC,CACvC,CAAC,CACDH,MAAM,CAACI,aAAa,CAACR,IAAI,CAAC,CAC5B,CACF,CAAC,CAED,KAAM,CAAAS,YAAY,CAAGA,CAAA,GAAM,CACzB;AACA,KAAM,CAAAC,UAAU,CAAG,CAAE1D,IAAI,CAAE,IAAI,CAAE5K,KAAK,CAAE,IAAI,CAAEJ,KAAK,CAAE,IAAI,CAAEiL,KAAK,CAAE,IAAK,CAAC,CACxEwC,UAAU,CAACiB,UAAU,CAAC,CACtBhB,aAAa,CAAC,MAAM,CAAEN,QAAQ,CAACpC,IAAI,CAAC,CACpC0C,aAAa,CAAC,OAAO,CAAEN,QAAQ,CAAChN,KAAK,CAAC,CACtCsN,aAAa,CAAC,OAAO,CAAEN,QAAQ,CAACpN,KAAK,CAAC,CACtC,GAAI2O,MAAM,CAACC,IAAI,CAACtB,MAAM,CAAC,CAAC1N,MAAM,GAAK,CAAC,EAAIwN,QAAQ,CAACpC,IAAI,EAAIoC,QAAQ,CAAChN,KAAK,EAAIgN,QAAQ,CAACpN,KAAK,CAAE,CACzF8K,QAAQ,CAACsC,QAAQ,CAAC,CACpB,CACF,CAAC,CAED,mBACE3Q,IAAA,QAAK8N,SAAS,CAAC,mEAAmE,CAAAC,QAAA,cAChF/N,IAAA,QAAK8N,SAAS,CAAC,wBAAwB,CAAAC,QAAA,cACrC7N,KAAA,QAAK4N,SAAS,CAAC,2DAA2D,CAAAC,QAAA,eACxE7N,KAAA,QAAK4N,SAAS,CAAC,kBAAkB,CAAAC,QAAA,eAC/B/N,IAAA,OAAI8N,SAAS,CAAC,4CAA4C,CAAAC,QAAA,CAAC,uBAAqB,CAAI,CAAC,cACrF/N,IAAA,MAAG8N,SAAS,CAAC,eAAe,CAAAC,QAAA,CAAC,8BAA4B,CAAG,CAAC,EAC1D,CAAC,cAEN7N,KAAA,QAAK4N,SAAS,CAAC,WAAW,CAAAC,QAAA,eAExB/N,IAAA,QAAK8N,SAAS,CAAC,0BAA0B,CAAAC,QAAA,cACvC7N,KAAA,QAAK4N,SAAS,CAAC,UAAU,CAAAC,QAAA,EACtB4C,QAAQ,CAACnC,KAAK,cACbxO,IAAA,QACEoS,GAAG,CAAEzB,QAAQ,CAACnC,KAAM,CACpB6D,GAAG,CAAC,SAAS,CACbvE,SAAS,CAAC,wEAAwE,CACnF,CAAC,cAEF9N,IAAA,QAAK8N,SAAS,CAAC,wIAAwI,CAAAC,QAAA,cACrJ/N,IAAA,CAACjC,IAAI,EAAC+P,SAAS,CAAC,yBAAyB,CAAE,CAAC,CACzC,CACN,cACD5N,KAAA,UAAO4N,SAAS,CAAC,+HAA+H,CAAC,aAAW,sBAAsB,CAAAC,QAAA,eAChL/N,IAAA,CAAC9B,IAAI,EAAC4P,SAAS,CAAC,SAAS,CAAE,CAAC,cAC5B9N,IAAA,UACEiD,IAAI,CAAC,MAAM,CACXqP,MAAM,CAAC,SAAS,CAChBC,QAAQ,CAAEjB,iBAAkB,CAC5BxD,SAAS,CAAC,QAAQ,CACnB,CAAC,EACG,CAAC,EACL,CAAC,CACH,CAAC,cAGN5N,KAAA,QAAA6N,QAAA,eACE/N,IAAA,UAAO8N,SAAS,CAAC,gDAAgD,CAAAC,QAAA,CAAC,aAAW,CAAO,CAAC,cACrF/N,IAAA,UACEiD,IAAI,CAAC,MAAM,CACXuP,QAAQ,MACRtB,KAAK,CAAEP,QAAQ,CAACpC,IAAK,CACrBgE,QAAQ,CAAGhM,CAAC,EAAK,CAAEqK,WAAW,CAAApG,aAAA,CAAAA,aAAA,IAAMmG,QAAQ,MAAEpC,IAAI,CAAEhI,CAAC,CAACiL,MAAM,CAACN,KAAK,EAAE,CAAC,CAAE,GAAIH,OAAO,CAACxC,IAAI,CAAE0C,aAAa,CAAC,MAAM,CAAE1K,CAAC,CAACiL,MAAM,CAACN,KAAK,CAAC,CAAE,CAAE,CAClIuB,MAAM,CAAGlM,CAAC,EAAK,CAAEyK,UAAU,CAAAxG,aAAA,CAAAA,aAAA,IAAMuG,OAAO,MAAExC,IAAI,CAAE,IAAI,EAAE,CAAC,CAAE0C,aAAa,CAAC,MAAM,CAAE1K,CAAC,CAACiL,MAAM,CAACN,KAAK,CAAC,CAAE,CAAE,CAClGwB,WAAW,CAAC,sBAAsB,CAClC,eAAc7B,MAAM,CAACtC,IAAI,CAAG,MAAM,CAAG,OAAQ,CAC7C,mBAAkBsC,MAAM,CAACtC,IAAI,CAAG,oBAAoB,CAAGnL,SAAU,CACjE0K,SAAS,8BAAAzD,MAAA,CAA+BwG,MAAM,CAACtC,IAAI,CAAG,gBAAgB,CAAG,iBAAiB,gIAA+H,CAC1N,CAAC,CACDsC,MAAM,CAACtC,IAAI,EAAIwC,OAAO,CAACxC,IAAI,eAAIvO,IAAA,MAAGsH,EAAE,CAAC,oBAAoB,CAACwG,SAAS,CAAC,2BAA2B,CAAAC,QAAA,CAAE8C,MAAM,CAACtC,IAAI,CAAI,CAAC,EAC/G,CAAC,cAENrO,KAAA,QAAA6N,QAAA,eACE/N,IAAA,UAAO8N,SAAS,CAAC,gDAAgD,CAAAC,QAAA,CAAC,gBAAc,CAAO,CAAC,cACxF7N,KAAA,QAAK4N,SAAS,CAAC,UAAU,CAAAC,QAAA,eACvB/N,IAAA,CAAChC,KAAK,EAAC8P,SAAS,CAAC,+CAA+C,CAAE,CAAC,cACnE9N,IAAA,UACEiD,IAAI,CAAC,KAAK,CACVuP,QAAQ,MACRtB,KAAK,CAAEP,QAAQ,CAAChN,KAAM,CACtB4O,QAAQ,CAAGhM,CAAC,EAAK,CAAEqK,WAAW,CAAApG,aAAA,CAAAA,aAAA,IAAMmG,QAAQ,MAAEhN,KAAK,CAAE4C,CAAC,CAACiL,MAAM,CAACN,KAAK,EAAE,CAAC,CAAE,GAAIH,OAAO,CAACpN,KAAK,CAAEsN,aAAa,CAAC,OAAO,CAAE1K,CAAC,CAACiL,MAAM,CAACN,KAAK,CAAC,CAAE,CAAE,CACrIuB,MAAM,CAAGlM,CAAC,EAAK,CAAEyK,UAAU,CAAAxG,aAAA,CAAAA,aAAA,IAAMuG,OAAO,MAAEpN,KAAK,CAAE,IAAI,EAAE,CAAC,CAAEsN,aAAa,CAAC,OAAO,CAAE1K,CAAC,CAACiL,MAAM,CAACN,KAAK,CAAC,CAAE,CAAE,CACpGwB,WAAW,CAAC,uBAAuB,CACnC,eAAc7B,MAAM,CAAClN,KAAK,CAAG,MAAM,CAAG,OAAQ,CAC9C,mBAAkBkN,MAAM,CAAClN,KAAK,CAAG,qBAAqB,CAAGP,SAAU,CACnE0K,SAAS,oCAAAzD,MAAA,CAAqCwG,MAAM,CAAClN,KAAK,CAAG,gBAAgB,CAAG,iBAAiB,gIAA+H,CACjO,CAAC,EACC,CAAC,CACLkN,MAAM,CAAClN,KAAK,EAAIoN,OAAO,CAACpN,KAAK,eAAI3D,IAAA,MAAGsH,EAAE,CAAC,qBAAqB,CAACwG,SAAS,CAAC,2BAA2B,CAAAC,QAAA,CAAE8C,MAAM,CAAClN,KAAK,CAAI,CAAC,EACnH,CAAC,cAENzD,KAAA,QAAA6N,QAAA,eACE/N,IAAA,UAAO8N,SAAS,CAAC,gDAAgD,CAAAC,QAAA,CAAC,iBAAe,CAAO,CAAC,cACzF7N,KAAA,QAAK4N,SAAS,CAAC,UAAU,CAAAC,QAAA,eACvB/N,IAAA,CAAC/B,IAAI,EAAC6P,SAAS,CAAC,+CAA+C,CAAE,CAAC,cAClE9N,IAAA,UACEiD,IAAI,CAAC,OAAO,CACZuP,QAAQ,MACRtB,KAAK,CAAEP,QAAQ,CAACpN,KAAM,CACtBgP,QAAQ,CAAGhM,CAAC,EAAK,CAAEqK,WAAW,CAAApG,aAAA,CAAAA,aAAA,IAAMmG,QAAQ,MAAEpN,KAAK,CAAEgD,CAAC,CAACiL,MAAM,CAACN,KAAK,EAAE,CAAC,CAAE,GAAIH,OAAO,CAACxN,KAAK,CAAE0N,aAAa,CAAC,OAAO,CAAE1K,CAAC,CAACiL,MAAM,CAACN,KAAK,CAAC,CAAE,CAAE,CACrIuB,MAAM,CAAGlM,CAAC,EAAK,CAAEyK,UAAU,CAAAxG,aAAA,CAAAA,aAAA,IAAMuG,OAAO,MAAExN,KAAK,CAAE,IAAI,EAAE,CAAC,CAAE0N,aAAa,CAAC,OAAO,CAAE1K,CAAC,CAACiL,MAAM,CAACN,KAAK,CAAC,CAAE,CAAE,CACpGwB,WAAW,CAAC,wBAAwB,CACpC,eAAc7B,MAAM,CAACtN,KAAK,CAAG,MAAM,CAAG,OAAQ,CAC9C,mBAAkBsN,MAAM,CAACtN,KAAK,CAAG,qBAAqB,CAAGH,SAAU,CACnE0K,SAAS,oCAAAzD,MAAA,CAAqCwG,MAAM,CAACtN,KAAK,CAAG,gBAAgB,CAAG,iBAAiB,gIAA+H,CACjO,CAAC,EACC,CAAC,CACLsN,MAAM,CAACtN,KAAK,EAAIwN,OAAO,CAACxN,KAAK,eAAIvD,IAAA,MAAGsH,EAAE,CAAC,qBAAqB,CAACwG,SAAS,CAAC,2BAA2B,CAAAC,QAAA,CAAE8C,MAAM,CAACtN,KAAK,CAAI,CAAC,EACnH,CAAC,cAENrD,KAAA,QAAA6N,QAAA,eACE/N,IAAA,UAAO8N,SAAS,CAAC,gDAAgD,CAAAC,QAAA,CAAC,qBAAmB,CAAO,CAAC,cAC7F7N,KAAA,QAAK4N,SAAS,CAAC,UAAU,CAAAC,QAAA,eACvB/N,IAAA,CAAChC,KAAK,EAAC8P,SAAS,CAAC,+CAA+C,CAAE,CAAC,cACnE9N,IAAA,UACEiD,IAAI,CAAC,KAAK,CACViO,KAAK,CAAEP,QAAQ,CAAClG,QAAS,CACzB8H,QAAQ,CAAGhM,CAAC,EAAKqK,WAAW,CAAApG,aAAA,CAAAA,aAAA,IAAMmG,QAAQ,MAAElG,QAAQ,CAAElE,CAAC,CAACiL,MAAM,CAACN,KAAK,EAAE,CAAE,CACxEwB,WAAW,CAAC,uBAAuB,CACnC5E,SAAS,CAAC,6KAA6K,CACxL,CAAC,EACC,CAAC,cACN9N,IAAA,MAAG8N,SAAS,CAAC,4BAA4B,CAAAC,QAAA,CAAC,uDAAqD,CAAG,CAAC,EAChG,CAAC,cAGN/N,IAAA,WACEkO,OAAO,CAAE8D,YAAa,CACtBlE,SAAS,CAAC,4KAA4K,CAAAC,QAAA,CACvL,gBAED,CAAQ,CAAC,EACN,CAAC,EACH,CAAC,CACH,CAAC,CACH,CAAC,CAEV,CAEA,QAAS,CAAAO,WAAWA,CAAAqE,KAAA,CAAyF,KAAAC,UAAA,CAAAC,iBAAA,IAAxF,CAAE5L,IAAI,CAAEwH,MAAM,CAAEM,aAAa,CAAEL,SAAS,CAAEC,eAAe,CAAEC,YAAY,CAAEE,WAAY,CAAC,CAAA6D,KAAA,CACzG,KAAM,CAAA3D,KAAK,CAAG/H,IAAI,CAACyD,iBAAiB,EAAI,CAAEC,OAAO,CAAE,IAAI,CAAEC,SAAS,CAAE,KAAM,CAAC,CAC3E,KAAM,CAACkI,UAAU,CAAEC,aAAa,CAAC,CAAG7W,KAAK,CAACC,QAAQ,CAAC6S,KAAK,CAAC,CACzD,KAAM,CAACgE,iBAAiB,CAAEC,oBAAoB,CAAC,CAAG/W,KAAK,CAACC,QAAQ,CAAC,IAAI,CAAC,CACtE,KAAM,CAAC+W,SAAS,CAAEC,YAAY,CAAC,CAAGjX,KAAK,CAACC,QAAQ,CAAC,EAAE,CAAC,CACpD,KAAM,CAACiX,WAAW,CAAEC,cAAc,CAAC,CAAGnX,KAAK,CAACC,QAAQ,CAAC,EAAE,CAAC,CAExD,KAAM,CAAAmX,UAAU,CAAIC,GAAG,EAAK,CAC1B,KAAM,CAAAC,IAAI,CAAAhJ,aAAA,CAAAA,aAAA,IAAQsI,UAAU,MAAE,CAACS,GAAG,EAAG,CAACT,UAAU,CAACS,GAAG,CAAC,EAAE,CACvDR,aAAa,CAACS,IAAI,CAAC,CACnBzE,aAAa,EAAIA,aAAa,CAACyE,IAAI,CAAC,CACtC,CAAC,CAED,KAAM,CAAAC,gBAAgB,CAAG,KAAAA,CAAA,GAAY,CACnC,GAAI,CAAC7E,YAAY,CAAE,OACnBqE,oBAAoB,CAAC,QAAQ,CAAC,CAC9BE,YAAY,CAAC,EAAE,CAAC,CAChBE,cAAc,CAAC,EAAE,CAAC,CAClB,GAAI,CACF,KAAM,CAAAzE,YAAY,CAAC,CAAC,CACpByE,cAAc,CAAC,qCAAqC,CAAC,CACvD,CAAE,MAAO/N,GAAG,CAAE,CACZ6N,YAAY,CAAC7N,GAAG,CAAC0D,OAAO,EAAI,+BAA+B,CAAC,CAC9D,CAAC,OAAS,CACRiK,oBAAoB,CAAC,IAAI,CAAC,CAC5B,CACF,CAAC,CAED,KAAM,CAAAS,eAAe,CAAGA,CAAA,GAAM,CAC5B,GAAI,CAAC5E,WAAW,CAAE,OAClBA,WAAW,CAAC,CAAC,CACf,CAAC,CAED,KAAM,CAAA6E,SAAS,CAAGhF,eAAe,SAAfA,eAAe,iBAAfA,eAAe,CAAExE,QAAQ,CAAC,YAAY,CAAC,CACzD,KAAM,CAAAyJ,QAAQ,CAAGjF,eAAe,SAAfA,eAAe,iBAAfA,eAAe,CAAExE,QAAQ,CAAC,OAAO,CAAC,CACnD,KAAM,CAAA0J,WAAW,CAAGlF,eAAe,SAAfA,eAAe,iBAAfA,eAAe,CAAExE,QAAQ,CAAC,UAAU,CAAC,CAEzD,mBACEjK,KAAA,QAAK4N,SAAS,CAAC,+DAA+D,CAAAC,QAAA,eAE5E/N,IAAA,QAAK8N,SAAS,CAAC,0EAA0E,CAAAC,QAAA,cACvF7N,KAAA,QAAK4N,SAAS,CAAC,mDAAmD,CAAAC,QAAA,eAChE/N,IAAA,OAAI8N,SAAS,CAAC,+BAA+B,CAAAC,QAAA,CAAC,YAAU,CAAI,CAAC,cAC7D7N,KAAA,WACEgO,OAAO,CAAEO,MAAO,CAChBX,SAAS,CAAC,2JAA2J,CAAAC,QAAA,eAErK/N,IAAA,CAAC9B,IAAI,EAAC4P,SAAS,CAAC,SAAS,CAAE,CAAC,OAE9B,EAAQ,CAAC,EACN,CAAC,CACH,CAAC,cAGN9N,IAAA,QAAK8N,SAAS,CAAC,aAAa,CAAAC,QAAA,cAC1B7N,KAAA,QAAK4N,SAAS,CAAC,4EAA4E,CAAAC,QAAA,eAEzF7N,KAAA,QAAK4N,SAAS,CAAC,wCAAwC,CAAAC,QAAA,EACpD9G,IAAI,CAACuH,KAAK,cACTxO,IAAA,QACEoS,GAAG,CAAEnL,IAAI,CAACuH,KAAM,CAChB6D,GAAG,CAAC,SAAS,CACbvE,SAAS,CAAC,yEAAyE,CACpF,CAAC,cAEF9N,IAAA,QAAK8N,SAAS,CAAC,yIAAyI,CAAAC,QAAA,cACtJ/N,IAAA,SAAM8N,SAAS,CAAC,+BAA+B,CAAAC,QAAA,CAC5C,EAAA6E,UAAA,CAAA3L,IAAI,CAACsH,IAAI,UAAAqE,UAAA,kBAAAC,iBAAA,CAATD,UAAA,CAAWkB,MAAM,CAAC,CAAC,CAAC,UAAAjB,iBAAA,iBAApBA,iBAAA,CAAsBkB,WAAW,CAAC,CAAC,GAAI,GAAG,CACvC,CAAC,CACJ,CACN,cACD/T,IAAA,OAAI8N,SAAS,CAAC,kCAAkC,CAAAC,QAAA,CAAE9G,IAAI,CAACsH,IAAI,CAAK,CAAC,cACjEvO,IAAA,SAAM8N,SAAS,CAAC,4JAA4J,CAAAC,QAAA,CACzK9G,IAAI,CAAChE,IAAI,GAAK,UAAU,cACvB/C,KAAA,CAAAE,SAAA,EAAA2N,QAAA,eACE/N,IAAA,CAACtC,IAAI,EAACoQ,SAAS,CAAC,gBAAgB,CAAE,CAAC,WAErC,EAAE,CAAC,cAEH5N,KAAA,CAAAE,SAAA,EAAA2N,QAAA,eACE/N,IAAA,CAACjC,IAAI,EAAC+P,SAAS,CAAC,gBAAgB,CAAE,CAAC,SAErC,EAAE,CACH,CACG,CAAC,EACJ,CAAC,cAGN5N,KAAA,QAAK4N,SAAS,CAAC,gBAAgB,CAAAC,QAAA,eAC7B/N,IAAA,QAAK8N,SAAS,CAAC,yHAAyH,CAAAC,QAAA,cACtI7N,KAAA,QAAK4N,SAAS,CAAC,mBAAmB,CAAAC,QAAA,eAChC/N,IAAA,QAAK8N,SAAS,CAAC,kHAAkH,CAAAC,QAAA,cAC/H/N,IAAA,CAAChC,KAAK,EAAC8P,SAAS,CAAC,uBAAuB,CAAE,CAAC,CACxC,CAAC,cACN5N,KAAA,QAAA6N,QAAA,eACE/N,IAAA,MAAG8N,SAAS,CAAC,0CAA0C,CAAAC,QAAA,CAAC,cAAY,CAAG,CAAC,cACxE/N,IAAA,MAAG8N,SAAS,CAAC,6BAA6B,CAAAC,QAAA,CAAE9G,IAAI,CAACtD,KAAK,CAAI,CAAC,EACxD,CAAC,EACH,CAAC,CACH,CAAC,cAEN3D,IAAA,QAAK8N,SAAS,CAAC,yHAAyH,CAAAC,QAAA,cACtI7N,KAAA,QAAK4N,SAAS,CAAC,mBAAmB,CAAAC,QAAA,eAChC/N,IAAA,QAAK8N,SAAS,CAAC,kHAAkH,CAAAC,QAAA,cAC/H/N,IAAA,CAAC/B,IAAI,EAAC6P,SAAS,CAAC,uBAAuB,CAAE,CAAC,CACvC,CAAC,cACN5N,KAAA,QAAA6N,QAAA,eACE/N,IAAA,MAAG8N,SAAS,CAAC,0CAA0C,CAAAC,QAAA,CAAC,eAAa,CAAG,CAAC,cACzE/N,IAAA,MAAG8N,SAAS,CAAC,6BAA6B,CAAAC,QAAA,CAAE9G,IAAI,CAAC1D,KAAK,CAAI,CAAC,EACxD,CAAC,EACH,CAAC,CACH,CAAC,cAENvD,IAAA,QAAK8N,SAAS,CAAC,yHAAyH,CAAAC,QAAA,cACtI7N,KAAA,QAAK4N,SAAS,CAAC,mBAAmB,CAAAC,QAAA,eAChC/N,IAAA,QAAK8N,SAAS,CAAC,sHAAsH,CAAAC,QAAA,cACnI/N,IAAA,CAAC3B,QAAQ,EAACyP,SAAS,CAAC,yBAAyB,CAAE,CAAC,CAC7C,CAAC,cACN5N,KAAA,QAAA6N,QAAA,eACE/N,IAAA,MAAG8N,SAAS,CAAC,0CAA0C,CAAAC,QAAA,CAAC,cAAY,CAAG,CAAC,cACxE/N,IAAA,MAAG8N,SAAS,CAAC,6BAA6B,CAAAC,QAAA,CACvC,GAAI,CAAA/J,IAAI,CAACiD,IAAI,CAAClD,SAAS,CAAC,CAACiQ,kBAAkB,CAAC,OAAO,CAAE,CACpDC,IAAI,CAAE,SAAS,CACfC,KAAK,CAAE,MAAM,CACbC,GAAG,CAAE,SACP,CAAC,CAAC,CACD,CAAC,EACD,CAAC,EACH,CAAC,CACH,CAAC,EACH,CAAC,cAGNjU,KAAA,QAAK4N,SAAS,CAAC,4FAA4F,CAAAC,QAAA,eACzG7N,KAAA,QAAK4N,SAAS,CAAC,8BAA8B,CAAAC,QAAA,eAC3C/N,IAAA,QAAK8N,SAAS,CAAC,6GAA6G,CAAAC,QAAA,cAC1H/N,IAAA,CAAC1B,IAAI,EAACwP,SAAS,CAAC,oBAAoB,CAAE,CAAC,CACpC,CAAC,cACN9N,IAAA,OAAI8N,SAAS,CAAC,yBAAyB,CAAAC,QAAA,CAAC,0BAAwB,CAAI,CAAC,EAClE,CAAC,cACN7N,KAAA,QAAK4N,SAAS,CAAC,WAAW,CAAAC,QAAA,eACxB7N,KAAA,UAAO4N,SAAS,CAAC,+HAA+H,CAAAC,QAAA,eAC9I/N,IAAA,UACEiD,IAAI,CAAC,UAAU,CACfmR,OAAO,CAAEtB,UAAU,CAACnI,OAAQ,CAC5B4H,QAAQ,CAAEA,CAAA,GAAMe,UAAU,CAAC,SAAS,CAAE,CACtCxF,SAAS,CAAC,mEAAmE,CAC9E,CAAC,cACF5N,KAAA,QAAA6N,QAAA,eACE/N,IAAA,MAAG8N,SAAS,CAAC,mCAAmC,CAAAC,QAAA,CAAC,aAAW,CAAG,CAAC,cAChE/N,IAAA,MAAG8N,SAAS,CAAC,uBAAuB,CAAAC,QAAA,CAAC,kDAAgD,CAAG,CAAC,EACtF,CAAC,EACD,CAAC,cACR7N,KAAA,UAAO4N,SAAS,CAAC,+HAA+H,CAAAC,QAAA,eAC9I/N,IAAA,UACEiD,IAAI,CAAC,UAAU,CACfmR,OAAO,CAAEtB,UAAU,CAAClI,SAAU,CAC9B2H,QAAQ,CAAEA,CAAA,GAAMe,UAAU,CAAC,WAAW,CAAE,CACxCxF,SAAS,CAAC,mEAAmE,CAC9E,CAAC,cACF5N,KAAA,QAAA6N,QAAA,eACE/N,IAAA,MAAG8N,SAAS,CAAC,mCAAmC,CAAAC,QAAA,CAAC,gBAAc,CAAG,CAAC,cACnE/N,IAAA,MAAG8N,SAAS,CAAC,uBAAuB,CAAAC,QAAA,CAAC,yCAAuC,CAAG,CAAC,EAC7E,CAAC,EACD,CAAC,EACL,CAAC,cACN/N,IAAA,MAAG8N,SAAS,CAAC,4CAA4C,CAAAC,QAAA,CAAC,2DAAoD,CAAG,CAAC,EAC/G,CAAC,cAGN7N,KAAA,QAAK4N,SAAS,CAAC,sGAAsG,CAAAC,QAAA,eACnH7N,KAAA,QAAK4N,SAAS,CAAC,8BAA8B,CAAAC,QAAA,eAC3C/N,IAAA,QAAK8N,SAAS,CAAC,+GAA+G,CAAAC,QAAA,cAC5H/N,IAAA,CAACvB,KAAK,EAACqP,SAAS,CAAC,oBAAoB,CAAE,CAAC,CACrC,CAAC,cACN5N,KAAA,QAAA6N,QAAA,eACE/N,IAAA,OAAI8N,SAAS,CAAC,yBAAyB,CAAAC,QAAA,CAAC,iBAAe,CAAI,CAAC,cAC5D/N,IAAA,MAAG8N,SAAS,CAAC,uBAAuB,CAAAC,QAAA,CAAC,kCAAgC,CAAG,CAAC,EACtE,CAAC,EACH,CAAC,CAGLqF,WAAW,eACVlT,KAAA,QAAK4N,SAAS,CAAC,wGAAwG,CAAAC,QAAA,eACrH/N,IAAA,CAAC7B,WAAW,EAAC2P,SAAS,CAAC,SAAS,CAAE,CAAC,CAClCsF,WAAW,EACT,CACN,CACAF,SAAS,eACRhT,KAAA,QAAK4N,SAAS,CAAC,qGAAqG,CAAAC,QAAA,eAClH/N,IAAA,CAACzB,aAAa,EAACuP,SAAS,CAAC,SAAS,CAAE,CAAC,CACpCoF,SAAS,EACP,CACN,cAEDhT,KAAA,QAAK4N,SAAS,CAAC,WAAW,CAAAC,QAAA,eAExB7N,KAAA,QAAK4N,SAAS,qEAAAzD,MAAA,CAAsEsJ,SAAS,CAAG,kBAAkB,CAAG,iBAAiB,CAAG,CAAA5F,QAAA,eACvI7N,KAAA,QAAK4N,SAAS,CAAC,yBAAyB,CAAAC,QAAA,eACtC7N,KAAA,QAAK4N,SAAS,CAAC,SAAS,CAACuG,OAAO,CAAC,WAAW,CAAAtG,QAAA,eAC1C/N,IAAA,SAAMsU,IAAI,CAAC,SAAS,CAACC,CAAC,CAAC,yHAAyH,CAAC,CAAC,cAClJvU,IAAA,SAAMsU,IAAI,CAAC,SAAS,CAACC,CAAC,CAAC,uIAAuI,CAAC,CAAC,cAChKvU,IAAA,SAAMsU,IAAI,CAAC,SAAS,CAACC,CAAC,CAAC,+HAA+H,CAAC,CAAC,cACxJvU,IAAA,SAAMsU,IAAI,CAAC,SAAS,CAACC,CAAC,CAAC,qIAAqI,CAAC,CAAC,EAC3J,CAAC,cACNvU,IAAA,SAAM8N,SAAS,CAAC,2BAA2B,CAAAC,QAAA,CAAC,QAAM,CAAM,CAAC,EACtD,CAAC,CACL4F,SAAS,cACRzT,KAAA,SAAM4N,SAAS,CAAC,4DAA4D,CAAAC,QAAA,eAC1E/N,IAAA,CAAC7B,WAAW,EAAC2P,SAAS,CAAC,SAAS,CAAE,CAAC,UACrC,EAAM,CAAC,cAEP9N,IAAA,WACEkO,OAAO,CAAEuF,gBAAiB,CAC1Be,QAAQ,CAAExB,iBAAiB,GAAK,QAAS,CACzClF,SAAS,CAAC,iJAAiJ,CAAAC,QAAA,CAE1JiF,iBAAiB,GAAK,QAAQ,CAAG,YAAY,CAAG,MAAM,CACjD,CACT,EACE,CAAC,cAGN9S,KAAA,QAAK4N,SAAS,qEAAAzD,MAAA,CAAsEuJ,QAAQ,CAAG,kBAAkB,CAAG,iBAAiB,CAAG,CAAA7F,QAAA,eACtI7N,KAAA,QAAK4N,SAAS,CAAC,yBAAyB,CAAAC,QAAA,eACtC/N,IAAA,CAAChC,KAAK,EAAC8P,SAAS,CAAC,wBAAwB,CAAE,CAAC,cAC5C9N,IAAA,SAAM8N,SAAS,CAAC,2BAA2B,CAAAC,QAAA,CAAC,OAAK,CAAM,CAAC,EACrD,CAAC,CACL6F,QAAQ,cACP1T,KAAA,SAAM4N,SAAS,CAAC,4DAA4D,CAAAC,QAAA,eAC1E/N,IAAA,CAAC7B,WAAW,EAAC2P,SAAS,CAAC,SAAS,CAAE,CAAC,UACrC,EAAM,CAAC,cAEP9N,IAAA,WACEkO,OAAO,CAAEwF,eAAgB,CACzB5F,SAAS,CAAC,6HAA6H,CAAAC,QAAA,CACxI,MAED,CAAQ,CACT,EACE,CAAC,cAGN7N,KAAA,QAAK4N,SAAS,qEAAAzD,MAAA,CAAsEwJ,WAAW,CAAG,kBAAkB,CAAG,iBAAiB,CAAG,CAAA9F,QAAA,eACzI7N,KAAA,QAAK4N,SAAS,CAAC,yBAAyB,CAAAC,QAAA,eACtC/N,IAAA,CAAC/B,IAAI,EAAC6P,SAAS,CAAC,uBAAuB,CAAE,CAAC,cAC1C9N,IAAA,SAAM8N,SAAS,CAAC,2BAA2B,CAAAC,QAAA,CAAC,kBAAgB,CAAM,CAAC,EAChE,CAAC,CACL8F,WAAW,cACV3T,KAAA,SAAM4N,SAAS,CAAC,4DAA4D,CAAAC,QAAA,eAC1E/N,IAAA,CAAC7B,WAAW,EAAC2P,SAAS,CAAC,SAAS,CAAE,CAAC,UACrC,EAAM,CAAC,cAEP9N,IAAA,SAAM8N,SAAS,CAAC,uBAAuB,CAAAC,QAAA,CAAC,aAAW,CAAM,CAC1D,EACE,CAAC,EACH,CAAC,cAEN/N,IAAA,MAAG8N,SAAS,CAAC,4CAA4C,CAAAC,QAAA,CAAC,0CAAwC,CAAG,CAAC,EACnG,CAAC,CAGLW,SAAS,eACRxO,KAAA,WACEgO,OAAO,CAAEQ,SAAU,CACnBZ,SAAS,CAAC,qJAAqJ,CAAAC,QAAA,eAE/J/N,IAAA,CAACxB,MAAM,EAACsP,SAAS,CAAC,SAAS,CAAE,CAAC,WAEhC,EAAQ,CACT,EACE,CAAC,CACH,CAAC,EACH,CAAC,CAEV,CAEA,QAAS,CAAAqB,sBAAsBA,CAAAsF,KAAA,CAAwC,KAAAC,iBAAA,CAAAC,qBAAA,IAAvC,CAAEvF,UAAU,CAAEF,QAAQ,CAAExN,WAAY,CAAC,CAAA+S,KAAA,CACnE,KAAM,CAACG,IAAI,CAAEC,OAAO,CAAC,CAAG1Y,QAAQ,CAAC,CAAE2Y,YAAY,CAAE,CAAApT,WAAW,SAAXA,WAAW,iBAAXA,WAAW,CAAE6M,IAAI,GAAI,EAAE,CAAEwG,WAAW,CAAE,EAAE,CAAEC,QAAQ,CAAE,EAAE,CAAEC,KAAK,CAAE,KAAM,CAAC,CAAC,CAExH,KAAM,CAAAjD,YAAY,CAAGA,CAAA,GAAM,CACzB,GAAI,CAAC4C,IAAI,CAACE,YAAY,EAAI,CAACF,IAAI,CAACK,KAAK,CAAE,CACrChL,KAAK,CAAC,uDAAuD,CAAC,CAC9D,OACF,CACAmF,UAAU,CAACwF,IAAI,CAAC,CAClB,CAAC,CAED,mBACE1U,KAAA,QAAK4N,SAAS,CAAC,+DAA+D,CAAAC,QAAA,eAE5E/N,IAAA,QAAK8N,SAAS,CAAC,0EAA0E,CAAAC,QAAA,cACvF7N,KAAA,QAAK4N,SAAS,CAAC,+BAA+B,CAAAC,QAAA,eAC5C/N,IAAA,QAAK8N,SAAS,CAAC,yHAAyH,CAAAC,QAAA,cACtI/N,IAAA,SAAM8N,SAAS,CAAC,+BAA+B,CAAAC,QAAA,CAC5C,CAAArM,WAAW,SAAXA,WAAW,kBAAAgT,iBAAA,CAAXhT,WAAW,CAAE6M,IAAI,UAAAmG,iBAAA,kBAAAC,qBAAA,CAAjBD,iBAAA,CAAmBZ,MAAM,CAAC,CAAC,CAAC,UAAAa,qBAAA,iBAA5BA,qBAAA,CAA8BZ,WAAW,CAAC,CAAC,GAAI,GAAG,CAC/C,CAAC,CACJ,CAAC,cACN7T,KAAA,OAAI4N,SAAS,CAAC,oCAAoC,CAAAC,QAAA,EAAC,WAAS,CAAC,CAAArM,WAAW,SAAXA,WAAW,iBAAXA,WAAW,CAAE6M,IAAI,GAAI,UAAU,CAAC,GAAC,EAAI,CAAC,cACnGvO,IAAA,MAAG8N,SAAS,CAAC,eAAe,CAAAC,QAAA,CAAC,mDAAiD,CAAG,CAAC,EAC/E,CAAC,CACH,CAAC,cAGN/N,IAAA,QAAK8N,SAAS,CAAC,YAAY,CAAAC,QAAA,cACzB/N,IAAA,QAAK8N,SAAS,CAAC,mBAAmB,CAAAC,QAAA,cAChC7N,KAAA,QAAK4N,SAAS,CAAC,2DAA2D,CAAAC,QAAA,eAExE7N,KAAA,QAAK4N,SAAS,CAAC,6CAA6C,CAAAC,QAAA,eAC1D7N,KAAA,QAAK4N,SAAS,CAAC,yBAAyB,CAAAC,QAAA,eACtC/N,IAAA,QAAK8N,SAAS,CAAC,gGAAgG,CAAAC,QAAA,CAAC,GAAC,CAAK,CAAC,cACvH/N,IAAA,SAAM8N,SAAS,CAAC,mCAAmC,CAAAC,QAAA,CAAC,iBAAe,CAAM,CAAC,EACvE,CAAC,cACN/N,IAAA,QAAK8N,SAAS,CAAC,uBAAuB,CAAM,CAAC,cAC7C5N,KAAA,QAAK4N,SAAS,CAAC,yBAAyB,CAAAC,QAAA,eACtC/N,IAAA,QAAK8N,SAAS,CAAC,mGAAmG,CAAAC,QAAA,CAAC,GAAC,CAAK,CAAC,cAC1H/N,IAAA,SAAM8N,SAAS,CAAC,uBAAuB,CAAAC,QAAA,CAAC,eAAa,CAAM,CAAC,EACzD,CAAC,EACH,CAAC,cAEN7N,KAAA,QAAK4N,SAAS,CAAC,WAAW,CAAAC,QAAA,eACxB7N,KAAA,QAAA6N,QAAA,eACE/N,IAAA,UAAO8N,SAAS,CAAC,gDAAgD,CAAAC,QAAA,CAAC,gBAAc,CAAO,CAAC,cACxF/N,IAAA,UACEkR,KAAK,CAAE0D,IAAI,CAACE,YAAa,CACzBvC,QAAQ,CAAGhM,CAAC,EAAKsO,OAAO,CAAArK,aAAA,CAAAA,aAAA,IAAMoK,IAAI,MAAEE,YAAY,CAAEvO,CAAC,CAACiL,MAAM,CAACN,KAAK,EAAE,CAAE,CACpEpD,SAAS,CAAC,0HAA0H,CACpI4E,WAAW,CAAC,4BAA4B,CACzC,CAAC,cACF1S,IAAA,MAAG8N,SAAS,CAAC,8BAA8B,CAAAC,QAAA,CAAC,8DAA4D,CAAG,CAAC,EACzG,CAAC,cAEN7N,KAAA,QAAA6N,QAAA,eACE/N,IAAA,UAAO8N,SAAS,CAAC,gDAAgD,CAAAC,QAAA,CAAC,4BAA0B,CAAO,CAAC,cACpG/N,IAAA,UACEkR,KAAK,CAAE0D,IAAI,CAACG,WAAY,CACxBxC,QAAQ,CAAGhM,CAAC,EAAKsO,OAAO,CAAArK,aAAA,CAAAA,aAAA,IAAMoK,IAAI,MAAEG,WAAW,CAAExO,CAAC,CAACiL,MAAM,CAACN,KAAK,EAAE,CAAE,CACnEwB,WAAW,CAAC,0CAA0C,CACtD5E,SAAS,CAAC,0HAA0H,CACrI,CAAC,cACF9N,IAAA,MAAG8N,SAAS,CAAC,8BAA8B,CAAAC,QAAA,CAAC,4CAA0C,CAAG,CAAC,EACvF,CAAC,cAEN7N,KAAA,QAAA6N,QAAA,eACE/N,IAAA,UAAO8N,SAAS,CAAC,gDAAgD,CAAAC,QAAA,CAAC,sBAAoB,CAAO,CAAC,cAC9F/N,IAAA,UACEkR,KAAK,CAAE0D,IAAI,CAACI,QAAS,CACrBzC,QAAQ,CAAGhM,CAAC,EAAKsO,OAAO,CAAArK,aAAA,CAAAA,aAAA,IAAMoK,IAAI,MAAEI,QAAQ,CAAEzO,CAAC,CAACiL,MAAM,CAACN,KAAK,EAAE,CAAE,CAChEpD,SAAS,CAAC,0HAA0H,CACpI4E,WAAW,CAAC,2BAA2B,CACxC,CAAC,cACF1S,IAAA,MAAG8N,SAAS,CAAC,8BAA8B,CAAAC,QAAA,CAAC,yDAAuD,CAAG,CAAC,EACpG,CAAC,cAEN/N,IAAA,QAAK8N,SAAS,CAAC,gFAAgF,CAAAC,QAAA,cAC7F7N,KAAA,UAAO4N,SAAS,CAAC,uCAAuC,CAAAC,QAAA,eACtD/N,IAAA,UACEiD,IAAI,CAAC,UAAU,CACfmR,OAAO,CAAEQ,IAAI,CAACK,KAAM,CACpB1C,QAAQ,CAAGhM,CAAC,EAAKsO,OAAO,CAAArK,aAAA,CAAAA,aAAA,IAAMoK,IAAI,MAAEK,KAAK,CAAE1O,CAAC,CAACiL,MAAM,CAAC4C,OAAO,EAAE,CAAE,CAC/DtG,SAAS,CAAC,wEAAwE,CACnF,CAAC,cACF5N,KAAA,SAAM4N,SAAS,CAAC,uBAAuB,CAAAC,QAAA,EAAC,qEAC6B,CAAC,GAAG,cACvE/N,IAAA,WAAQiD,IAAI,CAAC,QAAQ,CAACiL,OAAO,CAAG3H,CAAC,EAAKA,CAAC,CAAC2O,cAAc,CAAC,CAAE,CAACpH,SAAS,CAAC,yDAAyD,CAAAC,QAAA,CAAC,kBAE9H,CAAQ,CAAC,IACX,EAAM,CAAC,EACF,CAAC,CACL,CAAC,cAEN7N,KAAA,QAAK4N,SAAS,CAAC,iBAAiB,CAAAC,QAAA,eAC9B/N,IAAA,WACEkO,OAAO,CAAEgB,QAAS,CAClBpB,SAAS,CAAC,oGAAoG,CAAAC,QAAA,CAC/G,QAED,CAAQ,CAAC,cACT/N,IAAA,WACEkO,OAAO,CAAE8D,YAAa,CACtBlE,SAAS,CAAC,6KAA6K,CAAAC,QAAA,CACxL,0BAED,CAAQ,CAAC,EACN,CAAC,EACH,CAAC,EACH,CAAC,CACH,CAAC,CACH,CAAC,EACH,CAAC,CAEV,CAEA,QAAS,CAAAkB,eAAeA,CAAAkG,KAAA,CAA+B,IAA9B,CAAElO,IAAI,CAAEoH,QAAQ,CAAEa,QAAS,CAAC,CAAAiG,KAAA,CACnD,KAAM,CAACxE,QAAQ,CAAEC,WAAW,CAAC,CAAGzU,QAAQ,CAAC,CACvCoS,IAAI,CAAEtH,IAAI,CAACsH,IAAI,EAAI,EAAE,CACrB5K,KAAK,CAAEsD,IAAI,CAACtD,KAAK,EAAI,EAAE,CACvBJ,KAAK,CAAE0D,IAAI,CAAC1D,KAAK,EAAI,EAAE,CACvBkH,QAAQ,CAAExD,IAAI,CAACwD,QAAQ,EAAI,EAAE,CAC7B+D,KAAK,CAAEvH,IAAI,CAACuH,KAAK,EAAI,EACvB,CAAC,CAAC,CACF,KAAM,CAACqC,MAAM,CAAEC,SAAS,CAAC,CAAG3U,QAAQ,CAAC,CAAC,CAAC,CAAC,CACxC,KAAM,CAAC4U,OAAO,CAAEC,UAAU,CAAC,CAAG7U,QAAQ,CAAC,CAAC,CAAC,CAAC,CAE1C,KAAM,CAAA8U,aAAa,CAAG,QAAAA,CAAC1C,IAAI,CAAE2C,KAAK,CAAkB,IAAhB,CAAAC,MAAM,CAAAjO,SAAA,CAAAC,MAAA,IAAAD,SAAA,MAAAE,SAAA,CAAAF,SAAA,IAAG,CAAC,CAAC,CAC7C,KAAM,CAAAkO,SAAS,CAAA5G,aAAA,IAAQqG,MAAM,CAAE,CAC/B,OAAQtC,IAAI,EACV,IAAK,MAAM,CACT,GAAI,CAAC2C,KAAK,EAAIA,KAAK,CAAC5I,IAAI,CAAC,CAAC,CAACnF,MAAM,CAAG,CAAC,CAAE,CACrCiO,SAAS,CAAC7C,IAAI,CAAG,oCAAoC,CACvD,CAAC,IAAM,CACL,MAAO,CAAA6C,SAAS,CAAC7C,IAAI,CACvB,CACA,MACF,IAAK,OAAO,CACV,GAAI,CAAC2C,KAAK,EAAI,CAAC,sBAAsB,CAACG,IAAI,CAACH,KAAK,CAAC5I,IAAI,CAAC,CAAC,CAAC,CAAE,CACxD8I,SAAS,CAACzN,KAAK,CAAG,4BAA4B,CAChD,CAAC,IAAM,CACL,MAAO,CAAAyN,SAAS,CAACzN,KAAK,CACxB,CACA,MACF,IAAK,OAAO,CACV,GAAI,CAACuN,KAAK,EAAI,CAAC,4BAA4B,CAACG,IAAI,CAACH,KAAK,CAAC5I,IAAI,CAAC,CAAC,CAAC,CAAE,CAC9D8I,SAAS,CAAC7N,KAAK,CAAG,qBAAqB,CACzC,CAAC,IAAM,CACL,MAAO,CAAA6N,SAAS,CAAC7N,KAAK,CACxB,CACA,MACF,QACE,MACJ,CACAuN,SAAS,CAACM,SAAS,CAAC,CACtB,CAAC,CAED,KAAM,CAAAE,iBAAiB,CAAI/K,CAAC,EAAK,CAC/B,KAAM,CAAAgL,IAAI,CAAGhL,CAAC,CAACiL,MAAM,CAACC,KAAK,CAAC,CAAC,CAAC,CAC9B,GAAIF,IAAI,CAAE,CACR,KAAM,CAAAI,MAAM,CAAG,GAAI,CAAAC,UAAU,CAAC,CAAC,CAC/BD,MAAM,CAACE,SAAS,CAAG,IAAM,CACvBjB,WAAW,CAAApG,aAAA,CAAAA,aAAA,IAAMmG,QAAQ,MAAEnC,KAAK,CAAEmD,MAAM,CAACG,MAAM,EAAE,CAAC,CACpD,CAAC,CACDH,MAAM,CAACI,aAAa,CAACR,IAAI,CAAC,CAC5B,CACF,CAAC,CAED,KAAM,CAAAS,YAAY,CAAGA,CAAA,GAAM,CACzBhB,UAAU,CAAC,CAAEzC,IAAI,CAAE,IAAI,CAAE5K,KAAK,CAAE,IAAI,CAAEJ,KAAK,CAAE,IAAK,CAAC,CAAC,CACpD0N,aAAa,CAAC,MAAM,CAAEN,QAAQ,CAACpC,IAAI,CAAC,CACpC0C,aAAa,CAAC,OAAO,CAAEN,QAAQ,CAAChN,KAAK,CAAC,CACtCsN,aAAa,CAAC,OAAO,CAAEN,QAAQ,CAACpN,KAAK,CAAC,CACtC,GAAI2O,MAAM,CAACC,IAAI,CAACtB,MAAM,CAAC,CAAC1N,MAAM,GAAK,CAAC,EAAIwN,QAAQ,CAACpC,IAAI,EAAIoC,QAAQ,CAAChN,KAAK,EAAIgN,QAAQ,CAACpN,KAAK,CAAE,CACzF8K,QAAQ,CAACsC,QAAQ,CAAC,CACpB,CACF,CAAC,CAED,mBACE3Q,IAAA,QAAK8N,SAAS,CAAC,mEAAmE,CAAAC,QAAA,cAChF/N,IAAA,QAAK8N,SAAS,CAAC,wBAAwB,CAAAC,QAAA,cACrC7N,KAAA,QAAK4N,SAAS,CAAC,2DAA2D,CAAAC,QAAA,eACxE7N,KAAA,QAAK4N,SAAS,CAAC,wCAAwC,CAAAC,QAAA,eACrD/N,IAAA,OAAI8N,SAAS,CAAC,uCAAuC,CAAAC,QAAA,CAAC,cAAY,CAAI,CAAC,cACvE/N,IAAA,WAAQkO,OAAO,CAAEgB,QAAS,CAACpB,SAAS,CAAC,8CAA8C,CAAAC,QAAA,cACjF/N,IAAA,CAAClC,CAAC,EAACgQ,SAAS,CAAC,SAAS,CAAE,CAAC,CACnB,CAAC,EACN,CAAC,cAEN5N,KAAA,QAAK4N,SAAS,CAAC,WAAW,CAAAC,QAAA,eAExB/N,IAAA,QAAK8N,SAAS,CAAC,0BAA0B,CAAAC,QAAA,cACvC7N,KAAA,QAAK4N,SAAS,CAAC,UAAU,CAAAC,QAAA,EACtB4C,QAAQ,CAACnC,KAAK,cACbxO,IAAA,QAAKoS,GAAG,CAAEzB,QAAQ,CAACnC,KAAM,CAAC6D,GAAG,CAAC,SAAS,CAACvE,SAAS,CAAC,wEAAwE,CAAE,CAAC,cAE7H9N,IAAA,QAAK8N,SAAS,CAAC,wIAAwI,CAAAC,QAAA,cACrJ/N,IAAA,CAACjC,IAAI,EAAC+P,SAAS,CAAC,yBAAyB,CAAE,CAAC,CACzC,CACN,cACD5N,KAAA,UAAO4N,SAAS,CAAC,yHAAyH,CAAC,aAAW,0BAA0B,CAAAC,QAAA,eAC9K/N,IAAA,CAAC9B,IAAI,EAAC4P,SAAS,CAAC,SAAS,CAAE,CAAC,cAC5B9N,IAAA,UACEiD,IAAI,CAAC,MAAM,CACXqP,MAAM,CAAC,SAAS,CAChBC,QAAQ,CAAEjB,iBAAkB,CAC5BxD,SAAS,CAAC,QAAQ,CACnB,CAAC,EACG,CAAC,EACL,CAAC,CACH,CAAC,cAGN5N,KAAA,QAAA6N,QAAA,eACE/N,IAAA,UAAO8N,SAAS,CAAC,gDAAgD,CAAAC,QAAA,CAAC,WAAS,CAAO,CAAC,cACnF/N,IAAA,UACEiD,IAAI,CAAC,MAAM,CACXuP,QAAQ,MACRtB,KAAK,CAAEP,QAAQ,CAACpC,IAAK,CACrBgE,QAAQ,CAAGhM,CAAC,EAAK,CAAEqK,WAAW,CAAApG,aAAA,CAAAA,aAAA,IAAMmG,QAAQ,MAAEpC,IAAI,CAAEhI,CAAC,CAACiL,MAAM,CAACN,KAAK,EAAE,CAAC,CAAE,GAAIH,OAAO,CAACxC,IAAI,CAAE0C,aAAa,CAAC,MAAM,CAAE1K,CAAC,CAACiL,MAAM,CAACN,KAAK,CAAC,CAAE,CAAE,CAClIuB,MAAM,CAAGlM,CAAC,EAAK,CAAEyK,UAAU,CAAAxG,aAAA,CAAAA,aAAA,IAAMuG,OAAO,MAAExC,IAAI,CAAE,IAAI,EAAE,CAAC,CAAE0C,aAAa,CAAC,MAAM,CAAE1K,CAAC,CAACiL,MAAM,CAACN,KAAK,CAAC,CAAE,CAAE,CAClG,eAAcL,MAAM,CAACtC,IAAI,CAAG,MAAM,CAAG,OAAQ,CAC7C,mBAAkBsC,MAAM,CAACtC,IAAI,CAAG,iBAAiB,CAAGnL,SAAU,CAC9D0K,SAAS,8BAAAzD,MAAA,CAA+BwG,MAAM,CAACtC,IAAI,CAAG,gBAAgB,CAAG,iBAAiB,gIAA+H,CAC1N,CAAC,CACDsC,MAAM,CAACtC,IAAI,EAAIwC,OAAO,CAACxC,IAAI,eAAIvO,IAAA,MAAGsH,EAAE,CAAC,iBAAiB,CAACwG,SAAS,CAAC,2BAA2B,CAAAC,QAAA,CAAE8C,MAAM,CAACtC,IAAI,CAAI,CAAC,EAC5G,CAAC,cAENrO,KAAA,QAAA6N,QAAA,eACE/N,IAAA,UAAO8N,SAAS,CAAC,gDAAgD,CAAAC,QAAA,CAAC,cAAY,CAAO,CAAC,cACtF7N,KAAA,QAAK4N,SAAS,CAAC,UAAU,CAAAC,QAAA,eACvB/N,IAAA,CAAChC,KAAK,EAAC8P,SAAS,CAAC,+CAA+C,CAAE,CAAC,cACnE9N,IAAA,UACEiD,IAAI,CAAC,KAAK,CACVuP,QAAQ,MACRtB,KAAK,CAAEP,QAAQ,CAAChN,KAAM,CACtB4O,QAAQ,CAAGhM,CAAC,EAAK,CAAEqK,WAAW,CAAApG,aAAA,CAAAA,aAAA,IAAMmG,QAAQ,MAAEhN,KAAK,CAAE4C,CAAC,CAACiL,MAAM,CAACN,KAAK,EAAE,CAAC,CAAE,GAAIH,OAAO,CAACpN,KAAK,CAAEsN,aAAa,CAAC,OAAO,CAAE1K,CAAC,CAACiL,MAAM,CAACN,KAAK,CAAC,CAAE,CAAE,CACrIuB,MAAM,CAAGlM,CAAC,EAAK,CAAEyK,UAAU,CAAAxG,aAAA,CAAAA,aAAA,IAAMuG,OAAO,MAAEpN,KAAK,CAAE,IAAI,EAAE,CAAC,CAAEsN,aAAa,CAAC,OAAO,CAAE1K,CAAC,CAACiL,MAAM,CAACN,KAAK,CAAC,CAAE,CAAE,CACpG,eAAcL,MAAM,CAAClN,KAAK,CAAG,MAAM,CAAG,OAAQ,CAC9C,mBAAkBkN,MAAM,CAAClN,KAAK,CAAG,kBAAkB,CAAGP,SAAU,CAChE0K,SAAS,oCAAAzD,MAAA,CAAqCwG,MAAM,CAAClN,KAAK,CAAG,gBAAgB,CAAG,iBAAiB,gIAA+H,CACjO,CAAC,EACC,CAAC,CACLkN,MAAM,CAAClN,KAAK,EAAIoN,OAAO,CAACpN,KAAK,eAAI3D,IAAA,MAAGsH,EAAE,CAAC,kBAAkB,CAACwG,SAAS,CAAC,2BAA2B,CAAAC,QAAA,CAAE8C,MAAM,CAAClN,KAAK,CAAI,CAAC,EAChH,CAAC,cAENzD,KAAA,QAAA6N,QAAA,eACE/N,IAAA,UAAO8N,SAAS,CAAC,gDAAgD,CAAAC,QAAA,CAAC,eAAa,CAAO,CAAC,cACvF7N,KAAA,QAAK4N,SAAS,CAAC,UAAU,CAAAC,QAAA,eACvB/N,IAAA,CAAC/B,IAAI,EAAC6P,SAAS,CAAC,+CAA+C,CAAE,CAAC,cAClE9N,IAAA,UACEiD,IAAI,CAAC,OAAO,CACZuP,QAAQ,MACRtB,KAAK,CAAEP,QAAQ,CAACpN,KAAM,CACtBgP,QAAQ,CAAGhM,CAAC,EAAK,CAAEqK,WAAW,CAAApG,aAAA,CAAAA,aAAA,IAAMmG,QAAQ,MAAEpN,KAAK,CAAEgD,CAAC,CAACiL,MAAM,CAACN,KAAK,EAAE,CAAC,CAAE,GAAIH,OAAO,CAACxN,KAAK,CAAE0N,aAAa,CAAC,OAAO,CAAE1K,CAAC,CAACiL,MAAM,CAACN,KAAK,CAAC,CAAE,CAAE,CACrIuB,MAAM,CAAGlM,CAAC,EAAK,CAAEyK,UAAU,CAAAxG,aAAA,CAAAA,aAAA,IAAMuG,OAAO,MAAExN,KAAK,CAAE,IAAI,EAAE,CAAC,CAAE0N,aAAa,CAAC,OAAO,CAAE1K,CAAC,CAACiL,MAAM,CAACN,KAAK,CAAC,CAAE,CAAE,CACpG,eAAcL,MAAM,CAACtN,KAAK,CAAG,MAAM,CAAG,OAAQ,CAC9C,mBAAkBsN,MAAM,CAACtN,KAAK,CAAG,kBAAkB,CAAGH,SAAU,CAChE0K,SAAS,oCAAAzD,MAAA,CAAqCwG,MAAM,CAACtN,KAAK,CAAG,gBAAgB,CAAG,iBAAiB,gIAA+H,CACjO,CAAC,EACC,CAAC,CACLsN,MAAM,CAACtN,KAAK,EAAIwN,OAAO,CAACxN,KAAK,eAAIvD,IAAA,MAAGsH,EAAE,CAAC,kBAAkB,CAACwG,SAAS,CAAC,2BAA2B,CAAAC,QAAA,CAAE8C,MAAM,CAACtN,KAAK,CAAI,CAAC,EAChH,CAAC,cAENrD,KAAA,QAAA6N,QAAA,eACE/N,IAAA,UAAO8N,SAAS,CAAC,gDAAgD,CAAAC,QAAA,CAAC,qBAAmB,CAAO,CAAC,cAC7F7N,KAAA,QAAK4N,SAAS,CAAC,UAAU,CAAAC,QAAA,eACvB/N,IAAA,CAAChC,KAAK,EAAC8P,SAAS,CAAC,+CAA+C,CAAE,CAAC,cACnE9N,IAAA,UACEiD,IAAI,CAAC,KAAK,CACViO,KAAK,CAAEP,QAAQ,CAAClG,QAAS,CACzB8H,QAAQ,CAAGhM,CAAC,EAAKqK,WAAW,CAAApG,aAAA,CAAAA,aAAA,IAAMmG,QAAQ,MAAElG,QAAQ,CAAElE,CAAC,CAACiL,MAAM,CAACN,KAAK,EAAE,CAAE,CACxEwB,WAAW,CAAC,uBAAuB,CACnC5E,SAAS,CAAC,6KAA6K,CACxL,CAAC,EACC,CAAC,cACN9N,IAAA,MAAG8N,SAAS,CAAC,4BAA4B,CAAAC,QAAA,CAAC,uDAAqD,CAAG,CAAC,EAChG,CAAC,cAGN7N,KAAA,QAAK4N,SAAS,CAAC,0CAA0C,CAAAC,QAAA,eACvD/N,IAAA,WACEkO,OAAO,CAAEgB,QAAS,CAClBpB,SAAS,CAAC,6FAA6F,CAAAC,QAAA,CACxG,QAED,CAAQ,CAAC,cACT/N,IAAA,WACEkO,OAAO,CAAE8D,YAAa,CACtBlE,SAAS,CAAC,uJAAuJ,CAAAC,QAAA,CAClK,cAED,CAAQ,CAAC,EACN,CAAC,EACH,CAAC,EACH,CAAC,CACH,CAAC,CACH,CAAC,CAEV,CAEA,uDAEA,QAAS,CAAAgC,aAAaA,CAAAqF,KAAA,CAAgC,IAA/B,CAAExU,QAAQ,CAAEyO,eAAgB,CAAC,CAAA+F,KAAA,CAClD,KAAM,CAACC,SAAS,CAAEC,YAAY,CAAC,CAAGnZ,QAAQ,CAAC,EAAE,CAAC,CAE9CC,SAAS,CAAC,IAAM,CACd,GAAI,CACF,KAAM,CAAAmZ,YAAY,CAAG5P,YAAY,CAACK,OAAO,CAAC,WAAW,CAAC,CACtD,GAAIuP,YAAY,CAAE,CAChB,KAAM,CAAAC,GAAG,CAAG3P,IAAI,CAACiB,KAAK,CAACyO,YAAY,CAAC,CACpC,GAAIpO,KAAK,CAACC,OAAO,CAACoO,GAAG,CAAC,CAAEF,YAAY,CAACE,GAAG,CAAC,CAC3C,CACF,CAAE,MAAAC,QAAA,CAAM,CAAC,CACX,CAAC,CAAE,EAAE,CAAC,CAEN,KAAM,CAAAC,cAAc,CAAInF,SAAS,EAAK,CACpC+E,YAAY,CAACzJ,IAAI,EAAI,CACnB,KAAM,CAAAiE,OAAO,CAAGjE,IAAI,CAAChH,MAAM,CAACyC,EAAE,EAAIA,EAAE,GAAKiJ,SAAS,CAAC,CACnD,GAAI,CACF5K,YAAY,CAACC,OAAO,CAAC,WAAW,CAAEC,IAAI,CAACC,SAAS,CAACgK,OAAO,CAAC,CAAC,CAC5D,CAAE,MAAA6F,QAAA,CAAM,CAAC,CACT,MAAO,CAAA7F,OAAO,CAChB,CAAC,CAAC,CACJ,CAAC,CAED,KAAM,CAAA8F,gBAAgB,CAAGhV,QAAQ,CAACiE,MAAM,CAAC8K,CAAC,EAAI0F,SAAS,CAAClL,QAAQ,CAACwF,CAAC,CAACrI,EAAE,CAAC,CAAC,CAEvE,mBACEtH,IAAA,QAAK8N,SAAS,CAAC,mEAAmE,CAAAC,QAAA,cAChF7N,KAAA,QAAK4N,SAAS,CAAC,wBAAwB,CAAAC,QAAA,eACrC/N,IAAA,QAAK8N,SAAS,CAAC,MAAM,CAAAC,QAAA,cACnB7N,KAAA,QAAK4N,SAAS,CAAC,8BAA8B,CAAAC,QAAA,eAC3C/N,IAAA,QAAK8N,SAAS,CAAC,8GAA8G,CAAAC,QAAA,cAC3H/N,IAAA,CAAC5B,KAAK,EAAC0P,SAAS,CAAC,qCAAqC,CAAE,CAAC,CACtD,CAAC,cACN5N,KAAA,QAAA6N,QAAA,eACE/N,IAAA,OAAI8N,SAAS,CAAC,uCAAuC,CAAAC,QAAA,CAAC,gBAAc,CAAI,CAAC,cACzE/N,IAAA,MAAG8N,SAAS,CAAC,eAAe,CAAAC,QAAA,CACzB6H,gBAAgB,CAACzS,MAAM,GAAK,CAAC,CAC1B,iCAAiC,IAAAkH,MAAA,CAC9BuL,gBAAgB,CAACzS,MAAM,YAAAkH,MAAA,CAAUuL,gBAAgB,CAACzS,MAAM,GAAK,CAAC,CAAG,SAAS,CAAG,UAAU,CAAE,CAC/F,CAAC,EACD,CAAC,EACH,CAAC,CACH,CAAC,CAELyS,gBAAgB,CAACzS,MAAM,GAAK,CAAC,cAC5BjD,KAAA,QAAK4N,SAAS,CAAC,wEAAwE,CAAAC,QAAA,eACrF/N,IAAA,QAAK8N,SAAS,CAAC,gHAAgH,CAAAC,QAAA,cAC7H/N,IAAA,CAAC5B,KAAK,EAAC0P,SAAS,CAAC,yBAAyB,CAAE,CAAC,CAC1C,CAAC,cACN9N,IAAA,OAAI8N,SAAS,CAAC,sCAAsC,CAAAC,QAAA,CAAC,uBAAqB,CAAI,CAAC,cAC/E/N,IAAA,MAAG8N,SAAS,CAAC,6CAA6C,CAAAC,QAAA,CAAC,kGAE3D,CAAG,CAAC,EACD,CAAC,cAEN/N,IAAA,QAAK8N,SAAS,CAAC,qEAAqE,CAAAC,QAAA,CACjF6H,gBAAgB,CAACC,GAAG,CAAC1I,OAAO,EAAI,CAC/B,KAAM,CAAA2I,WAAW,CAAGC,OAAO,CAAC,0BAA0B,CAAC,CAACC,OAAO,CAC/D,mBACEhW,IAAA,CAAC8V,WAAW,EAEV3I,OAAO,CAAEA,OAAQ,CACjBe,OAAO,CAAEA,CAAA,GAAMmB,eAAe,CAAClC,OAAO,CAAE,CACxC8I,UAAU,CAAE,IAAK,CACjBC,gBAAgB,CAAER,cAAe,EAJ5BvI,OAAO,CAAC7F,EAKd,CAAC,CAEN,CAAC,CAAC,CACC,CACN,EACE,CAAC,CACH,CAAC,CAEV,CAEA,KAAM,CAAA6O,wBAAwB,CAAGA,CAAA,IAAO,CACtCxP,KAAK,CAAE,EAAE,CACTY,KAAK,CAAE,EAAE,CACTC,QAAQ,CAAE,EAAE,CACZ2E,aAAa,CAAE,EAAE,CACjB1E,WAAW,CAAE,EAAE,CACfC,MAAM,CAAE,EAAE,CACVC,MAAM,CAAE,WAAW,CACnBC,aAAa,CAAE,GAAI,CAAA5D,IAAI,CAAC,CAAC,CAACC,WAAW,CAAC,CAAC,CAACmS,KAAK,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,CACrDvO,SAAS,CAAE,EAAE,CACb0E,QAAQ,CAAE,IAAI,CACdC,SAAS,CAAE,IAAI,CACfC,aAAa,CAAE,eAAe,CAC9B4J,QAAQ,CAAE,SAAS,CACnBC,aAAa,CAAE,MAAM,CACrBC,WAAW,CAAE,KAAK,CAClBC,gBAAgB,CAAE,KAAK,CACvB9J,OAAO,CAAE,KACX,CAAC,CAAC,CAEF,QAAS,CAAA8C,cAAcA,CAAAiH,KAAA,CAAoF,IAAnF,CAAEpI,QAAQ,CAAEa,QAAQ,CAAExN,WAAW,CAAElB,QAAQ,CAAE8O,aAAa,CAAEG,mBAAoB,CAAC,CAAAgH,KAAA,CACvG,KAAM,CAAAC,YAAY,CAAGzQ,OAAO,CAACC,GAAG,CAACyQ,0BAA0B,CAC3D,KAAM,CAAAC,iBAAiB,CAAG,CAAC3Q,OAAO,CAACC,GAAG,CAAC2Q,2BAA2B,EAAI,EAAE,EAAErO,WAAW,CAAC,CAAC,CAEvF,KAAM,CAAAV,UAAU,CAAGpG,WAAW,SAAXA,WAAW,iBAAXA,WAAW,CAAE4F,EAAE,CAClC,KAAM,CAACqJ,QAAQ,CAAEC,WAAW,CAAC,CAAGzU,QAAQ,CAAC,IAAM,CAC7C,KAAM,CAAA2a,IAAI,CAAGX,wBAAwB,CAAC,CAAC,CACvC,GAAIrO,UAAU,CAAE,CACd,KAAM,CAAAiP,KAAK,CAAGzX,mBAAmB,CAACwI,UAAU,CAAC,CAC7C,GAAIiP,KAAK,CAAE,KAAAC,kBAAA,CAAAC,cAAA,CACT,OAAAzM,aAAA,CAAAA,aAAA,CAAAA,aAAA,IACKsM,IAAI,EACJC,KAAK,MACRlP,SAAS,CAAEV,KAAK,CAACC,OAAO,CAAC2P,KAAK,CAAClP,SAAS,CAAC,CAAGkP,KAAK,CAAClP,SAAS,CAAGiP,IAAI,CAACjP,SAAS,CAC5E0O,WAAW,EAAAS,kBAAA,CAAED,KAAK,CAACR,WAAW,UAAAS,kBAAA,UAAAA,kBAAA,CAAIF,IAAI,CAACP,WAAW,CAClD7J,OAAO,EAAAuK,cAAA,CAAEF,KAAK,CAACrK,OAAO,UAAAuK,cAAA,UAAAA,cAAA,CAAIH,IAAI,CAACpK,OAAO,CACtChF,MAAM,CAAE,EAAE,GAEd,CACF,CACA,MAAO,CAAAoP,IAAI,CACb,CAAC,CAAC,CACF,KAAM,CAACI,eAAe,CAAEC,iBAAiB,CAAC,CAAGhb,QAAQ,CAAC,EAAE,CAAC,CACzD,KAAM,CAAC0U,MAAM,CAAEC,SAAS,CAAC,CAAG3U,QAAQ,CAAC,CAAC,CAAC,CAAC,CACxC,KAAM,CAACib,eAAe,CAAEC,kBAAkB,CAAC,CAAGlb,QAAQ,CAAC,KAAK,CAAC,CAC7D,KAAM,CAAAmb,sBAAsB,CAAGpb,KAAK,CAACqb,MAAM,CAAC,CAAC,CAAC,CAAC,CAC/C,KAAM,CAACC,iBAAiB,CAAEC,oBAAoB,CAAC,CAAGtb,QAAQ,CAAC,IAAI,CAAC,CAAE;AAClE,KAAM,CAACub,gBAAgB,CAAEC,mBAAmB,CAAC,CAAGxb,QAAQ,CAAC,EAAE,CAAC,CAC5D,KAAM,CAACyb,oBAAoB,CAAEC,uBAAuB,CAAC,CAAG1b,QAAQ,CAAC,KAAK,CAAC,CAEvEC,SAAS,CAAC,IAAM,CACd,GAAI,CAAC0L,UAAU,CAAE,OACjB,KAAM,CAAAiP,KAAK,CAAGzX,mBAAmB,CAACwI,UAAU,CAAC,CAC7C,GAAIiP,KAAK,CAAE,CACTnG,WAAW,CAAC/E,IAAI,OAAAiM,mBAAA,CAAAC,eAAA,QAAAvN,aAAA,CAAAA,aAAA,CAAAA,aAAA,IACXqB,IAAI,EACJkL,KAAK,MACRlP,SAAS,CAAEV,KAAK,CAACC,OAAO,CAAC2P,KAAK,CAAClP,SAAS,CAAC,CAAGkP,KAAK,CAAClP,SAAS,CAAG,EAAE,CAChE0O,WAAW,EAAAuB,mBAAA,CAAEf,KAAK,CAACR,WAAW,UAAAuB,mBAAA,UAAAA,mBAAA,CAAI,KAAK,CACvCpL,OAAO,EAAAqL,eAAA,CAAEhB,KAAK,CAACrK,OAAO,UAAAqL,eAAA,UAAAA,eAAA,CAAI,KAAK,CAC/BrQ,MAAM,CAAE,EAAE,IACV,CAAC,CACL,CAAC,IAAM,CACLkJ,WAAW,CAACuF,wBAAwB,CAAC,CAAC,CAAC,CACzC,CACF,CAAC,CAAE,CAACrO,UAAU,CAAC,CAAC,CAEhB1L,SAAS,CAAC,IAAM,CACd,GAAI,CAAC0L,UAAU,EAAItH,QAAQ,GAAK,UAAU,CAAE,OAC5CjB,mBAAmB,CAACuI,UAAU,CAAE6I,QAAQ,CAAC,CAC3C,CAAC,CAAE,CAACA,QAAQ,CAAE7I,UAAU,CAAEtH,QAAQ,CAAC,CAAC,CAEpC;AACApE,SAAS,CAAC,IAAM,KAAA4b,gBAAA,CACd,KAAM,CAAAC,WAAW,CAAGtH,QAAQ,CAAChK,KAAK,EAAIgK,QAAQ,CAAClJ,WAAW,EAAI,EAAAuQ,gBAAA,CAAArH,QAAQ,CAACjJ,MAAM,UAAAsQ,gBAAA,iBAAfA,gBAAA,CAAiB7U,MAAM,EAAG,CAAC,CAEzF,KAAM,CAAA+U,kBAAkB,CAAI3R,CAAC,EAAK,CAChC,GAAI0R,WAAW,CAAE,CACf1R,CAAC,CAAC2O,cAAc,CAAC,CAAC,CAClB3O,CAAC,CAAC4R,WAAW,CAAG,EAAE,CAClB,MAAO,EAAE,CACX,CACF,CAAC,CAED,GAAIF,WAAW,CAAE,CACfnL,MAAM,CAACsL,gBAAgB,CAAC,cAAc,CAAEF,kBAAkB,CAAC,CAC7D,CAEA,MAAO,IAAM,CACXpL,MAAM,CAACuL,mBAAmB,CAAC,cAAc,CAAEH,kBAAkB,CAAC,CAChE,CAAC,CACH,CAAC,CAAE,CAACvH,QAAQ,CAAChK,KAAK,CAAEgK,QAAQ,CAAClJ,WAAW,CAAEkJ,QAAQ,CAACjJ,MAAM,CAAC,CAAC,CAE3D;AACA,KAAM,CAAA4Q,sBAAsB,CAAGjc,OAAO,CAAC,IAAM,CAC1Ckc,GAAG,EAAKA,GAAG,CAACC,UAAU,CAAC,kCAAkC,CAAC,CAAGD,GAAG,oCAAAlO,MAAA,CAAsCkO,GAAG,CAAE,CAC3GA,GAAG,EAAKA,GAAG,CAACC,UAAU,CAAC,wBAAwB,CAAC,CAAGD,GAAG,0BAAAlO,MAAA,CAA4BoO,kBAAkB,CAACF,GAAG,CAAC,CAAE,CAC7G,CAAE,EAAE,CAAC,CAEN,KAAM,CAAAG,qBAAqB,CAAGpc,WAAW,CAAC,eAAOic,GAAG,CAAmB,IAAjB,CAAAI,OAAO,CAAAzV,SAAA,CAAAC,MAAA,IAAAD,SAAA,MAAAE,SAAA,CAAAF,SAAA,IAAG,CAAC,CAAC,CAChE,KAAM,CAAA0V,YAAY,CAAGA,CAAA,GAAM,CACzB,KAAM,CAAA9B,IAAI,CAAAtM,aAAA,IAAQmO,OAAO,CAAE,CAC3B,GAAIA,OAAO,CAACE,OAAO,CAAE/B,IAAI,CAAC+B,OAAO,CAAArO,aAAA,IAAQmO,OAAO,CAACE,OAAO,CAAE,CAC1D,MAAO,CAAA/B,IAAI,CACb,CAAC,CAED,KAAM,CAAAgC,OAAO,CAAG,KAAO,CAAAC,SAAS,EAAK,CACnC,KAAM,CAAAC,IAAI,CAAG,KAAM,CAAAC,KAAK,CAACF,SAAS,CAAEH,YAAY,CAAC,CAAC,CAAC,CACnD,GAAI,CAACI,IAAI,CAACE,EAAE,CAAE,KAAM,IAAI,CAAAC,KAAK,+BAAA9O,MAAA,CAA+B2O,IAAI,CAACrR,MAAM,CAAE,CAAC,CAC1E,MAAO,CAAAqR,IAAI,CACb,CAAC,CAED,GAAI,CACF,MAAO,MAAM,CAAAF,OAAO,CAACP,GAAG,CAAC,CAC3B,CAAE,MAAOjT,GAAG,CAAE,KAAA8T,eAAA,CACZ,IAAAA,eAAA,CAAIT,OAAO,CAACU,MAAM,UAAAD,eAAA,WAAdA,eAAA,CAAgBE,OAAO,CAAE,KAAM,CAAAhU,GAAG,CACtC,GAAI,CAAAiU,SAAS,CAAGjU,GAAG,CACnB,IAAK,KAAM,CAAAkU,SAAS,GAAI,CAAAlB,sBAAsB,CAAE,CAC9C,GAAI,CACF,KAAM,CAAAmB,UAAU,CAAGD,SAAS,CAACjB,GAAG,CAAC,CACjC,MAAO,MAAM,CAAAO,OAAO,CAACW,UAAU,CAAC,CAClC,CAAE,MAAOC,QAAQ,CAAE,KAAAC,gBAAA,CACjBJ,SAAS,CAAGG,QAAQ,CACpB,IAAAC,gBAAA,CAAIhB,OAAO,CAACU,MAAM,UAAAM,gBAAA,WAAdA,gBAAA,CAAgBL,OAAO,CAAE,MAC/B,CACF,CACA,KAAM,CAAAC,SAAS,CACjB,CACF,CAAC,CAAE,CAACjB,sBAAsB,CAAC,CAAC,CAE5B;AACA,KAAM,CAAAsB,qBAAqB,CAAG,KAAO,CAAAC,KAAK,EAAK,CAC7C,GAAI,CAACA,KAAK,EAAIA,KAAK,CAACvR,IAAI,CAAC,CAAC,CAACnF,MAAM,CAAG,CAAC,CAAE,MAAO,EAAE,CAEhD;AACA,GAAIyT,iBAAiB,GAAK,QAAQ,EAAIF,YAAY,CAAE,CAClD,GAAI,KAAAoD,cAAA,CACF,KAAM,CAAAd,IAAI,CAAG,KAAM,CAAAC,KAAK,sDAAA5O,MAAA,CAAsDoO,kBAAkB,CAACoB,KAAK,CAAC,wBAAAxP,MAAA,CAAsBqM,YAAY,oDAAkD,CAAC,CAC5L,KAAM,CAAAqD,IAAI,CAAG,KAAM,CAAAf,IAAI,CAACgB,IAAI,CAAC,CAAC,CAC9B,GAAID,IAAI,SAAJA,IAAI,YAAAD,cAAA,CAAJC,IAAI,CAAEE,QAAQ,UAAAH,cAAA,WAAdA,cAAA,CAAgB3W,MAAM,CAAE,CAC1B,MAAO,CAAA4W,IAAI,CAACE,QAAQ,CAACpE,GAAG,CAACqE,CAAC,OAAAC,WAAA,CAAAC,qBAAA,CAAAC,YAAA,CAAAC,qBAAA,OAAK,CAC7BC,GAAG,CAAEL,CAAC,CAACM,MAAM,CAAGN,CAAC,CAACM,MAAM,CAAC,CAAC,CAAC,EAAAL,WAAA,CAAGD,CAAC,CAACO,QAAQ,UAAAN,WAAA,kBAAAC,qBAAA,CAAVD,WAAA,CAAYO,WAAW,UAAAN,qBAAA,iBAAvBA,qBAAA,CAA0B,CAAC,CAAC,CAC1DO,GAAG,CAAET,CAAC,CAACM,MAAM,CAAGN,CAAC,CAACM,MAAM,CAAC,CAAC,CAAC,EAAAH,YAAA,CAAGH,CAAC,CAACO,QAAQ,UAAAJ,YAAA,kBAAAC,qBAAA,CAAVD,YAAA,CAAYK,WAAW,UAAAJ,qBAAA,iBAAvBA,qBAAA,CAA0B,CAAC,CAAC,CAC1DM,KAAK,CAAEV,CAAC,CAACW,UAAU,EAAIX,CAAC,CAACY,IAAI,CAC7BC,MAAM,CAAE,QACV,CAAC,EAAC,CAAC,CAAClW,MAAM,CAACmW,KAAK,EAAI,MAAO,CAAAA,KAAK,CAACT,GAAG,GAAK,QAAQ,EAAI,MAAO,CAAAS,KAAK,CAACL,GAAG,GAAK,QAAQ,CAAC,CACrF,CACF,CAAE,MAAOrV,GAAG,CAAE,CACZC,OAAO,CAACiB,IAAI,CAAC,+BAA+B,CAAElB,GAAG,CAAC,CACpD,CACF,CAEA;AACA,GAAI,CACF,KAAM,CAAA2V,QAAQ,CAAG,KAAM,CAAAhC,KAAK,qCAAA5O,MAAA,CAAqCoO,kBAAkB,CAACoB,KAAK,CAAC,YAAU,CAAC,CACrG,GAAIoB,QAAQ,CAAC/B,EAAE,CAAE,CACf,KAAM,CAAAgC,QAAQ,CAAG,KAAM,CAAAD,QAAQ,CAACjB,IAAI,CAAC,CAAC,CACtC,GAAI7S,KAAK,CAACC,OAAO,CAAC8T,QAAQ,CAAC,EAAIA,QAAQ,CAAC/X,MAAM,CAAE,CAC9C,MAAO,CAAA+X,QAAQ,CAACC,KAAK,CAAC,CAAC,CAAE,CAAC,CAAC,CAACtF,GAAG,CAACmF,KAAK,GAAK,CACxCT,GAAG,CAAElN,UAAU,CAAC2N,KAAK,CAACT,GAAG,CAAC,CAC1BI,GAAG,CAAEtN,UAAU,CAAC2N,KAAK,CAACL,GAAG,CAAC,CAC1BC,KAAK,CAAEI,KAAK,CAACI,YAAY,EAAIJ,KAAK,CAACzM,IAAI,CACvCwM,MAAM,CAAE,SACV,CAAC,CAAC,CAAC,CACL,CACF,CACF,CAAE,MAAOM,OAAO,CAAE,CAChB9V,OAAO,CAACiB,IAAI,CAAC,gCAAgC,CAAE6U,OAAO,CAAC,CACzD,CAEA;AACA,KAAM,CAAAC,QAAQ,CAAIrV,OAAO,CAACC,GAAG,CAACqV,oBAAoB,GAAKzO,MAAM,CAACtF,QAAQ,EAAIsF,MAAM,CAACtF,QAAQ,CAACgU,IAAI,GAAK,MAAM,CAAG,wBAAwB,CAAG,EAAE,CAAE,CAC3I,GAAIF,QAAQ,CAAE,CACZ,GAAI,CACF,KAAM,CAAAG,SAAS,CAAG,KAAM,CAAAxC,KAAK,IAAA5O,MAAA,CAAIiR,QAAQ,mBAAAjR,MAAA,CAAiBoO,kBAAkB,CAACoB,KAAK,CAAC,CAAE,CAAC,CACtF,GAAI4B,SAAS,CAACvC,EAAE,CAAE,CAChB,KAAM,CAAAwC,SAAS,CAAG,KAAM,CAAAD,SAAS,CAACzB,IAAI,CAAC,CAAC,CACxC,GAAI7S,KAAK,CAACC,OAAO,CAACsU,SAAS,CAAC,EAAIA,SAAS,CAACvY,MAAM,CAAE,CAChD,MAAO,CAAAuY,SAAS,CAACP,KAAK,CAAC,CAAC,CAAE,CAAC,CAAC,CAACtF,GAAG,CAACmF,KAAK,GAAK,CACzCT,GAAG,CAAElN,UAAU,CAAC2N,KAAK,CAACT,GAAG,CAAC,CAC1BI,GAAG,CAAEtN,UAAU,CAAC2N,KAAK,CAACL,GAAG,CAAC,CAC1BC,KAAK,CAAEI,KAAK,CAACI,YAAY,CACzBL,MAAM,CAAEO,QAAQ,CAACnR,QAAQ,CAAC,WAAW,CAAC,CAAG,aAAa,CAAG,OAC3D,CAAC,CAAC,CAAC,CACL,CACF,CACF,CAAE,MAAOuP,QAAQ,CAAE,CACjBnU,OAAO,CAACiB,IAAI,CAAC,oCAAoC,CAAEkT,QAAQ,CAAC,CAC9D,CACF,CAEA;AACA,GAAI,CACF,KAAM,CAAAiC,UAAU,CAAG,KAAM,CAAAjD,qBAAqB,8EAAArO,MAAA,CAA8EoO,kBAAkB,CAACoB,KAAK,CAAC,EAAI,CACvJhB,OAAO,CAAE,CACP,YAAY,CAAE,4CAA4C,CAC1D,QAAQ,CAAE,kBACZ,CACF,CAAC,CAAC,CACF,GAAI8C,UAAU,CAACzC,EAAE,CAAE,CACjB,KAAM,CAAA0C,UAAU,CAAG,KAAM,CAAAD,UAAU,CAAC3B,IAAI,CAAC,CAAC,CAC1C,GAAI7S,KAAK,CAACC,OAAO,CAACwU,UAAU,CAAC,EAAIA,UAAU,CAACzY,MAAM,CAAE,CAClD,MAAO,CAAAyY,UAAU,CAACT,KAAK,CAAC,CAAC,CAAE,CAAC,CAAC,CAACtF,GAAG,CAACmF,KAAK,GAAK,CAC1CT,GAAG,CAAElN,UAAU,CAAC2N,KAAK,CAACT,GAAG,CAAC,CAC1BI,GAAG,CAAEtN,UAAU,CAAC2N,KAAK,CAACL,GAAG,CAAC,CAC1BC,KAAK,CAAEI,KAAK,CAACI,YAAY,CACzBL,MAAM,CAAE,QACV,CAAC,CAAC,CAAC,CACL,CACF,CACF,CAAE,MAAOc,SAAS,CAAE,CAClBtW,OAAO,CAACiB,IAAI,CAAC,yCAAyC,CAAEqV,SAAS,CAAC,CACpE,CAEA,MAAO,EAAE,CACX,CAAC,CAED,KAAM,CAAAC,kBAAkB,CAAG,CACzB,MAAM,CAAE,SAAS,CAAE,SAAS,CAAE,SAAS,CAAE,kBAAkB,CAC3D,SAAS,CAAE,IAAI,CAAE,WAAW,CAAE,cAAc,CAAE,QAAQ,CACvD,CAED,KAAM,CAAA7K,aAAa,CAAG,QAAAA,CAAC1C,IAAI,CAAE2C,KAAK,CAAkB,IAAhB,CAAAC,MAAM,CAAAjO,SAAA,CAAAC,MAAA,IAAAD,SAAA,MAAAE,SAAA,CAAAF,SAAA,IAAG,CAAC,CAAC,CAC7C,KAAM,CAAAkO,SAAS,CAAA5G,aAAA,IAAQqG,MAAM,CAAE,CAE/B,OAAQtC,IAAI,EACV,IAAK,OAAO,CACV,GAAI,CAAC2C,KAAK,EAAIA,KAAK,CAAC5I,IAAI,CAAC,CAAC,CAACnF,MAAM,CAAG,CAAC,CAAE,CACrCiO,SAAS,CAACzK,KAAK,CAAG,qCAAqC,CACzD,CAAC,IAAM,CACL,MAAO,CAAAyK,SAAS,CAACzK,KAAK,CACxB,CACA,MACF,IAAK,OAAO,CACV,GAAI,CAACuK,KAAK,EAAI7D,UAAU,CAAC6D,KAAK,CAAC,EAAI,CAAC,CAAE,CACpCE,SAAS,CAAC7J,KAAK,CAAG,8BAA8B,CAClD,CAAC,IAAM,IAAI8F,UAAU,CAAC6D,KAAK,CAAC,CAAG,GAAG,CAAE,CAClCE,SAAS,CAAC7J,KAAK,CAAG,oCAAoC,CACxD,CAAC,IAAM,IAAI8F,UAAU,CAAC6D,KAAK,CAAC,CAAG,KAAK,CAAE,CACpCE,SAAS,CAAC7J,KAAK,CAAG,wCAAwC,CAC5D,CAAC,IAAM,CACL,MAAO,CAAA6J,SAAS,CAAC7J,KAAK,CACxB,CACA,MACF,IAAK,UAAU,CAAE,KAAAwU,KAAA,CAAAC,qBAAA,CAAAC,KAAA,CAAAC,gBAAA,CACf,KAAM,CAAAC,UAAU,CAAG,EAAAJ,KAAA,EAAAC,qBAAA,CAAC7K,MAAM,CAAChF,aAAa,UAAA6P,qBAAA,UAAAA,qBAAA,CAAIrL,QAAQ,CAACxE,aAAa,UAAA4P,KAAA,UAAAA,KAAA,CAAI,EAAE,EAAEzT,IAAI,CAAC,CAAC,CAChF,KAAM,CAAA8T,QAAQ,CAAG,EAAAH,KAAA,EAAAC,gBAAA,CAAC/K,MAAM,CAAC3J,QAAQ,UAAA0U,gBAAA,UAAAA,gBAAA,CAAIhL,KAAK,UAAA+K,KAAA,UAAAA,KAAA,CAAI,EAAE,EAAE3T,IAAI,CAAC,CAAC,CACxD,GAAI,CAAC6T,UAAU,EAAIA,UAAU,CAAChZ,MAAM,CAAG,CAAC,CAAE,CACxCiO,SAAS,CAAC5J,QAAQ,CAAG,uDAAuD,CAC9E,CAAC,IAAM,IAAI,CAAC4U,QAAQ,EAAIA,QAAQ,CAACjZ,MAAM,CAAG,CAAC,CAAE,CAC3CiO,SAAS,CAAC5J,QAAQ,CAAG,yEAAyE,CAChG,CAAC,IAAM,CACL,MAAO,CAAA4J,SAAS,CAAC5J,QAAQ,CAC3B,CACA,MACF,CACA,IAAK,aAAa,CAChB,GAAI0J,KAAK,EAAIA,KAAK,CAAC/N,MAAM,CAAG,GAAG,CAAE,CAC/BiO,SAAS,CAAC3J,WAAW,CAAG,8CAA8C,CACxE,CAAC,IAAM,CACL,MAAO,CAAA2J,SAAS,CAAC3J,WAAW,CAC9B,CACA,MACF,QACE,MACJ,CAEAqJ,SAAS,CAACM,SAAS,CAAC,CACtB,CAAC,CAID;AACAhV,SAAS,CAAC,IAAM,CACd,GAAI,CACF,KAAM,CAAAigB,GAAG,CAAG1W,YAAY,CAACK,OAAO,CAAC,uBAAuB,CAAC,CACzD,GAAIqW,GAAG,CAAE,CACP,KAAM,CAAAnV,MAAM,CAAGrB,IAAI,CAACiB,KAAK,CAACuV,GAAG,CAAC,CAC9B,GAAInV,MAAM,EAAI,MAAO,CAAAA,MAAM,GAAK,QAAQ,CAAE,CACxCoQ,sBAAsB,CAACgF,OAAO,CAAGpV,MAAM,CACzC,CACF,CACF,CAAE,MAAOX,CAAC,CAAE,CAAE,aAChB,CAAC,CAAE,EAAE,CAAC,CAEN;AACA,KAAM,CAAAgW,cAAc,CAAG,KAAAA,CAAA,GAAY,CACjC,GAAI,CAAC5L,QAAQ,CAACxE,aAAa,CAAE,CAC3BgL,iBAAiB,CAAC,+BAA+B,CAAC,CAClD,OACF,CAEAA,iBAAiB,CAAC,wBAAwB,CAAC,CAC3C,GAAI,CACF,KAAM,CAAAjL,WAAW,IAAA7B,MAAA,CAAMsG,QAAQ,CAACxE,aAAa,OAAA9B,MAAA,CAAKsG,QAAQ,CAACnJ,QAAQ,kBAAgB,CACnF,KAAM,CAAAgV,OAAO,CAAG,KAAM,CAAA5C,qBAAqB,CAAC1N,WAAW,CAAC,CAExD,GAAIsQ,OAAO,CAACrZ,MAAM,CAAG,CAAC,CAAE,CACtB,KAAM,CAAAsZ,IAAI,CAAGD,OAAO,CAAC,CAAC,CAAC,CACvB5L,WAAW,CAAApG,aAAA,CAAAA,aAAA,IACNmG,QAAQ,MACXpE,QAAQ,CAAEc,UAAU,CAACoP,IAAI,CAAClC,GAAG,CAAC,CAC9B/N,SAAS,CAAEa,UAAU,CAACoP,IAAI,CAAC9B,GAAG,CAAC,EAChC,CAAC,CACFxD,iBAAiB,wBAAmB,CAAC,CACrC/Q,UAAU,CAAC,IAAM+Q,iBAAiB,CAAC,EAAE,CAAC,CAAE,IAAI,CAAC,CAC7CM,oBAAoB,CAACgF,IAAI,CAAC1B,MAAM,EAAI,gBAAgB,CAAC,CACrD,OACF,CAEA5D,iBAAiB,CAAC,6CAA6C,CAAC,CAChE,KAAM,CAAAuF,WAAW,CAAG,KAAM,CAAA9C,qBAAqB,IAAAvP,MAAA,CAAIsG,QAAQ,CAACnJ,QAAQ,kBAAgB,CAAC,CACrF,GAAIkV,WAAW,CAACvZ,MAAM,CAAG,CAAC,CAAE,CAC1B,KAAM,CAAAwZ,QAAQ,CAAGD,WAAW,CAAC,CAAC,CAAC,CAC/B9L,WAAW,CAAApG,aAAA,CAAAA,aAAA,IACNmG,QAAQ,MACXpE,QAAQ,CAAEc,UAAU,CAACsP,QAAQ,CAACpC,GAAG,CAAC,CAClC/N,SAAS,CAAEa,UAAU,CAACsP,QAAQ,CAAChC,GAAG,CAAC,EACpC,CAAC,CACFxD,iBAAiB,CAAC,eAAe,CAAC,CAClC/Q,UAAU,CAAC,IAAM+Q,iBAAiB,CAAC,EAAE,CAAC,CAAE,IAAI,CAAC,CAC7CM,oBAAoB,CAACkF,QAAQ,CAAC5B,MAAM,EAAI,gBAAgB,CAAC,CAC3D,CAAC,IAAM,CACL5D,iBAAiB,CAAC,yBAAyB,CAAC,CAC9C,CACF,CAAE,MAAO3R,KAAK,CAAE,CACdD,OAAO,CAACC,KAAK,CAAC,kBAAkB,CAAEA,KAAK,CAAC,CACxC2R,iBAAiB,CAAC,+CAA+C,CAAC,CAClEM,oBAAoB,CAAC,IAAI,CAAC,CAC5B,CACF,CAAC,CAED,KAAM,CAAAmF,aAAa,CAAInP,OAAO,EAAK,CACjC,GAAIkD,QAAQ,CAAC9I,SAAS,CAACsC,QAAQ,CAACsD,OAAO,CAAC,CAAE,CACxCmD,WAAW,CAAApG,aAAA,CAAAA,aAAA,IAAMmG,QAAQ,MAAE9I,SAAS,CAAE8I,QAAQ,CAAC9I,SAAS,CAAChD,MAAM,CAAC+I,CAAC,EAAIA,CAAC,GAAKH,OAAO,CAAC,EAAE,CAAC,CACxF,CAAC,IAAM,CACLmD,WAAW,CAAApG,aAAA,CAAAA,aAAA,IAAMmG,QAAQ,MAAE9I,SAAS,CAAE,CAAC,GAAG8I,QAAQ,CAAC9I,SAAS,CAAE4F,OAAO,CAAC,EAAE,CAAC,CAC3E,CACF,CAAC,CAED,KAAM,CAACoP,YAAY,CAAEC,eAAe,CAAC,CAAG3gB,QAAQ,CAAC,KAAK,CAAC,CAEvD,KAAM,CAAA6V,YAAY,CAAG,KAAAA,CAAA,GAAY,CAC/B;AACA,GAAI,CAACtQ,WAAW,CAAE,CAChB4N,aAAa,EAAIA,aAAa,CAAC,UAAU,CAAC,CAC1C,OACF,CACA,GAAI9O,QAAQ,GAAK,UAAU,CAAE,CAC3B;AACA8O,aAAa,EAAIA,aAAa,CAAC,UAAU,CAAC,CAC1C,OACF,CACA,GAAI,CAAC5N,WAAW,CAACwC,gBAAgB,CAAE,CACjC;AACAuL,mBAAmB,EAAIA,mBAAmB,CAAC,CAAC,CAC5C,OACF,CAEA;AACAwB,aAAa,CAAC,OAAO,CAAEN,QAAQ,CAAChK,KAAK,CAAC,CACtCsK,aAAa,CAAC,OAAO,CAAEN,QAAQ,CAACpJ,KAAK,CAAC,CACtC0J,aAAa,CAAC,UAAU,CAAEN,QAAQ,CAACnJ,QAAQ,CAAE,CAC3CA,QAAQ,CAAEmJ,QAAQ,CAACnJ,QAAQ,CAC3B2E,aAAa,CAAEwE,QAAQ,CAACxE,aAC1B,CAAC,CAAC,CACF8E,aAAa,CAAC,aAAa,CAAEN,QAAQ,CAAClJ,WAAW,CAAC,CAElD,GAAI,CAACkJ,QAAQ,CAAChK,KAAK,EAAIgK,QAAQ,CAAChK,KAAK,CAAC2B,IAAI,CAAC,CAAC,CAACnF,MAAM,CAAG,CAAC,CAAE,CACvD2N,SAAS,CAACjF,IAAI,EAAArB,aAAA,CAAAA,aAAA,IAAUqB,IAAI,MAAElF,KAAK,CAAE,qCAAqC,EAAG,CAAC,CAC9E,OACF,CACA,GAAI,CAACgK,QAAQ,CAACpJ,KAAK,EAAI8F,UAAU,CAACsD,QAAQ,CAACpJ,KAAK,CAAC,EAAI,CAAC,CAAE,CACtDuJ,SAAS,CAACjF,IAAI,EAAArB,aAAA,CAAAA,aAAA,IAAUqB,IAAI,MAAEtE,KAAK,CAAE,8BAA8B,EAAG,CAAC,CACvE,OACF,CACA,GAAI,CAACoJ,QAAQ,CAACnJ,QAAQ,EAAImJ,QAAQ,CAACnJ,QAAQ,CAACc,IAAI,CAAC,CAAC,CAACnF,MAAM,CAAG,CAAC,CAAE,CAC7D2N,SAAS,CAACjF,IAAI,EAAArB,aAAA,CAAAA,aAAA,IAAUqB,IAAI,MAAErE,QAAQ,CAAE,sBAAsB,EAAG,CAAC,CAClE,OACF,CACA,GAAI0K,MAAM,CAACC,IAAI,CAACtB,MAAM,CAAC,CAAC1N,MAAM,CAAG,CAAC,CAAE,CAClC,OACF,CAEA2Z,eAAe,CAAC,IAAI,CAAC,CACrB,GAAI,CACF,KAAM,CAAAzO,QAAQ,CAACsC,QAAQ,CAAC,CAC1B,CAAC,OAAS,CACRmM,eAAe,CAAC,KAAK,CAAC,CACxB,CACF,CAAC,CAED,KAAM,CAAAC,eAAe,CAAG,CAACpM,QAAQ,CAACxE,aAAa,CAAEwE,QAAQ,CAACnJ,QAAQ,CAAE,cAAc,CAAC,CAChF3C,MAAM,CAACuH,OAAO,CAAC,CACfC,IAAI,CAAC,IAAI,CAAC,CACb,KAAM,CAAA2Q,aAAa,CAAGD,eAAe,oDAAA1S,MAAA,CACkBoO,kBAAkB,CAACsE,eAAe,CAAC,EACtF,EAAE,CACN,KAAM,CAAAE,mBAAmB,CAAG,CAACtM,QAAQ,CAACxE,aAAa,CAAEwE,QAAQ,CAACnJ,QAAQ,CAAC,CACpEqO,GAAG,CAACqH,IAAI,EAAI,CAACA,IAAI,EAAI,EAAE,EAAE5U,IAAI,CAAC,CAAC,CAAC,CAChCzD,MAAM,CAACuH,OAAO,CAAC,CACfC,IAAI,CAAC,IAAI,CAAC,CAEbjQ,SAAS,CAAC,IAAM,CACd,GAAIwb,oBAAoB,CAAE,OAC1BD,mBAAmB,CAAC9L,IAAI,EAAKA,IAAI,GAAKoR,mBAAmB,CAAGpR,IAAI,CAAGoR,mBAAoB,CAAC,CAC1F,CAAC,CAAE,CAACA,mBAAmB,CAAErF,oBAAoB,CAAC,CAAC,CAE/C,KAAM,CAAAuF,uBAAuB,CAAIjM,KAAK,EAAK,CACzCyG,mBAAmB,CAACzG,KAAK,CAAC,CAC1B,GAAI,CAACA,KAAK,EAAIA,KAAK,CAAC/N,MAAM,CAAG,CAAC,CAAE,CAC9ByN,WAAW,CAAC/E,IAAI,EAAArB,aAAA,CAAAA,aAAA,IAAUqB,IAAI,MAAEM,aAAa,CAAE,EAAE,CAAE3E,QAAQ,CAAE,EAAE,EAAG,CAAC,CACnEyJ,aAAa,CAAC,UAAU,CAAE,EAAE,CAAC,CAC7B,OACF,CAEA,KAAM,CAAAmM,KAAK,CAAGlM,KAAK,CAChBkF,KAAK,CAAC,GAAG,CAAC,CACVP,GAAG,CAACqH,IAAI,EAAIA,IAAI,CAAC5U,IAAI,CAAC,CAAC,CAAC,CACxBzD,MAAM,CAACuH,OAAO,CAAC,CAElB,GAAIgR,KAAK,CAACja,MAAM,GAAK,CAAC,CAAE,CACtByN,WAAW,CAAC/E,IAAI,EAAArB,aAAA,CAAAA,aAAA,IAAUqB,IAAI,MAAEM,aAAa,CAAE,EAAE,CAAE3E,QAAQ,CAAE,EAAE,EAAG,CAAC,CACnEyJ,aAAa,CAAC,UAAU,CAAE,EAAE,CAAC,CAC7B,OACF,CAEA,GAAI,CAAAoM,MAAM,CAAGD,KAAK,CAAC,CAAC,CAAC,EAAI,EAAE,CAC3B,GAAI,CAAAE,eAAe,CAAGF,KAAK,CAACjC,KAAK,CAAC,CAAC,CAAC,CAAC9O,IAAI,CAAC,IAAI,CAAC,CAE/C,GAAI,CAACiR,eAAe,CAAE,CACpB,KAAM,CAAAC,KAAK,CAAGF,MAAM,CAACjH,KAAK,CAAC,KAAK,CAAC,CAACvR,MAAM,CAACuH,OAAO,CAAC,CACjD,GAAImR,KAAK,CAACpa,MAAM,EAAI,CAAC,CAAE,CACrB;AACA,KAAM,CAAAqa,iBAAiB,CAAGC,IAAI,CAACC,GAAG,CAAC,CAAC,CAAED,IAAI,CAACE,IAAI,CAACJ,KAAK,CAACpa,MAAM,CAAG,CAAC,CAAC,CAAC,CAClEma,eAAe,CAAGC,KAAK,CAACpC,KAAK,CAAC,CAACqC,iBAAiB,CAAC,CAACnR,IAAI,CAAC,GAAG,CAAC,CAC3DgR,MAAM,CAAGE,KAAK,CAACpC,KAAK,CAAC,CAAC,CAAEoC,KAAK,CAACpa,MAAM,CAAGqa,iBAAiB,CAAC,CAACnR,IAAI,CAAC,GAAG,CAAC,CACrE,CAAC,IAAM,CACLiR,eAAe,CAAGD,MAAM,CAC1B,CACF,CAEAzM,WAAW,CAAC/E,IAAI,EAAArB,aAAA,CAAAA,aAAA,IACXqB,IAAI,MACPM,aAAa,CAAEkR,MAAM,CACrB7V,QAAQ,CAAE8V,eAAe,EACzB,CAAC,CACHrM,aAAa,CAAC,UAAU,CAAEqM,eAAe,EAAID,MAAM,CAAE,CACnD7V,QAAQ,CAAE8V,eAAe,CACzBnR,aAAa,CAAEkR,MACjB,CAAC,CAAC,CACJ,CAAC,CAED,KAAM,CAAAO,wBAAwB,CAAGA,CAAA,GAAM,CACrC,GAAI,CAAC9V,UAAU,CAAE,OACjBtI,oBAAoB,CAACsI,UAAU,CAAC,CAChC,KAAM,CAAA+V,KAAK,CAAG1H,wBAAwB,CAAC,CAAC,CACxCvF,WAAW,CAACiN,KAAK,CAAC,CAClBlG,mBAAmB,CAAC,EAAE,CAAC,CACzB,CAAC,CAED,mBACE3X,IAAA,QAAK8N,SAAS,CAAC,mEAAmE,CAAAC,QAAA,cAChF/N,IAAA,QAAK8N,SAAS,CAAC,wBAAwB,CAAAC,QAAA,cACrC7N,KAAA,QAAK4N,SAAS,CAAC,2DAA2D,CAAAC,QAAA,eACxE7N,KAAA,QAAK4N,SAAS,CAAC,wCAAwC,CAAAC,QAAA,eACrD/N,IAAA,OAAI8N,SAAS,CAAC,uCAAuC,CAAAC,QAAA,CAAC,aAAW,CAAI,CAAC,cACtE/N,IAAA,WAAQkO,OAAO,CAAEgB,QAAS,CAACpB,SAAS,CAAC,wFAAwF,CAAAC,QAAA,cAC3H/N,IAAA,CAAClC,CAAC,EAACgQ,SAAS,CAAC,SAAS,CAAE,CAAC,CACnB,CAAC,EACN,CAAC,cAGN5N,KAAA,QAAK4N,SAAS,CAAC,MAAM,CAAAC,QAAA,eACnB7N,KAAA,QAAK4N,SAAS,CAAC,wCAAwC,CAAAC,QAAA,eACrD/N,IAAA,SAAM8N,SAAS,CAAC,mCAAmC,CAAAC,QAAA,CAAC,eAAa,CAAM,CAAC,cACxE/N,IAAA,SAAM8N,SAAS,CAAC,qCAAqC,CAAAC,QAAA,CAClD,CAAC,IAAM,CACN,GAAI,CAAA+P,SAAS,CAAG,CAAC,CACjB,KAAM,CAAAC,KAAK,CAAG,CAAC,CACf,GAAIpN,QAAQ,CAAChK,KAAK,EAAIgK,QAAQ,CAAChK,KAAK,CAAC2B,IAAI,CAAC,CAAC,CAACnF,MAAM,EAAI,CAAC,CAAE2a,SAAS,EAAE,CACpE,GAAInN,QAAQ,CAACpJ,KAAK,EAAI8F,UAAU,CAACsD,QAAQ,CAACpJ,KAAK,CAAC,EAAI,GAAG,CAAEuW,SAAS,EAAE,CACpE,GAAInN,QAAQ,CAACxE,aAAa,EAAIwE,QAAQ,CAACnJ,QAAQ,CAAEsW,SAAS,EAAE,CAC5D,GAAInN,QAAQ,CAAClJ,WAAW,EAAIkJ,QAAQ,CAAClJ,WAAW,CAACtE,MAAM,EAAI,EAAE,CAAE2a,SAAS,EAAE,CAC1E,GAAInN,QAAQ,CAACjJ,MAAM,EAAIiJ,QAAQ,CAACjJ,MAAM,CAACvE,MAAM,CAAG,CAAC,CAAE2a,SAAS,EAAE,CAC9D,SAAAzT,MAAA,CAAUyT,SAAS,MAAAzT,MAAA,CAAI0T,KAAK,eAC9B,CAAC,EAAE,CAAC,CACA,CAAC,EACJ,CAAC,cACN/d,IAAA,QAAK8N,SAAS,CAAC,8CAA8C,CAAAC,QAAA,cAC3D/N,IAAA,QACE8N,SAAS,CAAC,4FAA4F,CACtGkQ,KAAK,CAAE,CACLC,KAAK,IAAA5T,MAAA,CAAK,CAAC,IAAM,CACf,GAAI,CAAAyT,SAAS,CAAG,CAAC,CACjB,GAAInN,QAAQ,CAAChK,KAAK,EAAIgK,QAAQ,CAAChK,KAAK,CAAC2B,IAAI,CAAC,CAAC,CAACnF,MAAM,EAAI,CAAC,CAAE2a,SAAS,EAAE,CACpE,GAAInN,QAAQ,CAACpJ,KAAK,EAAI8F,UAAU,CAACsD,QAAQ,CAACpJ,KAAK,CAAC,EAAI,GAAG,CAAEuW,SAAS,EAAE,CACpE,GAAInN,QAAQ,CAACxE,aAAa,EAAIwE,QAAQ,CAACnJ,QAAQ,CAAEsW,SAAS,EAAE,CAC5D,GAAInN,QAAQ,CAAClJ,WAAW,EAAIkJ,QAAQ,CAAClJ,WAAW,CAACtE,MAAM,EAAI,EAAE,CAAE2a,SAAS,EAAE,CAC1E,GAAInN,QAAQ,CAACjJ,MAAM,EAAIiJ,QAAQ,CAACjJ,MAAM,CAACvE,MAAM,CAAG,CAAC,CAAE2a,SAAS,EAAE,CAC9D,MAAQ,CAAAA,SAAS,CAAG,CAAC,CAAI,GAAG,CAC9B,CAAC,EAAE,CAAC,KACN,CAAE,CACH,CAAC,CACC,CAAC,EACH,CAAC,cAEN5d,KAAA,QAAK4N,SAAS,CAAC,WAAW,CAAAC,QAAA,EACvB,CAAArM,WAAW,SAAXA,WAAW,iBAAXA,WAAW,CAAEuB,IAAI,IAAK,UAAU,eAC/B/C,KAAA,QAAK4N,SAAS,CAAC,6HAA6H,CAAAC,QAAA,eAC1I/N,IAAA,CAAC7B,WAAW,EAAC2P,SAAS,CAAC,8BAA8B,CAAE,CAAC,cACxD5N,KAAA,QAAK4N,SAAS,CAAC,WAAW,CAAAC,QAAA,eACxB/N,IAAA,MAAA+N,QAAA,CAAG,+KAGH,CAAG,CAAC,cACJ/N,IAAA,WACEiD,IAAI,CAAC,QAAQ,CACbiL,OAAO,CAAE0P,wBAAyB,CAClC9P,SAAS,CAAC,qFAAqF,CAAAC,QAAA,CAChG,kBAED,CAAQ,CAAC,EACN,CAAC,EACH,CACN,cAED7N,KAAA,QAAA6N,QAAA,eACE7N,KAAA,UAAO4N,SAAS,CAAC,gDAAgD,CAAAC,QAAA,EAAC,cAEhE,CAAC4C,QAAQ,CAAChK,KAAK,EAAIgK,QAAQ,CAAChK,KAAK,CAAC2B,IAAI,CAAC,CAAC,CAACnF,MAAM,EAAI,CAAC,EAAI,CAAC0N,MAAM,CAAClK,KAAK,eACnE3G,IAAA,SAAM8N,SAAS,CAAC,6BAA6B,CAAAC,QAAA,CAAC,mBAAY,CAAM,CACjE,EACI,CAAC,cACR7N,KAAA,QAAK4N,SAAS,CAAC,UAAU,CAAAC,QAAA,eACvB/N,IAAA,UACEiD,IAAI,CAAC,MAAM,CACXuP,QAAQ,MACRtB,KAAK,CAAEP,QAAQ,CAAChK,KAAM,CACtB4L,QAAQ,CAAGhM,CAAC,EAAK,CACfqK,WAAW,CAAApG,aAAA,CAAAA,aAAA,IAAMmG,QAAQ,MAAEhK,KAAK,CAAEJ,CAAC,CAACiL,MAAM,CAACN,KAAK,EAAE,CAAC,CACnDD,aAAa,CAAC,OAAO,CAAE1K,CAAC,CAACiL,MAAM,CAACN,KAAK,CAAC,CACxC,CAAE,CACFuB,MAAM,CAAGlM,CAAC,EAAK0K,aAAa,CAAC,OAAO,CAAE1K,CAAC,CAACiL,MAAM,CAACN,KAAK,CAAE,CACtDwB,WAAW,CAAC,2CAA2C,CACvD5E,SAAS,oCAAAzD,MAAA,CACPwG,MAAM,CAAClK,KAAK,CAAG,0BAA0B,CACzCgK,QAAQ,CAAChK,KAAK,EAAIgK,QAAQ,CAAChK,KAAK,CAAC2B,IAAI,CAAC,CAAC,CAACnF,MAAM,EAAI,CAAC,CAAG,+BAA+B,CACrF,iBAAiB,4CAAAkH,MAAA,CAEjBwG,MAAM,CAAClK,KAAK,CAAG,oBAAoB,CAAG,qBAAqB,iEACG,CACjE,CAAC,CACDgK,QAAQ,CAAChK,KAAK,EAAIgK,QAAQ,CAAChK,KAAK,CAAC2B,IAAI,CAAC,CAAC,CAACnF,MAAM,EAAI,CAAC,EAAI,CAAC0N,MAAM,CAAClK,KAAK,eACnE3G,IAAA,CAAC7B,WAAW,EAAC2P,SAAS,CAAC,iEAAiE,CAAE,CAC3F,EACE,CAAC,CACL+C,MAAM,CAAClK,KAAK,eAAIzG,KAAA,MAAG4N,SAAS,CAAC,mDAAmD,CAAAC,QAAA,eAAC/N,IAAA,SAAA+N,QAAA,CAAM,QAAC,CAAM,CAAC,IAAC,CAAC8C,MAAM,CAAClK,KAAK,EAAI,CAAC,EAChH,CAAC,cAGNzG,KAAA,QAAA6N,QAAA,eACE7N,KAAA,UAAO4N,SAAS,CAAC,gDAAgD,CAAAC,QAAA,EAAC,qBAEhE,CAAC4C,QAAQ,CAACpJ,KAAK,EAAI8F,UAAU,CAACsD,QAAQ,CAACpJ,KAAK,CAAC,EAAI,GAAG,EAAI8F,UAAU,CAACsD,QAAQ,CAACpJ,KAAK,CAAC,EAAI,KAAK,EAAI,CAACsJ,MAAM,CAACtJ,KAAK,eAC1GvH,IAAA,SAAM8N,SAAS,CAAC,6BAA6B,CAAAC,QAAA,CAAC,oBAAa,CAAM,CAClE,EACI,CAAC,cACR7N,KAAA,QAAK4N,SAAS,CAAC,UAAU,CAAAC,QAAA,eACvB/N,IAAA,SAAM8N,SAAS,CAAC,oEAAoE,CAAAC,QAAA,CAAC,GAAC,CAAM,CAAC,cAC7F/N,IAAA,UACEiD,IAAI,CAAC,QAAQ,CACbuP,QAAQ,MACRtB,KAAK,CAAEP,QAAQ,CAACpJ,KAAM,CACtBgL,QAAQ,CAAGhM,CAAC,EAAK,CACfqK,WAAW,CAAApG,aAAA,CAAAA,aAAA,IAAMmG,QAAQ,MAAEpJ,KAAK,CAAEhB,CAAC,CAACiL,MAAM,CAACN,KAAK,EAAE,CAAC,CACnDD,aAAa,CAAC,OAAO,CAAE1K,CAAC,CAACiL,MAAM,CAACN,KAAK,CAAC,CACxC,CAAE,CACFuB,MAAM,CAAGlM,CAAC,EAAK0K,aAAa,CAAC,OAAO,CAAE1K,CAAC,CAACiL,MAAM,CAACN,KAAK,CAAE,CACtDwB,WAAW,CAAC,MAAM,CAClBgL,GAAG,CAAC,KAAK,CACTQ,GAAG,CAAC,OAAO,CACXpQ,SAAS,oCAAAzD,MAAA,CACPwG,MAAM,CAACtJ,KAAK,CAAG,0BAA0B,CACzCoJ,QAAQ,CAACpJ,KAAK,EAAI8F,UAAU,CAACsD,QAAQ,CAACpJ,KAAK,CAAC,EAAI,GAAG,EAAI8F,UAAU,CAACsD,QAAQ,CAACpJ,KAAK,CAAC,EAAI,KAAK,CAAG,+BAA+B,CAC5H,iBAAiB,4CAAA8C,MAAA,CAEjBwG,MAAM,CAACtJ,KAAK,CAAG,oBAAoB,CAAG,qBAAqB,iEACG,CACjE,CAAC,CACDoJ,QAAQ,CAACpJ,KAAK,EAAI8F,UAAU,CAACsD,QAAQ,CAACpJ,KAAK,CAAC,EAAI,GAAG,EAAI8F,UAAU,CAACsD,QAAQ,CAACpJ,KAAK,CAAC,EAAI,KAAK,EAAI,CAACsJ,MAAM,CAACtJ,KAAK,eAC1GvH,IAAA,CAAC7B,WAAW,EAAC2P,SAAS,CAAC,iEAAiE,CAAE,CAC3F,EACE,CAAC,CACL+C,MAAM,CAACtJ,KAAK,eAAIrH,KAAA,MAAG4N,SAAS,CAAC,mDAAmD,CAAAC,QAAA,eAAC/N,IAAA,SAAA+N,QAAA,CAAM,QAAC,CAAM,CAAC,IAAC,CAAC8C,MAAM,CAACtJ,KAAK,EAAI,CAAC,CAClH,CAACsJ,MAAM,CAACtJ,KAAK,EAAIoJ,QAAQ,CAACpJ,KAAK,eAC9BvH,IAAA,MAAG8N,SAAS,CAAC,4BAA4B,CAAAC,QAAA,CAAC,2CAAyC,CAAG,CACvF,EACE,CAAC,cAGN7N,KAAA,QAAA6N,QAAA,eACE/N,IAAA,UAAO8N,SAAS,CAAC,gDAAgD,CAAAC,QAAA,CAAC,8BAA4B,CAAO,CAAC,cACtG/N,IAAA,MAAG8N,SAAS,CAAC,4BAA4B,CAAAC,QAAA,CAAC,oDAAkD,CAAG,CAAC,cAChG/N,IAAA,aACEwS,QAAQ,MACR2L,IAAI,CAAC,GAAG,CACRjN,KAAK,CAAEwG,gBAAiB,CACxBnF,QAAQ,CAAGhM,CAAC,EAAK4W,uBAAuB,CAAC5W,CAAC,CAACiL,MAAM,CAACN,KAAK,CAAE,CACzDkN,OAAO,CAAEA,CAAA,GAAMvG,uBAAuB,CAAC,IAAI,CAAE,CAC7CpF,MAAM,CAAGlM,CAAC,EAAK,CAAEsR,uBAAuB,CAAC,KAAK,CAAC,CAAEsF,uBAAuB,CAAC5W,CAAC,CAACiL,MAAM,CAACN,KAAK,CAAC,CAAE,CAAE,CAC5FwB,WAAW,CAAC,oDAAoD,CAChE5E,SAAS,8BAAAzD,MAAA,CAA+BwG,MAAM,CAACrJ,QAAQ,CAAG,gBAAgB,CAAG,iBAAiB,qDAAA6C,MAAA,CAAmDwG,MAAM,CAACrJ,QAAQ,CAAG,oBAAoB,CAAG,qBAAqB,6DAA4D,CAC5Q,CAAC,CACDqJ,MAAM,CAACrJ,QAAQ,eAAIxH,IAAA,MAAG8N,SAAS,CAAC,2BAA2B,CAAC,YAAU,WAAW,CAAAC,QAAA,CAAE8C,MAAM,CAACrJ,QAAQ,CAAI,CAAC,CACvG,CAACqJ,MAAM,CAACrJ,QAAQ,eACfxH,IAAA,MAAG8N,SAAS,CAAC,4BAA4B,CAAAC,QAAA,CAAC,oHAE1C,CAAG,CACJ,EACE,CAAC,cAGN7N,KAAA,QAAK4N,SAAS,CAAC,mFAAmF,CAAAC,QAAA,eAChG7N,KAAA,QAAK4N,SAAS,CAAC,6BAA6B,CAAAC,QAAA,eAC1C/N,IAAA,CAACnC,MAAM,EAACiQ,SAAS,CAAC,0CAA0C,CAAE,CAAC,cAC/D5N,KAAA,QAAK4N,SAAS,CAAC,QAAQ,CAAAC,QAAA,eACrB/N,IAAA,OAAI8N,SAAS,CAAC,0CAA0C,CAAAC,QAAA,CAAC,sBAAoB,CAAI,CAAC,cAClF7N,KAAA,MAAG4N,SAAS,CAAC,uBAAuB,CAAAC,QAAA,EAAC,iDACY,cAAA/N,IAAA,WAAA+N,QAAA,CAAQ,iBAAe,CAAQ,CAAC,2EACjF,EAAG,CAAC,EACD,CAAC,EACH,CAAC,cAEN7N,KAAA,QAAK4N,SAAS,CAAC,kCAAkC,CAAAC,QAAA,eAC/C7N,KAAA,WACE+C,IAAI,CAAC,QAAQ,CACbiL,OAAO,CAAEqO,cAAe,CACxBzO,SAAS,CAAC,gLAAgL,CAAAC,QAAA,eAE1L/N,IAAA,CAACnC,MAAM,EAACiQ,SAAS,CAAC,SAAS,CAAE,CAAC,kBAEhC,EAAQ,CAAC,cAET5N,KAAA,QAAK4N,SAAS,CAAC,8BAA8B,CAAAC,QAAA,EAC1CmJ,eAAe,eACdhX,KAAA,SAAM4N,SAAS,IAAAzD,MAAA,CAAK6M,eAAe,CAACsB,UAAU,CAAC,GAAG,CAAC,CAAG,8BAA8B,CAAGtB,eAAe,CAACsB,UAAU,CAAC,IAAI,CAAC,CAAG,gBAAgB,CAAG,eAAe,4BAA2B,CAAAzK,QAAA,EACpLmJ,eAAe,CAACsB,UAAU,CAAC,GAAG,CAAC,eAAIxY,IAAA,CAAC7B,WAAW,EAAC2P,SAAS,CAAC,SAAS,CAAE,CAAC,CACtEoJ,eAAe,CACfM,iBAAiB,GAAK,QAAQ,eAC7BxX,IAAA,SAAM8N,SAAS,CAAC,6FAA6F,CAAAC,QAAA,CAAC,QAAM,CAAM,CAC3H,CACAyJ,iBAAiB,GAAK,QAAQ,eAC7BxX,IAAA,SAAM8N,SAAS,CAAC,yFAAyF,CAAAC,QAAA,CAAC,QAAM,CAAM,CACvH,CACAyJ,iBAAiB,GAAK,SAAS,eAC9BxX,IAAA,SAAM8N,SAAS,CAAC,6FAA6F,CAAAC,QAAA,CAAC,SAAO,CAAM,CAC5H,CACAyJ,iBAAiB,GAAK,OAAO,eAC5BxX,IAAA,SAAM8N,SAAS,CAAC,2FAA2F,CAAAC,QAAA,CAAC,OAAK,CAAM,CACxH,CACAyJ,iBAAiB,GAAK,QAAQ,eAC7BxX,IAAA,SAAM8N,SAAS,CAAC,6FAA6F,CAAAC,QAAA,CAAC,UAAQ,CAAM,CAC7H,EACG,CACP,CACA4C,QAAQ,CAACpE,QAAQ,EAAIoE,QAAQ,CAACnE,SAAS,EAAI,CAAC0K,eAAe,eAC1DhX,KAAA,SAAM4N,SAAS,CAAC,sDAAsD,CAAAC,QAAA,eACpE/N,IAAA,CAAC7B,WAAW,EAAC2P,SAAS,CAAC,SAAS,CAAE,CAAC,sBAChB,CAAC6C,QAAQ,CAACpE,QAAQ,CAAC8R,OAAO,CAAC,CAAC,CAAC,CAAC,IAAE,CAAC1N,QAAQ,CAACnE,SAAS,CAAC6R,OAAO,CAAC,CAAC,CAAC,CAChF7G,iBAAiB,GAAK,QAAQ,eAC7BxX,IAAA,SAAM8N,SAAS,CAAC,6FAA6F,CAAAC,QAAA,CAAC,QAAM,CAAM,CAC3H,CACAyJ,iBAAiB,GAAK,SAAS,eAC9BxX,IAAA,SAAM8N,SAAS,CAAC,6FAA6F,CAAAC,QAAA,CAAC,SAAO,CAAM,CAC5H,EACG,CACP,CACAiP,aAAa,eACZ9c,KAAA,QAAK4N,SAAS,CAAC,2EAA2E,CAAAC,QAAA,eACxF/N,IAAA,SAAM8N,SAAS,CAAC,wCAAwC,CAAAC,QAAA,CAAC,sBAAoB,CAAM,CAAC,cACpF7N,KAAA,MACEoe,IAAI,CAAEtB,aAAc,CACpBxL,MAAM,CAAC,QAAQ,CACf+M,GAAG,CAAC,qBAAqB,CACzBzQ,SAAS,CAAC,0FAA0F,CAAAC,QAAA,eAEpG/N,IAAA,CAACnC,MAAM,EAACiQ,SAAS,CAAC,SAAS,CAAE,CAAC,uBAChC,EAAG,CAAC,cACJ9N,IAAA,SAAM8N,SAAS,CAAC,sCAAsC,CAAAC,QAAA,CAAC,sDAAoD,CAAM,CAAC,EAC/G,CACN,EACE,CAAC,EACH,CAAC,cACN7N,KAAA,QAAK4N,SAAS,CAAC,yFAAyF,CAAAC,QAAA,eACtG/N,IAAA,MAAG8N,SAAS,CAAC,kCAAkC,CAAAC,QAAA,CAAC,0BAAwB,CAAG,CAAC,cAC5E/N,IAAA,MAAA+N,QAAA,CAAG,yGAAuG,CAAG,CAAC,EAC3G,CAAC,EACH,CAAC,cAGN7N,KAAA,QAAK4N,SAAS,CAAC,uCAAuC,CAAAC,QAAA,eACpD7N,KAAA,QAAA6N,QAAA,eACE/N,IAAA,UAAO8N,SAAS,CAAC,gDAAgD,CAAAC,QAAA,CAAC,QAAM,CAAO,CAAC,cAChF7N,KAAA,WACEgR,KAAK,CAAEP,QAAQ,CAAChJ,MAAO,CACvB4K,QAAQ,CAAGhM,CAAC,EAAKqK,WAAW,CAAApG,aAAA,CAAAA,aAAA,IAAMmG,QAAQ,MAAEhJ,MAAM,CAAEpB,CAAC,CAACiL,MAAM,CAACN,KAAK,EAAE,CAAE,CACtEpD,SAAS,CAAC,kJAAkJ,CAAAC,QAAA,eAE5J/N,IAAA,WAAQkR,KAAK,CAAC,WAAW,CAAAnD,QAAA,CAAC,WAAS,CAAQ,CAAC,cAC5C/N,IAAA,WAAQkR,KAAK,CAAC,QAAQ,CAAAnD,QAAA,CAAC,QAAM,CAAQ,CAAC,EAChC,CAAC,EACN,CAAC,cAEN7N,KAAA,QAAA6N,QAAA,eACE/N,IAAA,UAAO8N,SAAS,CAAC,gDAAgD,CAAAC,QAAA,CAAC,gBAAc,CAAO,CAAC,cACxF/N,IAAA,UACEiD,IAAI,CAAC,MAAM,CACXiO,KAAK,CAAEP,QAAQ,CAAC/I,aAAc,CAC9B2K,QAAQ,CAAGhM,CAAC,EAAKqK,WAAW,CAAApG,aAAA,CAAAA,aAAA,IAAMmG,QAAQ,MAAE/I,aAAa,CAAErB,CAAC,CAACiL,MAAM,CAACN,KAAK,EAAE,CAAE,CAC7EpD,SAAS,CAAC,kJAAkJ,CAC7J,CAAC,EACC,CAAC,EACH,CAAC,cAGN5N,KAAA,QAAA6N,QAAA,eACE/N,IAAA,UAAO8N,SAAS,CAAC,gDAAgD,CAAAC,QAAA,CAAC,gBAAc,CAAO,CAAC,cACxF7N,KAAA,WACEgR,KAAK,CAAEP,QAAQ,CAAClE,aAAc,CAC9B8F,QAAQ,CAAGhM,CAAC,EAAKqK,WAAW,CAAApG,aAAA,CAAAA,aAAA,IAAMmG,QAAQ,MAAElE,aAAa,CAAElG,CAAC,CAACiL,MAAM,CAACN,KAAK,EAAE,CAAE,CAC7EpD,SAAS,CAAC,kJAAkJ,CAAAC,QAAA,eAE5J/N,IAAA,WAAQkR,KAAK,CAAC,eAAe,CAAAnD,QAAA,CAAC,eAAa,CAAQ,CAAC,cACpD/N,IAAA,WAAQkR,KAAK,CAAC,WAAW,CAAAnD,QAAA,CAAC,WAAS,CAAQ,CAAC,cAC5C/N,IAAA,WAAQkR,KAAK,CAAC,WAAW,CAAAnD,QAAA,CAAC,WAAS,CAAQ,CAAC,EACtC,CAAC,EACN,CAAC,cAGN7N,KAAA,QAAK4N,SAAS,CAAC,uCAAuC,CAAAC,QAAA,eACpD7N,KAAA,QAAA6N,QAAA,eACE/N,IAAA,UAAO8N,SAAS,CAAC,gDAAgD,CAAAC,QAAA,CAAC,WAAS,CAAO,CAAC,cACnF7N,KAAA,WACEgR,KAAK,CAAEP,QAAQ,CAAC0F,QAAS,CACzB9D,QAAQ,CAAGhM,CAAC,EAAKqK,WAAW,CAAApG,aAAA,CAAAA,aAAA,IAAMmG,QAAQ,MAAE0F,QAAQ,CAAE9P,CAAC,CAACiL,MAAM,CAACN,KAAK,EAAE,CAAE,CACxEpD,SAAS,CAAC,kJAAkJ,CAAAC,QAAA,eAE5J/N,IAAA,WAAQkR,KAAK,CAAC,SAAS,CAAAnD,QAAA,CAAC,cAAY,CAAQ,CAAC,cAC7C/N,IAAA,WAAQkR,KAAK,CAAC,QAAQ,CAAAnD,QAAA,CAAC,aAAW,CAAQ,CAAC,EACrC,CAAC,EACN,CAAC,cAEN7N,KAAA,QAAA6N,QAAA,eACE/N,IAAA,UAAO8N,SAAS,CAAC,gDAAgD,CAAAC,QAAA,CAAC,yBAAuB,CAAO,CAAC,cACjG7N,KAAA,WACEgR,KAAK,CAAEP,QAAQ,CAAC2F,aAAc,CAC9B/D,QAAQ,CAAGhM,CAAC,EAAKqK,WAAW,CAAApG,aAAA,CAAAA,aAAA,IAAMmG,QAAQ,MAAE2F,aAAa,CAAE/P,CAAC,CAACiL,MAAM,CAACN,KAAK,EAAE,CAAE,CAC7EpD,SAAS,CAAC,kJAAkJ,CAAAC,QAAA,eAE5J/N,IAAA,WAAQkR,KAAK,CAAC,KAAK,CAAAnD,QAAA,CAAC,YAAU,CAAQ,CAAC,cACvC/N,IAAA,WAAQkR,KAAK,CAAC,KAAK,CAAAnD,QAAA,CAAC,YAAU,CAAQ,CAAC,cACvC/N,IAAA,WAAQkR,KAAK,CAAC,MAAM,CAAAnD,QAAA,CAAC,aAAW,CAAQ,CAAC,cACzC/N,IAAA,WAAQkR,KAAK,CAAC,KAAK,CAAAnD,QAAA,CAAC,YAAU,CAAQ,CAAC,EACjC,CAAC,EACN,CAAC,EACH,CAAC,cAGN7N,KAAA,QAAK4N,SAAS,CAAC,uCAAuC,CAAAC,QAAA,eACpD7N,KAAA,QAAK4N,SAAS,CAAC,yBAAyB,CAAAC,QAAA,eACtC/N,IAAA,UACEiD,IAAI,CAAC,UAAU,CACfmR,OAAO,CAAEzD,QAAQ,CAAC4F,WAAY,CAC9BhE,QAAQ,CAAGhM,CAAC,EAAKqK,WAAW,CAAApG,aAAA,CAAAA,aAAA,IAAMmG,QAAQ,MAAE4F,WAAW,CAAEhQ,CAAC,CAACiL,MAAM,CAAC4C,OAAO,EAAE,CAAE,CAC7E9M,EAAE,CAAC,aAAa,CAChBwG,SAAS,CAAC,mEAAmE,CAC9E,CAAC,cACF9N,IAAA,UAAOwe,OAAO,CAAC,aAAa,CAAC1Q,SAAS,CAAC,mCAAmC,CAAAC,QAAA,CAAC,2BAE3E,CAAO,CAAC,EACL,CAAC,cAEN7N,KAAA,QAAA6N,QAAA,eACE/N,IAAA,UAAO8N,SAAS,CAAC,gDAAgD,CAAAC,QAAA,CAAC,mBAAiB,CAAO,CAAC,cAC3F7N,KAAA,WACEgR,KAAK,CAAEP,QAAQ,CAAC6F,gBAAiB,CACjCjE,QAAQ,CAAGhM,CAAC,EAAKqK,WAAW,CAAApG,aAAA,CAAAA,aAAA,IAAMmG,QAAQ,MAAE6F,gBAAgB,CAAEjQ,CAAC,CAACiL,MAAM,CAACN,KAAK,EAAE,CAAE,CAChFpD,SAAS,CAAC,kJAAkJ,CAAAC,QAAA,eAE5J/N,IAAA,WAAQkR,KAAK,CAAC,KAAK,CAAAnD,QAAA,CAAC,KAAG,CAAQ,CAAC,cAChC/N,IAAA,WAAQkR,KAAK,CAAC,MAAM,CAAAnD,QAAA,CAAC,WAAS,CAAQ,CAAC,cACvC/N,IAAA,WAAQkR,KAAK,CAAC,QAAQ,CAAAnD,QAAA,CAAC,aAAW,CAAQ,CAAC,EACrC,CAAC,EACN,CAAC,EACH,CAAC,cAGN7N,KAAA,QAAK4N,SAAS,CAAC,yBAAyB,CAAAC,QAAA,eACtC/N,IAAA,UACEiD,IAAI,CAAC,UAAU,CACfmR,OAAO,CAAE,CAAC,CAACzD,QAAQ,CAACjE,OAAQ,CAC5B6F,QAAQ,CAAGhM,CAAC,EAAKqK,WAAW,CAAApG,aAAA,CAAAA,aAAA,IAAMmG,QAAQ,MAAEjE,OAAO,CAAEnG,CAAC,CAACiL,MAAM,CAAC4C,OAAO,EAAE,CAAE,CACzE9M,EAAE,CAAC,aAAa,CACjB,CAAC,cACFtH,IAAA,UAAOwe,OAAO,CAAC,aAAa,CAAC1Q,SAAS,CAAC,mCAAmC,CAAAC,QAAA,CAAC,gDAE3E,CAAO,CAAC,EACL,CAAC,cAGN7N,KAAA,QAAA6N,QAAA,eACE7N,KAAA,UAAO4N,SAAS,CAAC,gDAAgD,CAAAC,QAAA,EAAC,aAEhE,CAAC4C,QAAQ,CAAClJ,WAAW,eACnBvH,KAAA,SAAM4N,SAAS,iBAAAzD,MAAA,CAAkBsG,QAAQ,CAAClJ,WAAW,CAACtE,MAAM,CAAG,GAAG,CAAG,cAAc,CAAG,eAAe,CAAG,CAAA4K,QAAA,EAAC,GACtG,CAAC4C,QAAQ,CAAClJ,WAAW,CAACtE,MAAM,CAAC,kBAChC,EAAM,CACP,EACI,CAAC,cACRnD,IAAA,aACEkR,KAAK,CAAEP,QAAQ,CAAClJ,WAAY,CAC5B8K,QAAQ,CAAGhM,CAAC,EAAK,CACfqK,WAAW,CAAApG,aAAA,CAAAA,aAAA,IAAMmG,QAAQ,MAAElJ,WAAW,CAAElB,CAAC,CAACiL,MAAM,CAACN,KAAK,EAAE,CAAC,CACzDD,aAAa,CAAC,aAAa,CAAE1K,CAAC,CAACiL,MAAM,CAACN,KAAK,CAAC,CAC9C,CAAE,CACFuB,MAAM,CAAGlM,CAAC,EAAK0K,aAAa,CAAC,aAAa,CAAE1K,CAAC,CAACiL,MAAM,CAACN,KAAK,CAAE,CAC5DwB,WAAW,CAAC,+DAA+D,CAC3EyL,IAAI,CAAC,GAAG,CACRrQ,SAAS,8BAAAzD,MAAA,CAA+BwG,MAAM,CAACpJ,WAAW,CAAG,gBAAgB,CAAG,iBAAiB,qDAAA4C,MAAA,CAAmDwG,MAAM,CAACpJ,WAAW,CAAG,oBAAoB,CAAG,qBAAqB,6DAA4D,CAClR,CAAC,CACDoJ,MAAM,CAACpJ,WAAW,eAAIzH,IAAA,MAAG8N,SAAS,CAAC,2BAA2B,CAAAC,QAAA,CAAE8C,MAAM,CAACpJ,WAAW,CAAI,CAAC,EACrF,CAAC,cAGNvH,KAAA,QAAA6N,QAAA,eACE/N,IAAA,UAAO8N,SAAS,CAAC,gDAAgD,CAAAC,QAAA,CAAC,WAAS,CAAO,CAAC,cACnF/N,IAAA,QAAK8N,SAAS,CAAC,uCAAuC,CAAAC,QAAA,CACnD+N,kBAAkB,CAACjG,GAAG,CAACpI,OAAO,eAC7BzN,IAAA,WAEEiD,IAAI,CAAC,QAAQ,CACbiL,OAAO,CAAEA,CAAA,GAAM0O,aAAa,CAACnP,OAAO,CAAE,CACtCK,SAAS,8DAAAzD,MAAA,CACPsG,QAAQ,CAAC9I,SAAS,CAACsC,QAAQ,CAACsD,OAAO,CAAC,CAChC,iEAAiE,CACjE,2FAA2F,CAC9F,CAAAM,QAAA,CAEFN,OAAO,EATHA,OAUC,CACT,CAAC,CACC,CAAC,EACH,CAAC,cAGNvN,KAAA,QAAA6N,QAAA,eACE/N,IAAA,UAAO8N,SAAS,CAAC,gDAAgD,CAAAC,QAAA,CAAC,gBAAc,CAAO,CAAC,cACxF/N,IAAA,QACE8N,SAAS,CAAC,sMAAsM,CAChNI,OAAO,CAAEA,CAAA,GAAMmJ,kBAAkB,CAAC,IAAI,CAAE,CAAAtJ,QAAA,cAExC7N,KAAA,QAAK4N,SAAS,CAAC,aAAa,CAAAC,QAAA,eAC1B/N,IAAA,QAAK8N,SAAS,CAAC,yKAAyK,CAAAC,QAAA,cACtL/N,IAAA,SAAM8N,SAAS,CAAC,UAAU,CAAAC,QAAA,CAAC,cAAE,CAAM,CAAC,CACjC,CAAC,cACN/N,IAAA,MAAG8N,SAAS,CAAC,kCAAkC,CAAAC,QAAA,CAC5C4C,QAAQ,CAACjJ,MAAM,CAACvE,MAAM,GAAK,CAAC,CAAG,YAAY,IAAAkH,MAAA,CAAMsG,QAAQ,CAACjJ,MAAM,CAACvE,MAAM,mBAAiB,CACxF,CAAC,cACJnD,IAAA,MAAG8N,SAAS,CAAC,uBAAuB,CAAAC,QAAA,CAAC,gDAErC,CAAG,CAAC,CACH4C,QAAQ,CAACjJ,MAAM,CAACvE,MAAM,GAAK,CAAC,eAC3BnD,IAAA,MAAG8N,SAAS,CAAC,wCAAwC,CAAAC,QAAA,CAAC,8CAEtD,CAAG,CACJ,EACE,CAAC,CACH,CAAC,CACL4C,QAAQ,CAACjJ,MAAM,CAACvE,MAAM,CAAG,CAAC,eACzBnD,IAAA,QAAK8N,SAAS,CAAC,4CAA4C,CAAAC,QAAA,CACxD4C,QAAQ,CAACjJ,MAAM,CAACmO,GAAG,CAAC,CAACrH,KAAK,CAAEiQ,KAAK,gBAChCve,KAAA,QAAiB4N,SAAS,CAAC,gBAAgB,CAAAC,QAAA,EACxC0Q,KAAK,GAAK,CAAC,eACVze,IAAA,QAAK8N,SAAS,CAAC,+HAA+H,CAAAC,QAAA,CAAC,OAE/I,CAAK,CACN,cACD/N,IAAA,QACEoS,GAAG,CAAE5D,KAAM,CACX6D,GAAG,YAAAhI,MAAA,CAAaoU,KAAK,CAAG,CAAC,CAAG,CAC5B3Q,SAAS,CAAC,wEAAwE,CACnF,CAAC,GAVM2Q,KAWL,CACN,CAAC,CACC,CACN,cACDze,IAAA,WACEiD,IAAI,CAAC,QAAQ,CACbiL,OAAO,CAAEA,CAAA,GAAMmJ,kBAAkB,CAAC,IAAI,CAAE,CACxCvJ,SAAS,CAAC,4DAA4D,CAAAC,QAAA,CAErE4C,QAAQ,CAACjJ,MAAM,CAACvE,MAAM,CAAG,CAAC,CAAG,gBAAgB,CAAG,EAAE,CAC7C,CAAC,EACN,CAAC,CAELiU,eAAe,eACdpX,IAAA,CAACd,WAAW,EACVwI,MAAM,CAAEiJ,QAAQ,CAACjJ,MAAO,CACxBgX,cAAc,CAAGC,SAAS,EAAK/N,WAAW,CAAApG,aAAA,CAAAA,aAAA,IAAMmG,QAAQ,MAAEjJ,MAAM,CAAEiX,SAAS,EAAE,CAAE,CAC/E1Q,OAAO,CAAEA,CAAA,GAAMoJ,kBAAkB,CAAC,KAAK,CAAE,CACzCuH,SAAS,CAAE,CAAE,CACd,CACF,cAGD1e,KAAA,QAAK4N,SAAS,CAAC,+BAA+B,CAAAC,QAAA,eAC5C/N,IAAA,WACEkO,OAAO,CAAE8D,YAAa,CACtBwC,QAAQ,CAAEqI,YAAY,EAAI3K,MAAM,CAACC,IAAI,CAACtB,MAAM,CAAC,CAAC1N,MAAM,CAAG,CAAE,CACzD2K,SAAS,6EAAAzD,MAAA,CACPwS,YAAY,EAAI3K,MAAM,CAACC,IAAI,CAACtB,MAAM,CAAC,CAAC1N,MAAM,CAAG,CAAC,CAC1C,gCAAgC,CAChC,sIAAsI,CACzI,CAAA4K,QAAA,CAEF8O,YAAY,cACX3c,KAAA,CAAAE,SAAA,EAAA2N,QAAA,eACE/N,IAAA,SAAM8N,SAAS,CAAC,WAAW,CAAAC,QAAA,CAAC,WAAS,CAAM,CAAC,cAC5C/N,IAAA,QAAK8N,SAAS,CAAC,mDAAmD,CAAAC,QAAA,cAChE/N,IAAA,QAAK8N,SAAS,CAAC,8EAA8E,CAAE,CAAC,CAC7F,CAAC,EACN,CAAC,CAEH,WACD,CACK,CAAC,CACRoE,MAAM,CAACC,IAAI,CAACtB,MAAM,CAAC,CAAC1N,MAAM,CAAG,CAAC,eAC7BnD,IAAA,MAAG8N,SAAS,CAAC,uCAAuC,CAAAC,QAAA,CAAC,+CAA6C,CAAG,CACtG,EACE,CAAC,EACH,CAAC,EACH,CAAC,CACH,CAAC,CACH,CAAC,CAEV,CAEA;AAEA,QAAS,CAAA2B,cAAcA,CAAAmP,KAAA,CAAyB,IAAxB,CAAEje,QAAQ,CAAEgP,QAAS,CAAC,CAAAiP,KAAA,CAC5C,mBACE7e,IAAA,QAAK8N,SAAS,CAAC,mEAAmE,CAAAC,QAAA,cAChF7N,KAAA,QAAK4N,SAAS,CAAC,wBAAwB,CAAAC,QAAA,EAEpCnN,QAAQ,CAACuC,MAAM,CAAG,CAAC,eAClBnD,IAAA,QAAK8N,SAAS,CAAC,oGAAoG,CAAAC,QAAA,cACjH7N,KAAA,QAAK4N,SAAS,CAAC,wBAAwB,CAAAC,QAAA,eACrC/N,IAAA,QAAK8N,SAAS,CAAC,kFAAkF,CAAAC,QAAA,cAC/F/N,IAAA,CAACzB,aAAa,EAACuP,SAAS,CAAC,wBAAwB,CAAE,CAAC,CACjD,CAAC,cACN5N,KAAA,QAAA6N,QAAA,eACE/N,IAAA,OAAI8N,SAAS,CAAC,mCAAmC,CAAAC,QAAA,CAAC,iBAAe,CAAI,CAAC,cACtE7N,KAAA,MAAG4N,SAAS,CAAC,wCAAwC,CAAAC,QAAA,EAAC,cACxC,cAAA/N,IAAA,SAAM8N,SAAS,CAAC,aAAa,CAAAC,QAAA,CAAC,qBAAmB,CAAM,CAAC,4GAEtE,EAAG,CAAC,EACD,CAAC,EACH,CAAC,CACH,CACN,cAED/N,IAAA,QAAK8N,SAAS,CAAC,MAAM,CAAAC,QAAA,cACnB7N,KAAA,QAAK4N,SAAS,CAAC,8BAA8B,CAAAC,QAAA,eAC3C/N,IAAA,QAAK8N,SAAS,CAAC,8GAA8G,CAAAC,QAAA,cAC3H/N,IAAA,CAACtC,IAAI,EAACoQ,SAAS,CAAC,uBAAuB,CAAE,CAAC,CACvC,CAAC,cACN5N,KAAA,QAAA6N,QAAA,eACE/N,IAAA,OAAI8N,SAAS,CAAC,uCAAuC,CAAAC,QAAA,CAAC,aAAW,CAAI,CAAC,cACtE/N,IAAA,MAAG8N,SAAS,CAAC,eAAe,CAAAC,QAAA,CACzBnN,QAAQ,CAACuC,MAAM,GAAK,CAAC,CAClB,kCAAkC,IAAAkH,MAAA,CAC/BzJ,QAAQ,CAACuC,MAAM,aAAAkH,MAAA,CAAWzJ,QAAQ,CAACuC,MAAM,GAAK,CAAC,CAAG,SAAS,CAAG,UAAU,CAAE,CAChF,CAAC,EACD,CAAC,EACH,CAAC,CACH,CAAC,CAELvC,QAAQ,CAACuC,MAAM,GAAK,CAAC,cACpBjD,KAAA,QAAK4N,SAAS,CAAC,wEAAwE,CAAAC,QAAA,eACrF/N,IAAA,QAAK8N,SAAS,CAAC,gHAAgH,CAAAC,QAAA,cAC7H/N,IAAA,CAACtC,IAAI,EAACoQ,SAAS,CAAC,yBAAyB,CAAE,CAAC,CACzC,CAAC,cACN9N,IAAA,OAAI8N,SAAS,CAAC,sCAAsC,CAAAC,QAAA,CAAC,iBAAe,CAAI,CAAC,cACzE/N,IAAA,MAAG8N,SAAS,CAAC,6CAA6C,CAAAC,QAAA,CAAC,wEAE3D,CAAG,CAAC,cACJ7N,KAAA,WACEgO,OAAO,CAAEA,CAAA,GAAMpB,MAAM,CAACtF,QAAQ,CAACsX,IAAI,CAAG,MAAO,CAC7ChR,SAAS,CAAC,wMAAwM,CAAAC,QAAA,eAElN/N,IAAA,CAACrC,UAAU,EAACmQ,SAAS,CAAC,SAAS,CAAE,CAAC,uBAEpC,EAAQ,CAAC,EACN,CAAC,cAEN9N,IAAA,QAAK8N,SAAS,CAAC,sDAAsD,CAAAC,QAAA,CAClEnN,QAAQ,CAACiV,GAAG,CAAC1I,OAAO,OAAA4R,cAAA,oBACnB7e,KAAA,QAAsB4N,SAAS,CAAC,yGAAyG,CAAAC,QAAA,EACtIZ,OAAO,CAACzF,MAAM,EAAIyF,OAAO,CAACzF,MAAM,CAACvE,MAAM,CAAG,CAAC,eAC1CjD,KAAA,QAAK4N,SAAS,CAAC,UAAU,CAAAC,QAAA,eACvB/N,IAAA,QAAKoS,GAAG,CAAEjF,OAAO,CAACzF,MAAM,CAAC,CAAC,CAAE,CAAC2K,GAAG,CAAC,MAAM,CAACvE,SAAS,CAAC,0BAA0B,CAAE,CAAC,CAC9EX,OAAO,CAACzF,MAAM,CAACvE,MAAM,CAAG,CAAC,eACxBjD,KAAA,QAAK4N,SAAS,CAAC,6GAA6G,CAAAC,QAAA,EACzHZ,OAAO,CAACzF,MAAM,CAACvE,MAAM,CAAC,SACzB,EAAK,CACN,cACDnD,IAAA,QAAK8N,SAAS,yEAAAzD,MAAA,CACZ8C,OAAO,CAACxF,MAAM,GAAK,WAAW,CAC1B,2BAA2B,CAC3B,wBAAwB,CAC3B,CAAAoG,QAAA,CACAZ,OAAO,CAACxF,MAAM,GAAK,WAAW,CAAG,QAAQ,CAAG,QAAQ,CAClD,CAAC,EACH,CACN,cACDzH,KAAA,QAAK4N,SAAS,CAAC,KAAK,CAAAC,QAAA,eAClB/N,IAAA,OAAI8N,SAAS,CAAC,mDAAmD,CAAAC,QAAA,CAAEZ,OAAO,CAACxG,KAAK,CAAK,CAAC,cACtFzG,KAAA,QAAK4N,SAAS,CAAC,sCAAsC,CAAAC,QAAA,EAAC,GAAC,EAAAgR,cAAA,CAAC5R,OAAO,CAAC5F,KAAK,UAAAwX,cAAA,iBAAbA,cAAA,CAAeC,cAAc,CAAC,CAAC,CAAC,QAAM,EAAK,CAAC,cACpG9e,KAAA,QAAK4N,SAAS,CAAC,8CAA8C,CAAAC,QAAA,eAC3D/N,IAAA,CAACnC,MAAM,EAACiQ,SAAS,CAAC,8BAA8B,CAAE,CAAC,cACnD9N,IAAA,SAAM8N,SAAS,CAAC,cAAc,CAAAC,QAAA,CAAEZ,OAAO,CAAC3F,QAAQ,CAAO,CAAC,EACrD,CAAC,cACNxH,IAAA,QAAK8N,SAAS,CAAC,YAAY,CAAAC,QAAA,cACzB/N,IAAA,WACEkO,OAAO,CAAEA,CAAA,GAAM0B,QAAQ,CAACzC,OAAO,CAAC7F,EAAE,CAAE,CACpCwG,SAAS,CAAC,wGAAwG,CAAAC,QAAA,CACnH,QAED,CAAQ,CAAC,CACN,CAAC,EACH,CAAC,GAjCEZ,OAAO,CAAC7F,EAkCb,CAAC,EACP,CAAC,CACC,CACN,EACE,CAAC,CACH,CAAC,CAEV,CAGA;AACA;AAEA;AAEA,QAAS,CAAA2I,SAASA,CAAAgP,KAAA,CAAgE,IAA/D,CAAE/O,WAAW,CAAG,QAAQ,CAAEjC,OAAO,CAAEkC,SAAS,CAAE9M,aAAc,CAAC,CAAA4b,KAAA,CAC9E,KAAM,CAACC,IAAI,CAAEC,OAAO,CAAC,CAAGhjB,QAAQ,CAAC,QAAQ,CAAC,CAAE;AAC5C,KAAM,CAACyY,IAAI,CAAEC,OAAO,CAAC,CAAG1Y,QAAQ,CAAC,CAC/BoS,IAAI,CAAE,EAAE,CACR5K,KAAK,CAAE,EAAE,CACTJ,KAAK,CAAE,EAAE,CACTC,QAAQ,CAAE,EAAE,CACZ4b,eAAe,CAAE,EAAE,CACnBC,GAAG,CAAE,EAAE,CACPpc,IAAI,CAAEiN,WACR,CAAC,CAAC,CACF,KAAM,CAACW,MAAM,CAAEC,SAAS,CAAC,CAAG3U,QAAQ,CAAC,CAAC,CAAC,CAAC,CACxC,KAAM,CAAC0gB,YAAY,CAAEC,eAAe,CAAC,CAAG3gB,QAAQ,CAAC,KAAK,CAAC,CACvD,KAAM,CAACmjB,SAAS,CAAEC,YAAY,CAAC,CAAGpjB,QAAQ,CAAC,EAAE,CAAC,CAC9C,KAAM,CAACqjB,SAAS,CAAEC,YAAY,CAAC,CAAGtjB,QAAQ,CAAC,KAAK,CAAC,CACjD,KAAM,CAACujB,OAAO,CAAEC,UAAU,CAAC,CAAGxjB,QAAQ,CAAC,KAAK,CAAC,CAC7C,KAAM,CAACyjB,cAAc,CAAEC,iBAAiB,CAAC,CAAG1jB,QAAQ,CAAC,EAAE,CAAC,CAExD,KAAM,CAAA2jB,YAAY,CAAGA,CAAA,GAAM,CACzB,KAAM,CAAA1O,SAAS,CAAG,CAAC,CAAC,CAEpB,GAAI8N,IAAI,GAAK,OAAO,CAAE,CACpB,GAAI,CAACtK,IAAI,CAACjR,KAAK,EAAIiR,IAAI,CAACjR,KAAK,CAAC2E,IAAI,CAAC,CAAC,CAACnF,MAAM,CAAG,CAAC,CAAE,CAC/CiO,SAAS,CAACzN,KAAK,CAAG,mCAAmC,CACvD,CACF,CAAC,IAAM,IAAIub,IAAI,GAAK,cAAc,CAAE,CAClC,GAAI,CAACtK,IAAI,CAACyK,GAAG,EAAIzK,IAAI,CAACyK,GAAG,CAAClc,MAAM,GAAK,CAAC,CAAE,CACtCiO,SAAS,CAACiO,GAAG,CAAG,+BAA+B,CACjD,CACF,CAAC,IAAM,CACL,GAAIH,IAAI,GAAK,QAAQ,CAAE,CACrB,GAAI,CAACtK,IAAI,CAACrG,IAAI,EAAIqG,IAAI,CAACrG,IAAI,CAACjG,IAAI,CAAC,CAAC,CAACnF,MAAM,CAAG,CAAC,CAAE,CAC7CiO,SAAS,CAAC7C,IAAI,CAAG,oCAAoC,CACvD,CACF,CAEA,GAAI,CAACqG,IAAI,CAACrR,KAAK,EAAI,CAAC,4BAA4B,CAAC8N,IAAI,CAACuD,IAAI,CAACrR,KAAK,CAAC,CAAE,CACjE6N,SAAS,CAAC7N,KAAK,CAAG,oCAAoC,CACxD,CAEA,GAAI2b,IAAI,GAAK,OAAO,CAAE,CACpB,GAAI,CAACtK,IAAI,CAACpR,QAAQ,EAAIoR,IAAI,CAACpR,QAAQ,CAACL,MAAM,CAAG,CAAC,CAAE,CAC9CiO,SAAS,CAAC5N,QAAQ,CAAG,wCAAwC,CAC/D,CACF,CAEA,GAAI0b,IAAI,GAAK,QAAQ,EAAItK,IAAI,CAACpR,QAAQ,GAAKoR,IAAI,CAACwK,eAAe,CAAE,CAC/DhO,SAAS,CAACgO,eAAe,CAAG,wBAAwB,CACtD,CACF,CAEAtO,SAAS,CAACM,SAAS,CAAC,CACpB,MAAO,CAAAc,MAAM,CAACC,IAAI,CAACf,SAAS,CAAC,CAACjO,MAAM,GAAK,CAAC,CAC5C,CAAC,CAED,KAAM,CAAA6O,YAAY,CAAG,KAAAA,CAAA,GAAY,CAC/B,GAAI,CAAC8N,YAAY,CAAC,CAAC,CAAE,OACrBhD,eAAe,CAAC,IAAI,CAAC,CACrByC,YAAY,CAAC,EAAE,CAAC,CAEhB,GAAI,CACF,GAAIL,IAAI,GAAK,QAAQ,CAAE,CACrB,KAAM,CAAA7b,aAAa,CAACC,MAAM,CAACsR,IAAI,CAACrR,KAAK,CAAEqR,IAAI,CAACpR,QAAQ,CAAEoR,IAAI,CAACrG,IAAI,CAAEqG,IAAI,CAAC3R,IAAI,CAAE2R,IAAI,CAACjR,KAAK,CAAC,CACvFwM,SAAS,SAATA,SAAS,iBAATA,SAAS,CAAG,CAAC,CACblC,OAAO,CAAC,CAAC,CACX,CAAC,IAAM,IAAIiR,IAAI,GAAK,QAAQ,CAAE,CAC5B,KAAM,CAAA7b,aAAa,CAACe,MAAM,CAACwQ,IAAI,CAACrR,KAAK,CAAEqR,IAAI,CAACpR,QAAQ,CAAC,CACrD2M,SAAS,SAATA,SAAS,iBAATA,SAAS,CAAG,CAAC,CACblC,OAAO,CAAC,CAAC,CACX,CAAC,IAAM,IAAIiR,IAAI,GAAK,OAAO,CAAE,CAC3B,KAAM,CAAA7b,aAAa,CAACmB,iBAAiB,CAACoQ,IAAI,CAACrR,KAAK,CAAC,CACjDkc,YAAY,CAAC,IAAI,CAAC,CACpB,CAAC,IAAM,IAAIP,IAAI,GAAK,OAAO,CAAE,CAC3B;AACA,KAAM,CAAApN,MAAM,CAAG,KAAM,CAAAzO,aAAa,CAAChG,YAAY,CAACuX,IAAI,CAACjR,KAAK,CAAC,CAC3Dkc,iBAAiB,CAAC/N,MAAM,CAACiO,eAAe,CAAC,CACzCJ,UAAU,CAAC,IAAI,CAAC,CAChBR,OAAO,CAAC,cAAc,CAAC,CACzB,CAAC,IAAM,IAAID,IAAI,GAAK,cAAc,CAAE,CAClC;AACA,KAAM,CAAA7b,aAAa,CAAC/F,cAAc,CAACsX,IAAI,CAACyK,GAAG,CAAEzK,IAAI,CAAC3R,IAAI,CAAE2R,IAAI,CAACrG,IAAI,CAAC,CAClE4B,SAAS,SAATA,SAAS,iBAATA,SAAS,CAAG,CAAC,CACblC,OAAO,CAAC,CAAC,CACX,CACF,CAAE,MAAO3I,GAAG,CAAE,CACZC,OAAO,CAACC,KAAK,CAAC,aAAa,CAAEF,GAAG,CAAC,CACjC,GAAI,CAAA0a,YAAY,CAAG,sCAAsC,CACzD,GAAI1a,GAAG,CAAC2a,IAAI,GAAK,2BAA2B,CAAE,CAC5CD,YAAY,CAAG,8DAA8D,CAC/E,CAAC,IAAM,IAAI1a,GAAG,CAAC2a,IAAI,GAAK,wBAAwB,CAAE,CAChDD,YAAY,CAAG,4CAA4C,CAC7D,CAAC,IAAM,IAAI1a,GAAG,CAAC2a,IAAI,GAAK,gCAAgC,CAAE,CACxDD,YAAY,CAAG,2CAA2C,CAC5D,CAAC,IAAM,IAAI1a,GAAG,CAAC2a,IAAI,GAAK,mBAAmB,CAAE,CAC3CD,YAAY,CAAG,yCAAyC,CAC1D,CAAC,IAAM,IAAI1a,GAAG,CAAC0D,OAAO,CAAE,CACtBgX,YAAY,CAAG1a,GAAG,CAAC0D,OAAO,CAC5B,CACAuW,YAAY,CAACS,YAAY,CAAC,CAC5B,CAAC,OAAS,CACRlD,eAAe,CAAC,KAAK,CAAC,CACxB,CACF,CAAC,CAED,KAAM,CAAAoD,kBAAkB,CAAG,KAAAA,CAAA,GAAY,CACrCpD,eAAe,CAAC,IAAI,CAAC,CACrByC,YAAY,CAAC,EAAE,CAAC,CAEhB,GAAI,CACF,KAAM,CAAAlc,aAAa,CAACgB,YAAY,CAACuQ,IAAI,CAAC3R,IAAI,CAAC,CAC3CkN,SAAS,SAATA,SAAS,iBAATA,SAAS,CAAG,CAAC,CACblC,OAAO,CAAC,CAAC,CACX,CAAE,MAAO3I,GAAG,CAAE,CACZia,YAAY,CAACja,GAAG,CAAC0D,OAAO,EAAI,0CAA0C,CAAC,CACzE,CAAC,OAAS,CACR8T,eAAe,CAAC,KAAK,CAAC,CACxB,CACF,CAAC,CAED,KAAM,CAAAqD,cAAc,CAAGA,CAAA,GAAM,CAC3BhB,OAAO,CAAC,OAAO,CAAC,CAChBI,YAAY,CAAC,EAAE,CAAC,CAChBI,UAAU,CAAC,KAAK,CAAC,CACnB,CAAC,CAED,mBACE3f,IAAA,QAAK8N,SAAS,CAAC,sIAAsI,CAAAC,QAAA,cACnJ7N,KAAA,QAAK4N,SAAS,CAAC,4FAA4F,CAAAC,QAAA,eAEzG7N,KAAA,QAAK4N,SAAS,CAAC,uCAAuC,CAAAC,QAAA,eACpD7N,KAAA,QAAA6N,QAAA,eACE7N,KAAA,QAAK4N,SAAS,CAAC,8BAA8B,CAAAC,QAAA,eAC3C/N,IAAA,QAAK8N,SAAS,CAAC,6GAA6G,CAAAC,QAAA,cAC1H/N,IAAA,CAACtC,IAAI,EAACoQ,SAAS,CAAC,oBAAoB,CAAE,CAAC,CACpC,CAAC,cACN5N,KAAA,SAAM4N,SAAS,CAAC,wBAAwB,CAAAC,QAAA,eACtC/N,IAAA,SAAM8N,SAAS,CAAC,0EAA0E,CAAAC,QAAA,CAAC,MAAI,CAAM,CAAC,cACtG/N,IAAA,SAAM8N,SAAS,CAAC,eAAe,CAAAC,QAAA,CAAC,IAAE,CAAM,CAAC,EACrC,CAAC,EACJ,CAAC,cACN7N,KAAA,OAAI4N,SAAS,CAAC,sCAAsC,CAAAC,QAAA,EACjDmR,IAAI,GAAK,QAAQ,EAAI,eAAe,CACpCA,IAAI,GAAK,QAAQ,EAAI,qBAAqB,CAC1CA,IAAI,GAAK,OAAO,EAAI,gBAAgB,CACpCA,IAAI,GAAK,OAAO,EAAI,oBAAoB,CACxCA,IAAI,GAAK,cAAc,EAAI,yBAAyB,EACnD,CAAC,cACLhf,KAAA,MAAG4N,SAAS,CAAC,4BAA4B,CAAAC,QAAA,EACtCmR,IAAI,GAAK,QAAQ,EAAI,qBAAqB,CAC1CA,IAAI,GAAK,QAAQ,EAAI,mBAAmB,CACxCA,IAAI,GAAK,OAAO,EAAI,6BAA6B,CACjDA,IAAI,GAAK,OAAO,EAAI,oCAAoC,CACxDA,IAAI,GAAK,cAAc,kBAAA7U,MAAA,CAAoBuV,cAAc,CAAE,EAC3D,CAAC,EACD,CAAC,cACN5f,IAAA,WACEkO,OAAO,CAAED,OAAQ,CACjBH,SAAS,CAAC,sFAAsF,CAAAC,QAAA,cAEhG/N,IAAA,CAAClC,CAAC,EAACgQ,SAAS,CAAC,SAAS,CAAE,CAAC,CACnB,CAAC,EACN,CAAC,CAGLwR,SAAS,eACRpf,KAAA,QAAK4N,SAAS,CAAC,qGAAqG,CAAAC,QAAA,eAClH/N,IAAA,CAACzB,aAAa,EAACuP,SAAS,CAAC,uBAAuB,CAAE,CAAC,CAClDwR,SAAS,EACP,CACN,CAGAE,SAAS,eACRtf,KAAA,QAAK4N,SAAS,CAAC,wGAAwG,CAAAC,QAAA,eACrH/N,IAAA,CAAC7B,WAAW,EAAC2P,SAAS,CAAC,uBAAuB,CAAE,CAAC,+CAEnD,EAAK,CACN,cAED5N,KAAA,QAAK4N,SAAS,CAAC,WAAW,CAAAC,QAAA,EAEvBmR,IAAI,GAAK,cAAc,eACtBhf,KAAA,CAAAE,SAAA,EAAA2N,QAAA,eACE7N,KAAA,QAAA6N,QAAA,eACE/N,IAAA,UAAO8N,SAAS,CAAC,gDAAgD,CAAAC,QAAA,CAAC,qBAAmB,CAAO,CAAC,cAC7F/N,IAAA,UACEiD,IAAI,CAAC,MAAM,CACXmd,SAAS,CAAC,SAAS,CACnBC,SAAS,CAAE,CAAE,CACbnP,KAAK,CAAE0D,IAAI,CAACyK,GAAI,CAChB9M,QAAQ,CAAGhM,CAAC,EAAK,CACf,KAAM,CAAA+Z,GAAG,CAAG/Z,CAAC,CAACiL,MAAM,CAACN,KAAK,CAACqP,OAAO,CAAC,KAAK,CAAE,EAAE,CAAC,CAACpF,KAAK,CAAC,CAAC,CAAE,CAAC,CAAC,CACzDtG,OAAO,CAAArK,aAAA,CAAAA,aAAA,IAAMoK,IAAI,MAAEyK,GAAG,CAAEiB,GAAG,EAAE,CAAC,CAC9BxP,SAAS,CAAAtG,aAAA,CAAAA,aAAA,IAAMqG,MAAM,MAAEwO,GAAG,CAAE,EAAE,EAAE,CAAC,CACjCE,YAAY,CAAC,EAAE,CAAC,CAClB,CAAE,CACFzR,SAAS,+JAAAzD,MAAA,CACPwG,MAAM,CAACwO,GAAG,CAAG,4BAA4B,CAAG,uCAAuC,CAClF,CACH3M,WAAW,CAAC,QAAQ,CACpB8N,SAAS,MACV,CAAC,CACD3P,MAAM,CAACwO,GAAG,eAAInf,KAAA,MAAG4N,SAAS,CAAC,sDAAsD,CAAAC,QAAA,eAAC/N,IAAA,SAAA+N,QAAA,CAAM,QAAC,CAAM,CAAC,CAAC8C,MAAM,CAACwO,GAAG,EAAI,CAAC,EAC9G,CAAC,cAGNnf,KAAA,QAAA6N,QAAA,eACE/N,IAAA,UAAO8N,SAAS,CAAC,gDAAgD,CAAAC,QAAA,CAAC,aAAW,CAAO,CAAC,cACrF/N,IAAA,UACEiD,IAAI,CAAC,MAAM,CACXiO,KAAK,CAAE0D,IAAI,CAACrG,IAAK,CACjBgE,QAAQ,CAAGhM,CAAC,EAAK,CAAEsO,OAAO,CAAArK,aAAA,CAAAA,aAAA,IAAMoK,IAAI,MAAErG,IAAI,CAAEhI,CAAC,CAACiL,MAAM,CAACN,KAAK,EAAE,CAAC,CAAEJ,SAAS,CAAAtG,aAAA,CAAAA,aAAA,IAAMqG,MAAM,MAAEtC,IAAI,CAAE,EAAE,EAAE,CAAC,CAAE,CAAE,CACrGT,SAAS,CAAC,kJAAkJ,CAC5J4E,WAAW,CAAC,UAAU,CACvB,CAAC,EACC,CAAC,cAGNxS,KAAA,QAAA6N,QAAA,eACE/N,IAAA,UAAO8N,SAAS,CAAC,gDAAgD,CAAAC,QAAA,CAAC,QAAM,CAAO,CAAC,cAChF7N,KAAA,QAAK4N,SAAS,CAAC,wBAAwB,CAAAC,QAAA,eACrC7N,KAAA,WACE+C,IAAI,CAAC,QAAQ,CACbiL,OAAO,CAAEA,CAAA,GAAM2G,OAAO,CAAArK,aAAA,CAAAA,aAAA,IAAMoK,IAAI,MAAE3R,IAAI,CAAE,QAAQ,EAAE,CAAE,CACpD6K,SAAS,4EAAAzD,MAAA,CACPuK,IAAI,CAAC3R,IAAI,GAAK,QAAQ,CAClB,mFAAmF,CACnF,sEAAsE,CACzE,CAAA8K,QAAA,eAEH/N,IAAA,CAACpC,MAAM,EAACkQ,SAAS,YAAAzD,MAAA,CAAauK,IAAI,CAAC3R,IAAI,GAAK,QAAQ,CAAG,eAAe,CAAG,EAAE,CAAG,CAAE,CAAC,cACjFjD,IAAA,SAAM8N,SAAS,CAAC,uBAAuB,CAAAC,QAAA,CAAC,oBAAkB,CAAM,CAAC,EAC3D,CAAC,cACT7N,KAAA,WACE+C,IAAI,CAAC,QAAQ,CACbiL,OAAO,CAAEA,CAAA,GAAM2G,OAAO,CAAArK,aAAA,CAAAA,aAAA,IAAMoK,IAAI,MAAE3R,IAAI,CAAE,UAAU,EAAE,CAAE,CACtD6K,SAAS,4EAAAzD,MAAA,CACPuK,IAAI,CAAC3R,IAAI,GAAK,UAAU,CACpB,mFAAmF,CACnF,sEAAsE,CACzE,CAAA8K,QAAA,eAEH/N,IAAA,CAACtC,IAAI,EAACoQ,SAAS,YAAAzD,MAAA,CAAauK,IAAI,CAAC3R,IAAI,GAAK,UAAU,CAAG,eAAe,CAAG,EAAE,CAAG,CAAE,CAAC,cACjFjD,IAAA,SAAM8N,SAAS,CAAC,uBAAuB,CAAAC,QAAA,CAAC,eAAa,CAAM,CAAC,EACtD,CAAC,EACN,CAAC,EACH,CAAC,cAEN/N,IAAA,WACEiD,IAAI,CAAC,QAAQ,CACbiL,OAAO,CAAEA,CAAA,GAAM,CAAEiR,OAAO,CAAC,OAAO,CAAC,CAAEQ,UAAU,CAAC,KAAK,CAAC,CAAE9K,OAAO,CAAArK,aAAA,CAAAA,aAAA,IAAMoK,IAAI,MAAEyK,GAAG,CAAE,EAAE,EAAE,CAAC,CAAE,CAAE,CACvFvR,SAAS,CAAC,uDAAuD,CAAAC,QAAA,CAClE,4BAED,CAAQ,CAAC,EACT,CACH,CAGAmR,IAAI,GAAK,OAAO,eACfhf,KAAA,CAAAE,SAAA,EAAA2N,QAAA,eACE7N,KAAA,QAAA6N,QAAA,eACE/N,IAAA,UAAO8N,SAAS,CAAC,gDAAgD,CAAAC,QAAA,CAAC,gBAAc,CAAO,CAAC,cACxF7N,KAAA,QAAK4N,SAAS,CAAC,YAAY,CAAAC,QAAA,eACzB/N,IAAA,QAAK8N,SAAS,CAAC,kGAAkG,CAAAC,QAAA,CAAC,8BAElH,CAAK,CAAC,cACN/N,IAAA,UACEiD,IAAI,CAAC,KAAK,CACViO,KAAK,CAAE0D,IAAI,CAACjR,KAAM,CAClB4O,QAAQ,CAAGhM,CAAC,EAAK,CACfsO,OAAO,CAAArK,aAAA,CAAAA,aAAA,IAAMoK,IAAI,MAAEjR,KAAK,CAAE4C,CAAC,CAACiL,MAAM,CAACN,KAAK,EAAE,CAAC,CAC3CJ,SAAS,CAAAtG,aAAA,CAAAA,aAAA,IAAMqG,MAAM,MAAElN,KAAK,CAAE,EAAE,EAAE,CAAC,CACnC4b,YAAY,CAAC,EAAE,CAAC,CAClB,CAAE,CACFzR,SAAS,+GAAAzD,MAAA,CACPwG,MAAM,CAAClN,KAAK,CAAG,4BAA4B,CAAG,uCAAuC,CACpF,CACH+O,WAAW,CAAC,aAAa,CACzB8N,SAAS,MACV,CAAC,EACC,CAAC,CACL3P,MAAM,CAAClN,KAAK,eAAIzD,KAAA,MAAG4N,SAAS,CAAC,sDAAsD,CAAAC,QAAA,eAAC/N,IAAA,SAAA+N,QAAA,CAAM,QAAC,CAAM,CAAC,CAAC8C,MAAM,CAAClN,KAAK,EAAI,CAAC,cACrH3D,IAAA,MAAG8N,SAAS,CAAC,4BAA4B,CAAAC,QAAA,CAAC,gDAA8C,CAAG,CAAC,EACzF,CAAC,cAEN/N,IAAA,WACEiD,IAAI,CAAC,QAAQ,CACbiL,OAAO,CAAEA,CAAA,GAAM,CAAEiR,OAAO,CAAC,QAAQ,CAAC,CAAEI,YAAY,CAAC,EAAE,CAAC,CAAE,CAAE,CACxDzR,SAAS,CAAC,uDAAuD,CAAAC,QAAA,CAClE,0BAED,CAAQ,CAAC,EACT,CACH,CAGA,CAACmR,IAAI,GAAK,QAAQ,EAAIA,IAAI,GAAK,QAAQ,gBACtChf,KAAA,CAAAE,SAAA,EAAA2N,QAAA,eACE7N,KAAA,QAAK4N,SAAS,CAAC,wBAAwB,CAAAC,QAAA,eACrC7N,KAAA,WACE+C,IAAI,CAAC,QAAQ,CACbiL,OAAO,CAAEgS,kBAAmB,CAC5B1L,QAAQ,CAAEqI,YAAa,CACvB/O,SAAS,CAAC,sKAAsK,CAAAC,QAAA,eAEhL7N,KAAA,QAAK4N,SAAS,CAAC,SAAS,CAACuG,OAAO,CAAC,WAAW,CAAAtG,QAAA,eAC1C/N,IAAA,SAAMsU,IAAI,CAAC,SAAS,CAACC,CAAC,CAAC,yHAAyH,CAAC,CAAC,cAClJvU,IAAA,SAAMsU,IAAI,CAAC,SAAS,CAACC,CAAC,CAAC,uIAAuI,CAAC,CAAC,cAChKvU,IAAA,SAAMsU,IAAI,CAAC,SAAS,CAACC,CAAC,CAAC,+HAA+H,CAAC,CAAC,cACxJvU,IAAA,SAAMsU,IAAI,CAAC,SAAS,CAACC,CAAC,CAAC,qIAAqI,CAAC,CAAC,EAC3J,CAAC,SAER,EAAQ,CAAC,cAETrU,KAAA,WACE+C,IAAI,CAAC,QAAQ,CACbiL,OAAO,CAAEiS,cAAe,CACxB3L,QAAQ,CAAEqI,YAAa,CACvB/O,SAAS,CAAC,sKAAsK,CAAAC,QAAA,eAEhL/N,IAAA,CAAChC,KAAK,EAAC8P,SAAS,CAAC,wBAAwB,CAAE,CAAC,QAE9C,EAAQ,CAAC,EACN,CAAC,cAEN5N,KAAA,QAAK4N,SAAS,CAAC,UAAU,CAAAC,QAAA,eACvB/N,IAAA,QAAK8N,SAAS,CAAC,oCAAoC,CAAAC,QAAA,cACjD/N,IAAA,QAAK8N,SAAS,CAAC,iCAAiC,CAAM,CAAC,CACpD,CAAC,cACN9N,IAAA,QAAK8N,SAAS,CAAC,sCAAsC,CAAAC,QAAA,cACnD/N,IAAA,SAAM8N,SAAS,CAAC,6BAA6B,CAAAC,QAAA,CAAC,cAAY,CAAM,CAAC,CAC9D,CAAC,EACH,CAAC,EACN,CACH,CAGAmR,IAAI,GAAK,OAAO,eACfhf,KAAA,QAAA6N,QAAA,eACE/N,IAAA,UAAO8N,SAAS,CAAC,gDAAgD,CAAAC,QAAA,CAAC,SAAO,CAAO,CAAC,cACjF/N,IAAA,UACEiD,IAAI,CAAC,OAAO,CACZiO,KAAK,CAAE0D,IAAI,CAACrR,KAAM,CAClBgP,QAAQ,CAAGhM,CAAC,EAAK,CAAEsO,OAAO,CAAArK,aAAA,CAAAA,aAAA,IAAMoK,IAAI,MAAErR,KAAK,CAAEgD,CAAC,CAACiL,MAAM,CAACN,KAAK,EAAE,CAAC,CAAEJ,SAAS,CAAAtG,aAAA,CAAAA,aAAA,IAAMqG,MAAM,MAAEtN,KAAK,CAAE,EAAE,EAAE,CAAC,CAAEgc,YAAY,CAAC,EAAE,CAAC,CAAE,CAAE,CACzHzR,SAAS,+GAAAzD,MAAA,CACPwG,MAAM,CAACtN,KAAK,CAAG,4BAA4B,CAAG,uCAAuC,CACpF,CACHmP,WAAW,CAAC,kBAAkB,CAC/B,CAAC,CACD7B,MAAM,CAACtN,KAAK,eAAIrD,KAAA,MAAG4N,SAAS,CAAC,sDAAsD,CAAAC,QAAA,eAAC/N,IAAA,SAAA+N,QAAA,CAAM,QAAC,CAAM,CAAC,CAAC8C,MAAM,CAACtN,KAAK,EAAI,CAAC,EAClH,CACN,CAGA,CAAC2b,IAAI,GAAK,QAAQ,EAAIA,IAAI,GAAK,QAAQ,gBACtChf,KAAA,CAAAE,SAAA,EAAA2N,QAAA,EAEGmR,IAAI,GAAK,QAAQ,eAChBhf,KAAA,QAAA6N,QAAA,eACE/N,IAAA,UAAO8N,SAAS,CAAC,gDAAgD,CAAAC,QAAA,CAAC,aAAW,CAAO,CAAC,cACrF/N,IAAA,UACEiD,IAAI,CAAC,MAAM,CACXiO,KAAK,CAAE0D,IAAI,CAACrG,IAAK,CACjBgE,QAAQ,CAAGhM,CAAC,EAAK,CAAEsO,OAAO,CAAArK,aAAA,CAAAA,aAAA,IAAMoK,IAAI,MAAErG,IAAI,CAAEhI,CAAC,CAACiL,MAAM,CAACN,KAAK,EAAE,CAAC,CAAEJ,SAAS,CAAAtG,aAAA,CAAAA,aAAA,IAAMqG,MAAM,MAAEtC,IAAI,CAAE,EAAE,EAAE,CAAC,CAAE,CAAE,CACrGT,SAAS,+GAAAzD,MAAA,CACPwG,MAAM,CAACtC,IAAI,CAAG,4BAA4B,CAAG,uCAAuC,CACnF,CACHmE,WAAW,CAAC,UAAU,CACvB,CAAC,CACD7B,MAAM,CAACtC,IAAI,eAAIrO,KAAA,MAAG4N,SAAS,CAAC,sDAAsD,CAAAC,QAAA,eAAC/N,IAAA,SAAA+N,QAAA,CAAM,QAAC,CAAM,CAAC,CAAC8C,MAAM,CAACtC,IAAI,EAAI,CAAC,EAChH,CACN,cAGDrO,KAAA,QAAA6N,QAAA,eACE/N,IAAA,UAAO8N,SAAS,CAAC,gDAAgD,CAAAC,QAAA,CAAC,SAAO,CAAO,CAAC,cACjF/N,IAAA,UACEiD,IAAI,CAAC,OAAO,CACZiO,KAAK,CAAE0D,IAAI,CAACrR,KAAM,CAClBgP,QAAQ,CAAGhM,CAAC,EAAK,CAAEsO,OAAO,CAAArK,aAAA,CAAAA,aAAA,IAAMoK,IAAI,MAAErR,KAAK,CAAEgD,CAAC,CAACiL,MAAM,CAACN,KAAK,EAAE,CAAC,CAAEJ,SAAS,CAAAtG,aAAA,CAAAA,aAAA,IAAMqG,MAAM,MAAEtN,KAAK,CAAE,EAAE,EAAE,CAAC,CAAEgc,YAAY,CAAC,EAAE,CAAC,CAAE,CAAE,CACzHzR,SAAS,+GAAAzD,MAAA,CACPwG,MAAM,CAACtN,KAAK,CAAG,4BAA4B,CAAG,uCAAuC,CACpF,CACHmP,WAAW,CAAC,kBAAkB,CAC/B,CAAC,CACD7B,MAAM,CAACtN,KAAK,eAAIrD,KAAA,MAAG4N,SAAS,CAAC,sDAAsD,CAAAC,QAAA,eAAC/N,IAAA,SAAA+N,QAAA,CAAM,QAAC,CAAM,CAAC,CAAC8C,MAAM,CAACtN,KAAK,EAAI,CAAC,EAClH,CAAC,cAGNrD,KAAA,QAAA6N,QAAA,eACE/N,IAAA,UAAO8N,SAAS,CAAC,gDAAgD,CAAAC,QAAA,CAAC,YAAU,CAAO,CAAC,cACpF/N,IAAA,UACEiD,IAAI,CAAC,UAAU,CACfiO,KAAK,CAAE0D,IAAI,CAACpR,QAAS,CACrB+O,QAAQ,CAAGhM,CAAC,EAAK,CAAEsO,OAAO,CAAArK,aAAA,CAAAA,aAAA,IAAMoK,IAAI,MAAEpR,QAAQ,CAAE+C,CAAC,CAACiL,MAAM,CAACN,KAAK,EAAE,CAAC,CAAEJ,SAAS,CAAAtG,aAAA,CAAAA,aAAA,IAAMqG,MAAM,MAAErN,QAAQ,CAAE,EAAE,EAAE,CAAC,CAAE+b,YAAY,CAAC,EAAE,CAAC,CAAE,CAAE,CAC/HzR,SAAS,+GAAAzD,MAAA,CACPwG,MAAM,CAACrN,QAAQ,CAAG,4BAA4B,CAAG,uCAAuC,CACvF,CACHkP,WAAW,CAAC,kDAAU,CACvB,CAAC,CACD7B,MAAM,CAACrN,QAAQ,eAAItD,KAAA,MAAG4N,SAAS,CAAC,sDAAsD,CAAAC,QAAA,eAAC/N,IAAA,SAAA+N,QAAA,CAAM,QAAC,CAAM,CAAC,CAAC8C,MAAM,CAACrN,QAAQ,EAAI,CAAC,EACxH,CAAC,CAGL0b,IAAI,GAAK,QAAQ,eAChBhf,KAAA,QAAA6N,QAAA,eACE/N,IAAA,UAAO8N,SAAS,CAAC,gDAAgD,CAAAC,QAAA,CAAC,oBAAkB,CAAO,CAAC,cAC5F/N,IAAA,UACEiD,IAAI,CAAC,UAAU,CACfiO,KAAK,CAAE0D,IAAI,CAACwK,eAAgB,CAC5B7M,QAAQ,CAAGhM,CAAC,EAAK,CAAEsO,OAAO,CAAArK,aAAA,CAAAA,aAAA,IAAMoK,IAAI,MAAEwK,eAAe,CAAE7Y,CAAC,CAACiL,MAAM,CAACN,KAAK,EAAE,CAAC,CAAEJ,SAAS,CAAAtG,aAAA,CAAAA,aAAA,IAAMqG,MAAM,MAAEuO,eAAe,CAAE,EAAE,EAAE,CAAC,CAAE,CAAE,CAC3HtR,SAAS,+GAAAzD,MAAA,CACPwG,MAAM,CAACuO,eAAe,CAAG,4BAA4B,CAAG,uCAAuC,CAC9F,CACH1M,WAAW,CAAC,kDAAU,CACvB,CAAC,CACD7B,MAAM,CAACuO,eAAe,eAAIlf,KAAA,MAAG4N,SAAS,CAAC,sDAAsD,CAAAC,QAAA,eAAC/N,IAAA,SAAA+N,QAAA,CAAM,QAAC,CAAM,CAAC,CAAC8C,MAAM,CAACuO,eAAe,EAAI,CAAC,EACtI,CACN,CAGAF,IAAI,GAAK,QAAQ,eAChBhf,KAAA,QAAA6N,QAAA,eACE7N,KAAA,UAAO4N,SAAS,CAAC,gDAAgD,CAAAC,QAAA,EAAC,QAC1D,cAAA/N,IAAA,SAAM8N,SAAS,CAAC,2BAA2B,CAAAC,QAAA,CAAC,YAAU,CAAM,CAAC,EAC9D,CAAC,cACR/N,IAAA,UACEiD,IAAI,CAAC,KAAK,CACViO,KAAK,CAAE0D,IAAI,CAACjR,KAAM,CAClB4O,QAAQ,CAAGhM,CAAC,EAAKsO,OAAO,CAAArK,aAAA,CAAAA,aAAA,IAAMoK,IAAI,MAAEjR,KAAK,CAAE4C,CAAC,CAACiL,MAAM,CAACN,KAAK,EAAE,CAAE,CAC7DpD,SAAS,CAAC,kJAAkJ,CAC5J4E,WAAW,CAAC,iBAAiB,CAC9B,CAAC,EACC,CACN,CAGAwM,IAAI,GAAK,QAAQ,eAChBhf,KAAA,QAAA6N,QAAA,eACE/N,IAAA,UAAO8N,SAAS,CAAC,gDAAgD,CAAAC,QAAA,CAAC,QAAM,CAAO,CAAC,cAChF7N,KAAA,QAAK4N,SAAS,CAAC,wBAAwB,CAAAC,QAAA,eACrC7N,KAAA,WACE+C,IAAI,CAAC,QAAQ,CACbiL,OAAO,CAAEA,CAAA,GAAM2G,OAAO,CAAArK,aAAA,CAAAA,aAAA,IAAMoK,IAAI,MAAE3R,IAAI,CAAE,QAAQ,EAAE,CAAE,CACpD6K,SAAS,4EAAAzD,MAAA,CACPuK,IAAI,CAAC3R,IAAI,GAAK,QAAQ,CAClB,mFAAmF,CACnF,sEAAsE,CACzE,CAAA8K,QAAA,eAEH/N,IAAA,CAACpC,MAAM,EAACkQ,SAAS,YAAAzD,MAAA,CAAauK,IAAI,CAAC3R,IAAI,GAAK,QAAQ,CAAG,eAAe,CAAG,EAAE,CAAG,CAAE,CAAC,cACjFjD,IAAA,SAAM8N,SAAS,CAAC,uBAAuB,CAAAC,QAAA,CAAC,oBAAkB,CAAM,CAAC,EAC3D,CAAC,cACT7N,KAAA,WACE+C,IAAI,CAAC,QAAQ,CACbiL,OAAO,CAAEA,CAAA,GAAM2G,OAAO,CAAArK,aAAA,CAAAA,aAAA,IAAMoK,IAAI,MAAE3R,IAAI,CAAE,UAAU,EAAE,CAAE,CACtD6K,SAAS,4EAAAzD,MAAA,CACPuK,IAAI,CAAC3R,IAAI,GAAK,UAAU,CACpB,mFAAmF,CACnF,sEAAsE,CACzE,CAAA8K,QAAA,eAEH/N,IAAA,CAACtC,IAAI,EAACoQ,SAAS,YAAAzD,MAAA,CAAauK,IAAI,CAAC3R,IAAI,GAAK,UAAU,CAAG,eAAe,CAAG,EAAE,CAAG,CAAE,CAAC,cACjFjD,IAAA,SAAM8N,SAAS,CAAC,uBAAuB,CAAAC,QAAA,CAAC,eAAa,CAAM,CAAC,EACtD,CAAC,EACN,CAAC,EACH,CACN,CAGAmR,IAAI,GAAK,QAAQ,eAChBlf,IAAA,WACEiD,IAAI,CAAC,QAAQ,CACbiL,OAAO,CAAEA,CAAA,GAAM,CAAEiR,OAAO,CAAC,OAAO,CAAC,CAAEI,YAAY,CAAC,EAAE,CAAC,CAAEE,YAAY,CAAC,KAAK,CAAC,CAAE,CAAE,CAC5E3R,SAAS,CAAC,uDAAuD,CAAAC,QAAA,CAClE,uBAED,CAAQ,CACT,EACD,CACH,cAGD/N,IAAA,WACEsH,EAAE,CAAC,sBAAsB,CACzB4G,OAAO,CAAE8D,YAAa,CACtBwC,QAAQ,CAAEqI,YAAa,CACvB/O,SAAS,6DAAAzD,MAAA,CACPwS,YAAY,CACR,gCAAgC,CAChC,gJAAgJ,CACnJ,CAAA9O,QAAA,CAEF8O,YAAY,cACX3c,KAAA,CAAAE,SAAA,EAAA2N,QAAA,eACE/N,IAAA,SAAM8N,SAAS,CAAC,WAAW,CAAAC,QAAA,CAAC,QAAM,CAAM,CAAC,cACzC/N,IAAA,QAAK8N,SAAS,CAAC,mDAAmD,CAAAC,QAAA,cAChE/N,IAAA,QAAK8N,SAAS,CAAC,8EAA8E,CAAE,CAAC,CAC7F,CAAC,EACN,CAAC,cAEH5N,KAAA,CAAAE,SAAA,EAAA2N,QAAA,EACGmR,IAAI,GAAK,QAAQ,EAAI,SAAS,CAC9BA,IAAI,GAAK,QAAQ,EAAI,gBAAgB,CACrCA,IAAI,GAAK,OAAO,EAAI,iBAAiB,CACrCA,IAAI,GAAK,OAAO,EAAI,wBAAwB,CAC5CA,IAAI,GAAK,cAAc,EAAI,kBAAkB,EAC9C,CACH,CACK,CAAC,cAGTlf,IAAA,QAAKsH,EAAE,CAAC,qBAAqB,CAACwG,SAAS,CAAC,qBAAqB,CAAM,CAAC,cAGpE5N,KAAA,QAAK4N,SAAS,CAAC,mCAAmC,CAAAC,QAAA,EAC/CmR,IAAI,GAAK,QAAQ,eAChBhf,KAAA,CAAAE,SAAA,EAAA2N,QAAA,EAAE,wBACsB,CAAC,GAAG,cAC1B/N,IAAA,WACEkO,OAAO,CAAEA,CAAA,GAAM,CAAEiR,OAAO,CAAC,QAAQ,CAAC,CAAEI,YAAY,CAAC,EAAE,CAAC,CAAE,CAAE,CACxDzR,SAAS,CAAC,iDAAiD,CAAAC,QAAA,CAC5D,SAED,CAAQ,CAAC,EACT,CACH,CACAmR,IAAI,GAAK,QAAQ,eAChBhf,KAAA,CAAAE,SAAA,EAAA2N,QAAA,EAAE,0BACwB,CAAC,GAAG,cAC5B/N,IAAA,WACEkO,OAAO,CAAEA,CAAA,GAAM,CAAEiR,OAAO,CAAC,QAAQ,CAAC,CAAEI,YAAY,CAAC,EAAE,CAAC,CAAE,CAAE,CACxDzR,SAAS,CAAC,iDAAiD,CAAAC,QAAA,CAC5D,SAED,CAAQ,CAAC,EACT,CACH,CACAmR,IAAI,GAAK,OAAO,eACflf,IAAA,WACEkO,OAAO,CAAEA,CAAA,GAAM,CAAEiR,OAAO,CAAC,QAAQ,CAAC,CAAEI,YAAY,CAAC,EAAE,CAAC,CAAEE,YAAY,CAAC,KAAK,CAAC,CAAE,CAAE,CAC7E3R,SAAS,CAAC,iDAAiD,CAAAC,QAAA,CAC5D,wBAED,CAAQ,CACT,CACA,CAACmR,IAAI,GAAK,OAAO,EAAIA,IAAI,GAAK,cAAc,gBAC3Clf,IAAA,WACEkO,OAAO,CAAEA,CAAA,GAAM,CAAEiR,OAAO,CAAC,QAAQ,CAAC,CAAEI,YAAY,CAAC,EAAE,CAAC,CAAEI,UAAU,CAAC,KAAK,CAAC,CAAE,CAAE,CAC3E7R,SAAS,CAAC,iDAAiD,CAAAC,QAAA,CAC5D,wBAED,CAAQ,CACT,EACE,CAAC,EACH,CAAC,cAGN7N,KAAA,MAAG4N,SAAS,CAAC,wCAAwC,CAAAC,QAAA,EAAC,kCACpB,cAAA/N,IAAA,WAAQ8N,SAAS,CAAC,+BAA+B,CAAAC,QAAA,CAAC,kBAAgB,CAAQ,CAAC,QAAK,cAAA/N,IAAA,WAAQ8N,SAAS,CAAC,+BAA+B,CAAAC,QAAA,CAAC,gBAAc,CAAQ,CAAC,EACxL,CAAC,EACD,CAAC,CACH,CAAC,CAEV,CAEA,QAAS,CAAAqC,SAASA,CAAAqQ,KAAA,CAA4C,IAA3C,CAAEngB,WAAW,CAAEC,cAAc,CAAEC,QAAS,CAAC,CAAAigB,KAAA,CAC1D,KAAM,CAAAC,QAAQ,CAAG,CACf,CAAEpZ,EAAE,CAAE,QAAQ,CAAEsT,KAAK,CAAE,QAAQ,CAAE+F,IAAI,cAAE3gB,IAAA,CAACpC,MAAM,EAACkQ,SAAS,CAAC,SAAS,CAAE,CAAC,CAAE8S,WAAW,CAAE,MAAO,CAAC,CAC5F,CAAEtZ,EAAE,CAAE,KAAK,CAAEsT,KAAK,CAAE,MAAM,CAAE+F,IAAI,cAAE3gB,IAAA,CAACrC,UAAU,EAACmQ,SAAS,CAAC,SAAS,CAAE,CAAC,CAAE+S,gBAAgB,CAAE,IAAI,CAAED,WAAW,CAAE,MAAO,CAAC,CACnH,CAAEtZ,EAAE,CAAE,WAAW,CAAEsT,KAAK,CAAE,OAAO,CAAE+F,IAAI,cAAE3gB,IAAA,CAAC5B,KAAK,EAAC0P,SAAS,CAAC,SAAS,CAAE,CAAC,CAAE8S,WAAW,CAAE,MAAO,CAAC,CAC7F,CAAEtZ,EAAE,CAAE,SAAS,CAAEsT,KAAK,CAAE,SAAS,CAAE+F,IAAI,cAAE3gB,IAAA,CAACjC,IAAI,EAAC+P,SAAS,CAAC,SAAS,CAAE,CAAC,CAAE8S,WAAW,CAAE,MAAO,CAAC,CAC7F,CAED,mBACE5gB,IAAA,QAAK8N,SAAS,CAAC,+HAA+H,CAAAC,QAAA,cAC5I/N,IAAA,QAAK8N,SAAS,CAAC,yCAAyC,CAAAC,QAAA,CACrD2S,QAAQ,CAAC7K,GAAG,CAACiL,IAAI,EAAI,CACpB,KAAM,CAAAtM,QAAQ,CAAGsM,IAAI,CAACD,gBAAgB,EAAIrgB,QAAQ,GAAK,UAAU,CACjE,KAAM,CAAAugB,QAAQ,CAAGzgB,WAAW,GAAKwgB,IAAI,CAACxZ,EAAE,CACxC,KAAM,CAAA0Z,YAAY,CAAG,CACnBC,IAAI,CAAE,0BAA0B,CAChCC,IAAI,CAAE,0BAA0B,CAChCC,IAAI,CAAE,0BACR,CAAC,CACD,mBACEjhB,KAAA,WAEE+C,IAAI,CAAC,QAAQ,CACbuR,QAAQ,CAAEA,QAAS,CACnBtG,OAAO,CAAEA,CAAA,GAAM,CAACsG,QAAQ,EAAIjU,cAAc,CAACugB,IAAI,CAACxZ,EAAE,CAAE,CACpDwG,SAAS,wFAAAzD,MAAA,CACPmK,QAAQ,CACJ,+BAA+B,CAC/B,iBAAiB,MAAAnK,MAAA,CAErB0W,QAAQ,IAAA1W,MAAA,CACD2W,YAAY,CAACF,IAAI,CAACF,WAAW,CAAC,mBACjC,oDAAoD,CACvD,CAAA7S,QAAA,eAEH/N,IAAA,SAAM8N,SAAS,sCAAAzD,MAAA,CAAuC0W,QAAQ,CAAG,WAAW,CAAG,EAAE,CAAG,CAAAhT,QAAA,CACjF+S,IAAI,CAACH,IAAI,CACN,CAAC,cACP3gB,IAAA,SAAM8N,SAAS,CAAC,yBAAyB,CAAAC,QAAA,CAAE+S,IAAI,CAAClG,KAAK,CAAO,CAAC,GAjBxDkG,IAAI,CAACxZ,EAkBJ,CAAC,CAEb,CAAC,CAAC,CACC,CAAC,CACH,CAAC,CAEV","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}