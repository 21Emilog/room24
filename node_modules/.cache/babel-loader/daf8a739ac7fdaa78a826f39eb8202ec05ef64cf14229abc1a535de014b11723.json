{"ast":null,"code":"import _objectSpread from\"C:/Users/kutum/Documents/room-rental-platform/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import React,{useState,useEffect,useMemo,useCallback}from'react';import{initFirebase,initAnalytics,requestFcmToken,listenForegroundMessages,trackEvent,fetchListings,addListing,deleteListing,subscribeToListings,isFirestoreEnabled}from'./firebase';import{Home,PlusCircle,Search,MapPin,X,User,Phone,Mail,Edit,CheckCircle,Heart,Calendar,Bell,AlertTriangle}from'lucide-react';import Header from'./components/Header';import ListingDetailModal from'./components/ListingDetailModal';import Footer from'./components/Footer';import BrowseView from'./components/BrowseView';import PrivacyPolicyModal from'./components/PrivacyPolicyModal';import NotificationBanner from'./components/NotificationBanner';import AnalyticsConsentModal from'./components/AnalyticsConsentModal';import NotificationsPanel from'./components/NotificationsPanel';import PhotoEditor from'./components/PhotoEditor';import OfflineIndicator from'./components/OfflineIndicator';import BackToTop from'./components/BackToTop';import{getNotifications}from'./utils/notificationEngine';import{loadListingTemplate,saveListingTemplate,clearListingTemplate}from'./utils/listingTemplateStorage';import{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";export default function RentalPlatform(){const[currentView,setCurrentView]=useState('browse');const[userType,setUserType]=useState(null);const[previewAsRenter,setPreviewAsRenter]=useState(false);// landlord UI preview toggle\nconst[listings,setListings]=useState([]);const[selectedListing,setSelectedListing]=useState(null);const[users,setUsers]=useState([]);// registry of all users (localStorage 'users')\nconst[searchLocation,setSearchLocation]=useState('');const[priceRange,setPriceRange]=useState([0,10000]);const[selectedAmenities,setSelectedAmenities]=useState([]);const[sortBy,setSortBy]=useState('newest');const[currentUser,setCurrentUser]=useState(null);const[showAuthModal,setShowAuthModal]=useState(false);const[authDefaultType,setAuthDefaultType]=useState('renter');// Mobile menu state moved into Header component\nconst[toast,setToast]=useState(null);const[showPrivacyPolicy,setShowPrivacyPolicy]=useState(false);const[notificationBanner,setNotificationBanner]=useState(null);const[showAnalyticsConsent,setShowAnalyticsConsent]=useState(false);const[showNotificationsPanel,setShowNotificationsPanel]=useState(false);const[unreadCount,setUnreadCount]=useState(0);const openAuthModal=function(){let type=arguments.length>0&&arguments[0]!==undefined?arguments[0]:'renter';setAuthDefaultType(type);setShowAuthModal(true);};// Update unread notification count\nuseEffect(()=>{const updateUnreadCount=()=>{const notifications=getNotifications();setUnreadCount(notifications.filter(n=>!n.read).length);};updateUnreadCount();const interval=setInterval(updateUnreadCount,5000);// check every 5s\nreturn()=>clearInterval(interval);},[]);useEffect(()=>{loadData();// Initialize Firebase + FCM token fetch (deferred until user interaction if desired)\nconst app=initFirebase();// Set up real-time listener for Firestore listings\nlet unsubscribeListings=null;if(isFirestoreEnabled()){unsubscribeListings=subscribeToListings(firestoreListings=>{if(firestoreListings&&firestoreListings.length>=0){setListings(firestoreListings);// Cache locally for offline access\nlocalStorage.setItem('listings',JSON.stringify(firestoreListings));}});}// Check analytics consent and show modal if not set\nconst analyticsConsent=localStorage.getItem('analytics-consent');if(!analyticsConsent&&process.env.REACT_APP_ENABLE_ANALYTICS==='true'){// Delay modal slightly so UI loads first\nsetTimeout(()=>setShowAnalyticsConsent(true),2000);}else if(analyticsConsent==='yes'){initAnalytics(app);}(async()=>{try{const token=await requestFcmToken();if(token){console.log('Obtained FCM token:',token);trackEvent('fcm_token_obtained');}}catch(e){console.warn('FCM token request failed',e);}})();listenForegroundMessages(payload=>{// Display notification banner instead of toast\nconst notification=(payload===null||payload===void 0?void 0:payload.notification)||{};if(notification.title||notification.body){setNotificationBanner({title:notification.title,body:notification.body});// Auto-dismiss after 8 seconds\nsetTimeout(()=>setNotificationBanner(null),8000);}});// Cleanup: unsubscribe from Firestore listener on unmount\nreturn()=>{if(unsubscribeListings){unsubscribeListings();}};},[]);// Guard: if someone navigates to 'add' without landlord auth, prompt to sign in\nuseEffect(()=>{if(currentView==='add'){if(!currentUser){openAuthModal('landlord');setCurrentView('browse');}else if(userType!=='landlord'){// Not a landlord - prompt to become one\nopenAuthModal('landlord');setCurrentView('browse');}else if(!currentUser.landlordComplete){// Landlord but hasn't completed onboarding\nsetCurrentView('landlord-onboarding');}}},[currentView,currentUser,userType]);const loadData=async()=>{try{// Try to load from Firestore first\nconst firestoreListings=await fetchListings();if(firestoreListings&&firestoreListings.length>0){console.log('Loaded listings from Firestore');setListings(firestoreListings);// Also cache to localStorage for offline access\nlocalStorage.setItem('listings',JSON.stringify(firestoreListings));}else{// Fall back to localStorage\nconst listingsResult=localStorage.getItem('listings');if(listingsResult){console.log('Loaded listings from localStorage (Firestore empty or unavailable)');setListings(JSON.parse(listingsResult));}}const userResult=localStorage.getItem('current-user');const usersResult=localStorage.getItem('users');if(userResult){const user=JSON.parse(userResult);setCurrentUser(user);setUserType(user.type);}if(usersResult){try{const parsed=JSON.parse(usersResult);setUsers(Array.isArray(parsed)?parsed:[]);}catch(e){console.warn('Corrupt users array in storage, resetting');setUsers([]);}}}catch(error){console.log('No existing data found, starting fresh');// Add sample listings for testing the map\nconst sampleListings=[{id:'listing-1',title:'Cozy Room in Soweto',price:2500,location:'Soweto, Johannesburg',description:'Comfortable room with bathroom and kitchen access',photos:[],status:'available',availableDate:new Date().toISOString(),amenities:['WiFi','Kitchen'],landlordId:'landlord-1',landlordName:'John Smith',landlordPhone:'+27 123 456 7890',landlordEmail:'john@example.com',landlordPhoto:'',createdAt:new Date().toISOString()},{id:'listing-2',title:'Modern Apartment in Sandton',price:4500,location:'Sandton, Johannesburg',description:'Luxurious apartment with parking and security',photos:[],status:'available',availableDate:new Date().toISOString(),amenities:['WiFi','Parking','Air Conditioning'],landlordId:'landlord-2',landlordName:'Jane Doe',landlordPhone:'+27 987 654 3210',landlordEmail:'jane@example.com',landlordPhoto:'',createdAt:new Date().toISOString()},{id:'listing-3',title:'Studio in Midrand',price:3200,location:'Midrand, Johannesburg',description:'Spacious studio flat with laundry facilities',photos:[],status:'available',availableDate:new Date().toISOString(),amenities:['Laundry','WiFi'],landlordId:'landlord-3',landlordName:'Mike Johnson',landlordPhone:'+27 555 555 5555',landlordEmail:'mike@example.com',landlordPhoto:'',createdAt:new Date().toISOString()}];setListings(sampleListings);}};// Helper: check for duplicate phone or email in registry (exclude an optional user id)\nconst isDuplicateContact=function(phone,email){let ignoreId=arguments.length>2&&arguments[2]!==undefined?arguments[2]:null;const normalizedPhone=(phone||'').trim();const normalizedEmail=(email||'').trim().toLowerCase();if(!users||users.length===0)return false;return users.some(u=>{if(ignoreId&&u.id===ignoreId)return false;const uPhone=(u.phone||'').trim();const uEmail=(u.email||'').trim().toLowerCase();const phoneMatch=normalizedPhone&&uPhone&&uPhone===normalizedPhone;const emailMatch=normalizedEmail&&uEmail&&uEmail===normalizedEmail;return phoneMatch||emailMatch;});};// Toast notification helper\nconst showToast=function(message){let type=arguments.length>1&&arguments[1]!==undefined?arguments[1]:'info';let title=arguments.length>2&&arguments[2]!==undefined?arguments[2]:'';setToast({message,type,title});setTimeout(()=>setToast(null),5000);};const handleAnalyticsConsentAccept=()=>{localStorage.setItem('analytics-consent','yes');setShowAnalyticsConsent(false);const app=initFirebase();initAnalytics(app);trackEvent('analytics_consent_granted');showToast('Analytics enabled','success','Thank you!');};const handleAnalyticsConsentDecline=()=>{localStorage.setItem('analytics-consent','no');setShowAnalyticsConsent(false);showToast('Analytics disabled','info');};const saveListings=async newListings=>{try{localStorage.setItem('listings',JSON.stringify(newListings));setListings(newListings);// Broadcast to runtime service worker for offline snapshot caching\nif(navigator.serviceWorker&&navigator.serviceWorker.controller){try{navigator.serviceWorker.controller.postMessage({type:'SYNC_LISTINGS',payload:newListings});}catch(_unused){}}}catch(error){console.error('Error saving listings:',error);}};const saveSubscriptions=async subscriptions=>{try{localStorage.setItem('subscriptions',JSON.stringify(subscriptions));}catch(error){console.error('Error saving subscriptions:',error);}};const getSubscriptions=async()=>{try{const res=localStorage.getItem('subscriptions');return res?JSON.parse(res):{};}catch(err){console.error('Error loading subscriptions',err);}return{};};const subscribeToArea=async(userId,area)=>{if(!userId){openAuthModal('renter');return;}if(!area||area.trim()===''){alert('Please enter a location to subscribe to.');return;}try{const subs=await getSubscriptions();subs[userId]=subs[userId]||[];if(!subs[userId].includes(area)){subs[userId].push(area);await saveSubscriptions(subs);alert(\"Subscribed to updates for \".concat(area));}else{alert(\"You are already subscribed to \".concat(area));}}catch(err){console.error('Subscribe failed',err);alert('Could not subscribe. Please try again.');}};const handleProfileSetup=async profileData=>{try{// Duplicate guard\nif(isDuplicateContact(profileData.phone,profileData.email)){showToast('Phone or email already registered','error','Duplicate');return;}const userId=\"user-\".concat(Date.now());const user=_objectSpread(_objectSpread({id:userId,type:userType},profileData),{},{whatsapp:profileData.whatsapp||'',notificationPrefs:{updates:true,marketing:false},createdAt:new Date().toISOString()});localStorage.setItem('current-user',JSON.stringify(user));setCurrentUser(user);// Update users registry\nconst existingUsersRaw=localStorage.getItem('users');let existingUsers=[];if(existingUsersRaw){try{existingUsers=JSON.parse(existingUsersRaw);}catch(_unused2){existingUsers=[];}}existingUsers.push(user);localStorage.setItem('users',JSON.stringify(existingUsers));setUsers(existingUsers);showToast('Profile created successfully!','success','Welcome!');setCurrentView('browse');}catch(error){console.error('Error saving profile:',error);// Still set the user locally even if storage fails\nconst userId=\"user-\".concat(Date.now());const user=_objectSpread(_objectSpread({id:userId,type:userType},profileData),{},{whatsapp:profileData.whatsapp||'',createdAt:new Date().toISOString()});setCurrentUser(user);const existingUsersRaw=localStorage.getItem('users');let existingUsers=[];if(existingUsersRaw){try{existingUsers=JSON.parse(existingUsersRaw);}catch(_unused3){existingUsers=[];}}existingUsers.push(user);try{localStorage.setItem('users',JSON.stringify(existingUsers));}catch(_unused4){}setUsers(existingUsers);showToast('Profile created (data may not be persisted)','error');setCurrentView('browse');}};const handleUpdateProfile=async profileData=>{try{// Duplicate guard (exclude current user id)\nif(isDuplicateContact(profileData.phone,profileData.email,currentUser===null||currentUser===void 0?void 0:currentUser.id)){showToast('Phone or email already used by another account','error','Duplicate');return;}const updatedUser=_objectSpread(_objectSpread({},currentUser),profileData);localStorage.setItem('current-user',JSON.stringify(updatedUser));setCurrentUser(updatedUser);// Update registry entry\nconst existingUsersRaw=localStorage.getItem('users');let existingUsers=[];if(existingUsersRaw){try{existingUsers=JSON.parse(existingUsersRaw);}catch(_unused5){existingUsers=[];}}const idx=existingUsers.findIndex(u=>u.id===updatedUser.id);if(idx!==-1){existingUsers[idx]=updatedUser;}else{existingUsers.push(updatedUser);// ensure presence\n}localStorage.setItem('users',JSON.stringify(existingUsers));setUsers(existingUsers);showToast('Profile updated successfully!','success');setCurrentView('browse');}catch(error){console.error('Error updating profile:',error);const updatedUser=_objectSpread(_objectSpread({},currentUser),profileData);setCurrentUser(updatedUser);const existingUsersRaw=localStorage.getItem('users');let existingUsers=[];if(existingUsersRaw){try{existingUsers=JSON.parse(existingUsersRaw);}catch(_unused6){existingUsers=[];}}const idx=existingUsers.findIndex(u=>u.id===updatedUser.id);if(idx!==-1){existingUsers[idx]=updatedUser;}else{existingUsers.push(updatedUser);}try{localStorage.setItem('users',JSON.stringify(existingUsers));}catch(_unused7){}setUsers(existingUsers);showToast('Profile updated (data may not be persisted)','error');setCurrentView('browse');}};const handleQuickAuth=async profileData=>{// Lightweight auth (used by AuthModal) - create and persist a user\ntry{if(isDuplicateContact(profileData.phone,profileData.email)){showToast('Phone or email already registered','error','Duplicate');return;}const userId=\"user-\".concat(Date.now());const user={id:userId,type:profileData.type||'renter',name:profileData.name,phone:profileData.phone||'',email:profileData.email||'',photo:profileData.photo||'',notificationPrefs:{updates:true,marketing:false},createdAt:new Date().toISOString()};localStorage.setItem('current-user',JSON.stringify(user));setCurrentUser(user);setUserType(user.type);// registry update\nconst existingUsersRaw=localStorage.getItem('users');let existingUsers=[];if(existingUsersRaw){try{existingUsers=JSON.parse(existingUsersRaw);}catch(_unused8){existingUsers=[];}}existingUsers.push(user);localStorage.setItem('users',JSON.stringify(existingUsers));setUsers(existingUsers);setShowAuthModal(false);// If landlord, route to onboarding to complete setup before posting\nif(user.type==='landlord'){setCurrentView('landlord-onboarding');}else{setCurrentView('browse');}}catch(err){console.error('Auth failed',err);}};// Sign out helper so you can re-auth as renter for perspective preview\nconst handleSignOut=()=>{try{localStorage.removeItem('current-user');}catch(e){console.warn('Could not clear localStorage current-user');}setCurrentUser(null);setUserType(null);setCurrentView('browse');showToast('Signed out. You can now sign in as Renter.','info');};const handleCompleteOnboarding=async onboardData=>{try{const updated=_objectSpread(_objectSpread({},currentUser),{},{landlordComplete:true,landlordInfo:onboardData});localStorage.setItem('current-user',JSON.stringify(updated));setCurrentUser(updated);setCurrentView('browse');}catch(err){console.error('Onboarding save failed',err);setCurrentUser(_objectSpread(_objectSpread({},currentUser),{},{landlordComplete:true,landlordInfo:onboardData}));setCurrentView('browse');}};const handleAddListing=async listingData=>{var _listingData$latitude,_listingData$longitud;// Combine streetAddress and location into fullAddress for complete address storage\nconst fullAddress=[listingData.streetAddress,listingData.location].filter(Boolean).join(', ');const newListingData={title:listingData.title,price:listingData.price,location:listingData.location,streetAddress:listingData.streetAddress||'',fullAddress:fullAddress||listingData.location||'',// Store complete address\ndescription:listingData.description,photos:listingData.photos||[],status:listingData.status||'available',availableDate:listingData.availableDate||new Date().toISOString(),amenities:listingData.amenities||[],latitude:(_listingData$latitude=listingData.latitude)!==null&&_listingData$latitude!==void 0?_listingData$latitude:null,longitude:(_listingData$longitud=listingData.longitude)!==null&&_listingData$longitud!==void 0?_listingData$longitud:null,paymentMethod:listingData.paymentMethod||'Bank and Cash',premium:!!listingData.premium,landlordId:currentUser.id,landlordName:currentUser.name,landlordPhone:currentUser.phone,landlordEmail:currentUser.email,landlordPhoto:currentUser.photo};try{// Try to save to Firestore first\nconst firestoreId=await addListing(newListingData);if(firestoreId){// Successfully saved to Firestore\nconst newListing=_objectSpread(_objectSpread({},newListingData),{},{id:firestoreId,createdAt:new Date().toISOString()});const updatedListings=[...listings,newListing];setListings(updatedListings);// Also cache locally\nlocalStorage.setItem('listings',JSON.stringify(updatedListings));showToast('Listing created and shared online!','success','Success!');}else{// Firestore not available, save locally only\nconst newListing=_objectSpread(_objectSpread({},newListingData),{},{id:\"listing-\".concat(Date.now()),createdAt:new Date().toISOString()});const updatedListings=[...listings,newListing];await saveListings(updatedListings);showToast('Listing saved locally (offline mode)','info','Saved');}}catch(error){console.error('Error adding listing:',error);// Fall back to local save\nconst newListing=_objectSpread(_objectSpread({},newListingData),{},{id:\"listing-\".concat(Date.now()),createdAt:new Date().toISOString()});const updatedListings=[...listings,newListing];await saveListings(updatedListings);showToast('Listing saved locally','info','Saved');}setCurrentView('browse');// Scroll to top to see new listing\nwindow.scrollTo({top:0,behavior:'smooth'});};// Messaging removed\nconst filteredListings=listings.filter(listing=>{const matchesLocation=!searchLocation||(listing.location||'').toLowerCase().includes(searchLocation.toLowerCase());const price=parseFloat(listing.price);const matchesPrice=price>=priceRange[0]&&price<=priceRange[1];const matchesAmenities=selectedAmenities.length===0||selectedAmenities.every(amenity=>{var _listing$amenities;return(_listing$amenities=listing.amenities)===null||_listing$amenities===void 0?void 0:_listing$amenities.includes(amenity);});return matchesLocation&&matchesPrice&&matchesAmenities;}).sort((a,b)=>{if(a.premium&&!b.premium)return-1;if(!a.premium&&b.premium)return 1;if(sortBy==='newest'){return new Date(b.createdAt)-new Date(a.createdAt);}else if(sortBy==='cheapest'){return parseFloat(a.price)-parseFloat(b.price);}else if(sortBy==='expensive'){return parseFloat(b.price)-parseFloat(a.price);}return 0;});// Allow guests to land on Browse by default. If userType isn't set,\n// show a gentle callout in the header (below) so users can pick a role\n// when they want to post or set up their profile.\nreturn/*#__PURE__*/_jsxs(\"div\",{className:\"min-h-screen bg-gradient-to-b from-slate-50 to-gray-100\",children:[/*#__PURE__*/_jsx(OfflineIndicator,{}),/*#__PURE__*/_jsx(BackToTop,{}),/*#__PURE__*/_jsx(Header,{currentUser:currentUser,previewAsRenter:previewAsRenter,setPreviewAsRenter:setPreviewAsRenter,openAuthModal:openAuthModal,handleSignOut:handleSignOut,setCurrentView:setCurrentView,unreadCount:unreadCount,onOpenNotifications:()=>setShowNotificationsPanel(true)}),notificationBanner&&/*#__PURE__*/_jsx(NotificationBanner,{title:notificationBanner.title,body:notificationBanner.body,onClose:()=>setNotificationBanner(null)}),toast&&/*#__PURE__*/_jsx(\"div\",{className:\"fixed top-20 right-4 z-50 max-w-sm w-full transition-all duration-300 \".concat(toast.type==='error'?'bg-gradient-to-r from-rose-50 to-red-50 border-rose-400':toast.type==='success'?'bg-gradient-to-r from-emerald-50 to-green-50 border-emerald-400':toast.type==='warning'?'bg-gradient-to-r from-amber-50 to-yellow-50 border-amber-400':'bg-gradient-to-r from-sky-50 to-blue-50 border-sky-400',\" border-l-4 rounded-xl shadow-2xl p-4 fade-in backdrop-blur-sm\"),children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-start gap-3\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex-shrink-0 w-8 h-8 rounded-xl flex items-center justify-center shadow-sm \".concat(toast.type==='error'?'bg-rose-500':toast.type==='success'?'bg-emerald-500':toast.type==='warning'?'bg-amber-500':'bg-sky-500'),children:[toast.type==='success'&&/*#__PURE__*/_jsx(CheckCircle,{className:\"w-5 h-5 text-white\"}),toast.type==='error'&&/*#__PURE__*/_jsx(\"span\",{className:\"text-white font-bold text-sm\",children:\"\\u2715\"}),toast.type==='warning'&&/*#__PURE__*/_jsx(\"span\",{className:\"text-white font-bold text-sm\",children:\"!\"}),toast.type==='info'&&/*#__PURE__*/_jsx(\"span\",{className:\"text-white font-bold text-sm\",children:\"i\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex-1 min-w-0\",children:[toast.title&&/*#__PURE__*/_jsx(\"p\",{className:\"font-bold mb-0.5 \".concat(toast.type==='error'?'text-rose-800':toast.type==='success'?'text-emerald-800':toast.type==='warning'?'text-amber-800':'text-sky-800'),children:toast.title}),/*#__PURE__*/_jsx(\"p\",{className:\"text-sm \".concat(toast.type==='error'?'text-rose-700':toast.type==='success'?'text-emerald-700':toast.type==='warning'?'text-amber-700':'text-sky-700'),children:toast.message})]}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>setToast(null),className:\"flex-shrink-0 p-1.5 rounded-lg hover:bg-white/50 transition \".concat(toast.type==='error'?'text-rose-500 hover:text-rose-700':toast.type==='success'?'text-emerald-500 hover:text-emerald-700':toast.type==='warning'?'text-amber-500 hover:text-amber-700':'text-sky-500 hover:text-sky-700'),\"aria-label\":\"Close notification\",children:/*#__PURE__*/_jsx(X,{className:\"w-4 h-4\"})})]})}),/*#__PURE__*/_jsxs(\"div\",{id:\"main-content\",className:\"max-w-7xl mx-auto pb-24 px-4 sm:px-6 lg:px-8\",role:\"main\",children:[currentView==='setup-profile'&&/*#__PURE__*/_jsx(ProfileSetupView,{onSubmit:handleProfileSetup,userType:userType}),currentView==='profile'&&currentUser&&/*#__PURE__*/_jsx(ProfileView,{user:currentUser,onEdit:()=>setCurrentView('edit-profile'),onUpdatePrefs:prefs=>{const updated=_objectSpread(_objectSpread({},currentUser),{},{notificationPrefs:prefs});setCurrentUser(updated);try{localStorage.setItem('current-user',JSON.stringify(updated));// update registry\nconst raw=localStorage.getItem('users');if(raw){try{const arr=JSON.parse(raw);const idx=arr.findIndex(u=>u.id===updated.id);if(idx!==-1){arr[idx]=updated;localStorage.setItem('users',JSON.stringify(arr));}}catch(_unused9){}}}catch(_unused0){}showToast('Preferences updated','success');}}),currentView==='edit-profile'&&currentUser&&/*#__PURE__*/_jsx(EditProfileView,{user:currentUser,onSubmit:handleUpdateProfile,onCancel:()=>setCurrentView('profile')}),currentView==='landlord-onboarding'&&currentUser&&userType==='landlord'&&/*#__PURE__*/_jsx(LandlordOnboardingView,{onComplete:handleCompleteOnboarding,onCancel:()=>setCurrentView('browse'),currentUser:currentUser}),currentView==='browse'&&/*#__PURE__*/_jsx(BrowseView,{listings:filteredListings,searchLocation:searchLocation,setSearchLocation:setSearchLocation,priceRange:priceRange,setPriceRange:setPriceRange,selectedAmenities:selectedAmenities,setSelectedAmenities:setSelectedAmenities,sortBy:sortBy,setSortBy:setSortBy,onSelectListing:setSelectedListing,setCurrentView:setCurrentView,currentUser:currentUser,onRequireAuth:openAuthModal,subscribeToArea:subscribeToArea,previewMode:previewAsRenter}),currentView==='add'&&/*#__PURE__*/_jsx(AddListingView,{onSubmit:handleAddListing,onCancel:()=>setCurrentView('browse'),currentUser:currentUser,userType:userType,onRequireAuth:openAuthModal,onRequireOnboarding:()=>setCurrentView('landlord-onboarding')}),currentView==='my-listings'&&currentUser&&userType==='landlord'&&/*#__PURE__*/_jsx(MyListingsView,{listings:listings.filter(l=>l.landlordId===currentUser.id),onDelete:async id=>{try{// Try to delete from Firestore first\nconst deleted=await deleteListing(id);if(deleted){showToast('Listing deleted','success');}}catch(error){console.error('Firestore delete failed:',error);}// Also update local state and localStorage\nconst updated=listings.filter(l=>l.id!==id);setListings(updated);localStorage.setItem('listings',JSON.stringify(updated));}}),currentView==='favorites'&&/*#__PURE__*/_jsx(FavoritesView,{listings:listings,onSelectListing:setSelectedListing})]}),selectedListing&&/*#__PURE__*/_jsx(ListingDetailModal,{listing:selectedListing,landlord:{name:selectedListing.landlordName,phone:selectedListing.landlordPhone,email:selectedListing.landlordEmail,photo:selectedListing.landlordPhoto},onClose:()=>setSelectedListing(null),userType:userType,currentUser:currentUser,onRequireAuth:openAuthModal,previewMode:previewAsRenter,showToast:showToast}),showAuthModal&&/*#__PURE__*/_jsx(AuthModal,{defaultType:authDefaultType,onClose:()=>setShowAuthModal(false),onSubmit:handleQuickAuth}),/*#__PURE__*/_jsx(BottomNav,{currentView:currentView,setCurrentView:setCurrentView,userType:userType}),showPrivacyPolicy&&/*#__PURE__*/_jsx(PrivacyPolicyModal,{onClose:()=>setShowPrivacyPolicy(false)}),showAnalyticsConsent&&/*#__PURE__*/_jsx(AnalyticsConsentModal,{onAccept:handleAnalyticsConsentAccept,onDecline:handleAnalyticsConsentDecline}),showNotificationsPanel&&/*#__PURE__*/_jsx(NotificationsPanel,{onClose:()=>{setShowNotificationsPanel(false);setUnreadCount(getNotifications().filter(n=>!n.read).length);},onSelectListing:listingId=>{const listing=listings.find(l=>(l.id||\"\".concat(l.title,\"-\").concat(l.createdAt))===listingId);if(listing){setSelectedListing(listing);}setShowNotificationsPanel(false);}}),/*#__PURE__*/_jsx(Footer,{onOpenPrivacy:()=>setShowPrivacyPolicy(true)})]});}function ProfileSetupView(_ref){let{onSubmit,userType}=_ref;const[formData,setFormData]=useState({name:'',phone:'',email:'',whatsapp:'',photo:''});const[errors,setErrors]=useState({});const[touched,setTouched]=useState({});const validateField=function(name,value){let extras=arguments.length>2&&arguments[2]!==undefined?arguments[2]:{};const newErrors=_objectSpread({},errors);switch(name){case'name':if(!value||value.trim().length<2){newErrors.name='Name must be at least 2 characters';}else{delete newErrors.name;}break;case'phone':if(!value||!/^[+]?[-0-9()\\s]{7,}$/.test(value.trim())){newErrors.phone='Enter a valid phone number (min 7 digits)';}else{delete newErrors.phone;}break;case'email':if(!value||!/^[^@\\s]+@[^@\\s]+\\.[^@\\s]+$/.test(value.trim())){newErrors.email='Enter a valid email address';}else{delete newErrors.email;}break;case'photo':if(value==='FILE_TOO_LARGE'){newErrors.photo='Photo is too large (max 2MB)';}else{delete newErrors.photo;}break;default:break;}setErrors(newErrors);};const handlePhotoUpload=e=>{const file=e.target.files[0];if(file){if(file.size>2*1024*1024){// 2MB limit\nsetFormData(_objectSpread(_objectSpread({},formData),{},{photo:''}));validateField('photo','FILE_TOO_LARGE');return;}const reader=new FileReader();reader.onloadend=()=>{setFormData(_objectSpread(_objectSpread({},formData),{},{photo:reader.result}));validateField('photo',reader.result);};reader.readAsDataURL(file);}};const handleSubmit=()=>{// Touch all fields\nconst allTouched={name:true,phone:true,email:true,photo:true};setTouched(allTouched);validateField('name',formData.name);validateField('phone',formData.phone);validateField('email',formData.email);if(Object.keys(errors).length===0&&formData.name&&formData.phone&&formData.email){onSubmit(formData);}};return/*#__PURE__*/_jsx(\"div\",{className:\"p-4 min-h-screen bg-gradient-to-b from-slate-50 to-gray-100 pb-24\",children:/*#__PURE__*/_jsx(\"div\",{className:\"max-w-2xl mx-auto mt-8\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white rounded-2xl shadow-lg border border-gray-100 p-8\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"text-center mb-8\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\"text-3xl font-extrabold text-gray-900 mb-2\",children:\"Complete Your Profile\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-gray-600\",children:\"Help others know who you are\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-6\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"flex justify-center mb-8\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"relative\",children:[formData.photo?/*#__PURE__*/_jsx(\"img\",{src:formData.photo,alt:\"Profile\",className:\"w-32 h-32 rounded-full object-cover border-4 border-blue-200 shadow-lg\"}):/*#__PURE__*/_jsx(\"div\",{className:\"w-32 h-32 rounded-full bg-gradient-to-br from-blue-100 to-blue-200 flex items-center justify-center border-4 border-blue-200 shadow-lg\",children:/*#__PURE__*/_jsx(User,{className:\"w-16 h-16 text-blue-600\"})}),/*#__PURE__*/_jsxs(\"label\",{className:\"absolute bottom-0 right-0 bg-blue-600 hover:bg-blue-700 text-white p-3 rounded-full cursor-pointer shadow-lg transition group\",\"aria-label\":\"Upload profile photo\",children:[/*#__PURE__*/_jsx(Edit,{className:\"w-5 h-5\"}),/*#__PURE__*/_jsx(\"input\",{type:\"file\",accept:\"image/*\",onChange:handlePhotoUpload,className:\"hidden\"})]})]})}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-semibold text-gray-800 mb-2\",children:\"Full Name *\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",required:true,value:formData.name,onChange:e=>{setFormData(_objectSpread(_objectSpread({},formData),{},{name:e.target.value}));if(touched.name)validateField('name',e.target.value);},onBlur:e=>{setTouched(_objectSpread(_objectSpread({},touched),{},{name:true}));validateField('name',e.target.value);},placeholder:\"Enter your full name\",\"aria-invalid\":errors.name?'true':'false',\"aria-describedby\":errors.name?'profile-name-error':undefined,className:\"w-full px-4 py-3 border-2 \".concat(errors.name?'border-red-400':'border-gray-200',\" bg-white text-gray-800 rounded-xl focus:ring-2 focus:ring-teal-400 focus:border-transparent transition placeholder-gray-400\")}),errors.name&&touched.name&&/*#__PURE__*/_jsx(\"p\",{id:\"profile-name-error\",className:\"mt-1 text-xs text-red-600\",children:errors.name})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-semibold text-gray-800 mb-2\",children:\"Phone Number *\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"relative\",children:[/*#__PURE__*/_jsx(Phone,{className:\"absolute left-4 top-3.5 w-5 h-5 text-gray-400\"}),/*#__PURE__*/_jsx(\"input\",{type:\"tel\",required:true,value:formData.phone,onChange:e=>{setFormData(_objectSpread(_objectSpread({},formData),{},{phone:e.target.value}));if(touched.phone)validateField('phone',e.target.value);},onBlur:e=>{setTouched(_objectSpread(_objectSpread({},touched),{},{phone:true}));validateField('phone',e.target.value);},placeholder:\"e.g., +27 12 345 6789\",\"aria-invalid\":errors.phone?'true':'false',\"aria-describedby\":errors.phone?'profile-phone-error':undefined,className:\"w-full pl-11 pr-4 py-3 border-2 \".concat(errors.phone?'border-red-400':'border-gray-200',\" bg-white text-gray-800 rounded-xl focus:ring-2 focus:ring-teal-400 focus:border-transparent transition placeholder-gray-400\")})]}),errors.phone&&touched.phone&&/*#__PURE__*/_jsx(\"p\",{id:\"profile-phone-error\",className:\"mt-1 text-xs text-red-600\",children:errors.phone})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-semibold text-gray-800 mb-2\",children:\"Email Address *\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"relative\",children:[/*#__PURE__*/_jsx(Mail,{className:\"absolute left-4 top-3.5 w-5 h-5 text-gray-400\"}),/*#__PURE__*/_jsx(\"input\",{type:\"email\",required:true,value:formData.email,onChange:e=>{setFormData(_objectSpread(_objectSpread({},formData),{},{email:e.target.value}));if(touched.email)validateField('email',e.target.value);},onBlur:e=>{setTouched(_objectSpread(_objectSpread({},touched),{},{email:true}));validateField('email',e.target.value);},placeholder:\"your.email@example.com\",\"aria-invalid\":errors.email?'true':'false',\"aria-describedby\":errors.email?'profile-email-error':undefined,className:\"w-full pl-11 pr-4 py-3 border-2 \".concat(errors.email?'border-red-400':'border-gray-200',\" bg-white text-gray-800 rounded-xl focus:ring-2 focus:ring-teal-400 focus:border-transparent transition placeholder-gray-400\")})]}),errors.email&&touched.email&&/*#__PURE__*/_jsx(\"p\",{id:\"profile-email-error\",className:\"mt-1 text-xs text-red-600\",children:errors.email})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-semibold text-gray-800 mb-2\",children:\"WhatsApp (optional)\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"relative\",children:[/*#__PURE__*/_jsx(Phone,{className:\"absolute left-4 top-3.5 w-5 h-5 text-gray-400\"}),/*#__PURE__*/_jsx(\"input\",{type:\"tel\",value:formData.whatsapp,onChange:e=>setFormData(_objectSpread(_objectSpread({},formData),{},{whatsapp:e.target.value})),placeholder:\"e.g., +27 71 234 5678\",className:\"w-full pl-11 pr-4 py-3 border-2 border-gray-200 bg-white text-gray-800 rounded-xl focus:ring-2 focus:ring-teal-400 focus:border-transparent transition placeholder-gray-400\"})]}),/*#__PURE__*/_jsx(\"p\",{className:\"text-xs text-gray-500 mt-1\",children:\"Used to create a WhatsApp chat link on your listings.\"})]}),/*#__PURE__*/_jsx(\"button\",{onClick:handleSubmit,className:\"w-full bg-gradient-to-r from-teal-500 to-cyan-500 hover:from-teal-600 hover:to-cyan-600 text-white font-semibold py-3 rounded-xl transition mt-8 shadow-lg hover:shadow-xl\",children:\"Complete Setup\"})]})]})})});}function ProfileView(_ref2){var _user$name,_user$name$charAt;let{user,onEdit,onUpdatePrefs}=_ref2;const prefs=user.notificationPrefs||{updates:true,marketing:false};const[localPrefs,setLocalPrefs]=React.useState(prefs);const togglePref=key=>{const next=_objectSpread(_objectSpread({},localPrefs),{},{[key]:!localPrefs[key]});setLocalPrefs(next);onUpdatePrefs&&onUpdatePrefs(next);};return/*#__PURE__*/_jsxs(\"div\",{className:\"min-h-screen bg-gradient-to-b from-slate-50 to-gray-100 pb-24\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"bg-gradient-to-br from-teal-600 via-teal-500 to-cyan-500 pt-8 pb-20 px-4\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"max-w-xl mx-auto flex justify-between items-start\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\"text-2xl font-bold text-white\",children:\"My Profile\"}),/*#__PURE__*/_jsxs(\"button\",{onClick:onEdit,className:\"bg-white/20 hover:bg-white/30 backdrop-blur-sm text-white px-4 py-2 rounded-xl transition-all duration-200 flex items-center gap-2 border border-white/30\",children:[/*#__PURE__*/_jsx(Edit,{className:\"w-4 h-4\"}),\"Edit\"]})]})}),/*#__PURE__*/_jsx(\"div\",{className:\"px-4 -mt-16\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white rounded-2xl shadow-xl border border-gray-100 p-6 max-w-xl mx-auto\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex flex-col items-center -mt-16 mb-6\",children:[user.photo?/*#__PURE__*/_jsx(\"img\",{src:user.photo,alt:\"Profile\",className:\"w-28 h-28 rounded-2xl object-cover border-4 border-white shadow-lg mb-4\"}):/*#__PURE__*/_jsx(\"div\",{className:\"w-28 h-28 rounded-2xl bg-gradient-to-br from-teal-400 to-cyan-500 flex items-center justify-center border-4 border-white shadow-lg mb-4\",children:/*#__PURE__*/_jsx(\"span\",{className:\"text-4xl font-bold text-white\",children:((_user$name=user.name)===null||_user$name===void 0?void 0:(_user$name$charAt=_user$name.charAt(0))===null||_user$name$charAt===void 0?void 0:_user$name$charAt.toUpperCase())||'U'})}),/*#__PURE__*/_jsx(\"h3\",{className:\"text-2xl font-bold text-gray-900\",children:user.name}),/*#__PURE__*/_jsx(\"span\",{className:\"inline-flex items-center mt-2 px-4 py-1.5 bg-gradient-to-r from-teal-50 to-cyan-50 text-teal-700 rounded-full text-sm font-semibold border border-teal-100\",children:user.type==='landlord'?/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(Home,{className:\"w-4 h-4 mr-1.5\"}),\"Landlord\"]}):/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(User,{className:\"w-4 h-4 mr-1.5\"}),\"Renter\"]})})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-3 mb-6\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"bg-gradient-to-r from-gray-50 to-slate-50 rounded-xl p-4 border border-gray-100 hover:border-gray-200 transition-colors\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"w-11 h-11 bg-gradient-to-br from-teal-100 to-cyan-100 rounded-xl flex items-center justify-center mr-4 shadow-sm\",children:/*#__PURE__*/_jsx(Phone,{className:\"w-5 h-5 text-teal-600\"})}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-xs font-medium text-gray-500 mb-0.5\",children:\"Phone Number\"}),/*#__PURE__*/_jsx(\"p\",{className:\"font-semibold text-gray-800\",children:user.phone})]})]})}),/*#__PURE__*/_jsx(\"div\",{className:\"bg-gradient-to-r from-gray-50 to-slate-50 rounded-xl p-4 border border-gray-100 hover:border-gray-200 transition-colors\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"w-11 h-11 bg-gradient-to-br from-cyan-100 to-blue-100 rounded-xl flex items-center justify-center mr-4 shadow-sm\",children:/*#__PURE__*/_jsx(Mail,{className:\"w-5 h-5 text-cyan-600\"})}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-xs font-medium text-gray-500 mb-0.5\",children:\"Email Address\"}),/*#__PURE__*/_jsx(\"p\",{className:\"font-semibold text-gray-800\",children:user.email})]})]})}),/*#__PURE__*/_jsx(\"div\",{className:\"bg-gradient-to-r from-gray-50 to-slate-50 rounded-xl p-4 border border-gray-100 hover:border-gray-200 transition-colors\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"w-11 h-11 bg-gradient-to-br from-violet-100 to-purple-100 rounded-xl flex items-center justify-center mr-4 shadow-sm\",children:/*#__PURE__*/_jsx(Calendar,{className:\"w-5 h-5 text-violet-600\"})}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-xs font-medium text-gray-500 mb-0.5\",children:\"Member Since\"}),/*#__PURE__*/_jsx(\"p\",{className:\"font-semibold text-gray-800\",children:new Date(user.createdAt).toLocaleDateString('en-ZA',{year:'numeric',month:'long',day:'numeric'})})]})]})})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"bg-gradient-to-br from-teal-50 via-cyan-50 to-sky-50 rounded-xl p-5 border border-teal-100\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center gap-3 mb-4\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"w-10 h-10 bg-gradient-to-br from-teal-500 to-cyan-500 rounded-xl flex items-center justify-center shadow-sm\",children:/*#__PURE__*/_jsx(Bell,{className:\"w-5 h-5 text-white\"})}),/*#__PURE__*/_jsx(\"h4\",{className:\"font-bold text-gray-800\",children:\"Notification Preferences\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-3\",children:[/*#__PURE__*/_jsxs(\"label\",{className:\"flex items-center gap-3 p-3 bg-white rounded-lg border border-gray-100 cursor-pointer hover:border-teal-200 transition-colors\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"checkbox\",checked:localPrefs.updates,onChange:()=>togglePref('updates'),className:\"w-5 h-5 rounded border-gray-300 text-teal-600 focus:ring-teal-500\"}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-sm font-medium text-gray-800\",children:\"Room Alerts\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-xs text-gray-500\",children:\"Get notified about new rooms in your saved areas\"})]})]}),/*#__PURE__*/_jsxs(\"label\",{className:\"flex items-center gap-3 p-3 bg-white rounded-lg border border-gray-100 cursor-pointer hover:border-teal-200 transition-colors\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"checkbox\",checked:localPrefs.marketing,onChange:()=>togglePref('marketing'),className:\"w-5 h-5 rounded border-gray-300 text-teal-600 focus:ring-teal-500\"}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-sm font-medium text-gray-800\",children:\"Tips & Updates\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-xs text-gray-500\",children:\"Occasional features and helpful content\"})]})]})]}),/*#__PURE__*/_jsx(\"p\",{className:\"text-[11px] text-gray-500 mt-3 text-center\",children:\"Changes save automatically \\u2022 You can opt out anytime\"})]})]})})]});}function LandlordOnboardingView(_ref3){var _currentUser$name,_currentUser$name$cha;let{onComplete,onCancel,currentUser}=_ref3;const[form,setForm]=useState({businessName:(currentUser===null||currentUser===void 0?void 0:currentUser.name)||'',bankDetails:'',idNumber:'',agree:false});const handleSubmit=()=>{if(!form.businessName||!form.agree){alert('Please provide a display name and agree to the terms.');return;}onComplete(form);};return/*#__PURE__*/_jsxs(\"div\",{className:\"min-h-screen bg-gradient-to-b from-slate-50 to-gray-100 pb-24\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"bg-gradient-to-br from-teal-600 via-teal-500 to-cyan-500 pt-8 pb-16 px-4\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"max-w-2xl mx-auto text-center\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"w-20 h-20 bg-white/20 backdrop-blur-sm rounded-2xl flex items-center justify-center mx-auto mb-4 border border-white/30\",children:/*#__PURE__*/_jsx(\"span\",{className:\"text-4xl font-bold text-white\",children:(currentUser===null||currentUser===void 0?void 0:(_currentUser$name=currentUser.name)===null||_currentUser$name===void 0?void 0:(_currentUser$name$cha=_currentUser$name.charAt(0))===null||_currentUser$name$cha===void 0?void 0:_currentUser$name$cha.toUpperCase())||'L'})}),/*#__PURE__*/_jsxs(\"h2\",{className:\"text-2xl font-bold text-white mb-2\",children:[\"Welcome, \",(currentUser===null||currentUser===void 0?void 0:currentUser.name)||'Landlord',\"!\"]}),/*#__PURE__*/_jsx(\"p\",{className:\"text-teal-100\",children:\"Complete your profile to start listing properties\"})]})}),/*#__PURE__*/_jsx(\"div\",{className:\"px-4 -mt-8\",children:/*#__PURE__*/_jsx(\"div\",{className:\"max-w-2xl mx-auto\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white rounded-2xl shadow-xl border border-gray-100 p-8\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-center gap-2 mb-8\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center gap-2\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"w-8 h-8 bg-teal-600 text-white rounded-full flex items-center justify-center text-sm font-bold\",children:\"1\"}),/*#__PURE__*/_jsx(\"span\",{className:\"text-sm font-medium text-gray-700\",children:\"Profile Details\"})]}),/*#__PURE__*/_jsx(\"div\",{className:\"w-8 h-0.5 bg-gray-200\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center gap-2\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"w-8 h-8 bg-gray-200 text-gray-500 rounded-full flex items-center justify-center text-sm font-bold\",children:\"2\"}),/*#__PURE__*/_jsx(\"span\",{className:\"text-sm text-gray-400\",children:\"Start Listing\"})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-5\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-semibold text-gray-800 mb-2\",children:\"Display Name *\"}),/*#__PURE__*/_jsx(\"input\",{value:form.businessName,onChange:e=>setForm(_objectSpread(_objectSpread({},form),{},{businessName:e.target.value})),className:\"w-full px-4 py-3 border border-gray-200 rounded-xl focus:ring-2 focus:ring-teal-500 focus:border-teal-500 transition-all\",placeholder:\"Your name or business name\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-xs text-gray-500 mt-1.5\",children:\"This name is shown to renters on your listings and messages.\"})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-semibold text-gray-800 mb-2\",children:\"Payment Details (Optional)\"}),/*#__PURE__*/_jsx(\"input\",{value:form.bankDetails,onChange:e=>setForm(_objectSpread(_objectSpread({},form),{},{bankDetails:e.target.value})),placeholder:\"Bank account or preferred payment method\",className:\"w-full px-4 py-3 border border-gray-200 rounded-xl focus:ring-2 focus:ring-teal-500 focus:border-teal-500 transition-all\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-xs text-gray-500 mt-1.5\",children:\"Private - only shown to confirmed renters.\"})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-semibold text-gray-800 mb-2\",children:\"ID Number (Optional)\"}),/*#__PURE__*/_jsx(\"input\",{value:form.idNumber,onChange:e=>setForm(_objectSpread(_objectSpread({},form),{},{idNumber:e.target.value})),className:\"w-full px-4 py-3 border border-gray-200 rounded-xl focus:ring-2 focus:ring-teal-500 focus:border-teal-500 transition-all\",placeholder:\"For verification purposes\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-xs text-gray-500 mt-1.5\",children:\"Verified landlords get a trust badge on their listings.\"})]}),/*#__PURE__*/_jsx(\"div\",{className:\"bg-gradient-to-r from-teal-50 to-cyan-50 rounded-xl p-4 border border-teal-100\",children:/*#__PURE__*/_jsxs(\"label\",{className:\"flex items-start gap-3 cursor-pointer\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"checkbox\",checked:form.agree,onChange:e=>setForm(_objectSpread(_objectSpread({},form),{},{agree:e.target.checked})),className:\"mt-1 w-5 h-5 rounded border-gray-300 text-teal-600 focus:ring-teal-500\"}),/*#__PURE__*/_jsxs(\"span\",{className:\"text-sm text-gray-700\",children:[\"I confirm I am authorised to list these properties and agree to the\",' ',/*#__PURE__*/_jsx(\"button\",{type:\"button\",onClick:e=>e.preventDefault(),className:\"text-teal-600 hover:text-teal-700 font-medium underline\",children:\"terms of service\"}),\".\"]})]})}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex gap-3 pt-4\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:onCancel,className:\"flex-1 bg-gray-100 hover:bg-gray-200 text-gray-700 font-medium py-3.5 rounded-xl transition-colors\",children:\"Cancel\"}),/*#__PURE__*/_jsx(\"button\",{onClick:handleSubmit,className:\"flex-1 bg-gradient-to-r from-teal-600 to-cyan-600 hover:from-teal-700 hover:to-cyan-700 text-white font-semibold py-3.5 rounded-xl transition-all shadow-md hover:shadow-lg\",children:\"Complete & Start Listing\"})]})]})]})})})]});}function EditProfileView(_ref4){let{user,onSubmit,onCancel}=_ref4;const[formData,setFormData]=useState({name:user.name||'',phone:user.phone||'',email:user.email||'',whatsapp:user.whatsapp||'',photo:user.photo||''});const[errors,setErrors]=useState({});const[touched,setTouched]=useState({});const validateField=function(name,value){let extras=arguments.length>2&&arguments[2]!==undefined?arguments[2]:{};const newErrors=_objectSpread({},errors);switch(name){case'name':if(!value||value.trim().length<2){newErrors.name='Name must be at least 2 characters';}else{delete newErrors.name;}break;case'phone':if(!value||!/^[+]?[-0-9()\\s]{7,}$/.test(value.trim())){newErrors.phone='Enter a valid phone number';}else{delete newErrors.phone;}break;case'email':if(!value||!/^[^@\\s]+@[^@\\s]+\\.[^@\\s]+$/.test(value.trim())){newErrors.email='Enter a valid email';}else{delete newErrors.email;}break;default:break;}setErrors(newErrors);};const handlePhotoUpload=e=>{const file=e.target.files[0];if(file){const reader=new FileReader();reader.onloadend=()=>{setFormData(_objectSpread(_objectSpread({},formData),{},{photo:reader.result}));};reader.readAsDataURL(file);}};const handleSubmit=()=>{setTouched({name:true,phone:true,email:true});validateField('name',formData.name);validateField('phone',formData.phone);validateField('email',formData.email);if(Object.keys(errors).length===0&&formData.name&&formData.phone&&formData.email){onSubmit(formData);}};return/*#__PURE__*/_jsx(\"div\",{className:\"p-4 min-h-screen bg-gradient-to-b from-slate-50 to-gray-100 pb-24\",children:/*#__PURE__*/_jsx(\"div\",{className:\"max-w-2xl mx-auto mt-8\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white rounded-2xl shadow-lg border border-gray-100 p-8\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between mb-8\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\"text-3xl font-extrabold text-gray-900\",children:\"Edit Profile\"}),/*#__PURE__*/_jsx(\"button\",{onClick:onCancel,className:\"text-gray-400 hover:text-gray-600 transition\",children:/*#__PURE__*/_jsx(X,{className:\"w-6 h-6\"})})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-6\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"flex justify-center mb-8\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"relative\",children:[formData.photo?/*#__PURE__*/_jsx(\"img\",{src:formData.photo,alt:\"Profile\",className:\"w-32 h-32 rounded-full object-cover border-4 border-blue-200 shadow-lg\"}):/*#__PURE__*/_jsx(\"div\",{className:\"w-32 h-32 rounded-full bg-gradient-to-br from-blue-100 to-blue-200 flex items-center justify-center border-4 border-blue-200 shadow-lg\",children:/*#__PURE__*/_jsx(User,{className:\"w-16 h-16 text-blue-600\"})}),/*#__PURE__*/_jsxs(\"label\",{className:\"absolute bottom-0 right-0 bg-blue-600 hover:bg-blue-700 text-white p-3 rounded-full cursor-pointer shadow-lg transition\",\"aria-label\":\"Upload new profile photo\",children:[/*#__PURE__*/_jsx(Edit,{className:\"w-5 h-5\"}),/*#__PURE__*/_jsx(\"input\",{type:\"file\",accept:\"image/*\",onChange:handlePhotoUpload,className:\"hidden\"})]})]})}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-semibold text-gray-800 mb-2\",children:\"Full Name\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",required:true,value:formData.name,onChange:e=>{setFormData(_objectSpread(_objectSpread({},formData),{},{name:e.target.value}));if(touched.name)validateField('name',e.target.value);},onBlur:e=>{setTouched(_objectSpread(_objectSpread({},touched),{},{name:true}));validateField('name',e.target.value);},\"aria-invalid\":errors.name?'true':'false',\"aria-describedby\":errors.name?'edit-name-error':undefined,className:\"w-full px-4 py-3 border-2 \".concat(errors.name?'border-red-400':'border-gray-200',\" bg-white text-gray-800 rounded-xl focus:ring-2 focus:ring-teal-400 focus:border-transparent transition placeholder-gray-400\")}),errors.name&&touched.name&&/*#__PURE__*/_jsx(\"p\",{id:\"edit-name-error\",className:\"mt-1 text-xs text-red-600\",children:errors.name})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-semibold text-gray-800 mb-2\",children:\"Phone Number\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"relative\",children:[/*#__PURE__*/_jsx(Phone,{className:\"absolute left-4 top-3.5 w-5 h-5 text-gray-400\"}),/*#__PURE__*/_jsx(\"input\",{type:\"tel\",required:true,value:formData.phone,onChange:e=>{setFormData(_objectSpread(_objectSpread({},formData),{},{phone:e.target.value}));if(touched.phone)validateField('phone',e.target.value);},onBlur:e=>{setTouched(_objectSpread(_objectSpread({},touched),{},{phone:true}));validateField('phone',e.target.value);},\"aria-invalid\":errors.phone?'true':'false',\"aria-describedby\":errors.phone?'edit-phone-error':undefined,className:\"w-full pl-11 pr-4 py-3 border-2 \".concat(errors.phone?'border-red-400':'border-gray-200',\" bg-white text-gray-800 rounded-xl focus:ring-2 focus:ring-teal-400 focus:border-transparent transition placeholder-gray-400\")})]}),errors.phone&&touched.phone&&/*#__PURE__*/_jsx(\"p\",{id:\"edit-phone-error\",className:\"mt-1 text-xs text-red-600\",children:errors.phone})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-semibold text-gray-800 mb-2\",children:\"Email Address\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"relative\",children:[/*#__PURE__*/_jsx(Mail,{className:\"absolute left-4 top-3.5 w-5 h-5 text-gray-400\"}),/*#__PURE__*/_jsx(\"input\",{type:\"email\",required:true,value:formData.email,onChange:e=>{setFormData(_objectSpread(_objectSpread({},formData),{},{email:e.target.value}));if(touched.email)validateField('email',e.target.value);},onBlur:e=>{setTouched(_objectSpread(_objectSpread({},touched),{},{email:true}));validateField('email',e.target.value);},\"aria-invalid\":errors.email?'true':'false',\"aria-describedby\":errors.email?'edit-email-error':undefined,className:\"w-full pl-11 pr-4 py-3 border-2 \".concat(errors.email?'border-red-400':'border-gray-200',\" bg-white text-gray-800 rounded-xl focus:ring-2 focus:ring-teal-400 focus:border-transparent transition placeholder-gray-400\")})]}),errors.email&&touched.email&&/*#__PURE__*/_jsx(\"p\",{id:\"edit-email-error\",className:\"mt-1 text-xs text-red-600\",children:errors.email})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-semibold text-gray-800 mb-2\",children:\"WhatsApp (optional)\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"relative\",children:[/*#__PURE__*/_jsx(Phone,{className:\"absolute left-4 top-3.5 w-5 h-5 text-gray-400\"}),/*#__PURE__*/_jsx(\"input\",{type:\"tel\",value:formData.whatsapp,onChange:e=>setFormData(_objectSpread(_objectSpread({},formData),{},{whatsapp:e.target.value})),placeholder:\"e.g., +27 71 234 5678\",className:\"w-full pl-11 pr-4 py-3 border-2 border-gray-200 bg-white text-gray-800 rounded-xl focus:ring-2 focus:ring-teal-400 focus:border-transparent transition placeholder-gray-400\"})]}),/*#__PURE__*/_jsx(\"p\",{className:\"text-xs text-gray-500 mt-1\",children:\"Used to create a WhatsApp chat link on your listings.\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex gap-3 pt-6 border-t border-gray-200\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:onCancel,className:\"flex-1 bg-gray-100 hover:bg-gray-200 text-gray-800 font-semibold py-3 rounded-xl transition\",children:\"Cancel\"}),/*#__PURE__*/_jsx(\"button\",{onClick:handleSubmit,className:\"flex-1 bg-gradient-to-r from-teal-500 to-cyan-500 hover:from-teal-600 hover:to-cyan-600 text-white font-semibold py-3 rounded-xl transition shadow-lg\",children:\"Save Changes\"})]})]})]})})});}/* BrowseView extracted to components/BrowseView.jsx */function FavoritesView(_ref5){let{listings,onSelectListing}=_ref5;const[favorites,setFavorites]=useState([]);useEffect(()=>{try{const rawFavorites=localStorage.getItem('favorites');if(rawFavorites){const arr=JSON.parse(rawFavorites);if(Array.isArray(arr))setFavorites(arr);}}catch(_unused1){}},[]);const toggleFavorite=listingId=>{setFavorites(prev=>{const updated=prev.filter(id=>id!==listingId);try{localStorage.setItem('favorites',JSON.stringify(updated));}catch(_unused10){}return updated;});};const favoriteListings=listings.filter(l=>favorites.includes(l.id));return/*#__PURE__*/_jsx(\"div\",{className:\"p-4 min-h-screen bg-gradient-to-b from-slate-50 to-gray-100 pb-24\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"max-w-7xl mx-auto mt-8\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"mb-8\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center gap-4 mb-3\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"w-14 h-14 bg-gradient-to-br from-rose-100 to-pink-100 rounded-2xl flex items-center justify-center shadow-sm\",children:/*#__PURE__*/_jsx(Heart,{className:\"w-7 h-7 text-rose-500 fill-rose-500\"})}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h2\",{className:\"text-3xl font-extrabold text-gray-900\",children:\"Saved Listings\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-gray-600\",children:favoriteListings.length===0?'Your favorites will appear here':\"\".concat(favoriteListings.length,\" saved \").concat(favoriteListings.length===1?'listing':'listings')})]})]})}),favoriteListings.length===0?/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white rounded-2xl border border-gray-100 shadow-sm p-12 text-center\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"w-24 h-24 bg-gradient-to-br from-rose-50 to-pink-50 rounded-full flex items-center justify-center mx-auto mb-6\",children:/*#__PURE__*/_jsx(Heart,{className:\"w-12 h-12 text-rose-300\"})}),/*#__PURE__*/_jsx(\"h3\",{className:\"text-xl font-bold text-gray-800 mb-2\",children:\"No saved listings yet\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-gray-500 text-sm mb-6 max-w-md mx-auto\",children:\"Browse rooms and tap the heart icon to save your favorites. They'll appear here for easy access.\"})]}):/*#__PURE__*/_jsx(\"div\",{className:\"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6\",children:favoriteListings.map(listing=>{const ListingCard=require('./components/ListingCard').default;return/*#__PURE__*/_jsx(ListingCard,{listing:listing,onClick:()=>onSelectListing(listing),isFavorite:true,onToggleFavorite:toggleFavorite},listing.id);})})]})});}const createDefaultListingForm=()=>({title:'',price:'',location:'',streetAddress:'',description:'',photos:[],status:'available',availableDate:new Date().toISOString().split('T')[0],amenities:[],latitude:null,longitude:null,paymentMethod:'Bank and Cash',roomType:'private',leaseDuration:'7-12',petFriendly:false,genderPreference:'any',premium:false});function AddListingView(_ref6){let{onSubmit,onCancel,currentUser,userType,onRequireAuth,onRequireOnboarding}=_ref6;const GEOCODER_KEY=process.env.REACT_APP_GEOCODER_API_KEY;const GEOCODER_PROVIDER=(process.env.REACT_APP_GEOCODER_PROVIDER||'').toLowerCase();const landlordId=currentUser===null||currentUser===void 0?void 0:currentUser.id;const[formData,setFormData]=useState(()=>{const base=createDefaultListingForm();if(landlordId){const saved=loadListingTemplate(landlordId);if(saved){var _saved$petFriendly,_saved$premium;return _objectSpread(_objectSpread(_objectSpread({},base),saved),{},{amenities:Array.isArray(saved.amenities)?saved.amenities:base.amenities,petFriendly:(_saved$petFriendly=saved.petFriendly)!==null&&_saved$petFriendly!==void 0?_saved$petFriendly:base.petFriendly,premium:(_saved$premium=saved.premium)!==null&&_saved$premium!==void 0?_saved$premium:base.premium,photos:[]});}}return base;});const[geocodingStatus,setGecodingStatus]=useState('');const[errors,setErrors]=useState({});const[showPhotoEditor,setShowPhotoEditor]=useState(false);const reverseGeocodeCacheRef=React.useRef({});const[lastGeocodeSource,setLastGeocodeSource]=useState(null);// 'cached' | 'mapbox' | 'proxy' | 'direct' | 'coords-only' | 'manual-geocode'\nconst[fullAddressInput,setFullAddressInput]=useState('');const[isFullAddressEditing,setIsFullAddressEditing]=useState(false);useEffect(()=>{if(!landlordId)return;const saved=loadListingTemplate(landlordId);if(saved){setFormData(prev=>{var _saved$petFriendly2,_saved$premium2;return _objectSpread(_objectSpread(_objectSpread({},prev),saved),{},{amenities:Array.isArray(saved.amenities)?saved.amenities:[],petFriendly:(_saved$petFriendly2=saved.petFriendly)!==null&&_saved$petFriendly2!==void 0?_saved$petFriendly2:false,premium:(_saved$premium2=saved.premium)!==null&&_saved$premium2!==void 0?_saved$premium2:false,photos:[]});});}else{setFormData(createDefaultListingForm());}},[landlordId]);useEffect(()=>{if(!landlordId||userType!=='landlord')return;saveListingTemplate(landlordId,formData);},[formData,landlordId,userType]);// Warn user before leaving if form has unsaved data\nuseEffect(()=>{var _formData$photos;const hasFormData=formData.title||formData.description||((_formData$photos=formData.photos)===null||_formData$photos===void 0?void 0:_formData$photos.length)>0;const handleBeforeUnload=e=>{if(hasFormData){e.preventDefault();e.returnValue='';return'';}};if(hasFormData){window.addEventListener('beforeunload',handleBeforeUnload);}return()=>{window.removeEventListener('beforeunload',handleBeforeUnload);};},[formData.title,formData.description,formData.photos]);// Helper: fetch with graceful fallbacks when third-party APIs lack CORS headers\nconst corsFallbackTransforms=useMemo(()=>[url=>url.startsWith('https://cors.isomorphic-git.org/')?url:\"https://cors.isomorphic-git.org/\".concat(url),url=>url.startsWith('https://corsproxy.io/?')?url:\"https://corsproxy.io/?\".concat(encodeURIComponent(url))],[]);const fetchWithCorsFallback=useCallback(async function(url){let options=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};const cloneOptions=()=>{const base=_objectSpread({},options);if(options.headers)base.headers=_objectSpread({},options.headers);return base;};const attempt=async targetUrl=>{const resp=await fetch(targetUrl,cloneOptions());if(!resp.ok)throw new Error(\"Request failed with status \".concat(resp.status));return resp;};try{return await attempt(url);}catch(err){var _options$signal;if((_options$signal=options.signal)!==null&&_options$signal!==void 0&&_options$signal.aborted)throw err;let lastError=err;for(const transform of corsFallbackTransforms){try{const proxiedUrl=transform(url);return await attempt(proxiedUrl);}catch(proxyErr){var _options$signal2;lastError=proxyErr;if((_options$signal2=options.signal)!==null&&_options$signal2!==void 0&&_options$signal2.aborted)break;}}throw lastError;}},[corsFallbackTransforms]);// Forward geocode helper for manual address lookups\nconst forwardGeocodeAddress=async query=>{if(!query||query.trim().length<3)return[];// 1. Mapbox (if configured)\nif(GEOCODER_PROVIDER==='mapbox'&&GEOCODER_KEY){try{var _data$features;const resp=await fetch(\"https://api.mapbox.com/geocoding/v5/mapbox.places/\".concat(encodeURIComponent(query),\".json?access_token=\").concat(GEOCODER_KEY,\"&limit=3&country=za&types=address,place,locality\"));const data=await resp.json();if(data!==null&&data!==void 0&&(_data$features=data.features)!==null&&_data$features!==void 0&&_data$features.length){return data.features.map(f=>{var _f$geometry,_f$geometry$coordinat,_f$geometry2,_f$geometry2$coordina;return{lat:f.center?f.center[1]:(_f$geometry=f.geometry)===null||_f$geometry===void 0?void 0:(_f$geometry$coordinat=_f$geometry.coordinates)===null||_f$geometry$coordinat===void 0?void 0:_f$geometry$coordinat[1],lon:f.center?f.center[0]:(_f$geometry2=f.geometry)===null||_f$geometry2===void 0?void 0:(_f$geometry2$coordina=_f$geometry2.coordinates)===null||_f$geometry2$coordina===void 0?void 0:_f$geometry2$coordina[0],label:f.place_name||f.text,source:'mapbox'};}).filter(entry=>typeof entry.lat==='number'&&typeof entry.lon==='number');}}catch(err){console.warn('Mapbox forward geocode failed',err);}}// 2. maps.co (CORS-friendly)\ntry{const mapsResp=await fetch(\"https://geocode.maps.co/search?q=\".concat(encodeURIComponent(query),\"&limit=3\"));if(mapsResp.ok){const mapsData=await mapsResp.json();if(Array.isArray(mapsData)&&mapsData.length){return mapsData.slice(0,3).map(entry=>({lat:parseFloat(entry.lat),lon:parseFloat(entry.lon),label:entry.display_name||entry.name,source:'maps.co'}));}}}catch(mapsErr){console.warn('maps.co forward geocode failed',mapsErr);}// 3. Local proxy (if running)\nconst API_BASE=process.env.REACT_APP_PROXY_BASE||(window.location&&window.location.port==='8443'?'https://localhost:4443':'');if(API_BASE){try{const proxyResp=await fetch(\"\".concat(API_BASE,\"/api/search?q=\").concat(encodeURIComponent(query)));if(proxyResp.ok){const proxyData=await proxyResp.json();if(Array.isArray(proxyData)&&proxyData.length){return proxyData.slice(0,3).map(entry=>({lat:parseFloat(entry.lat),lon:parseFloat(entry.lon),label:entry.display_name,source:API_BASE.includes('localhost')?'local-proxy':'proxy'}));}}}catch(proxyErr){console.warn('Local proxy forward geocode failed',proxyErr);}}// 4. Direct Nominatim fallback (may still be blocked, but last resort)\ntry{const directResp=await fetchWithCorsFallback(\"https://nominatim.openstreetmap.org/search?format=json&addressdetails=1&q=\".concat(encodeURIComponent(query)),{headers:{'User-Agent':'room-rental-platform/1.0 (direct fallback)','Accept':'application/json'}});if(directResp.ok){const directData=await directResp.json();if(Array.isArray(directData)&&directData.length){return directData.slice(0,3).map(entry=>({lat:parseFloat(entry.lat),lon:parseFloat(entry.lon),label:entry.display_name,source:'direct'}));}}}catch(directErr){console.warn('Direct nominatim forward geocode failed',directErr);}return[];};const availableAmenities=['WiFi','Parking','Kitchen','Laundry','Air Conditioning','Heating','TV','Furnished','Pet Friendly','Garden'];const validateField=function(name,value){let extras=arguments.length>2&&arguments[2]!==undefined?arguments[2]:{};const newErrors=_objectSpread({},errors);switch(name){case'title':if(!value||value.trim().length<5){newErrors.title='Title must be at least 5 characters';}else{delete newErrors.title;}break;case'price':if(!value||parseFloat(value)<=0){newErrors.price='Price must be greater than 0';}else if(parseFloat(value)<500){newErrors.price='Price seems too low (minimum R500)';}else if(parseFloat(value)>50000){newErrors.price='Price seems too high (maximum R50,000)';}else{delete newErrors.price;}break;case'location':{var _ref7,_extras$streetAddress,_ref8,_extras$location;const streetText=((_ref7=(_extras$streetAddress=extras.streetAddress)!==null&&_extras$streetAddress!==void 0?_extras$streetAddress:formData.streetAddress)!==null&&_ref7!==void 0?_ref7:'').trim();const areaText=((_ref8=(_extras$location=extras.location)!==null&&_extras$location!==void 0?_extras$location:value)!==null&&_ref8!==void 0?_ref8:'').trim();if(!streetText||streetText.length<3){newErrors.location='Add the street or stand number (e.g., 5170 Molefe St)';}else if(!areaText||areaText.length<3){newErrors.location='Add the suburb, city, and postal code (e.g., Ivory Park, Midrand, 1693)';}else{delete newErrors.location;}break;}case'description':if(value&&value.length>500){newErrors.description='Description is too long (max 500 characters)';}else{delete newErrors.description;}break;default:break;}setErrors(newErrors);};// Load persisted reverse geocode cache\nuseEffect(()=>{try{const raw=localStorage.getItem('reverse-geocode-cache');if(raw){const parsed=JSON.parse(raw);if(parsed&&typeof parsed==='object'){reverseGeocodeCacheRef.current=parsed;}}}catch(e){/* ignore */}},[]);// Geocode address using Nominatim (OpenStreetMap)\nconst geocodeAddress=async()=>{if(!formData.streetAddress){setGecodingStatus('Please enter a street address');return;}setGecodingStatus('Finding coordinates...');try{const fullAddress=\"\".concat(formData.streetAddress,\", \").concat(formData.location,\", South Africa\");const results=await forwardGeocodeAddress(fullAddress);if(results.length>0){const best=results[0];setFormData(_objectSpread(_objectSpread({},formData),{},{latitude:parseFloat(best.lat),longitude:parseFloat(best.lon)}));setGecodingStatus(\"\\u2713 Address found!\");setTimeout(()=>setGecodingStatus(''),2000);setLastGeocodeSource(best.source||'manual-geocode');return;}setGecodingStatus('Address not found. Trying with area only...');const areaResults=await forwardGeocodeAddress(\"\".concat(formData.location,\", South Africa\"));if(areaResults.length>0){const bestArea=areaResults[0];setFormData(_objectSpread(_objectSpread({},formData),{},{latitude:parseFloat(bestArea.lat),longitude:parseFloat(bestArea.lon)}));setGecodingStatus(' Area found!');setTimeout(()=>setGecodingStatus(''),2000);setLastGeocodeSource(bestArea.source||'manual-geocode');}else{setGecodingStatus('Could not find location');}}catch(error){console.error('Geocoding error:',error);setGecodingStatus('Error finding address. Check your connection.');setLastGeocodeSource(null);}};const toggleAmenity=amenity=>{if(formData.amenities.includes(amenity)){setFormData(_objectSpread(_objectSpread({},formData),{},{amenities:formData.amenities.filter(a=>a!==amenity)}));}else{setFormData(_objectSpread(_objectSpread({},formData),{},{amenities:[...formData.amenities,amenity]}));}};const[isSubmitting,setIsSubmitting]=useState(false);const handleSubmit=async()=>{// Enforce auth and onboarding checks before allowing submission\nif(!currentUser){onRequireAuth&&onRequireAuth('landlord');return;}if(userType!=='landlord'){// prompt to become landlord\nonRequireAuth&&onRequireAuth('landlord');return;}if(!currentUser.landlordComplete){// send to onboarding\nonRequireOnboarding&&onRequireOnboarding();return;}// Validate all fields\nvalidateField('title',formData.title);validateField('price',formData.price);validateField('location',formData.location,{location:formData.location,streetAddress:formData.streetAddress});validateField('description',formData.description);if(!formData.title||formData.title.trim().length<5){setErrors(prev=>_objectSpread(_objectSpread({},prev),{},{title:'Title must be at least 5 characters'}));return;}if(!formData.price||parseFloat(formData.price)<=0){setErrors(prev=>_objectSpread(_objectSpread({},prev),{},{price:'Price must be greater than 0'}));return;}if(!formData.location||formData.location.trim().length<3){setErrors(prev=>_objectSpread(_objectSpread({},prev),{},{location:'Location is required'}));return;}if(Object.keys(errors).length>0){return;}setIsSubmitting(true);try{await onSubmit(formData);}finally{setIsSubmitting(false);}};const googleMapsQuery=[formData.streetAddress,formData.location,'South Africa'].filter(Boolean).join(', ');const googleMapsUrl=googleMapsQuery?\"https://www.google.com/maps/search/?api=1&query=\".concat(encodeURIComponent(googleMapsQuery)):'';const combinedFormAddress=[formData.streetAddress,formData.location].map(part=>(part||'').trim()).filter(Boolean).join(', ');useEffect(()=>{if(isFullAddressEditing)return;setFullAddressInput(prev=>prev===combinedFormAddress?prev:combinedFormAddress);},[combinedFormAddress,isFullAddressEditing]);const handleFullAddressChange=value=>{setFullAddressInput(value);if(!value||value.length<3){setFormData(prev=>_objectSpread(_objectSpread({},prev),{},{streetAddress:'',location:''}));validateField('location','');return;}const parts=value.split(',').map(part=>part.trim()).filter(Boolean);if(parts.length===0){setFormData(prev=>_objectSpread(_objectSpread({},prev),{},{streetAddress:'',location:''}));validateField('location','');return;}let street=parts[0]||'';let derivedLocation=parts.slice(1).join(', ');if(!derivedLocation){const words=street.split(/\\s+/).filter(Boolean);if(words.length>=4){// Guess that the last few tokens describe the suburb/city/postal portion.\nconst locationWordCount=Math.min(4,Math.ceil(words.length/2));derivedLocation=words.slice(-locationWordCount).join(' ');street=words.slice(0,words.length-locationWordCount).join(' ');}else{derivedLocation=street;}}setFormData(prev=>_objectSpread(_objectSpread({},prev),{},{streetAddress:street,location:derivedLocation}));validateField('location',derivedLocation||street,{location:derivedLocation,streetAddress:street});};const handleResetSavedTemplate=()=>{if(!landlordId)return;clearListingTemplate(landlordId);const blank=createDefaultListingForm();setFormData(blank);setFullAddressInput('');};return/*#__PURE__*/_jsx(\"div\",{className:\"p-4 bg-gradient-to-b from-slate-50 to-gray-100 min-h-screen pb-24\",children:/*#__PURE__*/_jsx(\"div\",{className:\"max-w-3xl mx-auto mt-8\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white rounded-2xl shadow-lg border border-gray-100 p-8\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between mb-6\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\"text-3xl font-extrabold text-gray-900\",children:\"Post a Room\"}),/*#__PURE__*/_jsx(\"button\",{onClick:onCancel,className:\"text-gray-400 hover:text-gray-600 transition-colors p-2 rounded-full hover:bg-gray-100\",children:/*#__PURE__*/_jsx(X,{className:\"w-6 h-6\"})})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"mb-8\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-between items-center mb-2\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"text-sm font-medium text-gray-600\",children:\"Form Progress\"}),/*#__PURE__*/_jsx(\"span\",{className:\"text-sm font-semibold text-teal-600\",children:(()=>{let completed=0;const total=5;if(formData.title&&formData.title.trim().length>=5)completed++;if(formData.price&&parseFloat(formData.price)>=500)completed++;if(formData.streetAddress&&formData.location)completed++;if(formData.description&&formData.description.length>=10)completed++;if(formData.photos&&formData.photos.length>0)completed++;return\"\".concat(completed,\"/\").concat(total,\" completed\");})()})]}),/*#__PURE__*/_jsx(\"div\",{className:\"h-2 bg-gray-100 rounded-full overflow-hidden\",children:/*#__PURE__*/_jsx(\"div\",{className:\"h-full bg-gradient-to-r from-teal-500 to-cyan-500 rounded-full transition-all duration-500\",style:{width:\"\".concat((()=>{let completed=0;if(formData.title&&formData.title.trim().length>=5)completed++;if(formData.price&&parseFloat(formData.price)>=500)completed++;if(formData.streetAddress&&formData.location)completed++;if(formData.description&&formData.description.length>=10)completed++;if(formData.photos&&formData.photos.length>0)completed++;return completed/5*100;})(),\"%\")}})})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-6\",children:[(currentUser===null||currentUser===void 0?void 0:currentUser.type)==='landlord'&&/*#__PURE__*/_jsxs(\"div\",{className:\"bg-gradient-to-r from-teal-50 to-cyan-50 border border-teal-200 text-teal-800 text-sm rounded-xl p-4 flex items-start gap-3\",children:[/*#__PURE__*/_jsx(CheckCircle,{className:\"w-5 h-5 text-teal-600 mt-0.5\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-2\",children:[/*#__PURE__*/_jsx(\"p\",{children:\"We remember your latest listing details (address, price, and more) so you only need to upload fresh photos next time. Update any field below and we'll save it automatically.\"}),/*#__PURE__*/_jsx(\"button\",{type:\"button\",onClick:handleResetSavedTemplate,className:\"text-xs font-semibold text-teal-700 underline hover:text-teal-900 transition-colors\",children:\"Reset saved info\"})]})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsxs(\"label\",{className:\"block text-sm font-semibold text-gray-800 mb-2\",children:[\"Room Title *\",formData.title&&formData.title.trim().length>=5&&!errors.title&&/*#__PURE__*/_jsx(\"span\",{className:\"ml-2 text-green-600 text-xs\",children:\"\\u2713 Looks good\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"relative\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"text\",required:true,value:formData.title,onChange:e=>{setFormData(_objectSpread(_objectSpread({},formData),{},{title:e.target.value}));validateField('title',e.target.value);},onBlur:e=>validateField('title',e.target.value),placeholder:\"e.g., Cozy backroom with private bathroom\",className:\"w-full px-4 py-3 pr-10 border-2 \".concat(errors.title?'border-red-400 bg-red-50':formData.title&&formData.title.trim().length>=5?'border-teal-400 bg-teal-50/30':'border-gray-200',\" text-gray-800 rounded-xl focus:ring-2 \").concat(errors.title?'focus:ring-red-400':'focus:ring-teal-400',\" focus:border-transparent transition-all placeholder-gray-400\")}),formData.title&&formData.title.trim().length>=5&&!errors.title&&/*#__PURE__*/_jsx(CheckCircle,{className:\"absolute right-3 top-1/2 -translate-y-1/2 w-5 h-5 text-teal-600\"})]}),errors.title&&/*#__PURE__*/_jsxs(\"p\",{className:\"text-red-500 text-xs mt-1 flex items-center gap-1\",children:[/*#__PURE__*/_jsx(\"span\",{children:\"\\u26A0\"}),\" \",errors.title]})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsxs(\"label\",{className:\"block text-sm font-semibold text-gray-800 mb-2\",children:[\"Monthly Price (R) *\",formData.price&&parseFloat(formData.price)>=500&&parseFloat(formData.price)<=50000&&!errors.price&&/*#__PURE__*/_jsx(\"span\",{className:\"ml-2 text-green-600 text-xs\",children:\"\\u2713 Valid price\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"relative\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"absolute left-4 top-1/2 -translate-y-1/2 text-gray-500 font-medium\",children:\"R\"}),/*#__PURE__*/_jsx(\"input\",{type:\"number\",required:true,value:formData.price,onChange:e=>{setFormData(_objectSpread(_objectSpread({},formData),{},{price:e.target.value}));validateField('price',e.target.value);},onBlur:e=>validateField('price',e.target.value),placeholder:\"2500\",min:\"500\",max:\"50000\",className:\"w-full pl-10 pr-4 py-3 border-2 \".concat(errors.price?'border-red-400 bg-red-50':formData.price&&parseFloat(formData.price)>=500&&parseFloat(formData.price)<=50000?'border-teal-400 bg-teal-50/30':'border-gray-200',\" text-gray-800 rounded-xl focus:ring-2 \").concat(errors.price?'focus:ring-red-400':'focus:ring-teal-400',\" focus:border-transparent transition-all placeholder-gray-400\")}),formData.price&&parseFloat(formData.price)>=500&&parseFloat(formData.price)<=50000&&!errors.price&&/*#__PURE__*/_jsx(CheckCircle,{className:\"absolute right-3 top-1/2 -translate-y-1/2 w-5 h-5 text-teal-600\"})]}),errors.price&&/*#__PURE__*/_jsxs(\"p\",{className:\"text-red-500 text-xs mt-1 flex items-center gap-1\",children:[/*#__PURE__*/_jsx(\"span\",{children:\"\\u26A0\"}),\" \",errors.price]}),!errors.price&&formData.price&&/*#__PURE__*/_jsx(\"p\",{className:\"text-gray-500 text-xs mt-1\",children:\"Suggested range: R500 - R50,000 per month\"})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-semibold text-gray-800 mb-1\",children:\"Full South African Address *\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-xs text-gray-500 mb-2\",children:\"Example: 5170 Molefe St, Ivory Park, Midrand, 1693\"}),/*#__PURE__*/_jsx(\"textarea\",{required:true,rows:\"2\",value:fullAddressInput,onChange:e=>handleFullAddressChange(e.target.value),onFocus:()=>setIsFullAddressEditing(true),onBlur:e=>{setIsFullAddressEditing(false);handleFullAddressChange(e.target.value);},placeholder:\"Type the full street + suburb + city + postal code\",className:\"w-full px-4 py-3 border-2 \".concat(errors.location?'border-red-400':'border-gray-200',\" bg-white text-gray-800 rounded-xl focus:ring-2 \").concat(errors.location?'focus:ring-red-400':'focus:ring-teal-400',\" focus:border-transparent transition placeholder-gray-400\")}),errors.location&&/*#__PURE__*/_jsx(\"p\",{className:\"text-red-500 text-xs mt-1\",\"aria-live\":\"assertive\",children:errors.location}),!errors.location&&/*#__PURE__*/_jsx(\"p\",{className:\"text-gray-500 text-xs mt-1\",children:\"Include the street/stand number plus suburb, city, and postal code. Commas are optional; we will split it for you.\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"bg-gradient-to-br from-teal-50 to-cyan-50 border-2 border-teal-200 rounded-xl p-6\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-start gap-3 mb-4\",children:[/*#__PURE__*/_jsx(MapPin,{className:\"w-6 h-6 text-teal-600 flex-shrink-0 mt-1\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex-1\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"text-lg font-semibold text-gray-800 mb-1\",children:\"Confirm Your Address\"}),/*#__PURE__*/_jsxs(\"p\",{className:\"text-sm text-gray-600\",children:[\"Type the exact street + suburb above, then tap \",/*#__PURE__*/_jsx(\"strong\",{children:\"Look Up Address\"}),\" if you\\x110d like us to fetch coordinates for your Google Maps preview.\"]})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex flex-wrap gap-3 items-start\",children:[/*#__PURE__*/_jsxs(\"button\",{type:\"button\",onClick:geocodeAddress,className:\"w-full md:w-auto bg-white hover:bg-gray-50 text-gray-700 border-2 border-gray-300 px-6 py-3 rounded-lg text-sm font-semibold transition flex items-center justify-center gap-2\",children:[/*#__PURE__*/_jsx(MapPin,{className:\"w-4 h-4\"}),\"Look Up Address\"]}),/*#__PURE__*/_jsxs(\"div\",{className:\"text-sm flex-1 min-w-[220px]\",children:[geocodingStatus&&/*#__PURE__*/_jsxs(\"span\",{className:\"\".concat(geocodingStatus.startsWith('')?'text-green-600 font-semibold':geocodingStatus.startsWith('')?'text-amber-600':'text-gray-700',\" flex items-center gap-1\"),children:[geocodingStatus.startsWith('')&&/*#__PURE__*/_jsx(CheckCircle,{className:\"w-4 h-4\"}),geocodingStatus,lastGeocodeSource==='cached'&&/*#__PURE__*/_jsx(\"span\",{className:\"ml-2 inline-block px-2 py-1 text-[10px] rounded bg-purple-100 text-purple-600 font-semibold\",children:\"CACHED\"}),lastGeocodeSource==='mapbox'&&/*#__PURE__*/_jsx(\"span\",{className:\"ml-2 inline-block px-2 py-1 text-[10px] rounded bg-blue-100 text-blue-600 font-semibold\",children:\"MAPBOX\"}),lastGeocodeSource==='maps.co'&&/*#__PURE__*/_jsx(\"span\",{className:\"ml-2 inline-block px-2 py-1 text-[10px] rounded bg-indigo-100 text-indigo-600 font-semibold\",children:\"MAPS.CO\"}),lastGeocodeSource==='proxy'&&/*#__PURE__*/_jsx(\"span\",{className:\"ml-2 inline-block px-2 py-1 text-[10px] rounded bg-green-100 text-green-600 font-semibold\",children:\"PROXY\"}),lastGeocodeSource==='direct'&&/*#__PURE__*/_jsx(\"span\",{className:\"ml-2 inline-block px-2 py-1 text-[10px] rounded bg-yellow-100 text-yellow-700 font-semibold\",children:\"FALLBACK\"})]}),formData.latitude&&formData.longitude&&!geocodingStatus&&/*#__PURE__*/_jsxs(\"span\",{className:\"text-green-600 font-semibold flex items-center gap-1\",children:[/*#__PURE__*/_jsx(CheckCircle,{className:\"w-4 h-4\"}),\"Coordinates saved: \",formData.latitude.toFixed(4),\", \",formData.longitude.toFixed(4),lastGeocodeSource==='cached'&&/*#__PURE__*/_jsx(\"span\",{className:\"ml-2 inline-block px-2 py-1 text-[10px] rounded bg-purple-100 text-purple-600 font-semibold\",children:\"CACHED\"}),lastGeocodeSource==='maps.co'&&/*#__PURE__*/_jsx(\"span\",{className:\"ml-2 inline-block px-2 py-1 text-[10px] rounded bg-indigo-100 text-indigo-600 font-semibold\",children:\"MAPS.CO\"})]}),googleMapsUrl&&/*#__PURE__*/_jsxs(\"div\",{className:\"mt-3 bg-white border border-gray-200 rounded-lg p-3 text-xs text-gray-600\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"block text-gray-800 font-semibold mb-1\",children:\"Preview this address\"}),/*#__PURE__*/_jsxs(\"a\",{href:googleMapsUrl,target:\"_blank\",rel:\"noopener noreferrer\",className:\"inline-flex items-center gap-2 text-teal-700 font-semibold hover:text-teal-900 underline\",children:[/*#__PURE__*/_jsx(MapPin,{className:\"w-3 h-3\"}),\" Open in Google Maps\"]}),/*#__PURE__*/_jsx(\"span\",{className:\"block mt-2 text-[11px] text-gray-500\",children:\"Renters will see the same button under your listing.\"})]})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"mt-4 text-sm text-gray-600 bg-white border border-dashed border-gray-300 rounded-lg p-4\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"font-semibold text-gray-800 mb-1\",children:\"Manual address confirmed\"}),/*#__PURE__*/_jsx(\"p\",{children:\"We now rely on the address you type here. Use Google Maps above if you want to double-check directions.\"})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"grid grid-cols-1 md:grid-cols-2 gap-4\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-semibold text-gray-800 mb-2\",children:\"Status\"}),/*#__PURE__*/_jsxs(\"select\",{value:formData.status,onChange:e=>setFormData(_objectSpread(_objectSpread({},formData),{},{status:e.target.value})),className:\"w-full px-4 py-3 border-2 border-gray-200 bg-white text-gray-800 rounded-xl focus:ring-2 focus:ring-teal-400 focus:border-transparent transition\",children:[/*#__PURE__*/_jsx(\"option\",{value:\"available\",children:\"Available\"}),/*#__PURE__*/_jsx(\"option\",{value:\"rented\",children:\"Rented\"})]})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-semibold text-gray-800 mb-2\",children:\"Available Date\"}),/*#__PURE__*/_jsx(\"input\",{type:\"date\",value:formData.availableDate,onChange:e=>setFormData(_objectSpread(_objectSpread({},formData),{},{availableDate:e.target.value})),className:\"w-full px-4 py-3 border-2 border-gray-200 bg-white text-gray-800 rounded-xl focus:ring-2 focus:ring-teal-400 focus:border-transparent transition\"})]})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-semibold text-gray-800 mb-2\",children:\"Payment Method\"}),/*#__PURE__*/_jsxs(\"select\",{value:formData.paymentMethod,onChange:e=>setFormData(_objectSpread(_objectSpread({},formData),{},{paymentMethod:e.target.value})),className:\"w-full px-4 py-3 border-2 border-gray-200 bg-white text-gray-800 rounded-xl focus:ring-2 focus:ring-teal-400 focus:border-transparent transition\",children:[/*#__PURE__*/_jsx(\"option\",{value:\"Bank and Cash\",children:\"Bank and Cash\"}),/*#__PURE__*/_jsx(\"option\",{value:\"Cash Only\",children:\"Cash Only\"}),/*#__PURE__*/_jsx(\"option\",{value:\"Bank Only\",children:\"Bank Only\"})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"grid grid-cols-1 md:grid-cols-2 gap-4\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-semibold text-gray-800 mb-2\",children:\"Room Type\"}),/*#__PURE__*/_jsxs(\"select\",{value:formData.roomType,onChange:e=>setFormData(_objectSpread(_objectSpread({},formData),{},{roomType:e.target.value})),className:\"w-full px-4 py-3 border-2 border-gray-200 bg-white text-gray-800 rounded-xl focus:ring-2 focus:ring-teal-400 focus:border-transparent transition\",children:[/*#__PURE__*/_jsx(\"option\",{value:\"private\",children:\"Private Room\"}),/*#__PURE__*/_jsx(\"option\",{value:\"shared\",children:\"Shared Room\"})]})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-semibold text-gray-800 mb-2\",children:\"Lease Duration (months)\"}),/*#__PURE__*/_jsxs(\"select\",{value:formData.leaseDuration,onChange:e=>setFormData(_objectSpread(_objectSpread({},formData),{},{leaseDuration:e.target.value})),className:\"w-full px-4 py-3 border-2 border-gray-200 bg-white text-gray-800 rounded-xl focus:ring-2 focus:ring-teal-400 focus:border-transparent transition\",children:[/*#__PURE__*/_jsx(\"option\",{value:\"1-3\",children:\"1-3 months\"}),/*#__PURE__*/_jsx(\"option\",{value:\"4-6\",children:\"4-6 months\"}),/*#__PURE__*/_jsx(\"option\",{value:\"7-12\",children:\"7-12 months\"}),/*#__PURE__*/_jsx(\"option\",{value:\"12+\",children:\"12+ months\"})]})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"grid grid-cols-1 md:grid-cols-2 gap-4\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center gap-3\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"checkbox\",checked:formData.petFriendly,onChange:e=>setFormData(_objectSpread(_objectSpread({},formData),{},{petFriendly:e.target.checked})),id:\"petFriendly\",className:\"w-5 h-5 text-teal-600 border-gray-300 rounded focus:ring-teal-500\"}),/*#__PURE__*/_jsx(\"label\",{htmlFor:\"petFriendly\",className:\"text-sm font-medium text-gray-700\",children:\"\\uD83D\\uDC3E Pet Friendly\"})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-semibold text-gray-800 mb-2\",children:\"Gender Preference\"}),/*#__PURE__*/_jsxs(\"select\",{value:formData.genderPreference,onChange:e=>setFormData(_objectSpread(_objectSpread({},formData),{},{genderPreference:e.target.value})),className:\"w-full px-4 py-3 border-2 border-gray-200 bg-white text-gray-800 rounded-xl focus:ring-2 focus:ring-teal-400 focus:border-transparent transition\",children:[/*#__PURE__*/_jsx(\"option\",{value:\"any\",children:\"Any\"}),/*#__PURE__*/_jsx(\"option\",{value:\"male\",children:\"Male Only\"}),/*#__PURE__*/_jsx(\"option\",{value:\"female\",children:\"Female Only\"})]})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center gap-3\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"checkbox\",checked:!!formData.premium,onChange:e=>setFormData(_objectSpread(_objectSpread({},formData),{},{premium:e.target.checked})),id:\"premiumFlag\"}),/*#__PURE__*/_jsx(\"label\",{htmlFor:\"premiumFlag\",className:\"text-sm font-medium text-gray-700\",children:\"Premium listing (highlight & priority sorting)\"})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsxs(\"label\",{className:\"block text-sm font-semibold text-gray-800 mb-2\",children:[\"Description\",formData.description&&/*#__PURE__*/_jsxs(\"span\",{className:\"ml-2 text-xs \".concat(formData.description.length>500?'text-red-500':'text-gray-500'),children:[\"(\",formData.description.length,\"/500 characters)\"]})]}),/*#__PURE__*/_jsx(\"textarea\",{value:formData.description,onChange:e=>{setFormData(_objectSpread(_objectSpread({},formData),{},{description:e.target.value}));validateField('description',e.target.value);},onBlur:e=>validateField('description',e.target.value),placeholder:\"Describe the room, amenities, rules, and any other details...\",rows:\"4\",className:\"w-full px-4 py-3 border-2 \".concat(errors.description?'border-red-400':'border-gray-200',\" bg-white text-gray-800 rounded-xl focus:ring-2 \").concat(errors.description?'focus:ring-red-400':'focus:ring-teal-400',\" focus:border-transparent transition placeholder-gray-400\")}),errors.description&&/*#__PURE__*/_jsx(\"p\",{className:\"text-red-500 text-xs mt-1\",children:errors.description})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-semibold text-gray-800 mb-3\",children:\"Amenities\"}),/*#__PURE__*/_jsx(\"div\",{className:\"grid grid-cols-2 md:grid-cols-3 gap-2\",children:availableAmenities.map(amenity=>/*#__PURE__*/_jsx(\"button\",{type:\"button\",onClick:()=>toggleAmenity(amenity),className:\"px-4 py-2.5 rounded-xl text-sm font-medium transition-all \".concat(formData.amenities.includes(amenity)?'bg-gradient-to-r from-teal-500 to-cyan-500 text-white shadow-md':'bg-gray-100 text-gray-700 border-2 border-gray-200 hover:border-teal-300 hover:bg-teal-50'),children:amenity},amenity))})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-semibold text-gray-800 mb-2\",children:\"Photos (Max 5)\"}),/*#__PURE__*/_jsx(\"div\",{className:\"relative border-2 border-dashed border-gray-300 bg-gradient-to-br from-gray-50 to-slate-50 rounded-xl p-6 hover:border-teal-400 hover:bg-teal-50/30 transition-all duration-300 cursor-pointer group\",onClick:()=>setShowPhotoEditor(true),children:/*#__PURE__*/_jsxs(\"div\",{className:\"text-center\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"w-16 h-16 bg-gradient-to-br from-teal-100 to-cyan-100 rounded-2xl flex items-center justify-center mx-auto mb-3 group-hover:scale-110 transition-transform duration-300\",children:/*#__PURE__*/_jsx(\"span\",{className:\"text-3xl\",children:\"\\uD83D\\uDCF7\"})}),/*#__PURE__*/_jsx(\"p\",{className:\"text-gray-700 font-semibold mb-1\",children:formData.photos.length===0?'Add Photos':\"\".concat(formData.photos.length,\"/5 Photos Added\")}),/*#__PURE__*/_jsx(\"p\",{className:\"text-xs text-gray-500\",children:\"Click to upload \\u2022 JPG, PNG up to 5MB each\"}),formData.photos.length===0&&/*#__PURE__*/_jsx(\"p\",{className:\"text-xs text-teal-600 mt-2 font-medium\",children:\"Tip: Listings with photos get 3x more views!\"})]})}),formData.photos.length>0&&/*#__PURE__*/_jsx(\"div\",{className:\"mt-4 grid grid-cols-2 md:grid-cols-3 gap-3\",children:formData.photos.map((photo,index)=>/*#__PURE__*/_jsxs(\"div\",{className:\"relative group\",children:[index===0&&/*#__PURE__*/_jsx(\"div\",{className:\"absolute top-2 left-2 bg-gradient-to-r from-teal-500 to-cyan-500 text-white text-xs px-2 py-1 rounded-full font-semibold z-10\",children:\"Cover\"}),/*#__PURE__*/_jsx(\"img\",{src:photo,alt:\"Preview \".concat(index+1),className:\"w-full h-32 object-cover rounded-xl border-2 border-gray-200 shadow-sm\"})]},index))}),/*#__PURE__*/_jsx(\"button\",{type:\"button\",onClick:()=>setShowPhotoEditor(true),className:\"mt-3 text-sm text-teal-600 hover:text-teal-700 font-medium\",children:formData.photos.length>0?' Edit Photos':''})]}),showPhotoEditor&&/*#__PURE__*/_jsx(PhotoEditor,{photos:formData.photos,onPhotosChange:newPhotos=>setFormData(_objectSpread(_objectSpread({},formData),{},{photos:newPhotos})),onClose:()=>setShowPhotoEditor(false),maxPhotos:5}),/*#__PURE__*/_jsxs(\"div\",{className:\"border-t border-gray-200 pt-6\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:handleSubmit,disabled:isSubmitting||Object.keys(errors).length>0,className:\"w-full font-semibold py-3.5 rounded-xl transition-all shadow-lg relative \".concat(isSubmitting||Object.keys(errors).length>0?'bg-gray-400 cursor-not-allowed':'bg-gradient-to-r from-teal-500 to-cyan-500 hover:from-teal-600 hover:to-cyan-600 text-white hover:shadow-xl hover:shadow-teal-500/25'),children:isSubmitting?/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"span\",{className:\"opacity-0\",children:\"Post Room\"}),/*#__PURE__*/_jsx(\"div\",{className:\"absolute inset-0 flex items-center justify-center\",children:/*#__PURE__*/_jsx(\"div\",{className:\"w-5 h-5 border-2 border-white border-t-transparent rounded-full animate-spin\"})})]}):'Post Room'}),Object.keys(errors).length>0&&/*#__PURE__*/_jsx(\"p\",{className:\"text-red-500 text-xs mt-2 text-center\",children:\"Please fix the errors above before submitting\"})]})]})]})})});}// MessagesView removed - using direct contact instead\nfunction MyListingsView(_ref9){let{listings,onDelete}=_ref9;return/*#__PURE__*/_jsx(\"div\",{className:\"p-4 min-h-screen bg-gradient-to-b from-slate-50 to-gray-100 pb-24\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"max-w-7xl mx-auto mt-8\",children:[listings.length>0&&/*#__PURE__*/_jsx(\"div\",{className:\"mb-6 bg-gradient-to-r from-amber-50 to-orange-50 border border-amber-200 rounded-2xl p-4 shadow-sm\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-start gap-3\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"w-10 h-10 bg-amber-100 rounded-xl flex items-center justify-center flex-shrink-0\",children:/*#__PURE__*/_jsx(AlertTriangle,{className:\"w-5 h-5 text-amber-600\"})}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h3\",{className:\"font-semibold text-amber-800 mb-1\",children:\"Found a tenant?\"}),/*#__PURE__*/_jsxs(\"p\",{className:\"text-amber-700 text-sm leading-relaxed\",children:[\"Remember to \",/*#__PURE__*/_jsx(\"span\",{className:\"font-medium\",children:\"delete your listing\"}),\" once you've found a tenant. This will stop new calls and messages from other renters looking at your ad.\"]})]})]})}),/*#__PURE__*/_jsx(\"div\",{className:\"mb-8\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center gap-4 mb-3\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"w-14 h-14 bg-gradient-to-br from-teal-100 to-cyan-100 rounded-2xl flex items-center justify-center shadow-sm\",children:/*#__PURE__*/_jsx(Home,{className:\"w-7 h-7 text-teal-600\"})}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h2\",{className:\"text-3xl font-extrabold text-gray-900\",children:\"My Listings\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-gray-600\",children:listings.length===0?'Your properties will appear here':\"\".concat(listings.length,\" active \").concat(listings.length===1?'listing':'listings')})]})]})}),listings.length===0?/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white rounded-2xl border border-gray-100 shadow-sm p-12 text-center\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"w-24 h-24 bg-gradient-to-br from-teal-50 to-cyan-50 rounded-full flex items-center justify-center mx-auto mb-6\",children:/*#__PURE__*/_jsx(Home,{className:\"w-12 h-12 text-teal-400\"})}),/*#__PURE__*/_jsx(\"h3\",{className:\"text-xl font-bold text-gray-800 mb-2\",children:\"No Listings Yet\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-gray-500 text-sm mb-6 max-w-md mx-auto\",children:\"Start earning by posting your first room. It only takes a few minutes!\"}),/*#__PURE__*/_jsxs(\"button\",{onClick:()=>window.location.hash='#add',className:\"inline-flex items-center gap-2 bg-gradient-to-r from-teal-600 to-cyan-600 hover:from-teal-700 hover:to-cyan-700 text-white font-semibold px-6 py-3 rounded-xl transition-all shadow-md hover:shadow-lg\",children:[/*#__PURE__*/_jsx(PlusCircle,{className:\"w-5 h-5\"}),\"Post Your First Room\"]})]}):/*#__PURE__*/_jsx(\"div\",{className:\"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6\",children:listings.map(listing=>{var _listing$price;return/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white rounded-2xl shadow-sm border border-gray-100 overflow-hidden hover:shadow-md transition-shadow\",children:[listing.photos&&listing.photos.length>0&&/*#__PURE__*/_jsxs(\"div\",{className:\"relative\",children:[/*#__PURE__*/_jsx(\"img\",{src:listing.photos[0],alt:\"Room\",className:\"w-full h-48 object-cover\"}),listing.photos.length>1&&/*#__PURE__*/_jsxs(\"div\",{className:\"absolute top-3 right-3 bg-black/60 backdrop-blur-sm text-white px-2.5 py-1 rounded-full text-xs font-medium\",children:[listing.photos.length,\" photos\"]}),/*#__PURE__*/_jsx(\"div\",{className:\"absolute top-3 left-3 px-2.5 py-1 rounded-full text-xs font-semibold \".concat(listing.status==='available'?'bg-emerald-500 text-white':'bg-gray-500 text-white'),children:listing.status==='available'?'Active':'Rented'})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"p-5\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"font-bold text-lg text-gray-900 mb-1 line-clamp-1\",children:listing.title}),/*#__PURE__*/_jsxs(\"div\",{className:\"text-teal-600 font-bold text-xl mb-2\",children:[\"R\",(_listing$price=listing.price)===null||_listing$price===void 0?void 0:_listing$price.toLocaleString(),\"/month\"]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center text-gray-500 text-sm mb-4\",children:[/*#__PURE__*/_jsx(MapPin,{className:\"w-4 h-4 mr-1.5 text-gray-400\"}),/*#__PURE__*/_jsx(\"span\",{className:\"line-clamp-1\",children:listing.location})]}),/*#__PURE__*/_jsx(\"div\",{className:\"flex gap-2\",children:/*#__PURE__*/_jsx(\"button\",{onClick:()=>onDelete(listing.id),className:\"flex-1 bg-red-50 hover:bg-red-100 text-red-600 font-medium py-2.5 rounded-xl transition-colors text-sm\",children:\"Delete\"})})]})]},listing.id);})})]})});}// Inline message box component with validation for listing detail view\n// ListingInlineMessageBox removed\n// ConversationModal removed\nfunction AuthModal(_ref0){let{defaultType='renter',onClose,onSubmit}=_ref0;const[form,setForm]=useState({name:'',phone:'',email:'',type:defaultType,photo:''});const[errors,setErrors]=useState({});const[isSubmitting,setIsSubmitting]=useState(false);const validateForm=()=>{const newErrors={};if(!form.name||form.name.trim().length<2){newErrors.name='Name must be at least 2 characters';}if(!form.email||!/^[^\\s@]+@[^\\s@]+\\.[^\\s@]+$/.test(form.email)){newErrors.email='Please enter a valid email address';}setErrors(newErrors);return Object.keys(newErrors).length===0;};const handleSubmit=async()=>{if(!validateForm())return;setIsSubmitting(true);try{await onSubmit(form);}finally{setIsSubmitting(false);}};return/*#__PURE__*/_jsx(\"div\",{className:\"fixed inset-0 bg-gray-900/60 backdrop-blur-sm flex items-start sm:items-center justify-center p-4 pt-16 sm:pt-4 z-50 overflow-y-auto\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white rounded-2xl w-full max-w-md p-8 my-auto shadow-2xl fade-in border border-gray-100\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-start justify-between mb-8\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center gap-2 mb-2\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"w-10 h-10 bg-gradient-to-br from-teal-500 to-cyan-500 rounded-xl flex items-center justify-center shadow-lg\",children:/*#__PURE__*/_jsx(Home,{className:\"w-5 h-5 text-white\"})}),/*#__PURE__*/_jsxs(\"span\",{className:\"text-xl font-extrabold\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"bg-gradient-to-r from-teal-600 to-cyan-600 bg-clip-text text-transparent\",children:\"Room\"}),/*#__PURE__*/_jsx(\"span\",{className:\"text-rose-500\",children:\"24\"})]})]}),/*#__PURE__*/_jsx(\"h3\",{className:\"text-xl font-bold text-gray-900 mt-4\",children:\"Welcome!\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-sm text-gray-500 mt-1\",children:\"Sign in or create your account\"})]}),/*#__PURE__*/_jsx(\"button\",{onClick:onClose,className:\"p-2 text-gray-400 hover:text-gray-600 hover:bg-gray-100 rounded-xl transition-colors\",children:/*#__PURE__*/_jsx(X,{className:\"w-5 h-5\"})})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-5\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-semibold text-gray-700 mb-2\",children:\"Full name *\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",value:form.name,onChange:e=>{setForm(_objectSpread(_objectSpread({},form),{},{name:e.target.value}));setErrors(_objectSpread(_objectSpread({},errors),{},{name:''}));},className:\"w-full px-4 py-3 border-2 rounded-xl transition-all focus:ring-2 focus:ring-teal-100 focus:border-teal-500 \".concat(errors.name?'border-rose-400 bg-rose-50':'border-gray-200 hover:border-gray-300'),placeholder:\"John Doe\"}),errors.name&&/*#__PURE__*/_jsxs(\"p\",{className:\"text-rose-500 text-xs mt-1.5 flex items-center gap-1\",children:[/*#__PURE__*/_jsx(\"span\",{children:\"\\u26A0\"}),errors.name]})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-semibold text-gray-700 mb-2\",children:\"Email *\"}),/*#__PURE__*/_jsx(\"input\",{type:\"email\",value:form.email,onChange:e=>{setForm(_objectSpread(_objectSpread({},form),{},{email:e.target.value}));setErrors(_objectSpread(_objectSpread({},errors),{},{email:''}));},className:\"w-full px-4 py-3 border-2 rounded-xl transition-all focus:ring-2 focus:ring-teal-100 focus:border-teal-500 \".concat(errors.email?'border-rose-400 bg-rose-50':'border-gray-200 hover:border-gray-300'),placeholder:\"john@example.com\"}),errors.email&&/*#__PURE__*/_jsxs(\"p\",{className:\"text-rose-500 text-xs mt-1.5 flex items-center gap-1\",children:[/*#__PURE__*/_jsx(\"span\",{children:\"\\u26A0\"}),errors.email]})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsxs(\"label\",{className:\"block text-sm font-semibold text-gray-700 mb-2\",children:[\"Phone \",/*#__PURE__*/_jsx(\"span\",{className:\"text-gray-400 font-normal\",children:\"(optional)\"})]}),/*#__PURE__*/_jsx(\"input\",{type:\"tel\",value:form.phone,onChange:e=>setForm(_objectSpread(_objectSpread({},form),{},{phone:e.target.value})),className:\"w-full px-4 py-3 border-2 border-gray-200 hover:border-gray-300 rounded-xl transition-all focus:ring-2 focus:ring-teal-100 focus:border-teal-500\",placeholder:\"+27 12 345 6789\"})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-semibold text-gray-700 mb-2\",children:\"I am a\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"grid grid-cols-2 gap-3\",children:[/*#__PURE__*/_jsxs(\"button\",{type:\"button\",onClick:()=>setForm(_objectSpread(_objectSpread({},form),{},{type:'renter'})),className:\"p-4 rounded-xl border-2 transition-all flex flex-col items-center gap-2 \".concat(form.type==='renter'?'border-teal-500 bg-gradient-to-br from-teal-50 to-cyan-50 text-teal-700 shadow-md':'border-gray-200 hover:border-gray-300 text-gray-600 hover:bg-gray-50'),children:[/*#__PURE__*/_jsx(Search,{className:\"w-6 h-6 \".concat(form.type==='renter'?'text-teal-500':'')}),/*#__PURE__*/_jsx(\"span\",{className:\"text-sm font-semibold\",children:\"Looking for a room\"})]}),/*#__PURE__*/_jsxs(\"button\",{type:\"button\",onClick:()=>setForm(_objectSpread(_objectSpread({},form),{},{type:'landlord'})),className:\"p-4 rounded-xl border-2 transition-all flex flex-col items-center gap-2 \".concat(form.type==='landlord'?'border-rose-500 bg-gradient-to-br from-rose-50 to-pink-50 text-rose-700 shadow-md':'border-gray-200 hover:border-gray-300 text-gray-600 hover:bg-gray-50'),children:[/*#__PURE__*/_jsx(Home,{className:\"w-6 h-6 \".concat(form.type==='landlord'?'text-rose-500':'')}),/*#__PURE__*/_jsx(\"span\",{className:\"text-sm font-semibold\",children:\"Listing rooms\"})]})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex gap-3 pt-4\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:onClose,className:\"flex-1 bg-gray-100 hover:bg-gray-200 text-gray-700 font-semibold py-3 rounded-xl transition-colors\",children:\"Cancel\"}),/*#__PURE__*/_jsx(\"button\",{onClick:handleSubmit,disabled:isSubmitting,className:\"flex-1 font-bold py-3 rounded-xl transition-all relative \".concat(isSubmitting?'bg-teal-400 cursor-not-allowed':'bg-gradient-to-r from-teal-500 to-cyan-500 hover:from-teal-600 hover:to-cyan-600 text-white shadow-lg hover:shadow-xl hover:shadow-teal-500/25'),children:isSubmitting?/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"span\",{className:\"opacity-0\",children:\"Continue\"}),/*#__PURE__*/_jsx(\"div\",{className:\"absolute inset-0 flex items-center justify-center\",children:/*#__PURE__*/_jsx(\"div\",{className:\"w-5 h-5 border-2 border-white border-t-transparent rounded-full animate-spin\"})})]}):'Continue '})]})]}),/*#__PURE__*/_jsxs(\"p\",{className:\"text-xs text-gray-400 text-center mt-6\",children:[\"By continuing, you agree to our \",/*#__PURE__*/_jsx(\"button\",{className:\"text-teal-600 hover:underline\",children:\"Terms of Service\"}),\" and \",/*#__PURE__*/_jsx(\"button\",{className:\"text-teal-600 hover:underline\",children:\"Privacy Policy\"})]})]})});}function BottomNav(_ref1){let{currentView,setCurrentView,userType}=_ref1;const navItems=[{id:'browse',label:'Browse',icon:/*#__PURE__*/_jsx(Search,{className:\"w-5 h-5\"}),activeColor:'teal'},{id:'add',label:'List',icon:/*#__PURE__*/_jsx(PlusCircle,{className:\"w-5 h-5\"}),requiresLandlord:true,activeColor:'rose'},{id:'favorites',label:'Saved',icon:/*#__PURE__*/_jsx(Heart,{className:\"w-5 h-5\"}),activeColor:'rose'},{id:'profile',label:'Profile',icon:/*#__PURE__*/_jsx(User,{className:\"w-5 h-5\"}),activeColor:'blue'}];return/*#__PURE__*/_jsx(\"div\",{className:\"fixed bottom-0 left-0 right-0 bg-white/95 backdrop-blur-md border-t border-gray-100 px-4 py-2 z-20 md:hidden safe-area-bottom\",children:/*#__PURE__*/_jsx(\"div\",{className:\"grid grid-cols-4 gap-1 max-w-md mx-auto\",children:navItems.map(item=>{const disabled=item.requiresLandlord&&userType!=='landlord';const isActive=currentView===item.id;const colorClasses={teal:'text-teal-600 bg-teal-50',rose:'text-rose-600 bg-rose-50',blue:'text-blue-600 bg-blue-50'};return/*#__PURE__*/_jsxs(\"button\",{type:\"button\",disabled:disabled,onClick:()=>!disabled&&setCurrentView(item.id),className:\"flex flex-col items-center gap-0.5 py-2 px-1 rounded-xl transition-all duration-200 \".concat(disabled?'opacity-40 cursor-not-allowed':'active:scale-95',\" \").concat(isActive?\"\".concat(colorClasses[item.activeColor],\" font-semibold\"):'text-gray-400 hover:text-gray-600 hover:bg-gray-50'),children:[/*#__PURE__*/_jsx(\"span\",{className:\"transition-transform duration-200 \".concat(isActive?'scale-110':''),children:item.icon}),/*#__PURE__*/_jsx(\"span\",{className:\"text-[10px] font-medium\",children:item.label})]},item.id);})})});}","map":{"version":3,"names":["React","useState","useEffect","useMemo","useCallback","initFirebase","initAnalytics","requestFcmToken","listenForegroundMessages","trackEvent","fetchListings","addListing","deleteListing","subscribeToListings","isFirestoreEnabled","Home","PlusCircle","Search","MapPin","X","User","Phone","Mail","Edit","CheckCircle","Heart","Calendar","Bell","AlertTriangle","Header","ListingDetailModal","Footer","BrowseView","PrivacyPolicyModal","NotificationBanner","AnalyticsConsentModal","NotificationsPanel","PhotoEditor","OfflineIndicator","BackToTop","getNotifications","loadListingTemplate","saveListingTemplate","clearListingTemplate","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","RentalPlatform","currentView","setCurrentView","userType","setUserType","previewAsRenter","setPreviewAsRenter","listings","setListings","selectedListing","setSelectedListing","users","setUsers","searchLocation","setSearchLocation","priceRange","setPriceRange","selectedAmenities","setSelectedAmenities","sortBy","setSortBy","currentUser","setCurrentUser","showAuthModal","setShowAuthModal","authDefaultType","setAuthDefaultType","toast","setToast","showPrivacyPolicy","setShowPrivacyPolicy","notificationBanner","setNotificationBanner","showAnalyticsConsent","setShowAnalyticsConsent","showNotificationsPanel","setShowNotificationsPanel","unreadCount","setUnreadCount","openAuthModal","type","arguments","length","undefined","updateUnreadCount","notifications","filter","n","read","interval","setInterval","clearInterval","loadData","app","unsubscribeListings","firestoreListings","localStorage","setItem","JSON","stringify","analyticsConsent","getItem","process","env","REACT_APP_ENABLE_ANALYTICS","setTimeout","token","console","log","e","warn","payload","notification","title","body","landlordComplete","listingsResult","parse","userResult","usersResult","user","parsed","Array","isArray","error","sampleListings","id","price","location","description","photos","status","availableDate","Date","toISOString","amenities","landlordId","landlordName","landlordPhone","landlordEmail","landlordPhoto","createdAt","isDuplicateContact","phone","email","ignoreId","normalizedPhone","trim","normalizedEmail","toLowerCase","some","u","uPhone","uEmail","phoneMatch","emailMatch","showToast","message","handleAnalyticsConsentAccept","handleAnalyticsConsentDecline","saveListings","newListings","navigator","serviceWorker","controller","postMessage","_unused","saveSubscriptions","subscriptions","getSubscriptions","res","err","subscribeToArea","userId","area","alert","subs","includes","push","concat","handleProfileSetup","profileData","now","_objectSpread","whatsapp","notificationPrefs","updates","marketing","existingUsersRaw","existingUsers","_unused2","_unused3","_unused4","handleUpdateProfile","updatedUser","_unused5","idx","findIndex","_unused6","_unused7","handleQuickAuth","name","photo","_unused8","handleSignOut","removeItem","handleCompleteOnboarding","onboardData","updated","landlordInfo","handleAddListing","listingData","_listingData$latitude","_listingData$longitud","fullAddress","streetAddress","Boolean","join","newListingData","latitude","longitude","paymentMethod","premium","firestoreId","newListing","updatedListings","window","scrollTo","top","behavior","filteredListings","listing","matchesLocation","parseFloat","matchesPrice","matchesAmenities","every","amenity","_listing$amenities","sort","a","b","className","children","onOpenNotifications","onClose","onClick","role","ProfileSetupView","onSubmit","ProfileView","onEdit","onUpdatePrefs","prefs","raw","arr","_unused9","_unused0","EditProfileView","onCancel","LandlordOnboardingView","onComplete","onSelectListing","onRequireAuth","previewMode","AddListingView","onRequireOnboarding","MyListingsView","l","onDelete","deleted","FavoritesView","landlord","AuthModal","defaultType","BottomNav","onAccept","onDecline","listingId","find","onOpenPrivacy","_ref","formData","setFormData","errors","setErrors","touched","setTouched","validateField","value","extras","newErrors","test","handlePhotoUpload","file","target","files","size","reader","FileReader","onloadend","result","readAsDataURL","handleSubmit","allTouched","Object","keys","src","alt","accept","onChange","required","onBlur","placeholder","_ref2","_user$name","_user$name$charAt","localPrefs","setLocalPrefs","togglePref","key","next","charAt","toUpperCase","toLocaleDateString","year","month","day","checked","_ref3","_currentUser$name","_currentUser$name$cha","form","setForm","businessName","bankDetails","idNumber","agree","preventDefault","_ref4","_ref5","favorites","setFavorites","rawFavorites","_unused1","toggleFavorite","prev","_unused10","favoriteListings","map","ListingCard","require","default","isFavorite","onToggleFavorite","createDefaultListingForm","split","roomType","leaseDuration","petFriendly","genderPreference","_ref6","GEOCODER_KEY","REACT_APP_GEOCODER_API_KEY","GEOCODER_PROVIDER","REACT_APP_GEOCODER_PROVIDER","base","saved","_saved$petFriendly","_saved$premium","geocodingStatus","setGecodingStatus","showPhotoEditor","setShowPhotoEditor","reverseGeocodeCacheRef","useRef","lastGeocodeSource","setLastGeocodeSource","fullAddressInput","setFullAddressInput","isFullAddressEditing","setIsFullAddressEditing","_saved$petFriendly2","_saved$premium2","_formData$photos","hasFormData","handleBeforeUnload","returnValue","addEventListener","removeEventListener","corsFallbackTransforms","url","startsWith","encodeURIComponent","fetchWithCorsFallback","options","cloneOptions","headers","attempt","targetUrl","resp","fetch","ok","Error","_options$signal","signal","aborted","lastError","transform","proxiedUrl","proxyErr","_options$signal2","forwardGeocodeAddress","query","_data$features","data","json","features","f","_f$geometry","_f$geometry$coordinat","_f$geometry2","_f$geometry2$coordina","lat","center","geometry","coordinates","lon","label","place_name","text","source","entry","mapsResp","mapsData","slice","display_name","mapsErr","API_BASE","REACT_APP_PROXY_BASE","port","proxyResp","proxyData","directResp","directData","directErr","availableAmenities","_ref7","_extras$streetAddress","_ref8","_extras$location","streetText","areaText","current","geocodeAddress","results","best","areaResults","bestArea","toggleAmenity","isSubmitting","setIsSubmitting","googleMapsQuery","googleMapsUrl","combinedFormAddress","part","handleFullAddressChange","parts","street","derivedLocation","words","locationWordCount","Math","min","ceil","handleResetSavedTemplate","blank","completed","total","style","width","max","rows","onFocus","toFixed","href","rel","htmlFor","index","onPhotosChange","newPhotos","maxPhotos","disabled","_ref9","hash","_listing$price","toLocaleString","_ref0","validateForm","_ref1","navItems","icon","activeColor","requiresLandlord","item","isActive","colorClasses","teal","rose","blue"],"sources":["C:/Users/kutum/Documents/room-rental-platform/src/App.js"],"sourcesContent":["import React, { useState, useEffect, useMemo, useCallback } from 'react';\nimport { initFirebase, initAnalytics, requestFcmToken, listenForegroundMessages, trackEvent, fetchListings, addListing, deleteListing, subscribeToListings, isFirestoreEnabled } from './firebase';\nimport { Home, PlusCircle, Search, MapPin, X, User, Phone, Mail, Edit, CheckCircle, Heart, Calendar, Bell, AlertTriangle } from 'lucide-react';\nimport Header from './components/Header';\nimport ListingDetailModal from './components/ListingDetailModal';\nimport Footer from './components/Footer';\nimport BrowseView from './components/BrowseView';\nimport PrivacyPolicyModal from './components/PrivacyPolicyModal';\nimport NotificationBanner from './components/NotificationBanner';\nimport AnalyticsConsentModal from './components/AnalyticsConsentModal';\nimport NotificationsPanel from './components/NotificationsPanel';\nimport PhotoEditor from './components/PhotoEditor';\nimport OfflineIndicator from './components/OfflineIndicator';\nimport BackToTop from './components/BackToTop';\nimport { getNotifications } from './utils/notificationEngine';\nimport { loadListingTemplate, saveListingTemplate, clearListingTemplate } from './utils/listingTemplateStorage';\n\nexport default function RentalPlatform() {\n  const [currentView, setCurrentView] = useState('browse');\n  const [userType, setUserType] = useState(null);\n  const [previewAsRenter, setPreviewAsRenter] = useState(false); // landlord UI preview toggle\n  const [listings, setListings] = useState([]);\n  const [selectedListing, setSelectedListing] = useState(null);\n  const [users, setUsers] = useState([]); // registry of all users (localStorage 'users')\n  const [searchLocation, setSearchLocation] = useState('');\n  const [priceRange, setPriceRange] = useState([0, 10000]);\n  const [selectedAmenities, setSelectedAmenities] = useState([]);\n  const [sortBy, setSortBy] = useState('newest');\n  const [currentUser, setCurrentUser] = useState(null);\n  const [showAuthModal, setShowAuthModal] = useState(false);\n  const [authDefaultType, setAuthDefaultType] = useState('renter');\n  // Mobile menu state moved into Header component\n  const [toast, setToast] = useState(null);\n  const [showPrivacyPolicy, setShowPrivacyPolicy] = useState(false);\n  const [notificationBanner, setNotificationBanner] = useState(null);\n  const [showAnalyticsConsent, setShowAnalyticsConsent] = useState(false);\n  const [showNotificationsPanel, setShowNotificationsPanel] = useState(false);\n  const [unreadCount, setUnreadCount] = useState(0);\n\n  const openAuthModal = (type = 'renter') => {\n    setAuthDefaultType(type);\n    setShowAuthModal(true);\n  };\n\n  // Update unread notification count\n  useEffect(() => {\n    const updateUnreadCount = () => {\n      const notifications = getNotifications();\n      setUnreadCount(notifications.filter(n => !n.read).length);\n    };\n    updateUnreadCount();\n    const interval = setInterval(updateUnreadCount, 5000); // check every 5s\n    return () => clearInterval(interval);\n  }, []);\n  \n\n  useEffect(() => {\n    loadData();\n    // Initialize Firebase + FCM token fetch (deferred until user interaction if desired)\n    const app = initFirebase();\n    \n    // Set up real-time listener for Firestore listings\n    let unsubscribeListings = null;\n    if (isFirestoreEnabled()) {\n      unsubscribeListings = subscribeToListings((firestoreListings) => {\n        if (firestoreListings && firestoreListings.length >= 0) {\n          setListings(firestoreListings);\n          // Cache locally for offline access\n          localStorage.setItem('listings', JSON.stringify(firestoreListings));\n        }\n      });\n    }\n    \n    // Check analytics consent and show modal if not set\n    const analyticsConsent = localStorage.getItem('analytics-consent');\n    if (!analyticsConsent && process.env.REACT_APP_ENABLE_ANALYTICS === 'true') {\n      // Delay modal slightly so UI loads first\n      setTimeout(() => setShowAnalyticsConsent(true), 2000);\n    } else if (analyticsConsent === 'yes') {\n      initAnalytics(app);\n    }\n\n    (async () => {\n      try {\n        const token = await requestFcmToken();\n        if (token) {\n          console.log('Obtained FCM token:', token);\n          trackEvent('fcm_token_obtained');\n        }\n      } catch (e) {\n        console.warn('FCM token request failed', e);\n      }\n    })();\n    \n    listenForegroundMessages((payload) => {\n      // Display notification banner instead of toast\n      const notification = payload?.notification || {};\n      if (notification.title || notification.body) {\n        setNotificationBanner({\n          title: notification.title,\n          body: notification.body\n        });\n        // Auto-dismiss after 8 seconds\n        setTimeout(() => setNotificationBanner(null), 8000);\n      }\n    });\n    \n    // Cleanup: unsubscribe from Firestore listener on unmount\n    return () => {\n      if (unsubscribeListings) {\n        unsubscribeListings();\n      }\n    };\n  }, []);\n\n  // Guard: if someone navigates to 'add' without landlord auth, prompt to sign in\n  useEffect(() => {\n    if (currentView === 'add') {\n      if (!currentUser) {\n        openAuthModal('landlord');\n        setCurrentView('browse');\n      } else if (userType !== 'landlord') {\n        // Not a landlord - prompt to become one\n        openAuthModal('landlord');\n        setCurrentView('browse');\n      } else if (!currentUser.landlordComplete) {\n        // Landlord but hasn't completed onboarding\n        setCurrentView('landlord-onboarding');\n      }\n    }\n  }, [currentView, currentUser, userType]);\n\n  const loadData = async () => {\n    try {\n      // Try to load from Firestore first\n      const firestoreListings = await fetchListings();\n      if (firestoreListings && firestoreListings.length > 0) {\n        console.log('Loaded listings from Firestore');\n        setListings(firestoreListings);\n        // Also cache to localStorage for offline access\n        localStorage.setItem('listings', JSON.stringify(firestoreListings));\n      } else {\n        // Fall back to localStorage\n        const listingsResult = localStorage.getItem('listings');\n        if (listingsResult) {\n          console.log('Loaded listings from localStorage (Firestore empty or unavailable)');\n          setListings(JSON.parse(listingsResult));\n        }\n      }\n      \n      const userResult = localStorage.getItem('current-user');\n      const usersResult = localStorage.getItem('users');\n      if (userResult) {\n        const user = JSON.parse(userResult);\n        setCurrentUser(user);\n        setUserType(user.type);\n      }\n      if (usersResult) {\n        try {\n          const parsed = JSON.parse(usersResult);\n          setUsers(Array.isArray(parsed) ? parsed : []);\n        } catch (e) {\n          console.warn('Corrupt users array in storage, resetting');\n          setUsers([]);\n        }\n      }\n    } catch (error) {\n      console.log('No existing data found, starting fresh');\n      // Add sample listings for testing the map\n      const sampleListings = [\n        {\n          id: 'listing-1',\n          title: 'Cozy Room in Soweto',\n          price: 2500,\n          location: 'Soweto, Johannesburg',\n          description: 'Comfortable room with bathroom and kitchen access',\n          photos: [],\n          status: 'available',\n          availableDate: new Date().toISOString(),\n          amenities: ['WiFi', 'Kitchen'],\n          landlordId: 'landlord-1',\n          landlordName: 'John Smith',\n          landlordPhone: '+27 123 456 7890',\n          landlordEmail: 'john@example.com',\n          landlordPhoto: '',\n          createdAt: new Date().toISOString()\n        },\n        {\n          id: 'listing-2',\n          title: 'Modern Apartment in Sandton',\n          price: 4500,\n          location: 'Sandton, Johannesburg',\n          description: 'Luxurious apartment with parking and security',\n          photos: [],\n          status: 'available',\n          availableDate: new Date().toISOString(),\n          amenities: ['WiFi', 'Parking', 'Air Conditioning'],\n          landlordId: 'landlord-2',\n          landlordName: 'Jane Doe',\n          landlordPhone: '+27 987 654 3210',\n          landlordEmail: 'jane@example.com',\n          landlordPhoto: '',\n          createdAt: new Date().toISOString()\n        },\n        {\n          id: 'listing-3',\n          title: 'Studio in Midrand',\n          price: 3200,\n          location: 'Midrand, Johannesburg',\n          description: 'Spacious studio flat with laundry facilities',\n          photos: [],\n          status: 'available',\n          availableDate: new Date().toISOString(),\n          amenities: ['Laundry', 'WiFi'],\n          landlordId: 'landlord-3',\n          landlordName: 'Mike Johnson',\n          landlordPhone: '+27 555 555 5555',\n          landlordEmail: 'mike@example.com',\n          landlordPhoto: '',\n          createdAt: new Date().toISOString()\n        }\n      ];\n      setListings(sampleListings);\n    }\n  };\n\n  // Helper: check for duplicate phone or email in registry (exclude an optional user id)\n  const isDuplicateContact = (phone, email, ignoreId = null) => {\n    const normalizedPhone = (phone || '').trim();\n    const normalizedEmail = (email || '').trim().toLowerCase();\n    if (!users || users.length === 0) return false;\n    return users.some(u => {\n      if (ignoreId && u.id === ignoreId) return false;\n      const uPhone = (u.phone || '').trim();\n      const uEmail = (u.email || '').trim().toLowerCase();\n      const phoneMatch = normalizedPhone && uPhone && uPhone === normalizedPhone;\n      const emailMatch = normalizedEmail && uEmail && uEmail === normalizedEmail;\n      return phoneMatch || emailMatch;\n    });\n  };\n\n  // Toast notification helper\n  const showToast = (message, type = 'info', title = '') => {\n    setToast({ message, type, title });\n    setTimeout(() => setToast(null), 5000);\n  };\n\n  const handleAnalyticsConsentAccept = () => {\n    localStorage.setItem('analytics-consent', 'yes');\n    setShowAnalyticsConsent(false);\n    const app = initFirebase();\n    initAnalytics(app);\n    trackEvent('analytics_consent_granted');\n    showToast('Analytics enabled', 'success', 'Thank you!');\n  };\n\n  const handleAnalyticsConsentDecline = () => {\n    localStorage.setItem('analytics-consent', 'no');\n    setShowAnalyticsConsent(false);\n    showToast('Analytics disabled', 'info');\n  };\n\n  const saveListings = async (newListings) => {\n    try {\n      localStorage.setItem('listings', JSON.stringify(newListings));\n      setListings(newListings);\n      // Broadcast to runtime service worker for offline snapshot caching\n      if (navigator.serviceWorker && navigator.serviceWorker.controller) {\n        try { navigator.serviceWorker.controller.postMessage({ type: 'SYNC_LISTINGS', payload: newListings }); } catch {}\n      }\n    } catch (error) {\n      console.error('Error saving listings:', error);\n    }\n  };\n\n  const saveSubscriptions = async (subscriptions) => {\n    try {\n      localStorage.setItem('subscriptions', JSON.stringify(subscriptions));\n    } catch (error) {\n      console.error('Error saving subscriptions:', error);\n    }\n  };\n\n  const getSubscriptions = async () => {\n    try {\n      const res = localStorage.getItem('subscriptions');\n      return res ? JSON.parse(res) : {};\n    } catch (err) {\n      console.error('Error loading subscriptions', err);\n    }\n    return {};\n  };\n\n  const subscribeToArea = async (userId, area) => {\n    if (!userId) {\n      openAuthModal('renter');\n      return;\n    }\n    if (!area || area.trim() === '') {\n      alert('Please enter a location to subscribe to.');\n      return;\n    }\n    try {\n      const subs = await getSubscriptions();\n      subs[userId] = subs[userId] || [];\n      if (!subs[userId].includes(area)) {\n        subs[userId].push(area);\n        await saveSubscriptions(subs);\n        alert(`Subscribed to updates for ${area}`);\n      } else {\n        alert(`You are already subscribed to ${area}`);\n      }\n    } catch (err) {\n      console.error('Subscribe failed', err);\n      alert('Could not subscribe. Please try again.');\n    }\n  };\n\n  \n\nconst handleProfileSetup = async (profileData) => {\n  try {\n    // Duplicate guard\n    if (isDuplicateContact(profileData.phone, profileData.email)) {\n      showToast('Phone or email already registered', 'error', 'Duplicate');\n      return;\n    }\n    const userId = `user-${Date.now()}`;\n    const user = { \n      id: userId, \n      type: userType, \n      ...profileData,\n      whatsapp: profileData.whatsapp || '',\n      notificationPrefs: { updates: true, marketing: false },\n      createdAt: new Date().toISOString()\n    };\n    \n    localStorage.setItem('current-user', JSON.stringify(user));\n    setCurrentUser(user);\n    // Update users registry\n    const existingUsersRaw = localStorage.getItem('users');\n    let existingUsers = [];\n    if (existingUsersRaw) {\n      try { existingUsers = JSON.parse(existingUsersRaw); } catch { existingUsers = []; }\n    }\n    existingUsers.push(user);\n    localStorage.setItem('users', JSON.stringify(existingUsers));\n    setUsers(existingUsers);\n    showToast('Profile created successfully!', 'success', 'Welcome!');\n    setCurrentView('browse');\n  } catch (error) {\n    console.error('Error saving profile:', error);\n    // Still set the user locally even if storage fails\n    const userId = `user-${Date.now()}`;\n    const user = { \n      id: userId, \n      type: userType, \n      ...profileData,\n      whatsapp: profileData.whatsapp || '',\n      createdAt: new Date().toISOString()\n    };\n    setCurrentUser(user);\n    const existingUsersRaw = localStorage.getItem('users');\n    let existingUsers = [];\n    if (existingUsersRaw) {\n      try { existingUsers = JSON.parse(existingUsersRaw); } catch { existingUsers = []; }\n    }\n    existingUsers.push(user);\n    try { localStorage.setItem('users', JSON.stringify(existingUsers)); } catch {}\n    setUsers(existingUsers);\n    showToast('Profile created (data may not be persisted)', 'error');\n    setCurrentView('browse');\n  }\n};\n\nconst handleUpdateProfile = async (profileData) => {\n  try {\n    // Duplicate guard (exclude current user id)\n    if (isDuplicateContact(profileData.phone, profileData.email, currentUser?.id)) {\n      showToast('Phone or email already used by another account', 'error', 'Duplicate');\n      return;\n    }\n    const updatedUser = { ...currentUser, ...profileData };\n    \n    localStorage.setItem('current-user', JSON.stringify(updatedUser));\n    setCurrentUser(updatedUser);\n    // Update registry entry\n    const existingUsersRaw = localStorage.getItem('users');\n    let existingUsers = [];\n    if (existingUsersRaw) {\n      try { existingUsers = JSON.parse(existingUsersRaw); } catch { existingUsers = []; }\n    }\n    const idx = existingUsers.findIndex(u => u.id === updatedUser.id);\n    if (idx !== -1) {\n      existingUsers[idx] = updatedUser;\n    } else {\n      existingUsers.push(updatedUser); // ensure presence\n    }\n    localStorage.setItem('users', JSON.stringify(existingUsers));\n    setUsers(existingUsers);\n    showToast('Profile updated successfully!', 'success');\n    setCurrentView('browse');\n  } catch (error) {\n    console.error('Error updating profile:', error);\n    const updatedUser = { ...currentUser, ...profileData };\n    setCurrentUser(updatedUser);\n    const existingUsersRaw = localStorage.getItem('users');\n    let existingUsers = [];\n    if (existingUsersRaw) {\n      try { existingUsers = JSON.parse(existingUsersRaw); } catch { existingUsers = []; }\n    }\n    const idx = existingUsers.findIndex(u => u.id === updatedUser.id);\n    if (idx !== -1) {\n      existingUsers[idx] = updatedUser;\n    } else {\n      existingUsers.push(updatedUser);\n    }\n    try { localStorage.setItem('users', JSON.stringify(existingUsers)); } catch {}\n    setUsers(existingUsers);\n    showToast('Profile updated (data may not be persisted)', 'error');\n    setCurrentView('browse');\n  }\n};\n\nconst handleQuickAuth = async (profileData) => {\n  // Lightweight auth (used by AuthModal) - create and persist a user\n  try {\n    if (isDuplicateContact(profileData.phone, profileData.email)) {\n      showToast('Phone or email already registered', 'error', 'Duplicate');\n      return;\n    }\n    const userId = `user-${Date.now()}`;\n    const user = {\n      id: userId,\n      type: profileData.type || 'renter',\n      name: profileData.name,\n      phone: profileData.phone || '',\n      email: profileData.email || '',\n      photo: profileData.photo || '',\n      notificationPrefs: { updates: true, marketing: false },\n      createdAt: new Date().toISOString()\n    };\n    localStorage.setItem('current-user', JSON.stringify(user));\n    setCurrentUser(user);\n    setUserType(user.type);\n    // registry update\n    const existingUsersRaw = localStorage.getItem('users');\n    let existingUsers = [];\n    if (existingUsersRaw) {\n      try { existingUsers = JSON.parse(existingUsersRaw); } catch { existingUsers = []; }\n    }\n    existingUsers.push(user);\n    localStorage.setItem('users', JSON.stringify(existingUsers));\n    setUsers(existingUsers);\n    setShowAuthModal(false);\n    // If landlord, route to onboarding to complete setup before posting\n    if (user.type === 'landlord') {\n      setCurrentView('landlord-onboarding');\n    } else {\n      setCurrentView('browse');\n    }\n  } catch (err) {\n    console.error('Auth failed', err);\n  }\n};\n\n// Sign out helper so you can re-auth as renter for perspective preview\nconst handleSignOut = () => {\n  try {\n    localStorage.removeItem('current-user');\n  } catch (e) {\n    console.warn('Could not clear localStorage current-user');\n  }\n  setCurrentUser(null);\n  setUserType(null);\n  setCurrentView('browse');\n  showToast('Signed out. You can now sign in as Renter.', 'info');\n};\n\nconst handleCompleteOnboarding = async (onboardData) => {\n  try {\n    const updated = { ...currentUser, landlordComplete: true, landlordInfo: onboardData };\n    localStorage.setItem('current-user', JSON.stringify(updated));\n    setCurrentUser(updated);\n    setCurrentView('browse');\n  } catch (err) {\n    console.error('Onboarding save failed', err);\n    setCurrentUser({ ...currentUser, landlordComplete: true, landlordInfo: onboardData });\n    setCurrentView('browse');\n  }\n};\n\nconst handleAddListing = async (listingData) => {\n  // Combine streetAddress and location into fullAddress for complete address storage\n  const fullAddress = [listingData.streetAddress, listingData.location]\n    .filter(Boolean)\n    .join(', ');\n  \n  const newListingData = {\n    title: listingData.title,\n    price: listingData.price,\n    location: listingData.location,\n    streetAddress: listingData.streetAddress || '',\n    fullAddress: fullAddress || listingData.location || '', // Store complete address\n    description: listingData.description,\n    photos: listingData.photos || [],\n    status: listingData.status || 'available',\n    availableDate: listingData.availableDate || new Date().toISOString(),\n    amenities: listingData.amenities || [],\n    latitude: listingData.latitude ?? null,\n    longitude: listingData.longitude ?? null,\n    paymentMethod: listingData.paymentMethod || 'Bank and Cash',\n    premium: !!listingData.premium,\n    landlordId: currentUser.id,\n    landlordName: currentUser.name,\n    landlordPhone: currentUser.phone,\n    landlordEmail: currentUser.email,\n    landlordPhoto: currentUser.photo,\n  };\n\n  try {\n    // Try to save to Firestore first\n    const firestoreId = await addListing(newListingData);\n    if (firestoreId) {\n      // Successfully saved to Firestore\n      const newListing = { ...newListingData, id: firestoreId, createdAt: new Date().toISOString() };\n      const updatedListings = [...listings, newListing];\n      setListings(updatedListings);\n      // Also cache locally\n      localStorage.setItem('listings', JSON.stringify(updatedListings));\n      showToast('Listing created and shared online!', 'success', 'Success!');\n    } else {\n      // Firestore not available, save locally only\n      const newListing = { ...newListingData, id: `listing-${Date.now()}`, createdAt: new Date().toISOString() };\n      const updatedListings = [...listings, newListing];\n      await saveListings(updatedListings);\n      showToast('Listing saved locally (offline mode)', 'info', 'Saved');\n    }\n  } catch (error) {\n    console.error('Error adding listing:', error);\n    // Fall back to local save\n    const newListing = { ...newListingData, id: `listing-${Date.now()}`, createdAt: new Date().toISOString() };\n    const updatedListings = [...listings, newListing];\n    await saveListings(updatedListings);\n    showToast('Listing saved locally', 'info', 'Saved');\n  }\n  \n  setCurrentView('browse');\n  // Scroll to top to see new listing\n  window.scrollTo({ top: 0, behavior: 'smooth' });\n};\n\n  // Messaging removed\n\nconst filteredListings = listings\n  .filter(listing => {\n    const matchesLocation = !searchLocation || \n      (listing.location || '').toLowerCase().includes(searchLocation.toLowerCase());\n    const price = parseFloat(listing.price);\n    const matchesPrice = price >= priceRange[0] && price <= priceRange[1];\n    const matchesAmenities = selectedAmenities.length === 0 || \n      selectedAmenities.every(amenity => listing.amenities?.includes(amenity));\n\n    return matchesLocation && matchesPrice && matchesAmenities;\n  })\n  .sort((a, b) => {\n    if (a.premium && !b.premium) return -1;\n    if (!a.premium && b.premium) return 1;\n    if (sortBy === 'newest') {\n      return new Date(b.createdAt) - new Date(a.createdAt);\n    } else if (sortBy === 'cheapest') {\n      return parseFloat(a.price) - parseFloat(b.price);\n    } else if (sortBy === 'expensive') {\n      return parseFloat(b.price) - parseFloat(a.price);\n    }\n    return 0;\n  });\n\n  // Allow guests to land on Browse by default. If userType isn't set,\n  // show a gentle callout in the header (below) so users can pick a role\n  // when they want to post or set up their profile.\n\n  return (\n    <div className=\"min-h-screen bg-gradient-to-b from-slate-50 to-gray-100\">\n      {/* Offline Indicator */}\n      <OfflineIndicator />\n      \n      {/* Back to Top Button */}\n      <BackToTop />\n      \n      <Header\n        currentUser={currentUser}\n        previewAsRenter={previewAsRenter}\n        setPreviewAsRenter={setPreviewAsRenter}\n        openAuthModal={openAuthModal}\n        handleSignOut={handleSignOut}\n        setCurrentView={setCurrentView}\n        unreadCount={unreadCount}\n        onOpenNotifications={() => setShowNotificationsPanel(true)}\n      />\n\n      {/* Notification Banner (Push Notifications) */}\n      {notificationBanner && (\n        <NotificationBanner\n          title={notificationBanner.title}\n          body={notificationBanner.body}\n          onClose={() => setNotificationBanner(null)}\n        />\n      )}\n\n      {/* Toast Notification */}\n      {toast && (\n        <div className={`fixed top-20 right-4 z-50 max-w-sm w-full transition-all duration-300 ${\n          toast.type === 'error' ? 'bg-gradient-to-r from-rose-50 to-red-50 border-rose-400' :\n          toast.type === 'success' ? 'bg-gradient-to-r from-emerald-50 to-green-50 border-emerald-400' :\n          toast.type === 'warning' ? 'bg-gradient-to-r from-amber-50 to-yellow-50 border-amber-400' :\n          'bg-gradient-to-r from-sky-50 to-blue-50 border-sky-400'\n        } border-l-4 rounded-xl shadow-2xl p-4 fade-in backdrop-blur-sm`}>\n          <div className=\"flex items-start gap-3\">\n            <div className={`flex-shrink-0 w-8 h-8 rounded-xl flex items-center justify-center shadow-sm ${\n              toast.type === 'error' ? 'bg-rose-500' :\n              toast.type === 'success' ? 'bg-emerald-500' :\n              toast.type === 'warning' ? 'bg-amber-500' :\n              'bg-sky-500'\n            }`}>\n              {toast.type === 'success' && <CheckCircle className=\"w-5 h-5 text-white\" />}\n              {toast.type === 'error' && <span className=\"text-white font-bold text-sm\"></span>}\n              {toast.type === 'warning' && <span className=\"text-white font-bold text-sm\">!</span>}\n              {toast.type === 'info' && <span className=\"text-white font-bold text-sm\">i</span>}\n            </div>\n            <div className=\"flex-1 min-w-0\">\n              {toast.title && <p className={`font-bold mb-0.5 ${\n                toast.type === 'error' ? 'text-rose-800' :\n                toast.type === 'success' ? 'text-emerald-800' :\n                toast.type === 'warning' ? 'text-amber-800' :\n                'text-sky-800'\n              }`}>{toast.title}</p>}\n              <p className={`text-sm ${\n                toast.type === 'error' ? 'text-rose-700' :\n                toast.type === 'success' ? 'text-emerald-700' :\n                toast.type === 'warning' ? 'text-amber-700' :\n                'text-sky-700'\n              }`}>{toast.message}</p>\n            </div>\n            <button \n              onClick={() => setToast(null)}\n              className={`flex-shrink-0 p-1.5 rounded-lg hover:bg-white/50 transition ${\n                toast.type === 'error' ? 'text-rose-500 hover:text-rose-700' :\n                toast.type === 'success' ? 'text-emerald-500 hover:text-emerald-700' :\n                toast.type === 'warning' ? 'text-amber-500 hover:text-amber-700' :\n                'text-sky-500 hover:text-sky-700'\n              }`}\n              aria-label=\"Close notification\"\n            >\n              <X className=\"w-4 h-4\" />\n            </button>\n          </div>\n        </div>\n      )}\n\n      <div id=\"main-content\" className=\"max-w-7xl mx-auto pb-24 px-4 sm:px-6 lg:px-8\" role=\"main\">\n        {currentView === 'setup-profile' && (\n          <ProfileSetupView onSubmit={handleProfileSetup} userType={userType} />\n        )}\n\n        {currentView === 'profile' && currentUser && (\n          <ProfileView \n            user={currentUser} \n            onEdit={() => setCurrentView('edit-profile')} \n            onUpdatePrefs={(prefs) => {\n              const updated = { ...currentUser, notificationPrefs: prefs };\n              setCurrentUser(updated);\n              try {\n                localStorage.setItem('current-user', JSON.stringify(updated));\n                // update registry\n                const raw = localStorage.getItem('users');\n                if (raw) {\n                  try {\n                    const arr = JSON.parse(raw);\n                    const idx = arr.findIndex(u => u.id === updated.id);\n                    if (idx !== -1) { arr[idx] = updated; localStorage.setItem('users', JSON.stringify(arr)); }\n                  } catch {}\n                }\n              } catch {}\n              showToast('Preferences updated', 'success');\n            }}\n          />\n        )}\n\n        {currentView === 'edit-profile' && currentUser && (\n          <EditProfileView user={currentUser} onSubmit={handleUpdateProfile} onCancel={() => setCurrentView('profile')} />\n        )}\n\n        {currentView === 'landlord-onboarding' && currentUser && userType === 'landlord' && (\n          <LandlordOnboardingView onComplete={handleCompleteOnboarding} onCancel={() => setCurrentView('browse')} currentUser={currentUser} />\n        )}\n\n        {currentView === 'browse' && (\n                    <BrowseView \n                      listings={filteredListings}\n                      searchLocation={searchLocation}\n                      setSearchLocation={setSearchLocation}\n                      priceRange={priceRange}\n                      setPriceRange={setPriceRange}\n                      selectedAmenities={selectedAmenities}\n                      setSelectedAmenities={setSelectedAmenities}\n                      sortBy={sortBy}\n                      setSortBy={setSortBy}\n                      onSelectListing={setSelectedListing}\n                      setCurrentView={setCurrentView}\n                      currentUser={currentUser}\n                      onRequireAuth={openAuthModal}\n                      subscribeToArea={subscribeToArea}\n                      previewMode={previewAsRenter}\n                    />\n        )}\n\n        {/* Messages view removed */}\n\n        {currentView === 'add' && (\n          <AddListingView\n            onSubmit={handleAddListing}\n            onCancel={() => setCurrentView('browse')}\n            currentUser={currentUser}\n            userType={userType}\n            onRequireAuth={openAuthModal}\n            onRequireOnboarding={() => setCurrentView('landlord-onboarding')}\n          />\n        )}\n\n        {currentView === 'my-listings' && currentUser && userType === 'landlord' && (\n          <MyListingsView \n            listings={listings.filter(l => l.landlordId === currentUser.id)}\n            onDelete={async (id) => {\n              try {\n                // Try to delete from Firestore first\n                const deleted = await deleteListing(id);\n                if (deleted) {\n                  showToast('Listing deleted', 'success');\n                }\n              } catch (error) {\n                console.error('Firestore delete failed:', error);\n              }\n              // Also update local state and localStorage\n              const updated = listings.filter(l => l.id !== id);\n              setListings(updated);\n              localStorage.setItem('listings', JSON.stringify(updated));\n            }}\n          />\n        )}\n\n        {currentView === 'favorites' && (\n          <FavoritesView\n            listings={listings}\n            onSelectListing={setSelectedListing}\n          />\n        )}\n      </div>\n\n      {selectedListing && (\n        <ListingDetailModal \n          listing={selectedListing}\n          landlord={{\n            name: selectedListing.landlordName,\n            phone: selectedListing.landlordPhone,\n            email: selectedListing.landlordEmail,\n            photo: selectedListing.landlordPhoto\n          }}\n          onClose={() => setSelectedListing(null)}\n          userType={userType}\n          currentUser={currentUser}\n          onRequireAuth={openAuthModal}\n          previewMode={previewAsRenter}\n          showToast={showToast}\n        />\n      )}\n\n      {/* Conversation modal removed */}\n\n      {showAuthModal && (\n        <AuthModal\n          defaultType={authDefaultType}\n          onClose={() => setShowAuthModal(false)}\n          onSubmit={handleQuickAuth}\n        />\n      )}\n\n      <BottomNav \n        currentView={currentView}\n        setCurrentView={setCurrentView}\n        userType={userType}\n      />\n\n      {showPrivacyPolicy && (\n        <PrivacyPolicyModal onClose={() => setShowPrivacyPolicy(false)} />\n      )}\n\n      {showAnalyticsConsent && (\n        <AnalyticsConsentModal\n          onAccept={handleAnalyticsConsentAccept}\n          onDecline={handleAnalyticsConsentDecline}\n        />\n      )}\n\n      {showNotificationsPanel && (\n        <NotificationsPanel\n          onClose={() => {\n            setShowNotificationsPanel(false);\n            setUnreadCount(getNotifications().filter(n => !n.read).length);\n          }}\n          onSelectListing={(listingId) => {\n            const listing = listings.find(l => (l.id || `${l.title}-${l.createdAt}`) === listingId);\n            if (listing) {\n              setSelectedListing(listing);\n            }\n            setShowNotificationsPanel(false);\n          }}\n        />\n      )}\n\n      <Footer onOpenPrivacy={() => setShowPrivacyPolicy(true)} />\n    </div>\n  );\n}\n\n\n\nfunction ProfileSetupView({ onSubmit, userType }) {\n  const [formData, setFormData] = useState({\n    name: '',\n    phone: '',\n    email: '',\n    whatsapp: '',\n    photo: ''\n  });\n  const [errors, setErrors] = useState({});\n  const [touched, setTouched] = useState({});\n\n  const validateField = (name, value, extras = {}) => {\n    const newErrors = { ...errors };\n    switch (name) {\n      case 'name':\n        if (!value || value.trim().length < 2) {\n          newErrors.name = 'Name must be at least 2 characters';\n        } else {\n          delete newErrors.name;\n        }\n        break;\n      case 'phone':\n        if (!value || !/^[+]?[-0-9()\\s]{7,}$/.test(value.trim())) {\n          newErrors.phone = 'Enter a valid phone number (min 7 digits)';\n        } else {\n          delete newErrors.phone;\n        }\n        break;\n      case 'email':\n        if (!value || !/^[^@\\s]+@[^@\\s]+\\.[^@\\s]+$/.test(value.trim())) {\n          newErrors.email = 'Enter a valid email address';\n        } else {\n          delete newErrors.email;\n        }\n        break;\n      case 'photo':\n        if (value === 'FILE_TOO_LARGE') {\n          newErrors.photo = 'Photo is too large (max 2MB)';\n        } else {\n          delete newErrors.photo;\n        }\n        break;\n      default:\n        break;\n    }\n    setErrors(newErrors);\n  };\n\n  const handlePhotoUpload = (e) => {\n    const file = e.target.files[0];\n    if (file) {\n      if (file.size > 2 * 1024 * 1024) { // 2MB limit\n        setFormData({ ...formData, photo: '' });\n        validateField('photo', 'FILE_TOO_LARGE');\n        return;\n      }\n      const reader = new FileReader();\n      reader.onloadend = () => {\n        setFormData({ ...formData, photo: reader.result });\n        validateField('photo', reader.result);\n      };\n      reader.readAsDataURL(file);\n    }\n  };\n\n  const handleSubmit = () => {\n    // Touch all fields\n    const allTouched = { name: true, phone: true, email: true, photo: true };\n    setTouched(allTouched);\n    validateField('name', formData.name);\n    validateField('phone', formData.phone);\n    validateField('email', formData.email);\n    if (Object.keys(errors).length === 0 && formData.name && formData.phone && formData.email) {\n      onSubmit(formData);\n    }\n  };\n\n  return (\n    <div className=\"p-4 min-h-screen bg-gradient-to-b from-slate-50 to-gray-100 pb-24\">\n      <div className=\"max-w-2xl mx-auto mt-8\">\n        <div className=\"bg-white rounded-2xl shadow-lg border border-gray-100 p-8\">\n          <div className=\"text-center mb-8\">\n            <h2 className=\"text-3xl font-extrabold text-gray-900 mb-2\">Complete Your Profile</h2>\n            <p className=\"text-gray-600\">Help others know who you are</p>\n          </div>\n\n          <div className=\"space-y-6\">\n            {/* Photo Upload */}\n            <div className=\"flex justify-center mb-8\">\n              <div className=\"relative\">\n                {formData.photo ? (\n                  <img \n                    src={formData.photo} \n                    alt=\"Profile\" \n                    className=\"w-32 h-32 rounded-full object-cover border-4 border-blue-200 shadow-lg\" \n                  />\n                ) : (\n                  <div className=\"w-32 h-32 rounded-full bg-gradient-to-br from-blue-100 to-blue-200 flex items-center justify-center border-4 border-blue-200 shadow-lg\">\n                    <User className=\"w-16 h-16 text-blue-600\" />\n                  </div>\n                )}\n                <label className=\"absolute bottom-0 right-0 bg-blue-600 hover:bg-blue-700 text-white p-3 rounded-full cursor-pointer shadow-lg transition group\" aria-label=\"Upload profile photo\">\n                  <Edit className=\"w-5 h-5\" />\n                  <input\n                    type=\"file\"\n                    accept=\"image/*\"\n                    onChange={handlePhotoUpload}\n                    className=\"hidden\"\n                  />\n                </label>\n              </div>\n            </div>\n\n            {/* Form Fields */}\n            <div>\n              <label className=\"block text-sm font-semibold text-gray-800 mb-2\">Full Name *</label>\n              <input\n                type=\"text\"\n                required\n                value={formData.name}\n                onChange={(e) => { setFormData({ ...formData, name: e.target.value }); if (touched.name) validateField('name', e.target.value); }}\n                onBlur={(e) => { setTouched({ ...touched, name: true }); validateField('name', e.target.value); }}\n                placeholder=\"Enter your full name\"\n                aria-invalid={errors.name ? 'true' : 'false'}\n                aria-describedby={errors.name ? 'profile-name-error' : undefined}\n                className={`w-full px-4 py-3 border-2 ${errors.name ? 'border-red-400' : 'border-gray-200'} bg-white text-gray-800 rounded-xl focus:ring-2 focus:ring-teal-400 focus:border-transparent transition placeholder-gray-400`}\n              />\n              {errors.name && touched.name && <p id=\"profile-name-error\" className=\"mt-1 text-xs text-red-600\">{errors.name}</p>}\n            </div>\n\n            <div>\n              <label className=\"block text-sm font-semibold text-gray-800 mb-2\">Phone Number *</label>\n              <div className=\"relative\">\n                <Phone className=\"absolute left-4 top-3.5 w-5 h-5 text-gray-400\" />\n                <input\n                  type=\"tel\"\n                  required\n                  value={formData.phone}\n                  onChange={(e) => { setFormData({ ...formData, phone: e.target.value }); if (touched.phone) validateField('phone', e.target.value); }}\n                  onBlur={(e) => { setTouched({ ...touched, phone: true }); validateField('phone', e.target.value); }}\n                  placeholder=\"e.g., +27 12 345 6789\"\n                  aria-invalid={errors.phone ? 'true' : 'false'}\n                  aria-describedby={errors.phone ? 'profile-phone-error' : undefined}\n                  className={`w-full pl-11 pr-4 py-3 border-2 ${errors.phone ? 'border-red-400' : 'border-gray-200'} bg-white text-gray-800 rounded-xl focus:ring-2 focus:ring-teal-400 focus:border-transparent transition placeholder-gray-400`}\n                />\n              </div>\n              {errors.phone && touched.phone && <p id=\"profile-phone-error\" className=\"mt-1 text-xs text-red-600\">{errors.phone}</p>}\n            </div>\n\n            <div>\n              <label className=\"block text-sm font-semibold text-gray-800 mb-2\">Email Address *</label>\n              <div className=\"relative\">\n                <Mail className=\"absolute left-4 top-3.5 w-5 h-5 text-gray-400\" />\n                <input\n                  type=\"email\"\n                  required\n                  value={formData.email}\n                  onChange={(e) => { setFormData({ ...formData, email: e.target.value }); if (touched.email) validateField('email', e.target.value); }}\n                  onBlur={(e) => { setTouched({ ...touched, email: true }); validateField('email', e.target.value); }}\n                  placeholder=\"your.email@example.com\"\n                  aria-invalid={errors.email ? 'true' : 'false'}\n                  aria-describedby={errors.email ? 'profile-email-error' : undefined}\n                  className={`w-full pl-11 pr-4 py-3 border-2 ${errors.email ? 'border-red-400' : 'border-gray-200'} bg-white text-gray-800 rounded-xl focus:ring-2 focus:ring-teal-400 focus:border-transparent transition placeholder-gray-400`}\n                />\n              </div>\n              {errors.email && touched.email && <p id=\"profile-email-error\" className=\"mt-1 text-xs text-red-600\">{errors.email}</p>}\n            </div>\n\n            <div>\n              <label className=\"block text-sm font-semibold text-gray-800 mb-2\">WhatsApp (optional)</label>\n              <div className=\"relative\">\n                <Phone className=\"absolute left-4 top-3.5 w-5 h-5 text-gray-400\" />\n                <input\n                  type=\"tel\"\n                  value={formData.whatsapp}\n                  onChange={(e) => setFormData({ ...formData, whatsapp: e.target.value })}\n                  placeholder=\"e.g., +27 71 234 5678\"\n                  className=\"w-full pl-11 pr-4 py-3 border-2 border-gray-200 bg-white text-gray-800 rounded-xl focus:ring-2 focus:ring-teal-400 focus:border-transparent transition placeholder-gray-400\"\n                />\n              </div>\n              <p className=\"text-xs text-gray-500 mt-1\">Used to create a WhatsApp chat link on your listings.</p>\n            </div>\n\n            {/* Submit Button */}\n            <button\n              onClick={handleSubmit}\n              className=\"w-full bg-gradient-to-r from-teal-500 to-cyan-500 hover:from-teal-600 hover:to-cyan-600 text-white font-semibold py-3 rounded-xl transition mt-8 shadow-lg hover:shadow-xl\"\n            >\n              Complete Setup\n            </button>\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n}\n\nfunction ProfileView({ user, onEdit, onUpdatePrefs }) {\n  const prefs = user.notificationPrefs || { updates: true, marketing: false };\n  const [localPrefs, setLocalPrefs] = React.useState(prefs);\n\n  const togglePref = (key) => {\n    const next = { ...localPrefs, [key]: !localPrefs[key] };\n    setLocalPrefs(next);\n    onUpdatePrefs && onUpdatePrefs(next);\n  };\n\n  return (\n    <div className=\"min-h-screen bg-gradient-to-b from-slate-50 to-gray-100 pb-24\">\n      {/* Profile Header with Gradient */}\n      <div className=\"bg-gradient-to-br from-teal-600 via-teal-500 to-cyan-500 pt-8 pb-20 px-4\">\n        <div className=\"max-w-xl mx-auto flex justify-between items-start\">\n          <h2 className=\"text-2xl font-bold text-white\">My Profile</h2>\n          <button\n            onClick={onEdit}\n            className=\"bg-white/20 hover:bg-white/30 backdrop-blur-sm text-white px-4 py-2 rounded-xl transition-all duration-200 flex items-center gap-2 border border-white/30\"\n          >\n            <Edit className=\"w-4 h-4\" />\n            Edit\n          </button>\n        </div>\n      </div>\n\n      {/* Profile Card - Overlapping Header */}\n      <div className=\"px-4 -mt-16\">\n        <div className=\"bg-white rounded-2xl shadow-xl border border-gray-100 p-6 max-w-xl mx-auto\">\n          {/* Avatar & Name */}\n          <div className=\"flex flex-col items-center -mt-16 mb-6\">\n            {user.photo ? (\n              <img \n                src={user.photo} \n                alt=\"Profile\" \n                className=\"w-28 h-28 rounded-2xl object-cover border-4 border-white shadow-lg mb-4\" \n              />\n            ) : (\n              <div className=\"w-28 h-28 rounded-2xl bg-gradient-to-br from-teal-400 to-cyan-500 flex items-center justify-center border-4 border-white shadow-lg mb-4\">\n                <span className=\"text-4xl font-bold text-white\">\n                  {user.name?.charAt(0)?.toUpperCase() || 'U'}\n                </span>\n              </div>\n            )}\n            <h3 className=\"text-2xl font-bold text-gray-900\">{user.name}</h3>\n            <span className=\"inline-flex items-center mt-2 px-4 py-1.5 bg-gradient-to-r from-teal-50 to-cyan-50 text-teal-700 rounded-full text-sm font-semibold border border-teal-100\">\n              {user.type === 'landlord' ? (\n                <>\n                  <Home className=\"w-4 h-4 mr-1.5\" />\n                  Landlord\n                </>\n              ) : (\n                <>\n                  <User className=\"w-4 h-4 mr-1.5\" />\n                  Renter\n                </>\n              )}\n            </span>\n          </div>\n\n          {/* Contact Info Cards */}\n          <div className=\"space-y-3 mb-6\">\n            <div className=\"bg-gradient-to-r from-gray-50 to-slate-50 rounded-xl p-4 border border-gray-100 hover:border-gray-200 transition-colors\">\n              <div className=\"flex items-center\">\n                <div className=\"w-11 h-11 bg-gradient-to-br from-teal-100 to-cyan-100 rounded-xl flex items-center justify-center mr-4 shadow-sm\">\n                  <Phone className=\"w-5 h-5 text-teal-600\" />\n                </div>\n                <div>\n                  <p className=\"text-xs font-medium text-gray-500 mb-0.5\">Phone Number</p>\n                  <p className=\"font-semibold text-gray-800\">{user.phone}</p>\n                </div>\n              </div>\n            </div>\n\n            <div className=\"bg-gradient-to-r from-gray-50 to-slate-50 rounded-xl p-4 border border-gray-100 hover:border-gray-200 transition-colors\">\n              <div className=\"flex items-center\">\n                <div className=\"w-11 h-11 bg-gradient-to-br from-cyan-100 to-blue-100 rounded-xl flex items-center justify-center mr-4 shadow-sm\">\n                  <Mail className=\"w-5 h-5 text-cyan-600\" />\n                </div>\n                <div>\n                  <p className=\"text-xs font-medium text-gray-500 mb-0.5\">Email Address</p>\n                  <p className=\"font-semibold text-gray-800\">{user.email}</p>\n                </div>\n              </div>\n            </div>\n\n            <div className=\"bg-gradient-to-r from-gray-50 to-slate-50 rounded-xl p-4 border border-gray-100 hover:border-gray-200 transition-colors\">\n              <div className=\"flex items-center\">\n                <div className=\"w-11 h-11 bg-gradient-to-br from-violet-100 to-purple-100 rounded-xl flex items-center justify-center mr-4 shadow-sm\">\n                  <Calendar className=\"w-5 h-5 text-violet-600\" />\n                </div>\n                <div>\n                  <p className=\"text-xs font-medium text-gray-500 mb-0.5\">Member Since</p>\n                  <p className=\"font-semibold text-gray-800\">\n                    {new Date(user.createdAt).toLocaleDateString('en-ZA', { \n                      year: 'numeric', \n                      month: 'long', \n                      day: 'numeric' \n                    })}\n                  </p>\n                </div>\n              </div>\n            </div>\n          </div>\n\n          {/* Notification Preferences */}\n          <div className=\"bg-gradient-to-br from-teal-50 via-cyan-50 to-sky-50 rounded-xl p-5 border border-teal-100\">\n            <div className=\"flex items-center gap-3 mb-4\">\n              <div className=\"w-10 h-10 bg-gradient-to-br from-teal-500 to-cyan-500 rounded-xl flex items-center justify-center shadow-sm\">\n                <Bell className=\"w-5 h-5 text-white\" />\n              </div>\n              <h4 className=\"font-bold text-gray-800\">Notification Preferences</h4>\n            </div>\n            <div className=\"space-y-3\">\n              <label className=\"flex items-center gap-3 p-3 bg-white rounded-lg border border-gray-100 cursor-pointer hover:border-teal-200 transition-colors\">\n                <input\n                  type=\"checkbox\"\n                  checked={localPrefs.updates}\n                  onChange={() => togglePref('updates')}\n                  className=\"w-5 h-5 rounded border-gray-300 text-teal-600 focus:ring-teal-500\"\n                />\n                <div>\n                  <p className=\"text-sm font-medium text-gray-800\">Room Alerts</p>\n                  <p className=\"text-xs text-gray-500\">Get notified about new rooms in your saved areas</p>\n                </div>\n              </label>\n              <label className=\"flex items-center gap-3 p-3 bg-white rounded-lg border border-gray-100 cursor-pointer hover:border-teal-200 transition-colors\">\n                <input\n                  type=\"checkbox\"\n                  checked={localPrefs.marketing}\n                  onChange={() => togglePref('marketing')}\n                  className=\"w-5 h-5 rounded border-gray-300 text-teal-600 focus:ring-teal-500\"\n                />\n                <div>\n                  <p className=\"text-sm font-medium text-gray-800\">Tips & Updates</p>\n                  <p className=\"text-xs text-gray-500\">Occasional features and helpful content</p>\n                </div>\n              </label>\n            </div>\n            <p className=\"text-[11px] text-gray-500 mt-3 text-center\">Changes save automatically  You can opt out anytime</p>\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n}\n\nfunction LandlordOnboardingView({ onComplete, onCancel, currentUser }) {\n  const [form, setForm] = useState({ businessName: currentUser?.name || '', bankDetails: '', idNumber: '', agree: false });\n\n  const handleSubmit = () => {\n    if (!form.businessName || !form.agree) {\n      alert('Please provide a display name and agree to the terms.');\n      return;\n    }\n    onComplete(form);\n  };\n\n  return (\n    <div className=\"min-h-screen bg-gradient-to-b from-slate-50 to-gray-100 pb-24\">\n      {/* Header Banner */}\n      <div className=\"bg-gradient-to-br from-teal-600 via-teal-500 to-cyan-500 pt-8 pb-16 px-4\">\n        <div className=\"max-w-2xl mx-auto text-center\">\n          <div className=\"w-20 h-20 bg-white/20 backdrop-blur-sm rounded-2xl flex items-center justify-center mx-auto mb-4 border border-white/30\">\n            <span className=\"text-4xl font-bold text-white\">\n              {currentUser?.name?.charAt(0)?.toUpperCase() || 'L'}\n            </span>\n          </div>\n          <h2 className=\"text-2xl font-bold text-white mb-2\">Welcome, {currentUser?.name || 'Landlord'}!</h2>\n          <p className=\"text-teal-100\">Complete your profile to start listing properties</p>\n        </div>\n      </div>\n\n      {/* Form Card */}\n      <div className=\"px-4 -mt-8\">\n        <div className=\"max-w-2xl mx-auto\">\n          <div className=\"bg-white rounded-2xl shadow-xl border border-gray-100 p-8\">\n            {/* Progress Steps */}\n            <div className=\"flex items-center justify-center gap-2 mb-8\">\n              <div className=\"flex items-center gap-2\">\n                <div className=\"w-8 h-8 bg-teal-600 text-white rounded-full flex items-center justify-center text-sm font-bold\">1</div>\n                <span className=\"text-sm font-medium text-gray-700\">Profile Details</span>\n              </div>\n              <div className=\"w-8 h-0.5 bg-gray-200\"></div>\n              <div className=\"flex items-center gap-2\">\n                <div className=\"w-8 h-8 bg-gray-200 text-gray-500 rounded-full flex items-center justify-center text-sm font-bold\">2</div>\n                <span className=\"text-sm text-gray-400\">Start Listing</span>\n              </div>\n            </div>\n\n            <div className=\"space-y-5\">\n              <div>\n                <label className=\"block text-sm font-semibold text-gray-800 mb-2\">Display Name *</label>\n                <input \n                  value={form.businessName} \n                  onChange={(e) => setForm({ ...form, businessName: e.target.value })} \n                  className=\"w-full px-4 py-3 border border-gray-200 rounded-xl focus:ring-2 focus:ring-teal-500 focus:border-teal-500 transition-all\" \n                  placeholder=\"Your name or business name\"\n                />\n                <p className=\"text-xs text-gray-500 mt-1.5\">This name is shown to renters on your listings and messages.</p>\n              </div>\n\n              <div>\n                <label className=\"block text-sm font-semibold text-gray-800 mb-2\">Payment Details (Optional)</label>\n                <input \n                  value={form.bankDetails} \n                  onChange={(e) => setForm({ ...form, bankDetails: e.target.value })} \n                  placeholder=\"Bank account or preferred payment method\" \n                  className=\"w-full px-4 py-3 border border-gray-200 rounded-xl focus:ring-2 focus:ring-teal-500 focus:border-teal-500 transition-all\" \n                />\n                <p className=\"text-xs text-gray-500 mt-1.5\">Private - only shown to confirmed renters.</p>\n              </div>\n\n              <div>\n                <label className=\"block text-sm font-semibold text-gray-800 mb-2\">ID Number (Optional)</label>\n                <input \n                  value={form.idNumber} \n                  onChange={(e) => setForm({ ...form, idNumber: e.target.value })} \n                  className=\"w-full px-4 py-3 border border-gray-200 rounded-xl focus:ring-2 focus:ring-teal-500 focus:border-teal-500 transition-all\" \n                  placeholder=\"For verification purposes\"\n                />\n                <p className=\"text-xs text-gray-500 mt-1.5\">Verified landlords get a trust badge on their listings.</p>\n              </div>\n\n              <div className=\"bg-gradient-to-r from-teal-50 to-cyan-50 rounded-xl p-4 border border-teal-100\">\n                <label className=\"flex items-start gap-3 cursor-pointer\">\n                  <input \n                    type=\"checkbox\" \n                    checked={form.agree} \n                    onChange={(e) => setForm({ ...form, agree: e.target.checked })} \n                    className=\"mt-1 w-5 h-5 rounded border-gray-300 text-teal-600 focus:ring-teal-500\"\n                  />\n                  <span className=\"text-sm text-gray-700\">\n                    I confirm I am authorised to list these properties and agree to the{' '}\n                    <button type=\"button\" onClick={(e) => e.preventDefault()} className=\"text-teal-600 hover:text-teal-700 font-medium underline\">\n                      terms of service\n                    </button>.\n                  </span>\n                </label>\n              </div>\n\n              <div className=\"flex gap-3 pt-4\">\n                <button \n                  onClick={onCancel} \n                  className=\"flex-1 bg-gray-100 hover:bg-gray-200 text-gray-700 font-medium py-3.5 rounded-xl transition-colors\"\n                >\n                  Cancel\n                </button>\n                <button \n                  onClick={handleSubmit} \n                  className=\"flex-1 bg-gradient-to-r from-teal-600 to-cyan-600 hover:from-teal-700 hover:to-cyan-700 text-white font-semibold py-3.5 rounded-xl transition-all shadow-md hover:shadow-lg\"\n                >\n                  Complete & Start Listing\n                </button>\n              </div>\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n}\n\nfunction EditProfileView({ user, onSubmit, onCancel }) {\n  const [formData, setFormData] = useState({\n    name: user.name || '',\n    phone: user.phone || '',\n    email: user.email || '',\n    whatsapp: user.whatsapp || '',\n    photo: user.photo || ''\n  });\n  const [errors, setErrors] = useState({});\n  const [touched, setTouched] = useState({});\n\n  const validateField = (name, value, extras = {}) => {\n    const newErrors = { ...errors };\n    switch (name) {\n      case 'name':\n        if (!value || value.trim().length < 2) {\n          newErrors.name = 'Name must be at least 2 characters';\n        } else {\n          delete newErrors.name;\n        }\n        break;\n      case 'phone':\n        if (!value || !/^[+]?[-0-9()\\s]{7,}$/.test(value.trim())) {\n          newErrors.phone = 'Enter a valid phone number';\n        } else {\n          delete newErrors.phone;\n        }\n        break;\n      case 'email':\n        if (!value || !/^[^@\\s]+@[^@\\s]+\\.[^@\\s]+$/.test(value.trim())) {\n          newErrors.email = 'Enter a valid email';\n        } else {\n          delete newErrors.email;\n        }\n        break;\n      default:\n        break;\n    }\n    setErrors(newErrors);\n  };\n\n  const handlePhotoUpload = (e) => {\n    const file = e.target.files[0];\n    if (file) {\n      const reader = new FileReader();\n      reader.onloadend = () => {\n        setFormData({ ...formData, photo: reader.result });\n      };\n      reader.readAsDataURL(file);\n    }\n  };\n\n  const handleSubmit = () => {\n    setTouched({ name: true, phone: true, email: true });\n    validateField('name', formData.name);\n    validateField('phone', formData.phone);\n    validateField('email', formData.email);\n    if (Object.keys(errors).length === 0 && formData.name && formData.phone && formData.email) {\n      onSubmit(formData);\n    }\n  };\n\n  return (\n    <div className=\"p-4 min-h-screen bg-gradient-to-b from-slate-50 to-gray-100 pb-24\">\n      <div className=\"max-w-2xl mx-auto mt-8\">\n        <div className=\"bg-white rounded-2xl shadow-lg border border-gray-100 p-8\">\n          <div className=\"flex items-center justify-between mb-8\">\n            <h2 className=\"text-3xl font-extrabold text-gray-900\">Edit Profile</h2>\n            <button onClick={onCancel} className=\"text-gray-400 hover:text-gray-600 transition\">\n              <X className=\"w-6 h-6\" />\n            </button>\n          </div>\n\n          <div className=\"space-y-6\">\n            {/* Photo Upload */}\n            <div className=\"flex justify-center mb-8\">\n              <div className=\"relative\">\n                {formData.photo ? (\n                  <img src={formData.photo} alt=\"Profile\" className=\"w-32 h-32 rounded-full object-cover border-4 border-blue-200 shadow-lg\" />\n                ) : (\n                  <div className=\"w-32 h-32 rounded-full bg-gradient-to-br from-blue-100 to-blue-200 flex items-center justify-center border-4 border-blue-200 shadow-lg\">\n                    <User className=\"w-16 h-16 text-blue-600\" />\n                  </div>\n                )}\n                <label className=\"absolute bottom-0 right-0 bg-blue-600 hover:bg-blue-700 text-white p-3 rounded-full cursor-pointer shadow-lg transition\" aria-label=\"Upload new profile photo\">\n                  <Edit className=\"w-5 h-5\" />\n                  <input\n                    type=\"file\"\n                    accept=\"image/*\"\n                    onChange={handlePhotoUpload}\n                    className=\"hidden\"\n                  />\n                </label>\n              </div>\n            </div>\n\n            {/* Form Fields */}\n            <div>\n              <label className=\"block text-sm font-semibold text-gray-800 mb-2\">Full Name</label>\n              <input\n                type=\"text\"\n                required\n                value={formData.name}\n                onChange={(e) => { setFormData({ ...formData, name: e.target.value }); if (touched.name) validateField('name', e.target.value); }}\n                onBlur={(e) => { setTouched({ ...touched, name: true }); validateField('name', e.target.value); }}\n                aria-invalid={errors.name ? 'true' : 'false'}\n                aria-describedby={errors.name ? 'edit-name-error' : undefined}\n                className={`w-full px-4 py-3 border-2 ${errors.name ? 'border-red-400' : 'border-gray-200'} bg-white text-gray-800 rounded-xl focus:ring-2 focus:ring-teal-400 focus:border-transparent transition placeholder-gray-400`}\n              />\n              {errors.name && touched.name && <p id=\"edit-name-error\" className=\"mt-1 text-xs text-red-600\">{errors.name}</p>}\n            </div>\n\n            <div>\n              <label className=\"block text-sm font-semibold text-gray-800 mb-2\">Phone Number</label>\n              <div className=\"relative\">\n                <Phone className=\"absolute left-4 top-3.5 w-5 h-5 text-gray-400\" />\n                <input\n                  type=\"tel\"\n                  required\n                  value={formData.phone}\n                  onChange={(e) => { setFormData({ ...formData, phone: e.target.value }); if (touched.phone) validateField('phone', e.target.value); }}\n                  onBlur={(e) => { setTouched({ ...touched, phone: true }); validateField('phone', e.target.value); }}\n                  aria-invalid={errors.phone ? 'true' : 'false'}\n                  aria-describedby={errors.phone ? 'edit-phone-error' : undefined}\n                  className={`w-full pl-11 pr-4 py-3 border-2 ${errors.phone ? 'border-red-400' : 'border-gray-200'} bg-white text-gray-800 rounded-xl focus:ring-2 focus:ring-teal-400 focus:border-transparent transition placeholder-gray-400`}\n                />\n              </div>\n              {errors.phone && touched.phone && <p id=\"edit-phone-error\" className=\"mt-1 text-xs text-red-600\">{errors.phone}</p>}\n            </div>\n\n            <div>\n              <label className=\"block text-sm font-semibold text-gray-800 mb-2\">Email Address</label>\n              <div className=\"relative\">\n                <Mail className=\"absolute left-4 top-3.5 w-5 h-5 text-gray-400\" />\n                <input\n                  type=\"email\"\n                  required\n                  value={formData.email}\n                  onChange={(e) => { setFormData({ ...formData, email: e.target.value }); if (touched.email) validateField('email', e.target.value); }}\n                  onBlur={(e) => { setTouched({ ...touched, email: true }); validateField('email', e.target.value); }}\n                  aria-invalid={errors.email ? 'true' : 'false'}\n                  aria-describedby={errors.email ? 'edit-email-error' : undefined}\n                  className={`w-full pl-11 pr-4 py-3 border-2 ${errors.email ? 'border-red-400' : 'border-gray-200'} bg-white text-gray-800 rounded-xl focus:ring-2 focus:ring-teal-400 focus:border-transparent transition placeholder-gray-400`}\n                />\n              </div>\n              {errors.email && touched.email && <p id=\"edit-email-error\" className=\"mt-1 text-xs text-red-600\">{errors.email}</p>}\n            </div>\n\n            <div>\n              <label className=\"block text-sm font-semibold text-gray-800 mb-2\">WhatsApp (optional)</label>\n              <div className=\"relative\">\n                <Phone className=\"absolute left-4 top-3.5 w-5 h-5 text-gray-400\" />\n                <input\n                  type=\"tel\"\n                  value={formData.whatsapp}\n                  onChange={(e) => setFormData({ ...formData, whatsapp: e.target.value })}\n                  placeholder=\"e.g., +27 71 234 5678\"\n                  className=\"w-full pl-11 pr-4 py-3 border-2 border-gray-200 bg-white text-gray-800 rounded-xl focus:ring-2 focus:ring-teal-400 focus:border-transparent transition placeholder-gray-400\"\n                />\n              </div>\n              <p className=\"text-xs text-gray-500 mt-1\">Used to create a WhatsApp chat link on your listings.</p>\n            </div>\n\n            {/* Action Buttons */}\n            <div className=\"flex gap-3 pt-6 border-t border-gray-200\">\n              <button\n                onClick={onCancel}\n                className=\"flex-1 bg-gray-100 hover:bg-gray-200 text-gray-800 font-semibold py-3 rounded-xl transition\"\n              >\n                Cancel\n              </button>\n              <button\n                onClick={handleSubmit}\n                className=\"flex-1 bg-gradient-to-r from-teal-500 to-cyan-500 hover:from-teal-600 hover:to-cyan-600 text-white font-semibold py-3 rounded-xl transition shadow-lg\"\n              >\n                Save Changes\n              </button>\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n}\n\n/* BrowseView extracted to components/BrowseView.jsx */\n\nfunction FavoritesView({ listings, onSelectListing }) {\n  const [favorites, setFavorites] = useState([]);\n\n  useEffect(() => {\n    try {\n      const rawFavorites = localStorage.getItem('favorites');\n      if (rawFavorites) {\n        const arr = JSON.parse(rawFavorites);\n        if (Array.isArray(arr)) setFavorites(arr);\n      }\n    } catch {}\n  }, []);\n\n  const toggleFavorite = (listingId) => {\n    setFavorites(prev => {\n      const updated = prev.filter(id => id !== listingId);\n      try {\n        localStorage.setItem('favorites', JSON.stringify(updated));\n      } catch {}\n      return updated;\n    });\n  };\n\n  const favoriteListings = listings.filter(l => favorites.includes(l.id));\n\n  return (\n    <div className=\"p-4 min-h-screen bg-gradient-to-b from-slate-50 to-gray-100 pb-24\">\n      <div className=\"max-w-7xl mx-auto mt-8\">\n        <div className=\"mb-8\">\n          <div className=\"flex items-center gap-4 mb-3\">\n            <div className=\"w-14 h-14 bg-gradient-to-br from-rose-100 to-pink-100 rounded-2xl flex items-center justify-center shadow-sm\">\n              <Heart className=\"w-7 h-7 text-rose-500 fill-rose-500\" />\n            </div>\n            <div>\n              <h2 className=\"text-3xl font-extrabold text-gray-900\">Saved Listings</h2>\n              <p className=\"text-gray-600\">\n                {favoriteListings.length === 0\n                  ? 'Your favorites will appear here'\n                  : `${favoriteListings.length} saved ${favoriteListings.length === 1 ? 'listing' : 'listings'}`}\n              </p>\n            </div>\n          </div>\n        </div>\n\n        {favoriteListings.length === 0 ? (\n          <div className=\"bg-white rounded-2xl border border-gray-100 shadow-sm p-12 text-center\">\n            <div className=\"w-24 h-24 bg-gradient-to-br from-rose-50 to-pink-50 rounded-full flex items-center justify-center mx-auto mb-6\">\n              <Heart className=\"w-12 h-12 text-rose-300\" />\n            </div>\n            <h3 className=\"text-xl font-bold text-gray-800 mb-2\">No saved listings yet</h3>\n            <p className=\"text-gray-500 text-sm mb-6 max-w-md mx-auto\">\n              Browse rooms and tap the heart icon to save your favorites. They'll appear here for easy access.\n            </p>\n          </div>\n        ) : (\n          <div className=\"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6\">\n            {favoriteListings.map(listing => {\n              const ListingCard = require('./components/ListingCard').default;\n              return (\n                <ListingCard\n                  key={listing.id}\n                  listing={listing}\n                  onClick={() => onSelectListing(listing)}\n                  isFavorite={true}\n                  onToggleFavorite={toggleFavorite}\n                />\n              );\n            })}\n          </div>\n        )}\n      </div>\n    </div>\n  );\n}\n\nconst createDefaultListingForm = () => ({\n  title: '',\n  price: '',\n  location: '',\n  streetAddress: '',\n  description: '',\n  photos: [],\n  status: 'available',\n  availableDate: new Date().toISOString().split('T')[0],\n  amenities: [],\n  latitude: null,\n  longitude: null,\n  paymentMethod: 'Bank and Cash',\n  roomType: 'private',\n  leaseDuration: '7-12',\n  petFriendly: false,\n  genderPreference: 'any',\n  premium: false\n});\n\nfunction AddListingView({ onSubmit, onCancel, currentUser, userType, onRequireAuth, onRequireOnboarding }) {\n  const GEOCODER_KEY = process.env.REACT_APP_GEOCODER_API_KEY;\n  const GEOCODER_PROVIDER = (process.env.REACT_APP_GEOCODER_PROVIDER || '').toLowerCase();\n\n  const landlordId = currentUser?.id;\n  const [formData, setFormData] = useState(() => {\n    const base = createDefaultListingForm();\n    if (landlordId) {\n      const saved = loadListingTemplate(landlordId);\n      if (saved) {\n        return {\n          ...base,\n          ...saved,\n          amenities: Array.isArray(saved.amenities) ? saved.amenities : base.amenities,\n          petFriendly: saved.petFriendly ?? base.petFriendly,\n          premium: saved.premium ?? base.premium,\n          photos: []\n        };\n      }\n    }\n    return base;\n  });\n  const [geocodingStatus, setGecodingStatus] = useState('');\n  const [errors, setErrors] = useState({});\n  const [showPhotoEditor, setShowPhotoEditor] = useState(false);\n  const reverseGeocodeCacheRef = React.useRef({});\n  const [lastGeocodeSource, setLastGeocodeSource] = useState(null); // 'cached' | 'mapbox' | 'proxy' | 'direct' | 'coords-only' | 'manual-geocode'\n  const [fullAddressInput, setFullAddressInput] = useState('');\n  const [isFullAddressEditing, setIsFullAddressEditing] = useState(false);\n\n  useEffect(() => {\n    if (!landlordId) return;\n    const saved = loadListingTemplate(landlordId);\n    if (saved) {\n      setFormData(prev => ({\n        ...prev,\n        ...saved,\n        amenities: Array.isArray(saved.amenities) ? saved.amenities : [],\n        petFriendly: saved.petFriendly ?? false,\n        premium: saved.premium ?? false,\n        photos: []\n      }));\n    } else {\n      setFormData(createDefaultListingForm());\n    }\n  }, [landlordId]);\n\n  useEffect(() => {\n    if (!landlordId || userType !== 'landlord') return;\n    saveListingTemplate(landlordId, formData);\n  }, [formData, landlordId, userType]);\n\n  // Warn user before leaving if form has unsaved data\n  useEffect(() => {\n    const hasFormData = formData.title || formData.description || formData.photos?.length > 0;\n    \n    const handleBeforeUnload = (e) => {\n      if (hasFormData) {\n        e.preventDefault();\n        e.returnValue = '';\n        return '';\n      }\n    };\n    \n    if (hasFormData) {\n      window.addEventListener('beforeunload', handleBeforeUnload);\n    }\n    \n    return () => {\n      window.removeEventListener('beforeunload', handleBeforeUnload);\n    };\n  }, [formData.title, formData.description, formData.photos]);\n\n  // Helper: fetch with graceful fallbacks when third-party APIs lack CORS headers\n  const corsFallbackTransforms = useMemo(() => [\n    (url) => url.startsWith('https://cors.isomorphic-git.org/') ? url : `https://cors.isomorphic-git.org/${url}`,\n    (url) => url.startsWith('https://corsproxy.io/?') ? url : `https://corsproxy.io/?${encodeURIComponent(url)}`\n  ], []);\n\n  const fetchWithCorsFallback = useCallback(async (url, options = {}) => {\n    const cloneOptions = () => {\n      const base = { ...options };\n      if (options.headers) base.headers = { ...options.headers };\n      return base;\n    };\n\n    const attempt = async (targetUrl) => {\n      const resp = await fetch(targetUrl, cloneOptions());\n      if (!resp.ok) throw new Error(`Request failed with status ${resp.status}`);\n      return resp;\n    };\n\n    try {\n      return await attempt(url);\n    } catch (err) {\n      if (options.signal?.aborted) throw err;\n      let lastError = err;\n      for (const transform of corsFallbackTransforms) {\n        try {\n          const proxiedUrl = transform(url);\n          return await attempt(proxiedUrl);\n        } catch (proxyErr) {\n          lastError = proxyErr;\n          if (options.signal?.aborted) break;\n        }\n      }\n      throw lastError;\n    }\n  }, [corsFallbackTransforms]);\n\n  // Forward geocode helper for manual address lookups\n  const forwardGeocodeAddress = async (query) => {\n    if (!query || query.trim().length < 3) return [];\n\n    // 1. Mapbox (if configured)\n    if (GEOCODER_PROVIDER === 'mapbox' && GEOCODER_KEY) {\n      try {\n        const resp = await fetch(`https://api.mapbox.com/geocoding/v5/mapbox.places/${encodeURIComponent(query)}.json?access_token=${GEOCODER_KEY}&limit=3&country=za&types=address,place,locality`);\n        const data = await resp.json();\n        if (data?.features?.length) {\n          return data.features.map(f => ({\n            lat: f.center ? f.center[1] : f.geometry?.coordinates?.[1],\n            lon: f.center ? f.center[0] : f.geometry?.coordinates?.[0],\n            label: f.place_name || f.text,\n            source: 'mapbox'\n          })).filter(entry => typeof entry.lat === 'number' && typeof entry.lon === 'number');\n        }\n      } catch (err) {\n        console.warn('Mapbox forward geocode failed', err);\n      }\n    }\n\n    // 2. maps.co (CORS-friendly)\n    try {\n      const mapsResp = await fetch(`https://geocode.maps.co/search?q=${encodeURIComponent(query)}&limit=3`);\n      if (mapsResp.ok) {\n        const mapsData = await mapsResp.json();\n        if (Array.isArray(mapsData) && mapsData.length) {\n          return mapsData.slice(0, 3).map(entry => ({\n            lat: parseFloat(entry.lat),\n            lon: parseFloat(entry.lon),\n            label: entry.display_name || entry.name,\n            source: 'maps.co'\n          }));\n        }\n      }\n    } catch (mapsErr) {\n      console.warn('maps.co forward geocode failed', mapsErr);\n    }\n\n    // 3. Local proxy (if running)\n    const API_BASE = (process.env.REACT_APP_PROXY_BASE || (window.location && window.location.port === '8443' ? 'https://localhost:4443' : ''));\n    if (API_BASE) {\n      try {\n        const proxyResp = await fetch(`${API_BASE}/api/search?q=${encodeURIComponent(query)}`);\n        if (proxyResp.ok) {\n          const proxyData = await proxyResp.json();\n          if (Array.isArray(proxyData) && proxyData.length) {\n            return proxyData.slice(0, 3).map(entry => ({\n              lat: parseFloat(entry.lat),\n              lon: parseFloat(entry.lon),\n              label: entry.display_name,\n              source: API_BASE.includes('localhost') ? 'local-proxy' : 'proxy'\n            }));\n          }\n        }\n      } catch (proxyErr) {\n        console.warn('Local proxy forward geocode failed', proxyErr);\n      }\n    }\n\n    // 4. Direct Nominatim fallback (may still be blocked, but last resort)\n    try {\n      const directResp = await fetchWithCorsFallback(`https://nominatim.openstreetmap.org/search?format=json&addressdetails=1&q=${encodeURIComponent(query)}`, {\n        headers: {\n          'User-Agent': 'room-rental-platform/1.0 (direct fallback)',\n          'Accept': 'application/json'\n        }\n      });\n      if (directResp.ok) {\n        const directData = await directResp.json();\n        if (Array.isArray(directData) && directData.length) {\n          return directData.slice(0, 3).map(entry => ({\n            lat: parseFloat(entry.lat),\n            lon: parseFloat(entry.lon),\n            label: entry.display_name,\n            source: 'direct'\n          }));\n        }\n      }\n    } catch (directErr) {\n      console.warn('Direct nominatim forward geocode failed', directErr);\n    }\n\n    return [];\n  };\n\n  const availableAmenities = [\n    'WiFi', 'Parking', 'Kitchen', 'Laundry', 'Air Conditioning', \n    'Heating', 'TV', 'Furnished', 'Pet Friendly', 'Garden'\n  ];\n\n  const validateField = (name, value, extras = {}) => {\n    const newErrors = { ...errors };\n    \n    switch (name) {\n      case 'title':\n        if (!value || value.trim().length < 5) {\n          newErrors.title = 'Title must be at least 5 characters';\n        } else {\n          delete newErrors.title;\n        }\n        break;\n      case 'price':\n        if (!value || parseFloat(value) <= 0) {\n          newErrors.price = 'Price must be greater than 0';\n        } else if (parseFloat(value) < 500) {\n          newErrors.price = 'Price seems too low (minimum R500)';\n        } else if (parseFloat(value) > 50000) {\n          newErrors.price = 'Price seems too high (maximum R50,000)';\n        } else {\n          delete newErrors.price;\n        }\n        break;\n      case 'location': {\n        const streetText = (extras.streetAddress ?? formData.streetAddress ?? '').trim();\n        const areaText = (extras.location ?? value ?? '').trim();\n        if (!streetText || streetText.length < 3) {\n          newErrors.location = 'Add the street or stand number (e.g., 5170 Molefe St)';\n        } else if (!areaText || areaText.length < 3) {\n          newErrors.location = 'Add the suburb, city, and postal code (e.g., Ivory Park, Midrand, 1693)';\n        } else {\n          delete newErrors.location;\n        }\n        break;\n      }\n      case 'description':\n        if (value && value.length > 500) {\n          newErrors.description = 'Description is too long (max 500 characters)';\n        } else {\n          delete newErrors.description;\n        }\n        break;\n      default:\n        break;\n    }\n    \n    setErrors(newErrors);\n  };\n\n  \n\n  // Load persisted reverse geocode cache\n  useEffect(() => {\n    try {\n      const raw = localStorage.getItem('reverse-geocode-cache');\n      if (raw) {\n        const parsed = JSON.parse(raw);\n        if (parsed && typeof parsed === 'object') {\n          reverseGeocodeCacheRef.current = parsed;\n        }\n      }\n    } catch (e) { /* ignore */ }\n  }, []);\n\n  // Geocode address using Nominatim (OpenStreetMap)\n  const geocodeAddress = async () => {\n    if (!formData.streetAddress) {\n      setGecodingStatus('Please enter a street address');\n      return;\n    }\n    \n    setGecodingStatus('Finding coordinates...');\n    try {\n      const fullAddress = `${formData.streetAddress}, ${formData.location}, South Africa`;\n      const results = await forwardGeocodeAddress(fullAddress);\n\n      if (results.length > 0) {\n        const best = results[0];\n        setFormData({ \n          ...formData, \n          latitude: parseFloat(best.lat), \n          longitude: parseFloat(best.lon) \n        });\n        setGecodingStatus(` Address found!`);\n        setTimeout(() => setGecodingStatus(''), 2000);\n        setLastGeocodeSource(best.source || 'manual-geocode');\n        return;\n      }\n\n      setGecodingStatus('Address not found. Trying with area only...');\n      const areaResults = await forwardGeocodeAddress(`${formData.location}, South Africa`);\n      if (areaResults.length > 0) {\n        const bestArea = areaResults[0];\n        setFormData({ \n          ...formData, \n          latitude: parseFloat(bestArea.lat), \n          longitude: parseFloat(bestArea.lon) \n        });\n        setGecodingStatus(' Area found!');\n        setTimeout(() => setGecodingStatus(''), 2000);\n        setLastGeocodeSource(bestArea.source || 'manual-geocode');\n      } else {\n        setGecodingStatus('Could not find location');\n      }\n    } catch (error) {\n      console.error('Geocoding error:', error);\n      setGecodingStatus('Error finding address. Check your connection.');\n      setLastGeocodeSource(null);\n    }\n  };\n\n  const toggleAmenity = (amenity) => {\n    if (formData.amenities.includes(amenity)) {\n      setFormData({ ...formData, amenities: formData.amenities.filter(a => a !== amenity) });\n    } else {\n      setFormData({ ...formData, amenities: [...formData.amenities, amenity] });\n    }\n  };\n\n  const [isSubmitting, setIsSubmitting] = useState(false);\n\n  const handleSubmit = async () => {\n    // Enforce auth and onboarding checks before allowing submission\n    if (!currentUser) {\n      onRequireAuth && onRequireAuth('landlord');\n      return;\n    }\n    if (userType !== 'landlord') {\n      // prompt to become landlord\n      onRequireAuth && onRequireAuth('landlord');\n      return;\n    }\n    if (!currentUser.landlordComplete) {\n      // send to onboarding\n      onRequireOnboarding && onRequireOnboarding();\n      return;\n    }\n\n    // Validate all fields\n    validateField('title', formData.title);\n    validateField('price', formData.price);\n    validateField('location', formData.location, {\n      location: formData.location,\n      streetAddress: formData.streetAddress\n    });\n    validateField('description', formData.description);\n\n    if (!formData.title || formData.title.trim().length < 5) {\n      setErrors(prev => ({ ...prev, title: 'Title must be at least 5 characters' }));\n      return;\n    }\n    if (!formData.price || parseFloat(formData.price) <= 0) {\n      setErrors(prev => ({ ...prev, price: 'Price must be greater than 0' }));\n      return;\n    }\n    if (!formData.location || formData.location.trim().length < 3) {\n      setErrors(prev => ({ ...prev, location: 'Location is required' }));\n      return;\n    }\n    if (Object.keys(errors).length > 0) {\n      return;\n    }\n\n    setIsSubmitting(true);\n    try {\n      await onSubmit(formData);\n    } finally {\n      setIsSubmitting(false);\n    }\n  };\n\n  const googleMapsQuery = [formData.streetAddress, formData.location, 'South Africa']\n    .filter(Boolean)\n    .join(', ');\n  const googleMapsUrl = googleMapsQuery\n    ? `https://www.google.com/maps/search/?api=1&query=${encodeURIComponent(googleMapsQuery)}`\n    : '';\n  const combinedFormAddress = [formData.streetAddress, formData.location]\n    .map(part => (part || '').trim())\n    .filter(Boolean)\n    .join(', ');\n\n  useEffect(() => {\n    if (isFullAddressEditing) return;\n    setFullAddressInput(prev => (prev === combinedFormAddress ? prev : combinedFormAddress));\n  }, [combinedFormAddress, isFullAddressEditing]);\n\n  const handleFullAddressChange = (value) => {\n    setFullAddressInput(value);\n    if (!value || value.length < 3) {\n      setFormData(prev => ({ ...prev, streetAddress: '', location: '' }));\n      validateField('location', '');\n      return;\n    }\n\n    const parts = value\n      .split(',')\n      .map(part => part.trim())\n      .filter(Boolean);\n\n    if (parts.length === 0) {\n      setFormData(prev => ({ ...prev, streetAddress: '', location: '' }));\n      validateField('location', '');\n      return;\n    }\n\n    let street = parts[0] || '';\n    let derivedLocation = parts.slice(1).join(', ');\n\n    if (!derivedLocation) {\n      const words = street.split(/\\s+/).filter(Boolean);\n      if (words.length >= 4) {\n        // Guess that the last few tokens describe the suburb/city/postal portion.\n        const locationWordCount = Math.min(4, Math.ceil(words.length / 2));\n        derivedLocation = words.slice(-locationWordCount).join(' ');\n        street = words.slice(0, words.length - locationWordCount).join(' ');\n      } else {\n        derivedLocation = street;\n      }\n    }\n\n    setFormData(prev => ({\n      ...prev,\n      streetAddress: street,\n      location: derivedLocation\n    }));\n    validateField('location', derivedLocation || street, {\n      location: derivedLocation,\n      streetAddress: street\n    });\n  };\n\n  const handleResetSavedTemplate = () => {\n    if (!landlordId) return;\n    clearListingTemplate(landlordId);\n    const blank = createDefaultListingForm();\n    setFormData(blank);\n    setFullAddressInput('');\n  };\n\n  return (\n    <div className=\"p-4 bg-gradient-to-b from-slate-50 to-gray-100 min-h-screen pb-24\">\n      <div className=\"max-w-3xl mx-auto mt-8\">\n        <div className=\"bg-white rounded-2xl shadow-lg border border-gray-100 p-8\">\n          <div className=\"flex items-center justify-between mb-6\">\n            <h2 className=\"text-3xl font-extrabold text-gray-900\">Post a Room</h2>\n            <button onClick={onCancel} className=\"text-gray-400 hover:text-gray-600 transition-colors p-2 rounded-full hover:bg-gray-100\">\n              <X className=\"w-6 h-6\" />\n            </button>\n          </div>\n\n          {/* Progress Indicator */}\n          <div className=\"mb-8\">\n            <div className=\"flex justify-between items-center mb-2\">\n              <span className=\"text-sm font-medium text-gray-600\">Form Progress</span>\n              <span className=\"text-sm font-semibold text-teal-600\">\n                {(() => {\n                  let completed = 0;\n                  const total = 5;\n                  if (formData.title && formData.title.trim().length >= 5) completed++;\n                  if (formData.price && parseFloat(formData.price) >= 500) completed++;\n                  if (formData.streetAddress && formData.location) completed++;\n                  if (formData.description && formData.description.length >= 10) completed++;\n                  if (formData.photos && formData.photos.length > 0) completed++;\n                  return `${completed}/${total} completed`;\n                })()}\n              </span>\n            </div>\n            <div className=\"h-2 bg-gray-100 rounded-full overflow-hidden\">\n              <div \n                className=\"h-full bg-gradient-to-r from-teal-500 to-cyan-500 rounded-full transition-all duration-500\"\n                style={{\n                  width: `${(() => {\n                    let completed = 0;\n                    if (formData.title && formData.title.trim().length >= 5) completed++;\n                    if (formData.price && parseFloat(formData.price) >= 500) completed++;\n                    if (formData.streetAddress && formData.location) completed++;\n                    if (formData.description && formData.description.length >= 10) completed++;\n                    if (formData.photos && formData.photos.length > 0) completed++;\n                    return (completed / 5) * 100;\n                  })()}%`\n                }}\n              />\n            </div>\n          </div>\n\n          <div className=\"space-y-6\">\n            {currentUser?.type === 'landlord' && (\n              <div className=\"bg-gradient-to-r from-teal-50 to-cyan-50 border border-teal-200 text-teal-800 text-sm rounded-xl p-4 flex items-start gap-3\">\n                <CheckCircle className=\"w-5 h-5 text-teal-600 mt-0.5\" />\n                <div className=\"space-y-2\">\n                  <p>\n                    We remember your latest listing details (address, price, and more) so you only need to upload fresh photos next time.\n                    Update any field below and we'll save it automatically.\n                  </p>\n                  <button\n                    type=\"button\"\n                    onClick={handleResetSavedTemplate}\n                    className=\"text-xs font-semibold text-teal-700 underline hover:text-teal-900 transition-colors\"\n                  >\n                    Reset saved info\n                  </button>\n                </div>\n              </div>\n            )}\n            {/* Title */}\n            <div>\n              <label className=\"block text-sm font-semibold text-gray-800 mb-2\">\n                Room Title *\n                {formData.title && formData.title.trim().length >= 5 && !errors.title && (\n                  <span className=\"ml-2 text-green-600 text-xs\"> Looks good</span>\n                )}\n              </label>\n              <div className=\"relative\">\n                <input\n                  type=\"text\"\n                  required\n                  value={formData.title}\n                  onChange={(e) => {\n                    setFormData({ ...formData, title: e.target.value });\n                    validateField('title', e.target.value);\n                  }}\n                  onBlur={(e) => validateField('title', e.target.value)}\n                  placeholder=\"e.g., Cozy backroom with private bathroom\"\n                  className={`w-full px-4 py-3 pr-10 border-2 ${\n                    errors.title ? 'border-red-400 bg-red-50' : \n                    formData.title && formData.title.trim().length >= 5 ? 'border-teal-400 bg-teal-50/30' : \n                    'border-gray-200'\n                  } text-gray-800 rounded-xl focus:ring-2 ${\n                    errors.title ? 'focus:ring-red-400' : 'focus:ring-teal-400'\n                  } focus:border-transparent transition-all placeholder-gray-400`}\n                />\n                {formData.title && formData.title.trim().length >= 5 && !errors.title && (\n                  <CheckCircle className=\"absolute right-3 top-1/2 -translate-y-1/2 w-5 h-5 text-teal-600\" />\n                )}\n              </div>\n              {errors.title && <p className=\"text-red-500 text-xs mt-1 flex items-center gap-1\"><span></span> {errors.title}</p>}\n            </div>\n\n            {/* Price */}\n            <div>\n              <label className=\"block text-sm font-semibold text-gray-800 mb-2\">\n                Monthly Price (R) *\n                {formData.price && parseFloat(formData.price) >= 500 && parseFloat(formData.price) <= 50000 && !errors.price && (\n                  <span className=\"ml-2 text-green-600 text-xs\"> Valid price</span>\n                )}\n              </label>\n              <div className=\"relative\">\n                <span className=\"absolute left-4 top-1/2 -translate-y-1/2 text-gray-500 font-medium\">R</span>\n                <input\n                  type=\"number\"\n                  required\n                  value={formData.price}\n                  onChange={(e) => {\n                    setFormData({ ...formData, price: e.target.value });\n                    validateField('price', e.target.value);\n                  }}\n                  onBlur={(e) => validateField('price', e.target.value)}\n                  placeholder=\"2500\"\n                  min=\"500\"\n                  max=\"50000\"\n                  className={`w-full pl-10 pr-4 py-3 border-2 ${\n                    errors.price ? 'border-red-400 bg-red-50' : \n                    formData.price && parseFloat(formData.price) >= 500 && parseFloat(formData.price) <= 50000 ? 'border-teal-400 bg-teal-50/30' : \n                    'border-gray-200'\n                  } text-gray-800 rounded-xl focus:ring-2 ${\n                    errors.price ? 'focus:ring-red-400' : 'focus:ring-teal-400'\n                  } focus:border-transparent transition-all placeholder-gray-400`}\n                />\n                {formData.price && parseFloat(formData.price) >= 500 && parseFloat(formData.price) <= 50000 && !errors.price && (\n                  <CheckCircle className=\"absolute right-3 top-1/2 -translate-y-1/2 w-5 h-5 text-teal-600\" />\n                )}\n              </div>\n              {errors.price && <p className=\"text-red-500 text-xs mt-1 flex items-center gap-1\"><span></span> {errors.price}</p>}\n              {!errors.price && formData.price && (\n                <p className=\"text-gray-500 text-xs mt-1\">Suggested range: R500 - R50,000 per month</p>\n              )}\n            </div>\n\n            {/* Full Address */}\n            <div>\n              <label className=\"block text-sm font-semibold text-gray-800 mb-1\">Full South African Address *</label>\n              <p className=\"text-xs text-gray-500 mb-2\">Example: 5170 Molefe St, Ivory Park, Midrand, 1693</p>\n              <textarea\n                required\n                rows=\"2\"\n                value={fullAddressInput}\n                onChange={(e) => handleFullAddressChange(e.target.value)}\n                onFocus={() => setIsFullAddressEditing(true)}\n                onBlur={(e) => { setIsFullAddressEditing(false); handleFullAddressChange(e.target.value); }}\n                placeholder=\"Type the full street + suburb + city + postal code\"\n                className={`w-full px-4 py-3 border-2 ${errors.location ? 'border-red-400' : 'border-gray-200'} bg-white text-gray-800 rounded-xl focus:ring-2 ${errors.location ? 'focus:ring-red-400' : 'focus:ring-teal-400'} focus:border-transparent transition placeholder-gray-400`}\n              />\n              {errors.location && <p className=\"text-red-500 text-xs mt-1\" aria-live=\"assertive\">{errors.location}</p>}\n              {!errors.location && (\n                <p className=\"text-gray-500 text-xs mt-1\">\n                  Include the street/stand number plus suburb, city, and postal code. Commas are optional; we will split it for you.\n                </p>\n              )}\n            </div>\n\n            {/* Geocode Section - Manual confirmation only */}\n            <div className=\"bg-gradient-to-br from-teal-50 to-cyan-50 border-2 border-teal-200 rounded-xl p-6\">\n              <div className=\"flex items-start gap-3 mb-4\">\n                <MapPin className=\"w-6 h-6 text-teal-600 flex-shrink-0 mt-1\" />\n                <div className=\"flex-1\">\n                  <h3 className=\"text-lg font-semibold text-gray-800 mb-1\">Confirm Your Address</h3>\n                  <p className=\"text-sm text-gray-600\">\n                    Type the exact street + suburb above, then tap <strong>Look Up Address</strong> if you\u00110d like us to fetch coordinates for your Google Maps preview.\n                  </p>\n                </div>\n              </div>\n\n              <div className=\"flex flex-wrap gap-3 items-start\">\n                <button\n                  type=\"button\"\n                  onClick={geocodeAddress}\n                  className=\"w-full md:w-auto bg-white hover:bg-gray-50 text-gray-700 border-2 border-gray-300 px-6 py-3 rounded-lg text-sm font-semibold transition flex items-center justify-center gap-2\"\n                >\n                  <MapPin className=\"w-4 h-4\" />\n                  Look Up Address\n                </button>\n\n                <div className=\"text-sm flex-1 min-w-[220px]\">\n                  {geocodingStatus && (\n                    <span className={`${geocodingStatus.startsWith('') ? 'text-green-600 font-semibold' : geocodingStatus.startsWith('') ? 'text-amber-600' : 'text-gray-700'} flex items-center gap-1`}>\n                      {geocodingStatus.startsWith('') && <CheckCircle className=\"w-4 h-4\" />}\n                      {geocodingStatus}\n                      {lastGeocodeSource === 'cached' && (\n                        <span className=\"ml-2 inline-block px-2 py-1 text-[10px] rounded bg-purple-100 text-purple-600 font-semibold\">CACHED</span>\n                      )}\n                      {lastGeocodeSource === 'mapbox' && (\n                        <span className=\"ml-2 inline-block px-2 py-1 text-[10px] rounded bg-blue-100 text-blue-600 font-semibold\">MAPBOX</span>\n                      )}\n                      {lastGeocodeSource === 'maps.co' && (\n                        <span className=\"ml-2 inline-block px-2 py-1 text-[10px] rounded bg-indigo-100 text-indigo-600 font-semibold\">MAPS.CO</span>\n                      )}\n                      {lastGeocodeSource === 'proxy' && (\n                        <span className=\"ml-2 inline-block px-2 py-1 text-[10px] rounded bg-green-100 text-green-600 font-semibold\">PROXY</span>\n                      )}\n                      {lastGeocodeSource === 'direct' && (\n                        <span className=\"ml-2 inline-block px-2 py-1 text-[10px] rounded bg-yellow-100 text-yellow-700 font-semibold\">FALLBACK</span>\n                      )}\n                    </span>\n                  )}\n                  {formData.latitude && formData.longitude && !geocodingStatus && (\n                    <span className=\"text-green-600 font-semibold flex items-center gap-1\">\n                      <CheckCircle className=\"w-4 h-4\" />\n                      Coordinates saved: {formData.latitude.toFixed(4)}, {formData.longitude.toFixed(4)}\n                      {lastGeocodeSource === 'cached' && (\n                        <span className=\"ml-2 inline-block px-2 py-1 text-[10px] rounded bg-purple-100 text-purple-600 font-semibold\">CACHED</span>\n                      )}\n                      {lastGeocodeSource === 'maps.co' && (\n                        <span className=\"ml-2 inline-block px-2 py-1 text-[10px] rounded bg-indigo-100 text-indigo-600 font-semibold\">MAPS.CO</span>\n                      )}\n                    </span>\n                  )}\n                  {googleMapsUrl && (\n                    <div className=\"mt-3 bg-white border border-gray-200 rounded-lg p-3 text-xs text-gray-600\">\n                      <span className=\"block text-gray-800 font-semibold mb-1\">Preview this address</span>\n                      <a\n                        href={googleMapsUrl}\n                        target=\"_blank\"\n                        rel=\"noopener noreferrer\"\n                        className=\"inline-flex items-center gap-2 text-teal-700 font-semibold hover:text-teal-900 underline\"\n                      >\n                        <MapPin className=\"w-3 h-3\" /> Open in Google Maps\n                      </a>\n                      <span className=\"block mt-2 text-[11px] text-gray-500\">Renters will see the same button under your listing.</span>\n                    </div>\n                  )}\n                </div>\n              </div>\n              <div className=\"mt-4 text-sm text-gray-600 bg-white border border-dashed border-gray-300 rounded-lg p-4\">\n                <p className=\"font-semibold text-gray-800 mb-1\">Manual address confirmed</p>\n                <p>We now rely on the address you type here. Use Google Maps above if you want to double-check directions.</p>\n              </div>\n            </div>\n\n            {/* Status and Available Date - Two columns */}\n            <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n              <div>\n                <label className=\"block text-sm font-semibold text-gray-800 mb-2\">Status</label>\n                <select\n                  value={formData.status}\n                  onChange={(e) => setFormData({ ...formData, status: e.target.value })}\n                  className=\"w-full px-4 py-3 border-2 border-gray-200 bg-white text-gray-800 rounded-xl focus:ring-2 focus:ring-teal-400 focus:border-transparent transition\"\n                >\n                  <option value=\"available\">Available</option>\n                  <option value=\"rented\">Rented</option>\n                </select>\n              </div>\n\n              <div>\n                <label className=\"block text-sm font-semibold text-gray-800 mb-2\">Available Date</label>\n                <input\n                  type=\"date\"\n                  value={formData.availableDate}\n                  onChange={(e) => setFormData({ ...formData, availableDate: e.target.value })}\n                  className=\"w-full px-4 py-3 border-2 border-gray-200 bg-white text-gray-800 rounded-xl focus:ring-2 focus:ring-teal-400 focus:border-transparent transition\"\n                />\n              </div>\n            </div>\n\n            {/* Payment Method */}\n            <div>\n              <label className=\"block text-sm font-semibold text-gray-800 mb-2\">Payment Method</label>\n              <select\n                value={formData.paymentMethod}\n                onChange={(e) => setFormData({ ...formData, paymentMethod: e.target.value })}\n                className=\"w-full px-4 py-3 border-2 border-gray-200 bg-white text-gray-800 rounded-xl focus:ring-2 focus:ring-teal-400 focus:border-transparent transition\"\n              >\n                <option value=\"Bank and Cash\">Bank and Cash</option>\n                <option value=\"Cash Only\">Cash Only</option>\n                <option value=\"Bank Only\">Bank Only</option>\n              </select>\n            </div>\n\n            {/* Room Type and Lease Duration - Two columns */}\n            <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n              <div>\n                <label className=\"block text-sm font-semibold text-gray-800 mb-2\">Room Type</label>\n                <select\n                  value={formData.roomType}\n                  onChange={(e) => setFormData({ ...formData, roomType: e.target.value })}\n                  className=\"w-full px-4 py-3 border-2 border-gray-200 bg-white text-gray-800 rounded-xl focus:ring-2 focus:ring-teal-400 focus:border-transparent transition\"\n                >\n                  <option value=\"private\">Private Room</option>\n                  <option value=\"shared\">Shared Room</option>\n                </select>\n              </div>\n\n              <div>\n                <label className=\"block text-sm font-semibold text-gray-800 mb-2\">Lease Duration (months)</label>\n                <select\n                  value={formData.leaseDuration}\n                  onChange={(e) => setFormData({ ...formData, leaseDuration: e.target.value })}\n                  className=\"w-full px-4 py-3 border-2 border-gray-200 bg-white text-gray-800 rounded-xl focus:ring-2 focus:ring-teal-400 focus:border-transparent transition\"\n                >\n                  <option value=\"1-3\">1-3 months</option>\n                  <option value=\"4-6\">4-6 months</option>\n                  <option value=\"7-12\">7-12 months</option>\n                  <option value=\"12+\">12+ months</option>\n                </select>\n              </div>\n            </div>\n\n            {/* Pet Friendly and Gender Preference */}\n            <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n              <div className=\"flex items-center gap-3\">\n                <input\n                  type=\"checkbox\"\n                  checked={formData.petFriendly}\n                  onChange={(e) => setFormData({ ...formData, petFriendly: e.target.checked })}\n                  id=\"petFriendly\"\n                  className=\"w-5 h-5 text-teal-600 border-gray-300 rounded focus:ring-teal-500\"\n                />\n                <label htmlFor=\"petFriendly\" className=\"text-sm font-medium text-gray-700\">\n                   Pet Friendly\n                </label>\n              </div>\n\n              <div>\n                <label className=\"block text-sm font-semibold text-gray-800 mb-2\">Gender Preference</label>\n                <select\n                  value={formData.genderPreference}\n                  onChange={(e) => setFormData({ ...formData, genderPreference: e.target.value })}\n                  className=\"w-full px-4 py-3 border-2 border-gray-200 bg-white text-gray-800 rounded-xl focus:ring-2 focus:ring-teal-400 focus:border-transparent transition\"\n                >\n                  <option value=\"any\">Any</option>\n                  <option value=\"male\">Male Only</option>\n                  <option value=\"female\">Female Only</option>\n                </select>\n              </div>\n            </div>\n\n            {/* Premium Flag */}\n            <div className=\"flex items-center gap-3\">\n              <input\n                type=\"checkbox\"\n                checked={!!formData.premium}\n                onChange={(e) => setFormData({ ...formData, premium: e.target.checked })}\n                id=\"premiumFlag\"\n              />\n              <label htmlFor=\"premiumFlag\" className=\"text-sm font-medium text-gray-700\">\n                Premium listing (highlight & priority sorting)\n              </label>\n            </div>\n\n            {/* Description */}\n            <div>\n              <label className=\"block text-sm font-semibold text-gray-800 mb-2\">\n                Description \n                {formData.description && (\n                  <span className={`ml-2 text-xs ${formData.description.length > 500 ? 'text-red-500' : 'text-gray-500'}`}>\n                    ({formData.description.length}/500 characters)\n                  </span>\n                )}\n              </label>\n              <textarea\n                value={formData.description}\n                onChange={(e) => {\n                  setFormData({ ...formData, description: e.target.value });\n                  validateField('description', e.target.value);\n                }}\n                onBlur={(e) => validateField('description', e.target.value)}\n                placeholder=\"Describe the room, amenities, rules, and any other details...\"\n                rows=\"4\"\n                className={`w-full px-4 py-3 border-2 ${errors.description ? 'border-red-400' : 'border-gray-200'} bg-white text-gray-800 rounded-xl focus:ring-2 ${errors.description ? 'focus:ring-red-400' : 'focus:ring-teal-400'} focus:border-transparent transition placeholder-gray-400`}\n              />\n              {errors.description && <p className=\"text-red-500 text-xs mt-1\">{errors.description}</p>}\n            </div>\n\n            {/* Amenities */}\n            <div>\n              <label className=\"block text-sm font-semibold text-gray-800 mb-3\">Amenities</label>\n              <div className=\"grid grid-cols-2 md:grid-cols-3 gap-2\">\n                {availableAmenities.map(amenity => (\n                  <button\n                    key={amenity}\n                    type=\"button\"\n                    onClick={() => toggleAmenity(amenity)}\n                    className={`px-4 py-2.5 rounded-xl text-sm font-medium transition-all ${\n                      formData.amenities.includes(amenity)\n                        ? 'bg-gradient-to-r from-teal-500 to-cyan-500 text-white shadow-md'\n                        : 'bg-gray-100 text-gray-700 border-2 border-gray-200 hover:border-teal-300 hover:bg-teal-50'\n                    }`}\n                  >\n                    {amenity}\n                  </button>\n                ))}\n              </div>\n            </div>\n\n            {/* Photos */}\n            <div>\n              <label className=\"block text-sm font-semibold text-gray-800 mb-2\">Photos (Max 5)</label>\n              <div \n                className=\"relative border-2 border-dashed border-gray-300 bg-gradient-to-br from-gray-50 to-slate-50 rounded-xl p-6 hover:border-teal-400 hover:bg-teal-50/30 transition-all duration-300 cursor-pointer group\"\n                onClick={() => setShowPhotoEditor(true)}\n              >\n                <div className=\"text-center\">\n                  <div className=\"w-16 h-16 bg-gradient-to-br from-teal-100 to-cyan-100 rounded-2xl flex items-center justify-center mx-auto mb-3 group-hover:scale-110 transition-transform duration-300\">\n                    <span className=\"text-3xl\"></span>\n                  </div>\n                  <p className=\"text-gray-700 font-semibold mb-1\">\n                    {formData.photos.length === 0 ? 'Add Photos' : `${formData.photos.length}/5 Photos Added`}\n                  </p>\n                  <p className=\"text-xs text-gray-500\">\n                    Click to upload  JPG, PNG up to 5MB each\n                  </p>\n                  {formData.photos.length === 0 && (\n                    <p className=\"text-xs text-teal-600 mt-2 font-medium\">\n                      Tip: Listings with photos get 3x more views!\n                    </p>\n                  )}\n                </div>\n              </div>\n              {formData.photos.length > 0 && (\n                <div className=\"mt-4 grid grid-cols-2 md:grid-cols-3 gap-3\">\n                  {formData.photos.map((photo, index) => (\n                    <div key={index} className=\"relative group\">\n                      {index === 0 && (\n                        <div className=\"absolute top-2 left-2 bg-gradient-to-r from-teal-500 to-cyan-500 text-white text-xs px-2 py-1 rounded-full font-semibold z-10\">\n                          Cover\n                        </div>\n                      )}\n                      <img \n                        src={photo} \n                        alt={`Preview ${index + 1}`} \n                        className=\"w-full h-32 object-cover rounded-xl border-2 border-gray-200 shadow-sm\" \n                      />\n                    </div>\n                  ))}\n                </div>\n              )}\n              <button\n                type=\"button\"\n                onClick={() => setShowPhotoEditor(true)}\n                className=\"mt-3 text-sm text-teal-600 hover:text-teal-700 font-medium\"\n              >\n                {formData.photos.length > 0 ? ' Edit Photos' : ''}\n              </button>\n            </div>\n\n            {showPhotoEditor && (\n              <PhotoEditor\n                photos={formData.photos}\n                onPhotosChange={(newPhotos) => setFormData({ ...formData, photos: newPhotos })}\n                onClose={() => setShowPhotoEditor(false)}\n                maxPhotos={5}\n              />\n            )}\n\n            {/* Submit Button */}\n            <div className=\"border-t border-gray-200 pt-6\">\n              <button\n                onClick={handleSubmit}\n                disabled={isSubmitting || Object.keys(errors).length > 0}\n                className={`w-full font-semibold py-3.5 rounded-xl transition-all shadow-lg relative ${\n                  isSubmitting || Object.keys(errors).length > 0\n                    ? 'bg-gray-400 cursor-not-allowed'\n                    : 'bg-gradient-to-r from-teal-500 to-cyan-500 hover:from-teal-600 hover:to-cyan-600 text-white hover:shadow-xl hover:shadow-teal-500/25'\n                }`}\n              >\n                {isSubmitting ? (\n                  <>\n                    <span className=\"opacity-0\">Post Room</span>\n                    <div className=\"absolute inset-0 flex items-center justify-center\">\n                      <div className=\"w-5 h-5 border-2 border-white border-t-transparent rounded-full animate-spin\" />\n                    </div>\n                  </>\n                ) : (\n                  'Post Room'\n                )}\n              </button>\n              {Object.keys(errors).length > 0 && (\n                <p className=\"text-red-500 text-xs mt-2 text-center\">Please fix the errors above before submitting</p>\n              )}\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n}\n\n// MessagesView removed - using direct contact instead\n\nfunction MyListingsView({ listings, onDelete }) {\n  return (\n    <div className=\"p-4 min-h-screen bg-gradient-to-b from-slate-50 to-gray-100 pb-24\">\n      <div className=\"max-w-7xl mx-auto mt-8\">\n        {/* Landlord reminder banner */}\n        {listings.length > 0 && (\n          <div className=\"mb-6 bg-gradient-to-r from-amber-50 to-orange-50 border border-amber-200 rounded-2xl p-4 shadow-sm\">\n            <div className=\"flex items-start gap-3\">\n              <div className=\"w-10 h-10 bg-amber-100 rounded-xl flex items-center justify-center flex-shrink-0\">\n                <AlertTriangle className=\"w-5 h-5 text-amber-600\" />\n              </div>\n              <div>\n                <h3 className=\"font-semibold text-amber-800 mb-1\">Found a tenant?</h3>\n                <p className=\"text-amber-700 text-sm leading-relaxed\">\n                  Remember to <span className=\"font-medium\">delete your listing</span> once you've found a tenant. \n                  This will stop new calls and messages from other renters looking at your ad.\n                </p>\n              </div>\n            </div>\n          </div>\n        )}\n\n        <div className=\"mb-8\">\n          <div className=\"flex items-center gap-4 mb-3\">\n            <div className=\"w-14 h-14 bg-gradient-to-br from-teal-100 to-cyan-100 rounded-2xl flex items-center justify-center shadow-sm\">\n              <Home className=\"w-7 h-7 text-teal-600\" />\n            </div>\n            <div>\n              <h2 className=\"text-3xl font-extrabold text-gray-900\">My Listings</h2>\n              <p className=\"text-gray-600\">\n                {listings.length === 0\n                  ? 'Your properties will appear here'\n                  : `${listings.length} active ${listings.length === 1 ? 'listing' : 'listings'}`}\n              </p>\n            </div>\n          </div>\n        </div>\n\n        {listings.length === 0 ? (\n          <div className=\"bg-white rounded-2xl border border-gray-100 shadow-sm p-12 text-center\">\n            <div className=\"w-24 h-24 bg-gradient-to-br from-teal-50 to-cyan-50 rounded-full flex items-center justify-center mx-auto mb-6\">\n              <Home className=\"w-12 h-12 text-teal-400\" />\n            </div>\n            <h3 className=\"text-xl font-bold text-gray-800 mb-2\">No Listings Yet</h3>\n            <p className=\"text-gray-500 text-sm mb-6 max-w-md mx-auto\">\n              Start earning by posting your first room. It only takes a few minutes!\n            </p>\n            <button\n              onClick={() => window.location.hash = '#add'}\n              className=\"inline-flex items-center gap-2 bg-gradient-to-r from-teal-600 to-cyan-600 hover:from-teal-700 hover:to-cyan-700 text-white font-semibold px-6 py-3 rounded-xl transition-all shadow-md hover:shadow-lg\"\n            >\n              <PlusCircle className=\"w-5 h-5\" />\n              Post Your First Room\n            </button>\n          </div>\n        ) : (\n          <div className=\"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6\">\n            {listings.map(listing => (\n              <div key={listing.id} className=\"bg-white rounded-2xl shadow-sm border border-gray-100 overflow-hidden hover:shadow-md transition-shadow\">\n                {listing.photos && listing.photos.length > 0 && (\n                  <div className=\"relative\">\n                    <img src={listing.photos[0]} alt=\"Room\" className=\"w-full h-48 object-cover\" />\n                    {listing.photos.length > 1 && (\n                      <div className=\"absolute top-3 right-3 bg-black/60 backdrop-blur-sm text-white px-2.5 py-1 rounded-full text-xs font-medium\">\n                        {listing.photos.length} photos\n                      </div>\n                    )}\n                    <div className={`absolute top-3 left-3 px-2.5 py-1 rounded-full text-xs font-semibold ${\n                      listing.status === 'available' \n                        ? 'bg-emerald-500 text-white' \n                        : 'bg-gray-500 text-white'\n                    }`}>\n                      {listing.status === 'available' ? 'Active' : 'Rented'}\n                    </div>\n                  </div>\n                )}\n                <div className=\"p-5\">\n                  <h3 className=\"font-bold text-lg text-gray-900 mb-1 line-clamp-1\">{listing.title}</h3>\n                  <div className=\"text-teal-600 font-bold text-xl mb-2\">R{listing.price?.toLocaleString()}/month</div>\n                  <div className=\"flex items-center text-gray-500 text-sm mb-4\">\n                    <MapPin className=\"w-4 h-4 mr-1.5 text-gray-400\" />\n                    <span className=\"line-clamp-1\">{listing.location}</span>\n                  </div>\n                  <div className=\"flex gap-2\">\n                    <button\n                      onClick={() => onDelete(listing.id)}\n                      className=\"flex-1 bg-red-50 hover:bg-red-100 text-red-600 font-medium py-2.5 rounded-xl transition-colors text-sm\"\n                    >\n                      Delete\n                    </button>\n                  </div>\n                </div>\n              </div>\n            ))}\n          </div>\n        )}\n      </div>\n    </div>\n  );\n}\n\n\n// Inline message box component with validation for listing detail view\n// ListingInlineMessageBox removed\n\n// ConversationModal removed\n\nfunction AuthModal({ defaultType = 'renter', onClose, onSubmit }) {\n  const [form, setForm] = useState({ name: '', phone: '', email: '', type: defaultType, photo: '' });\n  const [errors, setErrors] = useState({});\n  const [isSubmitting, setIsSubmitting] = useState(false);\n\n  const validateForm = () => {\n    const newErrors = {};\n    if (!form.name || form.name.trim().length < 2) {\n      newErrors.name = 'Name must be at least 2 characters';\n    }\n    if (!form.email || !/^[^\\s@]+@[^\\s@]+\\.[^\\s@]+$/.test(form.email)) {\n      newErrors.email = 'Please enter a valid email address';\n    }\n    setErrors(newErrors);\n    return Object.keys(newErrors).length === 0;\n  };\n\n  const handleSubmit = async () => {\n    if (!validateForm()) return;\n    setIsSubmitting(true);\n    try {\n      await onSubmit(form);\n    } finally {\n      setIsSubmitting(false);\n    }\n  };\n\n  return (\n    <div className=\"fixed inset-0 bg-gray-900/60 backdrop-blur-sm flex items-start sm:items-center justify-center p-4 pt-16 sm:pt-4 z-50 overflow-y-auto\">\n      <div className=\"bg-white rounded-2xl w-full max-w-md p-8 my-auto shadow-2xl fade-in border border-gray-100\">\n        {/* Header */}\n        <div className=\"flex items-start justify-between mb-8\">\n          <div>\n            <div className=\"flex items-center gap-2 mb-2\">\n              <div className=\"w-10 h-10 bg-gradient-to-br from-teal-500 to-cyan-500 rounded-xl flex items-center justify-center shadow-lg\">\n                <Home className=\"w-5 h-5 text-white\" />\n              </div>\n              <span className=\"text-xl font-extrabold\">\n                <span className=\"bg-gradient-to-r from-teal-600 to-cyan-600 bg-clip-text text-transparent\">Room</span>\n                <span className=\"text-rose-500\">24</span>\n              </span>\n            </div>\n            <h3 className=\"text-xl font-bold text-gray-900 mt-4\">Welcome!</h3>\n            <p className=\"text-sm text-gray-500 mt-1\">Sign in or create your account</p>\n          </div>\n          <button \n            onClick={onClose} \n            className=\"p-2 text-gray-400 hover:text-gray-600 hover:bg-gray-100 rounded-xl transition-colors\"\n          >\n            <X className=\"w-5 h-5\" />\n          </button>\n        </div>\n\n        <div className=\"space-y-5\">\n          {/* Name */}\n          <div>\n            <label className=\"block text-sm font-semibold text-gray-700 mb-2\">Full name *</label>\n            <input \n              type=\"text\" \n              value={form.name} \n              onChange={(e) => { setForm({ ...form, name: e.target.value }); setErrors({ ...errors, name: '' }); }}\n              className={`w-full px-4 py-3 border-2 rounded-xl transition-all focus:ring-2 focus:ring-teal-100 focus:border-teal-500 ${\n                errors.name ? 'border-rose-400 bg-rose-50' : 'border-gray-200 hover:border-gray-300'\n              }`}\n              placeholder=\"John Doe\"\n            />\n            {errors.name && <p className=\"text-rose-500 text-xs mt-1.5 flex items-center gap-1\"><span></span>{errors.name}</p>}\n          </div>\n\n          {/* Email */}\n          <div>\n            <label className=\"block text-sm font-semibold text-gray-700 mb-2\">Email *</label>\n            <input \n              type=\"email\" \n              value={form.email} \n              onChange={(e) => { setForm({ ...form, email: e.target.value }); setErrors({ ...errors, email: '' }); }}\n              className={`w-full px-4 py-3 border-2 rounded-xl transition-all focus:ring-2 focus:ring-teal-100 focus:border-teal-500 ${\n                errors.email ? 'border-rose-400 bg-rose-50' : 'border-gray-200 hover:border-gray-300'\n              }`}\n              placeholder=\"john@example.com\"\n            />\n            {errors.email && <p className=\"text-rose-500 text-xs mt-1.5 flex items-center gap-1\"><span></span>{errors.email}</p>}\n          </div>\n\n          {/* Phone */}\n          <div>\n            <label className=\"block text-sm font-semibold text-gray-700 mb-2\">\n              Phone <span className=\"text-gray-400 font-normal\">(optional)</span>\n            </label>\n            <input \n              type=\"tel\" \n              value={form.phone} \n              onChange={(e) => setForm({ ...form, phone: e.target.value })}\n              className=\"w-full px-4 py-3 border-2 border-gray-200 hover:border-gray-300 rounded-xl transition-all focus:ring-2 focus:ring-teal-100 focus:border-teal-500\"\n              placeholder=\"+27 12 345 6789\"\n            />\n          </div>\n\n          {/* User Type */}\n          <div>\n            <label className=\"block text-sm font-semibold text-gray-700 mb-2\">I am a</label>\n            <div className=\"grid grid-cols-2 gap-3\">\n              <button\n                type=\"button\"\n                onClick={() => setForm({ ...form, type: 'renter' })}\n                className={`p-4 rounded-xl border-2 transition-all flex flex-col items-center gap-2 ${\n                  form.type === 'renter' \n                    ? 'border-teal-500 bg-gradient-to-br from-teal-50 to-cyan-50 text-teal-700 shadow-md' \n                    : 'border-gray-200 hover:border-gray-300 text-gray-600 hover:bg-gray-50'\n                }`}\n              >\n                <Search className={`w-6 h-6 ${form.type === 'renter' ? 'text-teal-500' : ''}`} />\n                <span className=\"text-sm font-semibold\">Looking for a room</span>\n              </button>\n              <button\n                type=\"button\"\n                onClick={() => setForm({ ...form, type: 'landlord' })}\n                className={`p-4 rounded-xl border-2 transition-all flex flex-col items-center gap-2 ${\n                  form.type === 'landlord' \n                    ? 'border-rose-500 bg-gradient-to-br from-rose-50 to-pink-50 text-rose-700 shadow-md' \n                    : 'border-gray-200 hover:border-gray-300 text-gray-600 hover:bg-gray-50'\n                }`}\n              >\n                <Home className={`w-6 h-6 ${form.type === 'landlord' ? 'text-rose-500' : ''}`} />\n                <span className=\"text-sm font-semibold\">Listing rooms</span>\n              </button>\n            </div>\n          </div>\n\n          {/* Buttons */}\n          <div className=\"flex gap-3 pt-4\">\n            <button \n              onClick={onClose} \n              className=\"flex-1 bg-gray-100 hover:bg-gray-200 text-gray-700 font-semibold py-3 rounded-xl transition-colors\"\n            >\n              Cancel\n            </button>\n            <button \n              onClick={handleSubmit}\n              disabled={isSubmitting}\n              className={`flex-1 font-bold py-3 rounded-xl transition-all relative ${\n                isSubmitting \n                  ? 'bg-teal-400 cursor-not-allowed' \n                  : 'bg-gradient-to-r from-teal-500 to-cyan-500 hover:from-teal-600 hover:to-cyan-600 text-white shadow-lg hover:shadow-xl hover:shadow-teal-500/25'\n              }`}\n            >\n              {isSubmitting ? (\n                <>\n                  <span className=\"opacity-0\">Continue</span>\n                  <div className=\"absolute inset-0 flex items-center justify-center\">\n                    <div className=\"w-5 h-5 border-2 border-white border-t-transparent rounded-full animate-spin\" />\n                  </div>\n                </>\n              ) : (\n                'Continue '\n              )}\n            </button>\n          </div>\n        </div>\n\n        {/* Footer */}\n        <p className=\"text-xs text-gray-400 text-center mt-6\">\n          By continuing, you agree to our <button className=\"text-teal-600 hover:underline\">Terms of Service</button> and <button className=\"text-teal-600 hover:underline\">Privacy Policy</button>\n        </p>\n      </div>\n    </div>\n  );\n}\n\nfunction BottomNav({ currentView, setCurrentView, userType }) {\n  const navItems = [\n    { id: 'browse', label: 'Browse', icon: <Search className=\"w-5 h-5\" />, activeColor: 'teal' },\n    { id: 'add', label: 'List', icon: <PlusCircle className=\"w-5 h-5\" />, requiresLandlord: true, activeColor: 'rose' },\n    { id: 'favorites', label: 'Saved', icon: <Heart className=\"w-5 h-5\" />, activeColor: 'rose' },\n    { id: 'profile', label: 'Profile', icon: <User className=\"w-5 h-5\" />, activeColor: 'blue' }\n  ];\n\n  return (\n    <div className=\"fixed bottom-0 left-0 right-0 bg-white/95 backdrop-blur-md border-t border-gray-100 px-4 py-2 z-20 md:hidden safe-area-bottom\">\n      <div className=\"grid grid-cols-4 gap-1 max-w-md mx-auto\">\n        {navItems.map(item => {\n          const disabled = item.requiresLandlord && userType !== 'landlord';\n          const isActive = currentView === item.id;\n          const colorClasses = {\n            teal: 'text-teal-600 bg-teal-50',\n            rose: 'text-rose-600 bg-rose-50',\n            blue: 'text-blue-600 bg-blue-50'\n          };\n          return (\n            <button\n              key={item.id}\n              type=\"button\"\n              disabled={disabled}\n              onClick={() => !disabled && setCurrentView(item.id)}\n              className={`flex flex-col items-center gap-0.5 py-2 px-1 rounded-xl transition-all duration-200 ${\n                disabled \n                  ? 'opacity-40 cursor-not-allowed' \n                  : 'active:scale-95'\n              } ${\n                isActive \n                  ? `${colorClasses[item.activeColor]} font-semibold` \n                  : 'text-gray-400 hover:text-gray-600 hover:bg-gray-50'\n              }`}\n            >\n              <span className={`transition-transform duration-200 ${isActive ? 'scale-110' : ''}`}>\n                {item.icon}\n              </span>\n              <span className=\"text-[10px] font-medium\">{item.label}</span>\n            </button>\n          );\n        })}\n      </div>\n    </div>\n  );\n}"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}