{"ast":null,"code":"import React,{useState,useEffect}from'react';import{Search,PlusCircle,Home,User,MapPin}from'lucide-react';import ListingCard from'./ListingCard';import ListingSkeletonCard from'./ListingSkeletonCard';import MapView from'../MapView';import{SidebarAd,InFeedAd}from'./AdBanner';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";export default function BrowseView(_ref){let{listings,searchLocation,setSearchLocation,priceRange,setPriceRange,selectedAmenities,setSelectedAmenities,sortBy,setSortBy,mapView,setMapView,onSelectListing,setCurrentView,currentUser,onRequireAuth,subscribeToArea,onFindNearby,nearbyRadius,setNearbyRadius,nearbyMode,clearNearby,userLocation,nearbyStatus,previewMode}=_ref;const[showAdvancedFilters,setShowAdvancedFilters]=useState(false);const[isDesktop,setIsDesktop]=useState(typeof window!=='undefined'?window.innerWidth>=1024:false);const[paymentFilter,setPaymentFilter]=useState('');const[locationTip,setLocationTip]=useState('');const[locationSuggestions,setLocationSuggestions]=useState([]);const[locationLoading,setLocationLoading]=useState(false);const[savedSearches,setSavedSearches]=useState([]);const[initialLoad,setInitialLoad]=useState(true);const[favorites,setFavorites]=useState([]);const suggestionCacheRef=React.useRef({});// cache: { queryLower: { data: [...], ts } }\nconst SUGGESTION_TTL_MS=15*60*1000;// 15 minutes\nconst toggleFavorite=listingId=>{setFavorites(prev=>{const updated=prev.includes(listingId)?prev.filter(id=>id!==listingId):[...prev,listingId];try{localStorage.setItem('favorites',JSON.stringify(updated));}catch(_unused){}return updated;});};// Restore persisted lightweight filters\nuseEffect(()=>{try{const storedPayment=localStorage.getItem('filter-payment');if(storedPayment)setPaymentFilter(storedPayment);const storedRadius=localStorage.getItem('filter-nearby-radius');if(storedRadius&&!isNaN(parseInt(storedRadius)))setNearbyRadius(parseInt(storedRadius));const storedPriceMin=localStorage.getItem('filter-price-min');const storedPriceMax=localStorage.getItem('filter-price-max');if(storedPriceMin&&!isNaN(parseInt(storedPriceMin))&&storedPriceMax&&!isNaN(parseInt(storedPriceMax))){setPriceRange([parseInt(storedPriceMin),parseInt(storedPriceMax)]);}const storedAmenities=localStorage.getItem('filter-amenities');if(storedAmenities){try{const arr=JSON.parse(storedAmenities);if(Array.isArray(arr))setSelectedAmenities(arr);}catch(_unused2){}}const rawSaved=localStorage.getItem('saved-searches');if(rawSaved){try{const arr=JSON.parse(rawSaved);if(Array.isArray(arr))setSavedSearches(arr);}catch(_unused3){}}const rawFavorites=localStorage.getItem('favorites');if(rawFavorites){try{const arr=JSON.parse(rawFavorites);if(Array.isArray(arr))setFavorites(arr);}catch(_unused4){}}}catch(e){// ignore storage errors\n}// eslint-disable-next-line react-hooks/exhaustive-deps\n},[]);useEffect(()=>{const t=setTimeout(()=>setInitialLoad(false),600);return()=>clearTimeout(t);},[]);useEffect(()=>{const handleResize=()=>setIsDesktop(window.innerWidth>=1024);window.addEventListener('resize',handleResize);return()=>window.removeEventListener('resize',handleResize);},[]);// Persist changes\nuseEffect(()=>{try{localStorage.setItem('filter-payment',paymentFilter);}catch(_unused5){}},[paymentFilter]);useEffect(()=>{try{localStorage.setItem('filter-nearby-radius',String(nearbyRadius));}catch(_unused6){}},[nearbyRadius]);useEffect(()=>{try{localStorage.setItem('filter-price-min',String(priceRange[0]));localStorage.setItem('filter-price-max',String(priceRange[1]));}catch(_unused7){}},[priceRange]);useEffect(()=>{try{localStorage.setItem('filter-amenities',JSON.stringify(selectedAmenities));}catch(_unused8){}},[selectedAmenities]);// Debounced provider-aware suggestions with caching & geolocation bias\nuseEffect(()=>{const raw=(searchLocation||'').trim();if(raw.length<3){setLocationSuggestions([]);setLocationLoading(false);return;}const key=(process.env.REACT_APP_GEOCODER_API_KEY||'').trim();const provider=(process.env.REACT_APP_GEOCODER_PROVIDER||'').toLowerCase();const qLower=raw.toLowerCase();const cached=suggestionCacheRef.current[qLower];if(cached&&Date.now()-cached.ts<SUGGESTION_TTL_MS){setLocationSuggestions(cached.data);return;// serve cache, skip network\n}const controller=new AbortController();setLocationLoading(true);const t=setTimeout(async()=>{try{let suggestions=[];if(provider==='mapbox'&&key){const proximity=userLocation?\"&proximity=\".concat(userLocation.lon,\",\").concat(userLocation.lat):'';const url=\"https://api.mapbox.com/geocoding/v5/mapbox.places/\".concat(encodeURIComponent(raw),\".json?access_token=\").concat(key,\"&limit=5&country=ZA&language=en\").concat(proximity,\"&types=place,locality,neighborhood\");const resp=await fetch(url,{signal:controller.signal});const data=await resp.json();if(data&&Array.isArray(data.features)){suggestions=data.features.map(f=>f.place_name).filter(Boolean);}}else{// Nominatim fallback with optional viewbox bias\nlet biasParams='';if(userLocation){const delta=0.2;// ~20km\nconst minLon=userLocation.lon-delta;const maxLon=userLocation.lon+delta;const minLat=userLocation.lat-delta;const maxLat=userLocation.lat+delta;biasParams=\"&bounded=1&viewbox=\".concat(minLon,\",\").concat(maxLat,\",\").concat(maxLon,\",\").concat(minLat);}const url=\"https://nominatim.openstreetmap.org/search?format=json&q=\".concat(encodeURIComponent(raw+', South Africa'),\"&limit=5\").concat(biasParams);const resp=await fetch(url,{signal:controller.signal,headers:{'Accept-Language':'en'}});const data=await resp.json();const uniq=[];data.forEach(item=>{const display=item.display_name||'';const parts=display.split(',').map(p=>p.trim());const area=parts.slice(0,2).join(', ');if(area&&!uniq.includes(area))uniq.push(area);});suggestions=uniq.slice(0,5);}suggestionCacheRef.current[qLower]={data:suggestions,ts:Date.now()};setLocationSuggestions(suggestions);}catch(e){setLocationSuggestions([]);}finally{setLocationLoading(false);}},450);return()=>{clearTimeout(t);controller.abort();};},[searchLocation,userLocation,SUGGESTION_TTL_MS]);// Sidebar navigation items (desktop only)\nconst desktopNavItems=[{id:'browse',label:'Browse',icon:Search},{id:'add',label:'List Room',icon:PlusCircle,show:currentUser&&currentUser.type==='landlord'&&!previewMode},{id:'my-listings',label:'My Rooms',icon:Home,show:currentUser&&currentUser.type==='landlord'&&!previewMode},{id:'profile',label:'Profile',icon:User}];const amenityOptions=['WiFi','Parking','Kitchen','Laundry','Air Conditioning','Heating','Furnished'];const toggleAmenity=amenity=>{if(selectedAmenities.includes(amenity)){setSelectedAmenities(selectedAmenities.filter(a=>a!==amenity));}else{setSelectedAmenities([...selectedAmenities,amenity]);}};const clearChip=(type,value)=>{if(type==='location')setSearchLocation('');if(type==='priceMin')setPriceRange([0,priceRange[1]]);if(type==='priceMax')setPriceRange([priceRange[0],10000]);if(type==='amenity')setSelectedAmenities(selectedAmenities.filter(a=>a!==value));if(type==='sort')setSortBy('newest');if(type==='nearby')clearNearby();};const renderFilterChips=()=>{const chips=[];if(searchLocation)chips.push({type:'location',label:searchLocation});if(priceRange[0]>0)chips.push({type:'priceMin',label:\"Min R\".concat(priceRange[0])});if(priceRange[1]<10000)chips.push({type:'priceMax',label:\"Max R\".concat(priceRange[1])});selectedAmenities.forEach(a=>chips.push({type:'amenity',label:a,value:a}));if(sortBy!=='newest')chips.push({type:'sort',label:\"Sort: \".concat(sortBy)});if(paymentFilter)chips.push({type:'payment',label:\"Pay: \".concat(paymentFilter)});if(nearbyMode&&userLocation)chips.push({type:'nearby',label:\"Within \".concat(nearbyRadius,\"km\")});if(chips.length===0)return null;return/*#__PURE__*/_jsxs(\"div\",{className:\"filter-chip-bar\",\"aria-label\":\"Active filters\",children:[chips.map((chip,idx)=>/*#__PURE__*/_jsxs(\"button\",{onClick:()=>clearChip(chip.type,chip.value),className:\"filter-chip\",\"aria-label\":\"Remove \".concat(chip.label,\" filter\"),children:[/*#__PURE__*/_jsx(\"span\",{children:chip.label}),/*#__PURE__*/_jsx(\"span\",{\"aria-hidden\":\"true\",children:\"\\u2715\"})]},idx)),/*#__PURE__*/_jsx(\"button\",{onClick:()=>{setSearchLocation('');setPriceRange([0,10000]);setSelectedAmenities([]);setSortBy('newest');if(nearbyMode)clearNearby();setPaymentFilter('');setLocationSuggestions([]);try{localStorage.removeItem('filter-payment');}catch(_unused9){}try{localStorage.removeItem('filter-price-min');localStorage.removeItem('filter-price-max');}catch(_unused0){}try{localStorage.removeItem('filter-amenities');}catch(_unused1){}},className:\"filter-chip bg-red-50 text-red-700 hover:bg-red-100\",children:\"Clear All\"})]});};const saveCurrentSearch=()=>{const snapshot={id:Date.now(),ts:Date.now(),location:searchLocation||'',priceRange:[...priceRange],amenities:[...selectedAmenities],payment:paymentFilter,nearby:nearbyMode?nearbyRadius:null,sort:sortBy};const next=[snapshot,...savedSearches].slice(0,15);// keep last 15\nsetSavedSearches(next);try{localStorage.setItem('saved-searches',JSON.stringify(next));}catch(_unused10){}};const loadSearch=s=>{setSearchLocation(s.location);setPriceRange(s.priceRange);setSelectedAmenities(s.amenities);setPaymentFilter(s.payment);if(s.nearby)setNearbyRadius(s.nearby);setSortBy(s.sort||'newest');};const renderFiltersBox=()=>/*#__PURE__*/_jsxs(\"div\",{className:\"filters-box\",\"aria-label\":\"Filters panel\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center gap-2 mb-2\",children:[/*#__PURE__*/_jsx(MapPin,{className:\"w-4 h-4 text-gray-400\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",placeholder:\"Search location...\",value:searchLocation,onChange:e=>setSearchLocation(e.target.value),className:\"flex-1 px-3 py-2 border border-gray-300 rounded-md text-sm focus:ring-2 focus:ring-teal-600 focus:border-transparent\",\"aria-label\":\"Location search\"}),locationLoading&&/*#__PURE__*/_jsx(\"span\",{className:\"text-xs text-teal-600 animate-pulse\",\"aria-live\":\"polite\",children:\"Loading...\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex flex-col gap-3\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex flex-col gap-1\",children:[/*#__PURE__*/_jsx(\"label\",{className:\"text-xs font-semibold text-gray-600\",children:\"Price Range\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center gap-2 text-xs bg-gray-50 px-2 py-1 rounded border border-gray-200\",children:[/*#__PURE__*/_jsxs(\"span\",{children:[\"R\",priceRange[0].toLocaleString(),\" - R\",priceRange[1].toLocaleString()]}),/*#__PURE__*/_jsxs(\"select\",{value:priceRange[0],onChange:e=>setPriceRange([parseInt(e.target.value),priceRange[1]]),className:\"bg-transparent border-l border-gray-300 pl-2 focus:outline-none\",\"aria-label\":\"Minimum price\",children:[/*#__PURE__*/_jsx(\"option\",{value:\"0\",children:\"Min\"}),/*#__PURE__*/_jsx(\"option\",{value:\"500\",children:\"R500\"}),/*#__PURE__*/_jsx(\"option\",{value:\"1000\",children:\"R1000\"}),/*#__PURE__*/_jsx(\"option\",{value:\"1500\",children:\"R1500\"})]}),/*#__PURE__*/_jsxs(\"select\",{value:priceRange[1],onChange:e=>setPriceRange([priceRange[0],parseInt(e.target.value)]),className:\"bg-transparent border-l border-gray-300 pl-2 focus:outline-none\",\"aria-label\":\"Maximum price\",children:[/*#__PURE__*/_jsx(\"option\",{value:\"10000\",children:\"R10,000\"}),/*#__PURE__*/_jsx(\"option\",{value:\"5000\",children:\"R5,000\"}),/*#__PURE__*/_jsx(\"option\",{value:\"3000\",children:\"R3,000\"}),/*#__PURE__*/_jsx(\"option\",{value:\"2000\",children:\"R2,000\"})]})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex flex-col gap-1\",children:[/*#__PURE__*/_jsx(\"label\",{className:\"text-xs font-semibold text-gray-600\",children:\"Sort\"}),/*#__PURE__*/_jsxs(\"select\",{value:sortBy,onChange:e=>setSortBy(e.target.value),className:\"text-sm bg-white border border-gray-300 px-2 py-1 rounded focus:ring-2 focus:ring-teal-600\",\"aria-label\":\"Sort order\",children:[/*#__PURE__*/_jsx(\"option\",{value:\"newest\",children:\"Newest\"}),/*#__PURE__*/_jsx(\"option\",{value:\"cheapest\",children:\"Cheapest\"}),/*#__PURE__*/_jsx(\"option\",{value:\"expensive\",children:\"Most Expensive\"})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex flex-col gap-1\",children:[/*#__PURE__*/_jsx(\"label\",{className:\"text-xs font-semibold text-gray-600\",children:\"Payment Method\"}),/*#__PURE__*/_jsxs(\"select\",{value:paymentFilter,onChange:e=>setPaymentFilter(e.target.value),className:\"text-sm bg-white border border-gray-300 px-2 py-1 rounded focus:ring-2 focus:ring-teal-600\",\"aria-label\":\"Payment method\",children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",children:\"Any\"}),/*#__PURE__*/_jsx(\"option\",{value:\"Bank and Cash\",children:\"Bank and Cash\"}),/*#__PURE__*/_jsx(\"option\",{value:\"Cash Only\",children:\"Cash Only\"}),/*#__PURE__*/_jsx(\"option\",{value:\"Bank Only\",children:\"Bank Only\"})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex flex-col gap-1\",children:[/*#__PURE__*/_jsx(\"label\",{className:\"text-xs font-semibold text-gray-600\",children:\"Saved Searches\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex flex-wrap gap-1\",children:[savedSearches.length===0&&/*#__PURE__*/_jsx(\"span\",{className:\"text-[11px] text-gray-500\",children:\"None saved\"}),savedSearches.map(s=>/*#__PURE__*/_jsxs(\"button\",{type:\"button\",onClick:()=>loadSearch(s),className:\"px-2 py-1 rounded-md text-[11px] font-medium bg-purple-50 text-purple-700 border border-purple-200 hover:bg-purple-100\",children:[s.location||'Any',\" \\u2022 \",s.priceRange[0],\"-\",s.priceRange[1]]},s.id))]}),/*#__PURE__*/_jsx(\"button\",{type:\"button\",onClick:saveCurrentSearch,className:\"mt-1 text-xs text-purple-700 hover:text-purple-800 font-medium underline\",children:\"Save Current Search\"})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"text-xs font-semibold text-gray-600 mb-1 block\",children:\"Amenities\"}),/*#__PURE__*/_jsx(\"div\",{className:\"flex flex-wrap gap-1\",children:amenityOptions.map(a=>/*#__PURE__*/_jsx(\"button\",{type:\"button\",onClick:()=>toggleAmenity(a),className:\"px-2 py-1 rounded-md text-[11px] font-medium border transition \".concat(selectedAmenities.includes(a)?'bg-teal-600 text-white border-teal-600 shadow-sm':'bg-gray-100 text-gray-700 border-gray-300 hover:bg-gray-200'),\"aria-pressed\":selectedAmenities.includes(a),children:a},a))})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"mt-2 flex flex-col gap-2\",children:[/*#__PURE__*/_jsx(\"label\",{className:\"text-xs font-semibold text-gray-600\",children:\"Nearby Search\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex gap-2\",children:[/*#__PURE__*/_jsx(\"button\",{type:\"button\",onClick:()=>onFindNearby&&onFindNearby(),className:\"flex-1 bg-green-600 hover:bg-green-700 text-white px-2 py-1 rounded text-xs font-medium\",children:\"Find Nearby\"}),/*#__PURE__*/_jsxs(\"select\",{value:nearbyRadius,onChange:e=>setNearbyRadius(parseInt(e.target.value)),className:\"text-xs bg-gray-50 border border-gray-300 px-2 py-1 rounded\",\"aria-label\":\"Nearby radius\",children:[/*#__PURE__*/_jsx(\"option\",{value:1,children:\"1km\"}),/*#__PURE__*/_jsx(\"option\",{value:3,children:\"3km\"}),/*#__PURE__*/_jsx(\"option\",{value:5,children:\"5km\"}),/*#__PURE__*/_jsx(\"option\",{value:10,children:\"10km\"})]})]}),nearbyMode&&/*#__PURE__*/_jsx(\"button\",{onClick:clearNearby,className:\"text-xs bg-white border border-gray-300 text-gray-700 px-2 py-1 rounded\",children:\"Clear Nearby\"}),nearbyStatus&&/*#__PURE__*/_jsx(\"div\",{className:\"text-xs text-gray-500\",\"aria-live\":\"polite\",children:nearbyStatus}),!userLocation&&/*#__PURE__*/_jsx(\"button\",{type:\"button\",onClick:()=>{onFindNearby&&onFindNearby();setLocationTip('Grant location access for accurate nearby rooms.');},className:\"text-xs text-blue-600 underline mt-1 text-left\",children:\"Enable Location\"}),locationTip&&!userLocation&&/*#__PURE__*/_jsx(\"div\",{className:\"text-[11px] text-yellow-700 bg-yellow-50 border border-yellow-200 rounded p-2 mt-1\",\"aria-live\":\"polite\",children:locationTip})]}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>setShowAdvancedFilters(!showAdvancedFilters),className:\"mt-2 text-xs text-teal-700 hover:text-teal-800 font-semibold px-2 py-1 rounded hover:bg-teal-50 transition\",\"aria-expanded\":showAdvancedFilters,children:showAdvancedFilters?'Close Advanced':'More Filters'}),showAdvancedFilters&&/*#__PURE__*/_jsx(\"div\",{className:\"mt-2 p-2 bg-gray-50 border border-gray-200 rounded\",\"aria-label\":\"Advanced filters\",children:/*#__PURE__*/_jsx(\"p\",{className:\"text-xs text-gray-600\",children:\"(Advanced filters placeholder)\"})})]})]});// Desktop layout\nif(isDesktop){return/*#__PURE__*/_jsx(\"div\",{className:\"bg-gray-50 min-h-screen pb-4\",\"aria-labelledby\":\"results-heading\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"layout-desktop\",children:[/*#__PURE__*/_jsxs(\"aside\",{className:\"sidebar-nav\",role:\"navigation\",\"aria-label\":\"Desktop navigation and filters\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsxs(\"h2\",{className:\"text-xl font-bold flex items-center gap-2 mb-4\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"text-teal-600\",children:\"Room\"}),/*#__PURE__*/_jsx(\"span\",{className:\"text-red-500\",children:\"24\"})]}),/*#__PURE__*/_jsx(\"div\",{className:\"sidebar-section-title mb-2\",children:\"Navigation\"}),/*#__PURE__*/_jsx(\"div\",{className:\"sidebar-menu\",children:desktopNavItems.filter(i=>i.show===undefined||i.show).map(item=>{const Icon=item.icon;const isActive=item.id==='browse';return/*#__PURE__*/_jsxs(\"button\",{onClick:()=>setCurrentView(item.id),className:isActive?'active':'',\"aria-label\":item.label,children:[/*#__PURE__*/_jsx(Icon,{className:\"w-4 h-4\"}),\" \",item.label]},item.id);})})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"div\",{className:\"sidebar-section-title mb-2\",children:\"Filters\"}),renderFiltersBox()]}),/*#__PURE__*/_jsx(SidebarAd,{}),!currentUser&&/*#__PURE__*/_jsxs(\"div\",{className:\"mt-auto pt-4 border-t border-gray-200\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-xs text-gray-500 mb-2\",children:\"Join to list rooms.\"}),!userLocation&&/*#__PURE__*/_jsx(\"button\",{type:\"button\",onClick:()=>{onFindNearby&&onFindNearby();setLocationTip('Allow location in browser prompt for Nearby.');},className:\"text-xs text-blue-600 underline\",children:\"Enable Location\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex gap-2\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:()=>onRequireAuth&&onRequireAuth('renter'),className:\"flex-1 bg-gray-100 hover:bg-gray-200 text-gray-800 text-xs py-2 rounded\",children:\"Sign In\"}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>onRequireAuth&&onRequireAuth('landlord'),className:\"flex-1 bg-red-500 hover:bg-red-600 text-white text-xs py-2 rounded\",children:\"List Room\"})]})]})]}),/*#__PURE__*/_jsxs(\"main\",{className:\"desktop-split\",role:\"main\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"list-pane\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between mb-3\",children:[/*#__PURE__*/_jsx(\"h2\",{id:\"results-heading\",className:\"text-lg font-semibold text-gray-800\",children:listings.length===0?'No rooms':\"\".concat(listings.length,\" rooms\")}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>setMapView(!mapView),className:\"text-xs px-3 py-1.5 rounded border border-gray-300 bg-white hover:bg-gray-50 transition\",\"aria-pressed\":mapView,children:mapView?'Hide Map':'Show Map'})]}),renderFilterChips(),initialLoad?/*#__PURE__*/_jsx(\"div\",{className:\"grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 2xl:grid-cols-4 gap-6\",\"aria-label\":\"Loading listings\",children:Array.from({length:8}).map((_,i)=>/*#__PURE__*/_jsx(ListingSkeletonCard,{},i))}):(paymentFilter?listings.filter(l=>l.paymentMethod===paymentFilter):listings).length===0?/*#__PURE__*/_jsx(\"div\",{className:\"bg-white border border-gray-200 rounded-lg p-8 text-center\",children:/*#__PURE__*/_jsx(\"p\",{className:\"text-gray-600 text-sm\",children:\"No rooms match your filters.\"})}):/*#__PURE__*/_jsx(\"div\",{className:\"grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 2xl:grid-cols-4 gap-6\",children:(paymentFilter?listings.filter(l=>l.paymentMethod===paymentFilter):listings).map((listing,idx)=>/*#__PURE__*/_jsxs(React.Fragment,{children:[/*#__PURE__*/_jsx(ListingCard,{listing:listing,onClick:()=>onSelectListing(listing)}),(idx+1)%6===0&&idx!==listings.length-1&&/*#__PURE__*/_jsx(\"div\",{className:\"md:col-span-2 xl:col-span-3 2xl:col-span-4\",children:/*#__PURE__*/_jsx(InFeedAd,{})})]},listing.id))})]}),mapView&&/*#__PURE__*/_jsx(\"div\",{className:\"map-pane\",children:/*#__PURE__*/_jsx(MapView,{listings:listings,onMarkerClick:l=>onSelectListing(l),userLocation:userLocation,nearbyRadius:nearbyRadius,fullHeight:true,onRadiusChange:setNearbyRadius,onRecenter:()=>{/* handled in MapView */}})})]})]})});}// Mobile / tablet layout\nreturn/*#__PURE__*/_jsxs(\"div\",{className:\"bg-gray-50 min-h-screen pb-20\",role:\"main\",\"aria-labelledby\":\"results-heading\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"bg-white border-b border-gray-200\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"max-w-7xl mx-auto px-4 py-6\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"mb-4 space-y-3\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"relative\",children:[/*#__PURE__*/_jsx(MapPin,{className:\"absolute left-3 top-3.5 w-5 h-5 text-gray-400\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",placeholder:\"Search by location, suburb, or area...\",value:searchLocation,onChange:e=>setSearchLocation(e.target.value),className:\"w-full pl-10 pr-4 py-3 border border-gray-300 rounded-lg text-gray-700 focus:ring-2 focus:ring-teal-600 focus:border-transparent shadow-sm\",\"aria-label\":\"Location search\"}),locationLoading&&/*#__PURE__*/_jsx(\"div\",{className:\"absolute right-3 top-3.5 text-teal-600 animate-pulse text-xs\",\"aria-live\":\"polite\",children:\"Loading...\"}),locationSuggestions.length>0&&/*#__PURE__*/_jsx(\"div\",{className:\"absolute left-0 right-0 top-full mt-1 bg-white border border-gray-200 rounded-lg shadow-sm z-20 overflow-hidden\",children:locationSuggestions.map(s=>/*#__PURE__*/_jsx(\"button\",{type:\"button\",onClick:()=>{setSearchLocation(s);setLocationSuggestions([]);},className:\"w-full text-left px-3 py-2 text-sm hover:bg-teal-50\",children:s},s))})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex flex-wrap items-center gap-2\",children:[/*#__PURE__*/_jsx(\"button\",{className:\"bg-teal-600 hover:bg-teal-700 text-white px-4 py-2 rounded-lg transition font-semibold shadow-sm text-sm\",onClick:()=>{},\"aria-label\":\"Search submit\",children:\"Search\"}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>{if(!searchLocation||searchLocation.trim()===''){alert('Enter a location to subscribe.');return;}if(!currentUser){onRequireAuth&&onRequireAuth('renter');return;}subscribeToArea&&subscribeToArea(currentUser.id,searchLocation.trim());},className:\"bg-white border border-gray-200 text-gray-700 px-3 py-2 rounded-lg hover:bg-gray-50 transition text-sm\",children:\"Subscribe\"}),/*#__PURE__*/_jsx(\"button\",{type:\"button\",onClick:()=>onFindNearby&&onFindNearby(),className:\"bg-green-600 hover:bg-green-700 text-white px-3 py-2 rounded-lg text-sm font-medium transition\",\"aria-label\":\"Find nearby\",children:\"Nearby\"}),/*#__PURE__*/_jsxs(\"select\",{value:nearbyRadius,onChange:e=>setNearbyRadius(parseInt(e.target.value)),className:\"text-sm bg-gray-50 border border-gray-200 px-3 py-2 rounded-lg text-gray-700 flex-shrink-0\",\"aria-label\":\"Nearby radius\",children:[/*#__PURE__*/_jsx(\"option\",{value:1,children:\"1 km\"}),/*#__PURE__*/_jsx(\"option\",{value:3,children:\"3 km\"}),/*#__PURE__*/_jsx(\"option\",{value:5,children:\"5 km\"}),/*#__PURE__*/_jsx(\"option\",{value:10,children:\"10 km\"})]}),nearbyMode&&/*#__PURE__*/_jsx(\"button\",{onClick:clearNearby,className:\"bg-white border border-gray-200 text-gray-700 px-3 py-2 rounded-lg text-sm\",\"aria-label\":\"Clear nearby\",children:\"Clear\"}),!userLocation&&/*#__PURE__*/_jsx(\"button\",{type:\"button\",onClick:()=>{onFindNearby&&onFindNearby();setLocationTip('Allow location access for better Nearby results.');},className:\"text-xs text-blue-600 underline\",children:\"Enable Location\"})]}),/*#__PURE__*/_jsx(\"div\",{className:\"flex flex-wrap gap-1 -mt-1 mb-2\",\"aria-label\":\"Quick radius\",children:[1,3,5,10].map(r=>/*#__PURE__*/_jsxs(\"button\",{type:\"button\",onClick:()=>setNearbyRadius(r),className:\"px-2 py-1 text-[11px] rounded border \".concat(nearbyRadius===r?'bg-green-600 text-white border-green-600':'bg-gray-100 text-gray-700 border-gray-300 hover:bg-gray-200'),\"aria-pressed\":nearbyRadius===r,children:[r,\"km\"]},r))}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex flex-wrap gap-2 mb-2\",children:[/*#__PURE__*/_jsx(\"button\",{type:\"button\",onClick:saveCurrentSearch,className:\"text-xs px-2 py-1 rounded bg-purple-600 hover:bg-purple-700 text-white font-semibold shadow-sm\",children:\"Save Search\"}),savedSearches.map(s=>/*#__PURE__*/_jsxs(\"button\",{type:\"button\",onClick:()=>loadSearch(s),className:\"text-[11px] px-2 py-1 rounded bg-purple-50 text-purple-700 border border-purple-200\",children:[s.location||'Any',\" \\u2022 \",s.priceRange[0],\"-\",s.priceRange[1]]},s.id))]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex gap-2 mb-3 flex-wrap items-center\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center gap-2 bg-gray-50 px-3 py-2 rounded-lg border border-gray-200\",children:[/*#__PURE__*/_jsxs(\"span\",{className:\"text-sm text-gray-600 font-medium\",children:[\"R\",priceRange[0].toLocaleString(),\" - R\",priceRange[1].toLocaleString()]}),/*#__PURE__*/_jsxs(\"select\",{value:priceRange[0],onChange:e=>setPriceRange([parseInt(e.target.value),priceRange[1]]),className:\"text-xs bg-transparent border-l border-gray-300 pl-2 text-gray-600 focus:outline-none\",\"aria-label\":\"Minimum price\",children:[/*#__PURE__*/_jsx(\"option\",{value:\"0\",children:\"Min\"}),/*#__PURE__*/_jsx(\"option\",{value:\"500\",children:\"R500\"}),/*#__PURE__*/_jsx(\"option\",{value:\"1000\",children:\"R1000\"}),/*#__PURE__*/_jsx(\"option\",{value:\"1500\",children:\"R1500\"})]}),/*#__PURE__*/_jsxs(\"select\",{value:priceRange[1],onChange:e=>setPriceRange([priceRange[0],parseInt(e.target.value)]),className:\"text-xs bg-transparent border-l border-gray-300 pl-2 text-gray-600 focus:outline-none\",\"aria-label\":\"Maximum price\",children:[/*#__PURE__*/_jsx(\"option\",{value:\"10000\",children:\"R10k\"}),/*#__PURE__*/_jsx(\"option\",{value:\"5000\",children:\"R5k\"}),/*#__PURE__*/_jsx(\"option\",{value:\"3000\",children:\"R3k\"}),/*#__PURE__*/_jsx(\"option\",{value:\"2000\",children:\"R2k\"})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center gap-2\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"text-sm text-gray-600\",children:\"Sort:\"}),/*#__PURE__*/_jsxs(\"select\",{value:sortBy,onChange:e=>setSortBy(e.target.value),className:\"text-sm bg-gray-50 border border-gray-200 px-3 py-2 rounded-lg text-gray-700 focus:ring-2 focus:ring-teal-600\",\"aria-label\":\"Sort order\",children:[/*#__PURE__*/_jsx(\"option\",{value:\"newest\",children:\"Newest\"}),/*#__PURE__*/_jsx(\"option\",{value:\"cheapest\",children:\"Cheapest\"}),/*#__PURE__*/_jsx(\"option\",{value:\"expensive\",children:\"Most Expensive\"})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center gap-2\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"text-sm text-gray-600\",children:\"Payment:\"}),/*#__PURE__*/_jsxs(\"select\",{value:paymentFilter,onChange:e=>setPaymentFilter(e.target.value),className:\"text-sm bg-gray-50 border border-gray-200 px-3 py-2 rounded-lg text-gray-700 focus:ring-2 focus:ring-teal-600\",\"aria-label\":\"Payment method filter\",children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",children:\"Any\"}),/*#__PURE__*/_jsx(\"option\",{value:\"Bank and Cash\",children:\"Bank & Cash\"}),/*#__PURE__*/_jsx(\"option\",{value:\"Cash Only\",children:\"Cash Only\"}),/*#__PURE__*/_jsx(\"option\",{value:\"Bank Only\",children:\"Bank Only\"})]})]}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>setShowAdvancedFilters(!showAdvancedFilters),className:\"text-sm text-teal-700 hover:text-teal-800 font-medium px-3 py-2 rounded-lg hover:bg-teal-50 transition\",\"aria-expanded\":showAdvancedFilters,children:showAdvancedFilters?'✕ Filters':'⚙️ Filters'})]}),locationTip&&!userLocation&&/*#__PURE__*/_jsx(\"div\",{className:\"text-xs text-yellow-700 bg-yellow-50 border border-yellow-200 rounded p-2 mb-3\",\"aria-live\":\"polite\",children:locationTip}),showAdvancedFilters&&/*#__PURE__*/_jsxs(\"div\",{className:\"mt-3 p-4 bg-gray-50 rounded-lg border border-gray-200\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"flex flex-wrap gap-1 mb-2\",\"aria-label\":\"Amenities\",children:amenityOptions.map(a=>/*#__PURE__*/_jsx(\"button\",{type:\"button\",onClick:()=>toggleAmenity(a),className:\"px-2 py-1 rounded-md text-[11px] font-medium border transition \".concat(selectedAmenities.includes(a)?'bg-teal-600 text-white border-teal-600 shadow-sm':'bg-gray-100 text-gray-700 border-gray-300 hover:bg-gray-200'),\"aria-pressed\":selectedAmenities.includes(a),children:a},a))}),/*#__PURE__*/_jsx(\"p\",{className:\"text-xs text-gray-500\",children:\"Select amenities to refine results.\"})]}),renderFilterChips()]})}),/*#__PURE__*/_jsx(\"div\",{className:\"max-w-7xl mx-auto px-4 pt-3\",children:/*#__PURE__*/_jsx(InFeedAd,{})}),/*#__PURE__*/_jsxs(\"div\",{className:\"max-w-7xl mx-auto px-4\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-between items-center mt-4 mb-3\",children:[/*#__PURE__*/_jsx(\"h2\",{id:\"results-heading\",className:\"text-2xl font-bold text-gray-800\",children:listings.length===0?'No rooms available':\"\".concat(listings.length,\" Rooms Available\")}),/*#__PURE__*/_jsxs(\"button\",{onClick:()=>setMapView(!mapView),className:\"text-sm px-4 py-2 rounded-lg border border-gray-200 bg-white hover:bg-gray-50 transition flex items-center gap-2\",\"aria-pressed\":mapView,children:[/*#__PURE__*/_jsx(MapPin,{className:\"w-4 h-4\"}),\" \",mapView?'Show List':'Show Map']})]}),mapView&&/*#__PURE__*/_jsx(\"div\",{className:\"mb-6\",children:/*#__PURE__*/_jsx(MapView,{listings:listings,onMarkerClick:l=>onSelectListing(l),userLocation:userLocation,nearbyRadius:nearbyRadius,fullHeight:false,onRadiusChange:setNearbyRadius})}),initialLoad?/*#__PURE__*/_jsx(\"div\",{className:\"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6 mb-12 justify-items-center\",\"aria-label\":\"Loading listings\",children:Array.from({length:8}).map((_,i)=>/*#__PURE__*/_jsx(ListingSkeletonCard,{},i))}):(paymentFilter?listings.filter(l=>l.paymentMethod===paymentFilter):listings).length===0?/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white rounded-lg border border-gray-200 p-12 text-center\",children:[/*#__PURE__*/_jsx(Home,{className:\"w-16 h-16 mx-auto mb-4 text-gray-300\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-gray-600 font-medium mb-2\",children:\"No rooms match your search\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-gray-500 text-sm mb-4\",children:\"Try adjusting your filters or search in a different location\"}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>{setSearchLocation('');setPriceRange([0,10000]);setSelectedAmenities([]);setSortBy('newest');},className:\"text-teal-700 hover:text-teal-800 font-medium text-sm\",children:\"Clear all filters\"})]}):/*#__PURE__*/_jsx(\"div\",{className:\"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6 mb-12 justify-items-center\",children:(paymentFilter?listings.filter(l=>l.paymentMethod===paymentFilter):listings).map((listing,idx)=>/*#__PURE__*/_jsxs(React.Fragment,{children:[/*#__PURE__*/_jsx(ListingCard,{listing:listing,onClick:()=>onSelectListing(listing),isFavorite:favorites.includes(listing.id),onToggleFavorite:toggleFavorite}),(idx+1)%8===0&&idx!==listings.length-1&&/*#__PURE__*/_jsx(\"div\",{className:\"sm:col-span-2 lg:col-span-3 xl:col-span-4\",children:/*#__PURE__*/_jsx(InFeedAd,{})})]},listing.id))})]})]});}","map":{"version":3,"names":["React","useState","useEffect","Search","PlusCircle","Home","User","MapPin","ListingCard","ListingSkeletonCard","MapView","SidebarAd","InFeedAd","jsx","_jsx","jsxs","_jsxs","BrowseView","_ref","listings","searchLocation","setSearchLocation","priceRange","setPriceRange","selectedAmenities","setSelectedAmenities","sortBy","setSortBy","mapView","setMapView","onSelectListing","setCurrentView","currentUser","onRequireAuth","subscribeToArea","onFindNearby","nearbyRadius","setNearbyRadius","nearbyMode","clearNearby","userLocation","nearbyStatus","previewMode","showAdvancedFilters","setShowAdvancedFilters","isDesktop","setIsDesktop","window","innerWidth","paymentFilter","setPaymentFilter","locationTip","setLocationTip","locationSuggestions","setLocationSuggestions","locationLoading","setLocationLoading","savedSearches","setSavedSearches","initialLoad","setInitialLoad","favorites","setFavorites","suggestionCacheRef","useRef","SUGGESTION_TTL_MS","toggleFavorite","listingId","prev","updated","includes","filter","id","localStorage","setItem","JSON","stringify","_unused","storedPayment","getItem","storedRadius","isNaN","parseInt","storedPriceMin","storedPriceMax","storedAmenities","arr","parse","Array","isArray","_unused2","rawSaved","_unused3","rawFavorites","_unused4","e","t","setTimeout","clearTimeout","handleResize","addEventListener","removeEventListener","_unused5","String","_unused6","_unused7","_unused8","raw","trim","length","key","process","env","REACT_APP_GEOCODER_API_KEY","provider","REACT_APP_GEOCODER_PROVIDER","toLowerCase","qLower","cached","current","Date","now","ts","data","controller","AbortController","suggestions","proximity","concat","lon","lat","url","encodeURIComponent","resp","fetch","signal","json","features","map","f","place_name","Boolean","biasParams","delta","minLon","maxLon","minLat","maxLat","headers","uniq","forEach","item","display","display_name","parts","split","p","area","slice","join","push","abort","desktopNavItems","label","icon","show","type","amenityOptions","toggleAmenity","amenity","a","clearChip","value","renderFilterChips","chips","className","children","chip","idx","onClick","removeItem","_unused9","_unused0","_unused1","saveCurrentSearch","snapshot","location","amenities","payment","nearby","sort","next","_unused10","loadSearch","s","renderFiltersBox","placeholder","onChange","target","toLocaleString","role","i","undefined","Icon","isActive","from","_","l","paymentMethod","listing","Fragment","onMarkerClick","fullHeight","onRadiusChange","onRecenter","alert","r","isFavorite","onToggleFavorite"],"sources":["C:/Users/kutum/Documents/room-rental-platform/src/components/BrowseView.jsx"],"sourcesContent":["import React, { useState, useEffect } from 'react';\r\nimport { Search, PlusCircle, Home, User, MapPin } from 'lucide-react';\r\nimport ListingCard from './ListingCard';\r\nimport ListingSkeletonCard from './ListingSkeletonCard';\r\nimport MapView from '../MapView';\r\nimport { SidebarAd, InFeedAd } from './AdBanner';\r\n\r\nexport default function BrowseView({\r\n  listings,\r\n  searchLocation,\r\n  setSearchLocation,\r\n  priceRange,\r\n  setPriceRange,\r\n  selectedAmenities,\r\n  setSelectedAmenities,\r\n  sortBy,\r\n  setSortBy,\r\n  mapView,\r\n  setMapView,\r\n  onSelectListing,\r\n  setCurrentView,\r\n  currentUser,\r\n  onRequireAuth,\r\n  subscribeToArea,\r\n  onFindNearby,\r\n  nearbyRadius,\r\n  setNearbyRadius,\r\n  nearbyMode,\r\n  clearNearby,\r\n  userLocation,\r\n  nearbyStatus,\r\n  previewMode\r\n}) {\r\n  const [showAdvancedFilters, setShowAdvancedFilters] = useState(false);\r\n  const [isDesktop, setIsDesktop] = useState(typeof window !== 'undefined' ? window.innerWidth >= 1024 : false);\r\n  const [paymentFilter, setPaymentFilter] = useState('');\r\n  const [locationTip, setLocationTip] = useState('');\r\n  const [locationSuggestions, setLocationSuggestions] = useState([]);\r\n  const [locationLoading, setLocationLoading] = useState(false);\r\n  const [savedSearches, setSavedSearches] = useState([]);\r\n  const [initialLoad, setInitialLoad] = useState(true);\r\n  const [favorites, setFavorites] = useState([]);\r\n  const suggestionCacheRef = React.useRef({}); // cache: { queryLower: { data: [...], ts } }\r\n  const SUGGESTION_TTL_MS = 15 * 60 * 1000; // 15 minutes\r\n\r\n  const toggleFavorite = (listingId) => {\r\n    setFavorites(prev => {\r\n      const updated = prev.includes(listingId)\r\n        ? prev.filter(id => id !== listingId)\r\n        : [...prev, listingId];\r\n      try {\r\n        localStorage.setItem('favorites', JSON.stringify(updated));\r\n      } catch {}\r\n      return updated;\r\n    });\r\n  };\r\n\r\n  // Restore persisted lightweight filters\r\n  useEffect(() => {\r\n    try {\r\n      const storedPayment = localStorage.getItem('filter-payment');\r\n      if (storedPayment) setPaymentFilter(storedPayment);\r\n      const storedRadius = localStorage.getItem('filter-nearby-radius');\r\n      if (storedRadius && !isNaN(parseInt(storedRadius))) setNearbyRadius(parseInt(storedRadius));\r\n      const storedPriceMin = localStorage.getItem('filter-price-min');\r\n      const storedPriceMax = localStorage.getItem('filter-price-max');\r\n      if (storedPriceMin && !isNaN(parseInt(storedPriceMin)) && storedPriceMax && !isNaN(parseInt(storedPriceMax))) {\r\n        setPriceRange([parseInt(storedPriceMin), parseInt(storedPriceMax)]);\r\n      }\r\n      const storedAmenities = localStorage.getItem('filter-amenities');\r\n      if (storedAmenities) {\r\n        try {\r\n          const arr = JSON.parse(storedAmenities);\r\n          if (Array.isArray(arr)) setSelectedAmenities(arr);\r\n        } catch {}\r\n      }\r\n      const rawSaved = localStorage.getItem('saved-searches');\r\n      if (rawSaved) {\r\n        try {\r\n          const arr = JSON.parse(rawSaved);\r\n          if (Array.isArray(arr)) setSavedSearches(arr);\r\n        } catch {}\r\n      }\r\n      const rawFavorites = localStorage.getItem('favorites');\r\n      if (rawFavorites) {\r\n        try {\r\n          const arr = JSON.parse(rawFavorites);\r\n          if (Array.isArray(arr)) setFavorites(arr);\r\n        } catch {}\r\n      }\r\n    } catch (e) {\r\n      // ignore storage errors\r\n    }\r\n    // eslint-disable-next-line react-hooks/exhaustive-deps\r\n  }, []);\r\n\r\n  useEffect(() => {\r\n    const t = setTimeout(() => setInitialLoad(false), 600);\r\n    return () => clearTimeout(t);\r\n  }, []);\r\n\r\n  useEffect(() => {\r\n    const handleResize = () => setIsDesktop(window.innerWidth >= 1024);\r\n    window.addEventListener('resize', handleResize);\r\n    return () => window.removeEventListener('resize', handleResize);\r\n  }, []);\r\n\r\n  // Persist changes\r\n  useEffect(() => {\r\n    try { localStorage.setItem('filter-payment', paymentFilter); } catch {}\r\n  }, [paymentFilter]);\r\n  useEffect(() => {\r\n    try { localStorage.setItem('filter-nearby-radius', String(nearbyRadius)); } catch {}\r\n  }, [nearbyRadius]);\r\n  useEffect(() => {\r\n    try {\r\n      localStorage.setItem('filter-price-min', String(priceRange[0]));\r\n      localStorage.setItem('filter-price-max', String(priceRange[1]));\r\n    } catch {}\r\n  }, [priceRange]);\r\n  useEffect(() => {\r\n    try { localStorage.setItem('filter-amenities', JSON.stringify(selectedAmenities)); } catch {}\r\n  }, [selectedAmenities]);\r\n\r\n  // Debounced provider-aware suggestions with caching & geolocation bias\r\n  useEffect(() => {\r\n    const raw = (searchLocation || '').trim();\r\n    if (raw.length < 3) { setLocationSuggestions([]); setLocationLoading(false); return; }\r\n    const key = (process.env.REACT_APP_GEOCODER_API_KEY || '').trim();\r\n    const provider = (process.env.REACT_APP_GEOCODER_PROVIDER || '').toLowerCase();\r\n    const qLower = raw.toLowerCase();\r\n    const cached = suggestionCacheRef.current[qLower];\r\n    if (cached && (Date.now() - cached.ts) < SUGGESTION_TTL_MS) {\r\n      setLocationSuggestions(cached.data);\r\n      return; // serve cache, skip network\r\n    }\r\n    const controller = new AbortController();\r\n    setLocationLoading(true);\r\n    const t = setTimeout(async () => {\r\n      try {\r\n        let suggestions = [];\r\n        if (provider === 'mapbox' && key) {\r\n          const proximity = userLocation ? `&proximity=${userLocation.lon},${userLocation.lat}` : '';\r\n          const url = `https://api.mapbox.com/geocoding/v5/mapbox.places/${encodeURIComponent(raw)}.json?access_token=${key}&limit=5&country=ZA&language=en${proximity}&types=place,locality,neighborhood`;\r\n          const resp = await fetch(url, { signal: controller.signal });\r\n          const data = await resp.json();\r\n          if (data && Array.isArray(data.features)) {\r\n            suggestions = data.features.map(f => f.place_name).filter(Boolean);\r\n          }\r\n        } else {\r\n          // Nominatim fallback with optional viewbox bias\r\n          let biasParams = '';\r\n          if (userLocation) {\r\n            const delta = 0.2; // ~20km\r\n            const minLon = userLocation.lon - delta;\r\n            const maxLon = userLocation.lon + delta;\r\n            const minLat = userLocation.lat - delta;\r\n            const maxLat = userLocation.lat + delta;\r\n            biasParams = `&bounded=1&viewbox=${minLon},${maxLat},${maxLon},${minLat}`;\r\n          }\r\n            const url = `https://nominatim.openstreetmap.org/search?format=json&q=${encodeURIComponent(raw + ', South Africa')}&limit=5${biasParams}`;\r\n            const resp = await fetch(url, { signal: controller.signal, headers: { 'Accept-Language': 'en' } });\r\n            const data = await resp.json();\r\n            const uniq = [];\r\n            data.forEach(item => {\r\n              const display = item.display_name || '';\r\n              const parts = display.split(',').map(p => p.trim());\r\n              const area = parts.slice(0, 2).join(', ');\r\n              if (area && !uniq.includes(area)) uniq.push(area);\r\n            });\r\n            suggestions = uniq.slice(0,5);\r\n        }\r\n        suggestionCacheRef.current[qLower] = { data: suggestions, ts: Date.now() };\r\n        setLocationSuggestions(suggestions);\r\n      } catch (e) {\r\n        setLocationSuggestions([]);\r\n      } finally {\r\n        setLocationLoading(false);\r\n      }\r\n    }, 450);\r\n    return () => { clearTimeout(t); controller.abort(); };\r\n  }, [searchLocation, userLocation, SUGGESTION_TTL_MS]);\r\n\r\n  // Sidebar navigation items (desktop only)\r\n  const desktopNavItems = [\r\n    { id: 'browse', label: 'Browse', icon: Search },\r\n    { id: 'add', label: 'List Room', icon: PlusCircle, show: currentUser && currentUser.type === 'landlord' && !previewMode },\r\n    { id: 'my-listings', label: 'My Rooms', icon: Home, show: currentUser && currentUser.type === 'landlord' && !previewMode },\r\n    { id: 'profile', label: 'Profile', icon: User }\r\n  ];\r\n\r\n  const amenityOptions = ['WiFi', 'Parking', 'Kitchen', 'Laundry', 'Air Conditioning', 'Heating', 'Furnished'];\r\n\r\n  const toggleAmenity = (amenity) => {\r\n    if (selectedAmenities.includes(amenity)) {\r\n      setSelectedAmenities(selectedAmenities.filter(a => a !== amenity));\r\n    } else {\r\n      setSelectedAmenities([...selectedAmenities, amenity]);\r\n    }\r\n  };\r\n\r\n  const clearChip = (type, value) => {\r\n    if (type === 'location') setSearchLocation('');\r\n    if (type === 'priceMin') setPriceRange([0, priceRange[1]]);\r\n    if (type === 'priceMax') setPriceRange([priceRange[0], 10000]);\r\n    if (type === 'amenity') setSelectedAmenities(selectedAmenities.filter(a => a !== value));\r\n    if (type === 'sort') setSortBy('newest');\r\n    if (type === 'nearby') clearNearby();\r\n  };\r\n\r\n  const renderFilterChips = () => {\r\n    const chips = [];\r\n    if (searchLocation) chips.push({ type: 'location', label: searchLocation });\r\n    if (priceRange[0] > 0) chips.push({ type: 'priceMin', label: `Min R${priceRange[0]}` });\r\n    if (priceRange[1] < 10000) chips.push({ type: 'priceMax', label: `Max R${priceRange[1]}` });\r\n    selectedAmenities.forEach(a => chips.push({ type: 'amenity', label: a, value: a }));\r\n    if (sortBy !== 'newest') chips.push({ type: 'sort', label: `Sort: ${sortBy}` });\r\n    if (paymentFilter) chips.push({ type: 'payment', label: `Pay: ${paymentFilter}` });\r\n    if (nearbyMode && userLocation) chips.push({ type: 'nearby', label: `Within ${nearbyRadius}km` });\r\n    if (chips.length === 0) return null;\r\n    return (\r\n      <div className=\"filter-chip-bar\" aria-label=\"Active filters\">\r\n        {chips.map((chip, idx) => (\r\n          <button\r\n            key={idx}\r\n            onClick={() => clearChip(chip.type, chip.value)}\r\n            className=\"filter-chip\"\r\n            aria-label={`Remove ${chip.label} filter`}\r\n          >\r\n            <span>{chip.label}</span>\r\n            <span aria-hidden=\"true\">✕</span>\r\n          </button>\r\n        ))}\r\n        <button\r\n          onClick={() => {\r\n            setSearchLocation('');\r\n            setPriceRange([0, 10000]);\r\n            setSelectedAmenities([]);\r\n            setSortBy('newest');\r\n            if (nearbyMode) clearNearby();\r\n              setPaymentFilter('');\r\n            setLocationSuggestions([]);\r\n              try { localStorage.removeItem('filter-payment'); } catch {}\r\n            try { localStorage.removeItem('filter-price-min'); localStorage.removeItem('filter-price-max'); } catch {}\r\n            try { localStorage.removeItem('filter-amenities'); } catch {}\r\n          }}\r\n          className=\"filter-chip bg-red-50 text-red-700 hover:bg-red-100\"\r\n        >Clear All</button>\r\n      </div>\r\n    );\r\n  };\r\n\r\n  const saveCurrentSearch = () => {\r\n    const snapshot = {\r\n      id: Date.now(),\r\n      ts: Date.now(),\r\n      location: searchLocation || '',\r\n      priceRange: [...priceRange],\r\n      amenities: [...selectedAmenities],\r\n      payment: paymentFilter,\r\n      nearby: nearbyMode ? nearbyRadius : null,\r\n      sort: sortBy\r\n    };\r\n    const next = [snapshot, ...savedSearches].slice(0, 15); // keep last 15\r\n    setSavedSearches(next);\r\n    try { localStorage.setItem('saved-searches', JSON.stringify(next)); } catch {}\r\n  };\r\n\r\n  const loadSearch = (s) => {\r\n    setSearchLocation(s.location);\r\n    setPriceRange(s.priceRange);\r\n    setSelectedAmenities(s.amenities);\r\n    setPaymentFilter(s.payment);\r\n    if (s.nearby) setNearbyRadius(s.nearby);\r\n    setSortBy(s.sort || 'newest');\r\n  };\r\n\r\n  const renderFiltersBox = () => (\r\n    <div className=\"filters-box\" aria-label=\"Filters panel\">\r\n      <div className=\"flex items-center gap-2 mb-2\">\r\n        <MapPin className=\"w-4 h-4 text-gray-400\" />\r\n        <input\r\n          type=\"text\"\r\n          placeholder=\"Search location...\"\r\n          value={searchLocation}\r\n          onChange={(e) => setSearchLocation(e.target.value)}\r\n          className=\"flex-1 px-3 py-2 border border-gray-300 rounded-md text-sm focus:ring-2 focus:ring-teal-600 focus:border-transparent\"\r\n          aria-label=\"Location search\"\r\n        />\r\n        {locationLoading && (\r\n          <span className=\"text-xs text-teal-600 animate-pulse\" aria-live=\"polite\">Loading...</span>\r\n        )}\r\n      </div>\r\n      <div className=\"flex flex-col gap-3\">\r\n        <div className=\"flex flex-col gap-1\">\r\n          <label className=\"text-xs font-semibold text-gray-600\">Price Range</label>\r\n          <div className=\"flex items-center gap-2 text-xs bg-gray-50 px-2 py-1 rounded border border-gray-200\">\r\n            <span>R{priceRange[0].toLocaleString()} - R{priceRange[1].toLocaleString()}</span>\r\n            <select\r\n              value={priceRange[0]}\r\n              onChange={(e) => setPriceRange([parseInt(e.target.value), priceRange[1]])}\r\n              className=\"bg-transparent border-l border-gray-300 pl-2 focus:outline-none\"\r\n              aria-label=\"Minimum price\"\r\n            >\r\n              <option value=\"0\">Min</option>\r\n              <option value=\"500\">R500</option>\r\n              <option value=\"1000\">R1000</option>\r\n              <option value=\"1500\">R1500</option>\r\n            </select>\r\n            <select\r\n              value={priceRange[1]}\r\n              onChange={(e) => setPriceRange([priceRange[0], parseInt(e.target.value)])}\r\n              className=\"bg-transparent border-l border-gray-300 pl-2 focus:outline-none\"\r\n              aria-label=\"Maximum price\"\r\n            >\r\n              <option value=\"10000\">R10,000</option>\r\n              <option value=\"5000\">R5,000</option>\r\n              <option value=\"3000\">R3,000</option>\r\n              <option value=\"2000\">R2,000</option>\r\n            </select>\r\n          </div>\r\n        </div>\r\n        <div className=\"flex flex-col gap-1\">\r\n          <label className=\"text-xs font-semibold text-gray-600\">Sort</label>\r\n          <select\r\n            value={sortBy}\r\n            onChange={(e) => setSortBy(e.target.value)}\r\n            className=\"text-sm bg-white border border-gray-300 px-2 py-1 rounded focus:ring-2 focus:ring-teal-600\"\r\n            aria-label=\"Sort order\"\r\n          >\r\n            <option value=\"newest\">Newest</option>\r\n            <option value=\"cheapest\">Cheapest</option>\r\n            <option value=\"expensive\">Most Expensive</option>\r\n          </select>\r\n        </div>\r\n        <div className=\"flex flex-col gap-1\">\r\n          <label className=\"text-xs font-semibold text-gray-600\">Payment Method</label>\r\n          <select\r\n            value={paymentFilter}\r\n            onChange={(e) => setPaymentFilter(e.target.value)}\r\n            className=\"text-sm bg-white border border-gray-300 px-2 py-1 rounded focus:ring-2 focus:ring-teal-600\"\r\n            aria-label=\"Payment method\"\r\n          >\r\n            <option value=\"\">Any</option>\r\n            <option value=\"Bank and Cash\">Bank and Cash</option>\r\n            <option value=\"Cash Only\">Cash Only</option>\r\n            <option value=\"Bank Only\">Bank Only</option>\r\n          </select>\r\n        </div>\r\n            <div className=\"flex flex-col gap-1\">\r\n              <label className=\"text-xs font-semibold text-gray-600\">Saved Searches</label>\r\n              <div className=\"flex flex-wrap gap-1\">\r\n                {savedSearches.length === 0 && (\r\n                  <span className=\"text-[11px] text-gray-500\">None saved</span>\r\n                )}\r\n                {savedSearches.map(s => (\r\n                  <button\r\n                    key={s.id}\r\n                    type=\"button\"\r\n                    onClick={() => loadSearch(s)}\r\n                    className=\"px-2 py-1 rounded-md text-[11px] font-medium bg-purple-50 text-purple-700 border border-purple-200 hover:bg-purple-100\"\r\n                  >{s.location || 'Any'} • {s.priceRange[0]}-{s.priceRange[1]}</button>\r\n                ))}\r\n              </div>\r\n              <button\r\n                type=\"button\"\r\n                onClick={saveCurrentSearch}\r\n                className=\"mt-1 text-xs text-purple-700 hover:text-purple-800 font-medium underline\"\r\n              >Save Current Search</button>\r\n            </div>\r\n        <div>\r\n          <label className=\"text-xs font-semibold text-gray-600 mb-1 block\">Amenities</label>\r\n          <div className=\"flex flex-wrap gap-1\">\r\n            {amenityOptions.map(a => (\r\n              <button\r\n                key={a}\r\n                type=\"button\"\r\n                onClick={() => toggleAmenity(a)}\r\n                className={`px-2 py-1 rounded-md text-[11px] font-medium border transition ${selectedAmenities.includes(a) ? 'bg-teal-600 text-white border-teal-600 shadow-sm' : 'bg-gray-100 text-gray-700 border-gray-300 hover:bg-gray-200'}`}\r\n                aria-pressed={selectedAmenities.includes(a)}\r\n              >{a}</button>\r\n            ))}\r\n          </div>\r\n        </div>\r\n        <div className=\"mt-2 flex flex-col gap-2\">\r\n          <label className=\"text-xs font-semibold text-gray-600\">Nearby Search</label>\r\n          <div className=\"flex gap-2\">\r\n            <button\r\n              type=\"button\"\r\n              onClick={() => onFindNearby && onFindNearby()}\r\n              className=\"flex-1 bg-green-600 hover:bg-green-700 text-white px-2 py-1 rounded text-xs font-medium\"\r\n            >Find Nearby</button>\r\n            <select\r\n              value={nearbyRadius}\r\n              onChange={(e) => setNearbyRadius(parseInt(e.target.value))}\r\n              className=\"text-xs bg-gray-50 border border-gray-300 px-2 py-1 rounded\"\r\n              aria-label=\"Nearby radius\"\r\n            >\r\n              <option value={1}>1km</option>\r\n              <option value={3}>3km</option>\r\n              <option value={5}>5km</option>\r\n              <option value={10}>10km</option>\r\n            </select>\r\n          </div>\r\n          {nearbyMode && (\r\n            <button\r\n              onClick={clearNearby}\r\n              className=\"text-xs bg-white border border-gray-300 text-gray-700 px-2 py-1 rounded\"\r\n            >Clear Nearby</button>\r\n          )}\r\n          {nearbyStatus && <div className=\"text-xs text-gray-500\" aria-live=\"polite\">{nearbyStatus}</div>}\r\n          {!userLocation && (\r\n            <button\r\n              type=\"button\"\r\n              onClick={() => { onFindNearby && onFindNearby(); setLocationTip('Grant location access for accurate nearby rooms.'); }}\r\n              className=\"text-xs text-blue-600 underline mt-1 text-left\"\r\n            >Enable Location</button>\r\n          )}\r\n          {locationTip && !userLocation && (\r\n            <div className=\"text-[11px] text-yellow-700 bg-yellow-50 border border-yellow-200 rounded p-2 mt-1\" aria-live=\"polite\">{locationTip}</div>\r\n          )}\r\n        </div>\r\n        <button\r\n          onClick={() => setShowAdvancedFilters(!showAdvancedFilters)}\r\n          className=\"mt-2 text-xs text-teal-700 hover:text-teal-800 font-semibold px-2 py-1 rounded hover:bg-teal-50 transition\"\r\n          aria-expanded={showAdvancedFilters}\r\n        >{showAdvancedFilters ? 'Close Advanced' : 'More Filters'}</button>\r\n        {showAdvancedFilters && (\r\n          <div className=\"mt-2 p-2 bg-gray-50 border border-gray-200 rounded\" aria-label=\"Advanced filters\"><p className=\"text-xs text-gray-600\">(Advanced filters placeholder)</p></div>\r\n        )}\r\n      </div>\r\n    </div>\r\n  );\r\n\r\n  // Desktop layout\r\n  if (isDesktop) {\r\n    return (\r\n      <div className=\"bg-gray-50 min-h-screen pb-4\" aria-labelledby=\"results-heading\">\r\n        <div className=\"layout-desktop\">\r\n          <aside className=\"sidebar-nav\" role=\"navigation\" aria-label=\"Desktop navigation and filters\">\r\n            <div>\r\n              <h2 className=\"text-xl font-bold flex items-center gap-2 mb-4\"><span className=\"text-teal-600\">Room</span><span className=\"text-red-500\">24</span></h2>\r\n              <div className=\"sidebar-section-title mb-2\">Navigation</div>\r\n              <div className=\"sidebar-menu\">\r\n                {desktopNavItems.filter(i => i.show === undefined || i.show).map(item => {\r\n                  const Icon = item.icon;\r\n                  const isActive = item.id === 'browse';\r\n                  return (\r\n                    <button\r\n                      key={item.id}\r\n                      onClick={() => setCurrentView(item.id)}\r\n                      className={isActive ? 'active' : ''}\r\n                      aria-label={item.label}\r\n                    >\r\n                      <Icon className=\"w-4 h-4\" /> {item.label}\r\n                    </button>\r\n                  );\r\n                })}\r\n              </div>\r\n            </div>\r\n            <div>\r\n              <div className=\"sidebar-section-title mb-2\">Filters</div>\r\n              {renderFiltersBox()}\r\n            </div>\r\n            {/* Sidebar Ad */}\r\n            <SidebarAd />\r\n            {!currentUser && (\r\n              <div className=\"mt-auto pt-4 border-t border-gray-200\">\r\n                <p className=\"text-xs text-gray-500 mb-2\">Join to list rooms.</p>\r\n            {!userLocation && (\r\n              <button\r\n                type=\"button\"\r\n                onClick={() => { onFindNearby && onFindNearby(); setLocationTip('Allow location in browser prompt for Nearby.'); }}\r\n                className=\"text-xs text-blue-600 underline\"\r\n              >Enable Location</button>\r\n            )}\r\n                <div className=\"flex gap-2\">\r\n                  <button onClick={() => onRequireAuth && onRequireAuth('renter')} className=\"flex-1 bg-gray-100 hover:bg-gray-200 text-gray-800 text-xs py-2 rounded\">Sign In</button>\r\n                  <button onClick={() => onRequireAuth && onRequireAuth('landlord')} className=\"flex-1 bg-red-500 hover:bg-red-600 text-white text-xs py-2 rounded\">List Room</button>\r\n                </div>\r\n              </div>\r\n            )}\r\n          </aside>\r\n          <main className=\"desktop-split\" role=\"main\">\r\n            <div className=\"list-pane\">\r\n              <div className=\"flex items-center justify-between mb-3\">\r\n                <h2 id=\"results-heading\" className=\"text-lg font-semibold text-gray-800\">{listings.length === 0 ? 'No rooms' : `${listings.length} rooms`}</h2>\r\n                <button\r\n                  onClick={() => setMapView(!mapView)}\r\n                  className=\"text-xs px-3 py-1.5 rounded border border-gray-300 bg-white hover:bg-gray-50 transition\"\r\n                  aria-pressed={mapView}\r\n                >{mapView ? 'Hide Map' : 'Show Map'}</button>\r\n              </div>\r\n              {renderFilterChips()}\r\n              {initialLoad ? (\r\n                <div className=\"grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 2xl:grid-cols-4 gap-6\" aria-label=\"Loading listings\">\r\n                  {Array.from({ length: 8 }).map((_, i) => <ListingSkeletonCard key={i} />)}\r\n                </div>\r\n              ) : (\r\n                (paymentFilter ? listings.filter(l => l.paymentMethod === paymentFilter) : listings).length === 0 ? (\r\n                  <div className=\"bg-white border border-gray-200 rounded-lg p-8 text-center\"><p className=\"text-gray-600 text-sm\">No rooms match your filters.</p></div>\r\n                ) : (\r\n                  <div className=\"grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 2xl:grid-cols-4 gap-6\">\r\n                    {(paymentFilter ? listings.filter(l => l.paymentMethod === paymentFilter) : listings).map((listing, idx) => (\r\n                      <React.Fragment key={listing.id}>\r\n                        <ListingCard listing={listing} onClick={() => onSelectListing(listing)} />\r\n                        {(idx + 1) % 6 === 0 && idx !== listings.length - 1 && (\r\n                          <div className=\"md:col-span-2 xl:col-span-3 2xl:col-span-4\">\r\n                            <InFeedAd />\r\n                          </div>\r\n                        )}\r\n                      </React.Fragment>\r\n                    ))}\r\n                  </div>\r\n                )\r\n              )}\r\n            </div>\r\n            {mapView && (\r\n              <div className=\"map-pane\">\r\n                <MapView\r\n                  listings={listings}\r\n                  onMarkerClick={(l) => onSelectListing(l)}\r\n                  userLocation={userLocation}\r\n                  nearbyRadius={nearbyRadius}\r\n                  fullHeight={true}\r\n                  onRadiusChange={setNearbyRadius}\r\n                  onRecenter={() => {/* handled in MapView */}}\r\n                />\r\n              </div>\r\n            )}\r\n          </main>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  // Mobile / tablet layout\r\n  return (\r\n    <div className=\"bg-gray-50 min-h-screen pb-20\" role=\"main\" aria-labelledby=\"results-heading\">\r\n      <div className=\"bg-white border-b border-gray-200\">\r\n        <div className=\"max-w-7xl mx-auto px-4 py-6\">\r\n          <div className=\"mb-4 space-y-3\">\r\n            <div className=\"relative\">\r\n              <MapPin className=\"absolute left-3 top-3.5 w-5 h-5 text-gray-400\" />\r\n              <input\r\n                type=\"text\"\r\n                placeholder=\"Search by location, suburb, or area...\"\r\n                value={searchLocation}\r\n                onChange={(e) => setSearchLocation(e.target.value)}\r\n                className=\"w-full pl-10 pr-4 py-3 border border-gray-300 rounded-lg text-gray-700 focus:ring-2 focus:ring-teal-600 focus:border-transparent shadow-sm\"\r\n                aria-label=\"Location search\"\r\n              />\r\n              {locationLoading && (\r\n                <div className=\"absolute right-3 top-3.5 text-teal-600 animate-pulse text-xs\" aria-live=\"polite\">Loading...</div>\r\n              )}\r\n              {locationSuggestions.length > 0 && (\r\n                <div className=\"absolute left-0 right-0 top-full mt-1 bg-white border border-gray-200 rounded-lg shadow-sm z-20 overflow-hidden\">\r\n                  {locationSuggestions.map(s => (\r\n                    <button\r\n                      key={s}\r\n                      type=\"button\"\r\n                      onClick={() => { setSearchLocation(s); setLocationSuggestions([]); }}\r\n                      className=\"w-full text-left px-3 py-2 text-sm hover:bg-teal-50\"\r\n                    >{s}</button>\r\n                  ))}\r\n                </div>\r\n              )}\r\n            </div>\r\n            <div className=\"flex flex-wrap items-center gap-2\">\r\n              <button className=\"bg-teal-600 hover:bg-teal-700 text-white px-4 py-2 rounded-lg transition font-semibold shadow-sm text-sm\" onClick={() => {}} aria-label=\"Search submit\">Search</button>\r\n              <button\r\n                onClick={() => {\r\n                  if (!searchLocation || searchLocation.trim() === '') {\r\n                    alert('Enter a location to subscribe.');\r\n                    return;\r\n                  }\r\n                  if (!currentUser) {\r\n                    onRequireAuth && onRequireAuth('renter');\r\n                    return;\r\n                  }\r\n                  subscribeToArea && subscribeToArea(currentUser.id, searchLocation.trim());\r\n                }}\r\n                className=\"bg-white border border-gray-200 text-gray-700 px-3 py-2 rounded-lg hover:bg-gray-50 transition text-sm\"\r\n              >Subscribe</button>\r\n              <button\r\n                type=\"button\"\r\n                onClick={() => onFindNearby && onFindNearby()}\r\n                className=\"bg-green-600 hover:bg-green-700 text-white px-3 py-2 rounded-lg text-sm font-medium transition\"\r\n                aria-label=\"Find nearby\"\r\n              >Nearby</button>\r\n              <select value={nearbyRadius} onChange={(e) => setNearbyRadius(parseInt(e.target.value))} className=\"text-sm bg-gray-50 border border-gray-200 px-3 py-2 rounded-lg text-gray-700 flex-shrink-0\" aria-label=\"Nearby radius\">\r\n                <option value={1}>1 km</option>\r\n                <option value={3}>3 km</option>\r\n                <option value={5}>5 km</option>\r\n                <option value={10}>10 km</option>\r\n              </select>\r\n              {nearbyMode && (\r\n                <button onClick={clearNearby} className=\"bg-white border border-gray-200 text-gray-700 px-3 py-2 rounded-lg text-sm\" aria-label=\"Clear nearby\">Clear</button>\r\n              )}\r\n              {!userLocation && (\r\n                <button\r\n                  type=\"button\"\r\n                  onClick={() => { onFindNearby && onFindNearby(); setLocationTip('Allow location access for better Nearby results.'); }}\r\n                  className=\"text-xs text-blue-600 underline\"\r\n                >Enable Location</button>\r\n              )}\r\n            </div>\r\n            <div className=\"flex flex-wrap gap-1 -mt-1 mb-2\" aria-label=\"Quick radius\">\r\n              {[1,3,5,10].map(r => (\r\n                <button\r\n                  key={r}\r\n                  type=\"button\"\r\n                  onClick={() => setNearbyRadius(r)}\r\n                  className={`px-2 py-1 text-[11px] rounded border ${nearbyRadius===r?'bg-green-600 text-white border-green-600':'bg-gray-100 text-gray-700 border-gray-300 hover:bg-gray-200'}`}\r\n                  aria-pressed={nearbyRadius===r}\r\n                >{r}km</button>\r\n              ))}\r\n            </div>\r\n            <div className=\"flex flex-wrap gap-2 mb-2\">\r\n              <button\r\n                type=\"button\"\r\n                onClick={saveCurrentSearch}\r\n                className=\"text-xs px-2 py-1 rounded bg-purple-600 hover:bg-purple-700 text-white font-semibold shadow-sm\"\r\n              >Save Search</button>\r\n              {savedSearches.map(s => (\r\n                <button\r\n                  key={s.id}\r\n                  type=\"button\"\r\n                  onClick={() => loadSearch(s)}\r\n                  className=\"text-[11px] px-2 py-1 rounded bg-purple-50 text-purple-700 border border-purple-200\"\r\n                >{s.location || 'Any'} • {s.priceRange[0]}-{s.priceRange[1]}</button>\r\n              ))}\r\n            </div>\r\n          </div>\r\n          <div className=\"flex gap-2 mb-3 flex-wrap items-center\">\r\n            <div className=\"flex items-center gap-2 bg-gray-50 px-3 py-2 rounded-lg border border-gray-200\">\r\n              <span className=\"text-sm text-gray-600 font-medium\">R{priceRange[0].toLocaleString()} - R{priceRange[1].toLocaleString()}</span>\r\n              <select\r\n                value={priceRange[0]}\r\n                onChange={(e) => setPriceRange([parseInt(e.target.value), priceRange[1]])}\r\n                className=\"text-xs bg-transparent border-l border-gray-300 pl-2 text-gray-600 focus:outline-none\"\r\n                aria-label=\"Minimum price\"\r\n              >\r\n                <option value=\"0\">Min</option>\r\n                <option value=\"500\">R500</option>\r\n                <option value=\"1000\">R1000</option>\r\n                <option value=\"1500\">R1500</option>\r\n              </select>\r\n              <select\r\n                value={priceRange[1]}\r\n                onChange={(e) => setPriceRange([priceRange[0], parseInt(e.target.value)])}\r\n                className=\"text-xs bg-transparent border-l border-gray-300 pl-2 text-gray-600 focus:outline-none\"\r\n                aria-label=\"Maximum price\"\r\n              >\r\n                <option value=\"10000\">R10k</option>\r\n                <option value=\"5000\">R5k</option>\r\n                <option value=\"3000\">R3k</option>\r\n                <option value=\"2000\">R2k</option>\r\n              </select>\r\n            </div>\r\n            <div className=\"flex items-center gap-2\">\r\n              <span className=\"text-sm text-gray-600\">Sort:</span>\r\n              <select\r\n                value={sortBy}\r\n                onChange={(e) => setSortBy(e.target.value)}\r\n                className=\"text-sm bg-gray-50 border border-gray-200 px-3 py-2 rounded-lg text-gray-700 focus:ring-2 focus:ring-teal-600\"\r\n                aria-label=\"Sort order\"\r\n              >\r\n                <option value=\"newest\">Newest</option>\r\n                <option value=\"cheapest\">Cheapest</option>\r\n                <option value=\"expensive\">Most Expensive</option>\r\n              </select>\r\n            </div>\r\n            <div className=\"flex items-center gap-2\">\r\n              <span className=\"text-sm text-gray-600\">Payment:</span>\r\n              <select\r\n                value={paymentFilter}\r\n                onChange={(e) => setPaymentFilter(e.target.value)}\r\n                className=\"text-sm bg-gray-50 border border-gray-200 px-3 py-2 rounded-lg text-gray-700 focus:ring-2 focus:ring-teal-600\"\r\n                aria-label=\"Payment method filter\"\r\n              >\r\n                <option value=\"\">Any</option>\r\n                <option value=\"Bank and Cash\">Bank & Cash</option>\r\n                <option value=\"Cash Only\">Cash Only</option>\r\n                <option value=\"Bank Only\">Bank Only</option>\r\n              </select>\r\n            </div>\r\n            <button\r\n              onClick={() => setShowAdvancedFilters(!showAdvancedFilters)}\r\n              className=\"text-sm text-teal-700 hover:text-teal-800 font-medium px-3 py-2 rounded-lg hover:bg-teal-50 transition\"\r\n              aria-expanded={showAdvancedFilters}\r\n            >{showAdvancedFilters ? '✕ Filters' : '⚙️ Filters'}</button>\r\n          </div>\r\n          {locationTip && !userLocation && (\r\n            <div className=\"text-xs text-yellow-700 bg-yellow-50 border border-yellow-200 rounded p-2 mb-3\" aria-live=\"polite\">{locationTip}</div>\r\n          )}\r\n          {showAdvancedFilters && (\r\n            <div className=\"mt-3 p-4 bg-gray-50 rounded-lg border border-gray-200\">\r\n              <div className=\"flex flex-wrap gap-1 mb-2\" aria-label=\"Amenities\">\r\n                {amenityOptions.map(a => (\r\n                  <button\r\n                    key={a}\r\n                    type=\"button\"\r\n                    onClick={() => toggleAmenity(a)}\r\n                    className={`px-2 py-1 rounded-md text-[11px] font-medium border transition ${selectedAmenities.includes(a) ? 'bg-teal-600 text-white border-teal-600 shadow-sm' : 'bg-gray-100 text-gray-700 border-gray-300 hover:bg-gray-200'}`}\r\n                    aria-pressed={selectedAmenities.includes(a)}\r\n                  >{a}</button>\r\n                ))}\r\n              </div>\r\n              <p className=\"text-xs text-gray-500\">Select amenities to refine results.</p>\r\n            </div>\r\n          )}\r\n          {renderFilterChips()}\r\n        </div>\r\n      </div>\r\n      {/* Mobile Banner Ad */}\r\n      <div className=\"max-w-7xl mx-auto px-4 pt-3\">\r\n        <InFeedAd />\r\n      </div>\r\n      <div className=\"max-w-7xl mx-auto px-4\">\r\n        <div className=\"flex justify-between items-center mt-4 mb-3\">\r\n          <h2 id=\"results-heading\" className=\"text-2xl font-bold text-gray-800\">{listings.length === 0 ? 'No rooms available' : `${listings.length} Rooms Available`}</h2>\r\n          <button\r\n            onClick={() => setMapView(!mapView)}\r\n            className=\"text-sm px-4 py-2 rounded-lg border border-gray-200 bg-white hover:bg-gray-50 transition flex items-center gap-2\"\r\n            aria-pressed={mapView}\r\n          >\r\n            <MapPin className=\"w-4 h-4\" /> {mapView ? 'Show List' : 'Show Map'}\r\n          </button>\r\n        </div>\r\n        {mapView && (\r\n          <div className=\"mb-6\">\r\n            <MapView\r\n              listings={listings}\r\n              onMarkerClick={(l) => onSelectListing(l)}\r\n              userLocation={userLocation}\r\n              nearbyRadius={nearbyRadius}\r\n              fullHeight={false}\r\n              onRadiusChange={setNearbyRadius}\r\n            />\r\n          </div>\r\n        )}\r\n        {initialLoad ? (\r\n          <div className=\"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6 mb-12 justify-items-center\" aria-label=\"Loading listings\">\r\n            {Array.from({ length: 8 }).map((_, i) => <ListingSkeletonCard key={i} />)}\r\n          </div>\r\n        ) : (\r\n          (paymentFilter ? listings.filter(l => l.paymentMethod === paymentFilter) : listings).length === 0 ? (\r\n            <div className=\"bg-white rounded-lg border border-gray-200 p-12 text-center\">\r\n              <Home className=\"w-16 h-16 mx-auto mb-4 text-gray-300\" />\r\n              <p className=\"text-gray-600 font-medium mb-2\">No rooms match your search</p>\r\n              <p className=\"text-gray-500 text-sm mb-4\">Try adjusting your filters or search in a different location</p>\r\n              <button\r\n                onClick={() => {\r\n                  setSearchLocation('');\r\n                  setPriceRange([0, 10000]);\r\n                  setSelectedAmenities([]);\r\n                  setSortBy('newest');\r\n                }}\r\n                className=\"text-teal-700 hover:text-teal-800 font-medium text-sm\"\r\n              >Clear all filters</button>\r\n            </div>\r\n          ) : (\r\n            <div className=\"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6 mb-12 justify-items-center\">\r\n              {(paymentFilter ? listings.filter(l => l.paymentMethod === paymentFilter) : listings).map((listing, idx) => (\r\n                <React.Fragment key={listing.id}>\r\n                  <ListingCard\r\n                    listing={listing}\r\n                    onClick={() => onSelectListing(listing)}\r\n                    isFavorite={favorites.includes(listing.id)}\r\n                    onToggleFavorite={toggleFavorite}\r\n                  />\r\n                  {(idx + 1) % 8 === 0 && idx !== listings.length - 1 && (\r\n                    <div className=\"sm:col-span-2 lg:col-span-3 xl:col-span-4\">\r\n                      <InFeedAd />\r\n                    </div>\r\n                  )}\r\n                </React.Fragment>\r\n              ))}\r\n            </div>\r\n          )\r\n        )}\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}