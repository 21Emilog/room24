{"ast":null,"code":"import React,{useMemo,useEffect,useState,useCallback}from'react';import{MapContainer,TileLayer,Marker,Popup,useMap,Circle,ZoomControl,ScaleControl,useMapEvents}from'react-leaflet';import'leaflet/dist/leaflet.css';import L from'leaflet';// Fix Leaflet's default icon paths when using CRA / webpack\nimport{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";delete L.Icon.Default.prototype._getIconUrl;L.Icon.Default.mergeOptions({iconRetinaUrl:require('leaflet/dist/images/marker-icon-2x.png'),iconUrl:require('leaflet/dist/images/marker-icon.png'),shadowUrl:require('leaflet/dist/images/marker-shadow.png')});// Custom animated marker with price tag - enhanced with amenity indicators\nconst createPriceMarker=function(price){let isSelected=arguments.length>1&&arguments[1]!==undefined?arguments[1]:false;let hasWifi=arguments.length>2&&arguments[2]!==undefined?arguments[2]:false;let isNew=arguments.length>3&&arguments[3]!==undefined?arguments[3]:false;const formattedPrice=price>=1000?\"R\".concat((price/1000).toFixed(price%1000===0?0:1),\"k\"):\"R\".concat(price);const badges=[];if(hasWifi)badges.push('üì∂');if(isNew)badges.push('‚ú®');return new L.DivIcon({className:'custom-price-marker',html:\"\\n      <div class=\\\"price-marker-container \".concat(isSelected?'selected':'',\"\\\" data-price=\\\"\").concat(price,\"\\\">\\n        \").concat(badges.length>0?\"<div class=\\\"marker-badges\\\">\".concat(badges.join(''),\"</div>\"):'',\"\\n        <div class=\\\"price-marker-bubble\\\">\\n          <span class=\\\"price-text\\\">\").concat(formattedPrice,\"</span>\\n        </div>\\n        <div class=\\\"price-marker-arrow\\\"></div>\\n        <div class=\\\"price-marker-shadow\\\"></div>\\n      </div>\\n    \"),iconSize:[80,50],iconAnchor:[40,50],popupAnchor:[0,-50]});};// User location marker (pulsing dot) - enhanced\nconst userLocationIcon=new L.DivIcon({className:'user-location-marker',html:\"\\n    <div class=\\\"user-location-container\\\">\\n      <div class=\\\"user-location-ring\\\"></div>\\n      <div class=\\\"user-location-pulse\\\"></div>\\n      <div class=\\\"user-location-dot\\\">\\n        <svg width=\\\"12\\\" height=\\\"12\\\" viewBox=\\\"0 0 24 24\\\" fill=\\\"white\\\">\\n          <path d=\\\"M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7z\\\"/>\\n        </svg>\\n      </div>\\n    </div>\\n  \",iconSize:[40,40],iconAnchor:[20,20]});// Custom marker icons with distinct colors for different listing types\n// eslint-disable-next-line no-unused-vars\nconst createListingIcon=function(){let type=arguments.length>0&&arguments[0]!==undefined?arguments[0]:'default';let price=arguments.length>1?arguments[1]:undefined;if(price){return createPriceMarker(price);}const colors={default:'#ef4444',premium:'#f59e0b',verified:'#10b981',new:'#0d9488'};const color=colors[type]||colors.default;return new L.Icon({iconUrl:'data:image/svg+xml;base64,'+btoa(\"\\n      <svg width=\\\"32\\\" height=\\\"44\\\" viewBox=\\\"0 0 32 44\\\" xmlns=\\\"http://www.w3.org/2000/svg\\\">\\n        <defs>\\n          <filter id=\\\"shadow\\\" x=\\\"-20%\\\" y=\\\"-20%\\\" width=\\\"140%\\\" height=\\\"140%\\\">\\n            <feDropShadow dx=\\\"0\\\" dy=\\\"2\\\" stdDeviation=\\\"2\\\" flood-color=\\\"#000\\\" flood-opacity=\\\"0.3\\\"/>\\n          </filter>\\n        </defs>\\n        <path d=\\\"M16 0C7.163 0 0 7.163 0 16c0 12 16 28 16 28s16-16 16-28C32 7.163 24.837 0 16 0z\\\" fill=\\\"\".concat(color,\"\\\" filter=\\\"url(#shadow)\\\"/>\\n        <circle cx=\\\"16\\\" cy=\\\"15\\\" r=\\\"7\\\" fill=\\\"white\\\"/>\\n        <path d=\\\"M16 11l-4 3v5h3v-3h2v3h3v-5l-4-3z\\\" fill=\\\"\").concat(color,\"\\\"/>\\n      </svg>\\n    \")),iconSize:[32,44],iconAnchor:[16,44],popupAnchor:[0,-44]});};// Mock location coordinates for South African areas - expanded\nconst locationCoordinates={'soweto':[-26.2373,27.8471],'johannesburg':[-26.2023,28.0436],'pretoria':[-25.7461,28.2333],'durban':[-29.8587,31.0192],'cape town':[-33.9249,18.4241],'sandton':[-26.1088,28.0545],'midrand':[-25.9860,28.1144],'benoni':[-26.1917,28.3603],'boksburg':[-26.1972,28.2328],'alberton':[-26.2745,28.1114],'randburg':[-26.0936,28.0065],'roodepoort':[-26.1625,27.8725],'kempton park':[-26.1000,28.2300],'germiston':[-26.2200,28.1700],'springs':[-26.2500,28.4400],'ivory park':[-25.9800,28.1900],'tembisa':[-25.9956,28.2269],'alexandra':[-26.1050,28.0900],'diepsloot':[-25.9333,28.0167],'centurion':[-25.8603,28.1894]};const getCoordinatesForLocation=location=>{if(!location)return[-26.2023,28.0436];const normalized=location.toLowerCase().trim();for(const[key,coords]of Object.entries(locationCoordinates)){if(normalized.includes(key)){// Add slight random offset to prevent marker stacking\nconst offset=()=>(Math.random()-0.5)*0.008;return[coords[0]+offset(),coords[1]+offset()];}}return[-26.2023,28.0436];// Default to Johannesburg\n};// Calculate distance between two points\nconst getDistance=(lat1,lon1,lat2,lon2)=>{const R=6371;// Earth's radius in km\nconst dLat=(lat2-lat1)*Math.PI/180;const dLon=(lon2-lon1)*Math.PI/180;const a=Math.sin(dLat/2)*Math.sin(dLat/2)+Math.cos(lat1*Math.PI/180)*Math.cos(lat2*Math.PI/180)*Math.sin(dLon/2)*Math.sin(dLon/2);const c=2*Math.atan2(Math.sqrt(a),Math.sqrt(1-a));return R*c;};function FitBounds(_ref){let{bounds,shouldFit}=_ref;const map=useMap();useEffect(()=>{if(bounds&&bounds.length>0&&shouldFit){const group=new L.FeatureGroup();bounds.forEach(coord=>group.addLayer(L.marker(coord)));map.fitBounds(group.getBounds(),{padding:[60,60],maxZoom:14,animate:true});}},[bounds,map,shouldFit]);return null;}// Map interaction tracker\nfunction MapEventHandler(_ref2){let{onZoomChange,onMoveEnd}=_ref2;useMapEvents({zoomend:e=>onZoomChange&&onZoomChange(e.target.getZoom()),moveend:e=>onMoveEnd&&onMoveEnd(e.target.getCenter())});return null;}// Compass component\nfunction Compass(){const map=useMap();const[rotation,setRotation]=useState(0);useEffect(()=>{const updateRotation=()=>{// Leaflet doesn't have rotation by default, but we can animate compass\nsetRotation(0);};map.on('move',updateRotation);return()=>map.off('move',updateRotation);},[map]);const handleClick=()=>{map.setView(map.getCenter(),map.getZoom(),{animate:true});};return/*#__PURE__*/_jsx(\"button\",{className:\"map-compass\",onClick:handleClick,title:\"Reset orientation\",style:{transform:\"rotate(\".concat(rotation,\"deg)\")},children:/*#__PURE__*/_jsxs(\"svg\",{width:\"24\",height:\"24\",viewBox:\"0 0 24 24\",fill:\"none\",children:[/*#__PURE__*/_jsx(\"path\",{d:\"M12 2L8 10H16L12 2Z\",fill:\"#ef4444\"}),/*#__PURE__*/_jsx(\"path\",{d:\"M12 22L16 14H8L12 22Z\",fill:\"#374151\"}),/*#__PURE__*/_jsx(\"circle\",{cx:\"12\",cy:\"12\",r:\"2\",fill:\"#374151\"})]})});}// Legend component\nfunction MapLegend(_ref3){let{userLocation,nearbyRadius,priceRange}=_ref3;const[isOpen,setIsOpen]=useState(false);return/*#__PURE__*/_jsxs(\"div\",{className:\"map-legend \".concat(isOpen?'open':''),children:[/*#__PURE__*/_jsxs(\"button\",{className:\"legend-toggle\",onClick:()=>setIsOpen(!isOpen),children:[/*#__PURE__*/_jsx(\"span\",{children:\"\\u2139\\uFE0F\"}),/*#__PURE__*/_jsx(\"span\",{className:\"legend-toggle-text\",children:isOpen?'Hide':'Legend'})]}),isOpen&&/*#__PURE__*/_jsxs(\"div\",{className:\"legend-content\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"legend-item\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"legend-marker price-low\"}),/*#__PURE__*/_jsx(\"span\",{children:\"R0 - R2,000/mo\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"legend-item\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"legend-marker price-mid\"}),/*#__PURE__*/_jsx(\"span\",{children:\"R2,000 - R4,000/mo\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"legend-item\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"legend-marker price-high\"}),/*#__PURE__*/_jsx(\"span\",{children:\"R4,000+/mo\"})]}),userLocation&&/*#__PURE__*/_jsxs(\"div\",{className:\"legend-item\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"legend-user-dot\"}),/*#__PURE__*/_jsx(\"span\",{children:\"Your location\"})]}),nearbyRadius>0&&/*#__PURE__*/_jsxs(\"div\",{className:\"legend-item\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"legend-radius\"}),/*#__PURE__*/_jsxs(\"span\",{children:[nearbyRadius,\"km radius\"]})]})]})]});}// Quick filters for map\nfunction MapQuickFilters(_ref4){let{onFilterChange,activeFilter}=_ref4;const filters=[{id:'all',label:'All',icon:'üè†'},{id:'cheap',label:'Under R2k',icon:'üí∞'},{id:'mid',label:'R2k-R4k',icon:'üè°'},{id:'wifi',label:'WiFi',icon:'üì∂'}];return/*#__PURE__*/_jsx(\"div\",{className:\"map-quick-filters\",children:filters.map(f=>/*#__PURE__*/_jsxs(\"button\",{className:\"quick-filter-btn \".concat(activeFilter===f.id?'active':''),onClick:()=>onFilterChange(f.id),children:[/*#__PURE__*/_jsx(\"span\",{children:f.icon}),/*#__PURE__*/_jsx(\"span\",{className:\"filter-label\",children:f.label})]},f.id))});}// Map style selector component\nfunction MapStyleSelector(_ref5){let{currentStyle,onStyleChange}=_ref5;const styles=[{id:'streets',label:'Streets',icon:'üó∫Ô∏è'},{id:'satellite',label:'Satellite',icon:'üõ∞Ô∏è'},{id:'dark',label:'Dark',icon:'üåô'},{id:'terrain',label:'Terrain',icon:'‚õ∞Ô∏è'}];return/*#__PURE__*/_jsx(\"div\",{className:\"map-style-selector\",children:styles.map(style=>/*#__PURE__*/_jsxs(\"button\",{onClick:()=>onStyleChange(style.id),className:\"map-style-btn \".concat(currentStyle===style.id?'active':''),title:style.label,children:[/*#__PURE__*/_jsx(\"span\",{className:\"style-icon\",children:style.icon}),/*#__PURE__*/_jsx(\"span\",{className:\"style-label\",children:style.label})]},style.id))});}function OverlayControls(_ref6){let{userLocation,nearbyRadius,onRecenter,onRadiusChange,mapStyle,onMapStyleChange,listingsCount,zoomLevel}=_ref6;const map=useMap();const[isExpanded,setIsExpanded]=useState(false);const[showSearch,setShowSearch]=useState(false);const handleZoomIn=()=>map.zoomIn();const handleZoomOut=()=>map.zoomOut();return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsxs(\"div\",{className:\"map-listings-badge\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"badge-main\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"badge-icon\",children:\"\\uD83C\\uDFE0\"}),/*#__PURE__*/_jsx(\"span\",{className:\"badge-count\",children:listingsCount}),/*#__PURE__*/_jsx(\"span\",{className:\"badge-label\",children:\"rooms\"})]}),userLocation&&nearbyRadius>0&&/*#__PURE__*/_jsxs(\"div\",{className:\"badge-subtitle\",children:[\"within \",nearbyRadius,\"km\"]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"map-controls-container\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:()=>setShowSearch(!showSearch),className:\"map-control-btn search-btn\",title:\"Search this area\",children:/*#__PURE__*/_jsxs(\"svg\",{width:\"18\",height:\"18\",viewBox:\"0 0 24 24\",fill:\"none\",stroke:\"currentColor\",strokeWidth:\"2\",children:[/*#__PURE__*/_jsx(\"circle\",{cx:\"11\",cy:\"11\",r:\"8\"}),/*#__PURE__*/_jsx(\"path\",{d:\"m21 21-4.35-4.35\"})]})}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>setIsExpanded(!isExpanded),className:\"map-control-btn map-style-toggle \".concat(isExpanded?'active':''),title:\"Change map style\",children:/*#__PURE__*/_jsx(\"span\",{children:\"\\uD83D\\uDDFA\\uFE0F\"})}),isExpanded&&/*#__PURE__*/_jsx(MapStyleSelector,{currentStyle:mapStyle,onStyleChange:style=>{onMapStyleChange(style);setIsExpanded(false);}}),userLocation&&/*#__PURE__*/_jsx(\"button\",{type:\"button\",onClick:()=>{if(onRecenter)onRecenter();map.setView([userLocation.lat,userLocation.lon],14,{animate:true});},className:\"map-control-btn recenter-btn\",title:\"Center on my location\",children:/*#__PURE__*/_jsxs(\"svg\",{width:\"18\",height:\"18\",viewBox:\"0 0 24 24\",fill:\"none\",stroke:\"currentColor\",strokeWidth:\"2\",children:[/*#__PURE__*/_jsx(\"circle\",{cx:\"12\",cy:\"12\",r:\"3\"}),/*#__PURE__*/_jsx(\"path\",{d:\"M12 2v4M12 18v4M2 12h4M18 12h4\"})]})}),/*#__PURE__*/_jsxs(\"div\",{className:\"zoom-controls\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:handleZoomIn,className:\"zoom-btn zoom-in\",title:\"Zoom in\",children:\"+\"}),/*#__PURE__*/_jsx(\"div\",{className:\"zoom-level\",children:zoomLevel}),/*#__PURE__*/_jsx(\"button\",{onClick:handleZoomOut,className:\"zoom-btn zoom-out\",title:\"Zoom out\",children:\"\\u2212\"})]}),/*#__PURE__*/_jsx(\"button\",{type:\"button\",onClick:()=>{const container=map.getContainer().parentElement;if(document.fullscreenElement){document.exitFullscreen();}else{container===null||container===void 0?void 0:container.requestFullscreen();}},className:\"map-control-btn fullscreen-btn\",title:\"Toggle fullscreen\",children:/*#__PURE__*/_jsx(\"svg\",{width:\"18\",height:\"18\",viewBox:\"0 0 24 24\",fill:\"none\",stroke:\"currentColor\",strokeWidth:\"2\",children:/*#__PURE__*/_jsx(\"path\",{d:\"M8 3H5a2 2 0 0 0-2 2v3M21 8V5a2 2 0 0 0-2-2h-3M3 16v3a2 2 0 0 0 2 2h3M16 21h3a2 2 0 0 0 2-2v-3\"})})})]}),showSearch&&/*#__PURE__*/_jsx(\"div\",{className:\"map-search-area\",children:/*#__PURE__*/_jsx(\"button\",{className:\"search-area-btn\",onClick:()=>{// Trigger search in visible area\nsetShowSearch(false);},children:\"\\uD83D\\uDD0D Search this area\"})}),userLocation&&/*#__PURE__*/_jsxs(\"div\",{className:\"map-radius-control\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"radius-header\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"radius-icon\",children:\"\\uD83D\\uDCCD\"}),/*#__PURE__*/_jsx(\"span\",{className:\"radius-label\",children:\"Search radius\"}),/*#__PURE__*/_jsxs(\"span\",{className:\"radius-value-inline\",children:[nearbyRadius,\" km\"]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"radius-slider-container\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"radius-min\",children:\"1\"}),/*#__PURE__*/_jsx(\"input\",{type:\"range\",min:1,max:25,step:1,value:nearbyRadius,onChange:e=>onRadiusChange&&onRadiusChange(parseInt(e.target.value)),className:\"radius-slider\"}),/*#__PURE__*/_jsx(\"span\",{className:\"radius-max\",children:\"25\"})]}),/*#__PURE__*/_jsx(\"div\",{className:\"radius-presets\",children:[1,3,5,10,15,25].map(r=>/*#__PURE__*/_jsxs(\"button\",{onClick:()=>onRadiusChange&&onRadiusChange(r),className:\"radius-preset-btn \".concat(nearbyRadius===r?'active':''),children:[r,\"km\"]},r))})]})]});}export default function MapView(_ref7){let{listings=[],onMarkerClick=()=>{},userLocation=null,nearbyRadius=0,fullHeight=false,onRadiusChange,onRecenter}=_ref7;const[mapStyle,setMapStyle]=useState('streets');const[selectedMarkerId,setSelectedMarkerId]=useState(null);const[hoveredMarkerId,setHoveredMarkerId]=useState(null);const[zoomLevel,setZoomLevel]=useState(12);const[activeFilter,setActiveFilter]=useState('all');const[shouldFitBounds,setShouldFitBounds]=useState(true);const markers=useMemo(()=>{return listings.filter(l=>{var _l$amenities;// Apply active filter\nif(activeFilter==='cheap')return l.price<2000;if(activeFilter==='mid')return l.price>=2000&&l.price<=4000;if(activeFilter==='wifi')return l.wifi||((_l$amenities=l.amenities)===null||_l$amenities===void 0?void 0:_l$amenities.includes('WiFi'));return true;}).map(l=>{var _ref8,_l$latitude,_ref9,_l$longitude,_l$amenities2;let lat=(_ref8=(_l$latitude=l.latitude)!==null&&_l$latitude!==void 0?_l$latitude:l.lat)!==null&&_ref8!==void 0?_ref8:l.coords&&l.coords[0];let lng=(_ref9=(_l$longitude=l.longitude)!==null&&_l$longitude!==void 0?_l$longitude:l.lng)!==null&&_ref9!==void 0?_ref9:l.coords&&l.coords[1];// Fallback to location-based coordinates if no explicit coords\nif(typeof lat!=='number'||typeof lng!=='number'){[lat,lng]=getCoordinatesForLocation(l.location);}// Check if listing is new (within 7 days)\nconst isNew=l.createdAt&&Date.now()-new Date(l.createdAt).getTime()<7*24*60*60*1000;// Calculate distance from user if available\nlet distance=null;if(userLocation&&typeof userLocation.lat==='number'){distance=getDistance(userLocation.lat,userLocation.lon,lat,lng);}return{id:l.id,title:l.title,location:l.location,price:l.price,lat,lng,raw:l,photos:l.photos,hasWifi:l.wifi||((_l$amenities2=l.amenities)===null||_l$amenities2===void 0?void 0:_l$amenities2.includes('WiFi')),isNew,distance};});},[listings,activeFilter,userLocation]);const defaultCenter=[-26.2041,28.0473];// Johannesburg fallback\nconst bounds=markers.length>0?markers.map(m=>[m.lat,m.lng]):null;// include user location in bounds so map can show renter + listings together\nconst allBounds=useMemo(()=>{const b=bounds?[...bounds]:[];if(userLocation&&typeof userLocation.lat==='number'&&typeof userLocation.lon==='number'){b.push([userLocation.lat,userLocation.lon]);}return b.length>0?b:null;},[bounds,userLocation]);// Map tile layers based on style\nconst getTileLayer=useCallback(()=>{const MAPBOX_KEY=process.env.REACT_APP_MAPBOX_API_KEY;switch(mapStyle){case'satellite':if(MAPBOX_KEY){return{url:\"https://api.mapbox.com/styles/v1/mapbox/satellite-streets-v12/tiles/{z}/{x}/{y}?access_token=\".concat(MAPBOX_KEY),attribution:'¬© Mapbox ¬© OpenStreetMap'};}return{url:'https://server.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}',attribution:'¬© Esri'};case'dark':if(MAPBOX_KEY){return{url:\"https://api.mapbox.com/styles/v1/mapbox/dark-v11/tiles/{z}/{x}/{y}?access_token=\".concat(MAPBOX_KEY),attribution:'¬© Mapbox'};}return{url:'https://{s}.basemaps.cartocdn.com/dark_all/{z}/{x}/{y}{r}.png',attribution:'¬© CartoDB'};default:// streets\nif(MAPBOX_KEY){return{url:\"https://api.mapbox.com/styles/v1/mapbox/streets-v12/tiles/{z}/{x}/{y}?access_token=\".concat(MAPBOX_KEY),attribution:'¬© Mapbox'};}return{url:'https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png',attribution:'¬© OpenStreetMap contributors'};}},[mapStyle]);const tileLayer=getTileLayer();const mapHeight=fullHeight?'calc(100vh - 180px)':'320px';const handleMarkerClick=useCallback(marker=>{setSelectedMarkerId(marker.id);onMarkerClick(marker.raw);},[onMarkerClick]);return/*#__PURE__*/_jsx(\"div\",{className:\"map-container-wrapper\",style:{height:mapHeight},children:markers.length===0?/*#__PURE__*/_jsxs(\"div\",{className:\"map-empty-state\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"empty-state-icon\",children:\"\\uD83D\\uDDFA\\uFE0F\"}),/*#__PURE__*/_jsx(\"h3\",{className:\"empty-state-title\",children:\"No listings on the map\"}),/*#__PURE__*/_jsx(\"p\",{className:\"empty-state-text\",children:listings.length===0?\"No listings available in this area\":\"Listings don't have location data yet\"}),listings.length>0&&/*#__PURE__*/_jsxs(\"div\",{className:\"empty-state-list\",children:[listings.slice(0,3).map(l=>/*#__PURE__*/_jsxs(\"button\",{onClick:()=>onMarkerClick(l),className:\"empty-state-listing\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"listing-title\",children:l.title}),/*#__PURE__*/_jsxs(\"span\",{className:\"listing-price\",children:[\"R\",Number(l.price).toLocaleString()]})]},l.id)),listings.length>3&&/*#__PURE__*/_jsxs(\"p\",{className:\"empty-state-more\",children:[\"+\",listings.length-3,\" more listings\"]})]})]}):/*#__PURE__*/_jsxs(MapContainer,{center:markers[0]?[markers[0].lat,markers[0].lng]:defaultCenter,zoom:12,className:\"map-container\",zoomControl:false,children:[/*#__PURE__*/_jsx(ZoomControl,{position:\"bottomright\"}),/*#__PURE__*/_jsx(TileLayer,{attribution:tileLayer.attribution,url:tileLayer.url}),/*#__PURE__*/_jsx(OverlayControls,{userLocation:userLocation,nearbyRadius:nearbyRadius,onRecenter:()=>{onRecenter&&onRecenter();setShouldFitBounds(false);},onRadiusChange:onRadiusChange,mapStyle:mapStyle,onMapStyleChange:setMapStyle,listingsCount:markers.length,zoomLevel:zoomLevel}),/*#__PURE__*/_jsx(MapEventHandler,{onZoomChange:setZoomLevel,onMoveEnd:()=>setShouldFitBounds(false)}),/*#__PURE__*/_jsx(Compass,{}),/*#__PURE__*/_jsx(MapLegend,{userLocation:userLocation,nearbyRadius:nearbyRadius}),/*#__PURE__*/_jsx(MapQuickFilters,{activeFilter:activeFilter,onFilterChange:setActiveFilter}),/*#__PURE__*/_jsx(ScaleControl,{position:\"bottomleft\"}),userLocation&&typeof userLocation.lat==='number'&&typeof userLocation.lon==='number'&&/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(Marker,{position:[userLocation.lat,userLocation.lon],icon:userLocationIcon,children:/*#__PURE__*/_jsx(Popup,{className:\"user-location-popup\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"popup-user-location\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"popup-icon\",children:\"\\uD83D\\uDCCD\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"popup-content\",children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Your Location\"}),/*#__PURE__*/_jsx(\"span\",{className:\"popup-accuracy\",children:\"Approximate position\"})]})]})})}),nearbyRadius>0&&/*#__PURE__*/_jsx(Circle,{center:[userLocation.lat,userLocation.lon],radius:nearbyRadius*1000,pathOptions:{color:'#0d9488',fillColor:'#0d9488',fillOpacity:0.08,weight:2,dashArray:'5, 10'}})]}),markers.map(m=>/*#__PURE__*/_jsx(Marker,{position:[m.lat,m.lng],icon:createPriceMarker(m.price,selectedMarkerId===m.id||hoveredMarkerId===m.id,m.hasWifi,m.isNew),eventHandlers:{click:()=>handleMarkerClick(m),mouseover:()=>setHoveredMarkerId(m.id),mouseout:()=>setHoveredMarkerId(null)},children:/*#__PURE__*/_jsx(Popup,{className:\"listing-popup\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"popup-listing-card\",children:[m.photos&&m.photos[0]&&/*#__PURE__*/_jsxs(\"div\",{className:\"popup-image\",children:[/*#__PURE__*/_jsx(\"img\",{src:m.photos[0],alt:m.title}),m.isNew&&/*#__PURE__*/_jsx(\"span\",{className:\"popup-badge new\",children:\"New\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"popup-details\",children:[/*#__PURE__*/_jsx(\"h4\",{className:\"popup-title\",children:m.title}),/*#__PURE__*/_jsxs(\"p\",{className:\"popup-location\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"location-icon\",children:\"\\uD83D\\uDCCD\"}),m.location,m.distance!==null&&/*#__PURE__*/_jsxs(\"span\",{className:\"distance-badge\",children:[m.distance.toFixed(1),\"km\"]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"popup-amenities\",children:m.hasWifi&&/*#__PURE__*/_jsx(\"span\",{className:\"amenity-badge\",children:\"\\uD83D\\uDCF6 WiFi\"})}),/*#__PURE__*/_jsxs(\"div\",{className:\"popup-footer\",children:[/*#__PURE__*/_jsxs(\"span\",{className:\"popup-price\",children:[\"R\",Number(m.price).toLocaleString(),/*#__PURE__*/_jsx(\"small\",{children:\"/mo\"})]}),/*#__PURE__*/_jsx(\"button\",{className:\"popup-view-btn\",onClick:()=>handleMarkerClick(m),children:\"View Details \\u2192\"})]})]})]})})},m.id)),/*#__PURE__*/_jsx(FitBounds,{bounds:allBounds||bounds,shouldFit:shouldFitBounds})]})});}","map":{"version":3,"names":["React","useMemo","useEffect","useState","useCallback","MapContainer","TileLayer","Marker","Popup","useMap","Circle","ZoomControl","ScaleControl","useMapEvents","L","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","Icon","Default","prototype","_getIconUrl","mergeOptions","iconRetinaUrl","require","iconUrl","shadowUrl","createPriceMarker","price","isSelected","arguments","length","undefined","hasWifi","isNew","formattedPrice","concat","toFixed","badges","push","DivIcon","className","html","join","iconSize","iconAnchor","popupAnchor","userLocationIcon","createListingIcon","type","colors","default","premium","verified","new","color","btoa","locationCoordinates","getCoordinatesForLocation","location","normalized","toLowerCase","trim","key","coords","Object","entries","includes","offset","Math","random","getDistance","lat1","lon1","lat2","lon2","R","dLat","PI","dLon","a","sin","cos","c","atan2","sqrt","FitBounds","_ref","bounds","shouldFit","map","group","FeatureGroup","forEach","coord","addLayer","marker","fitBounds","getBounds","padding","maxZoom","animate","MapEventHandler","_ref2","onZoomChange","onMoveEnd","zoomend","e","target","getZoom","moveend","getCenter","Compass","rotation","setRotation","updateRotation","on","off","handleClick","setView","onClick","title","style","transform","children","width","height","viewBox","fill","d","cx","cy","r","MapLegend","_ref3","userLocation","nearbyRadius","priceRange","isOpen","setIsOpen","MapQuickFilters","_ref4","onFilterChange","activeFilter","filters","id","label","icon","f","MapStyleSelector","_ref5","currentStyle","onStyleChange","styles","OverlayControls","_ref6","onRecenter","onRadiusChange","mapStyle","onMapStyleChange","listingsCount","zoomLevel","isExpanded","setIsExpanded","showSearch","setShowSearch","handleZoomIn","zoomIn","handleZoomOut","zoomOut","stroke","strokeWidth","lat","lon","container","getContainer","parentElement","document","fullscreenElement","exitFullscreen","requestFullscreen","min","max","step","value","onChange","parseInt","MapView","_ref7","listings","onMarkerClick","fullHeight","setMapStyle","selectedMarkerId","setSelectedMarkerId","hoveredMarkerId","setHoveredMarkerId","setZoomLevel","setActiveFilter","shouldFitBounds","setShouldFitBounds","markers","filter","l","_l$amenities","wifi","amenities","_ref8","_l$latitude","_ref9","_l$longitude","_l$amenities2","latitude","lng","longitude","createdAt","Date","now","getTime","distance","raw","photos","defaultCenter","m","allBounds","b","getTileLayer","MAPBOX_KEY","process","env","REACT_APP_MAPBOX_API_KEY","url","attribution","tileLayer","mapHeight","handleMarkerClick","slice","Number","toLocaleString","center","zoom","zoomControl","position","radius","pathOptions","fillColor","fillOpacity","weight","dashArray","eventHandlers","click","mouseover","mouseout","src","alt"],"sources":["C:/Users/kutum/Documents/room-rental-platform/src/MapView.js"],"sourcesContent":["import React, { useMemo, useEffect, useState, useCallback } from 'react';\r\nimport { MapContainer, TileLayer, Marker, Popup, useMap, Circle, ZoomControl, ScaleControl, useMapEvents } from 'react-leaflet';\r\nimport 'leaflet/dist/leaflet.css';\r\nimport L from 'leaflet';\r\n\r\n// Fix Leaflet's default icon paths when using CRA / webpack\r\ndelete L.Icon.Default.prototype._getIconUrl;\r\nL.Icon.Default.mergeOptions({\r\n  iconRetinaUrl: require('leaflet/dist/images/marker-icon-2x.png'),\r\n  iconUrl: require('leaflet/dist/images/marker-icon.png'),\r\n  shadowUrl: require('leaflet/dist/images/marker-shadow.png')\r\n});\r\n\r\n// Custom animated marker with price tag - enhanced with amenity indicators\r\nconst createPriceMarker = (price, isSelected = false, hasWifi = false, isNew = false) => {\r\n  const formattedPrice = price >= 1000 \r\n    ? `R${(price/1000).toFixed(price % 1000 === 0 ? 0 : 1)}k`\r\n    : `R${price}`;\r\n  \r\n  const badges = [];\r\n  if (hasWifi) badges.push('üì∂');\r\n  if (isNew) badges.push('‚ú®');\r\n  \r\n  return new L.DivIcon({\r\n    className: 'custom-price-marker',\r\n    html: `\r\n      <div class=\"price-marker-container ${isSelected ? 'selected' : ''}\" data-price=\"${price}\">\r\n        ${badges.length > 0 ? `<div class=\"marker-badges\">${badges.join('')}</div>` : ''}\r\n        <div class=\"price-marker-bubble\">\r\n          <span class=\"price-text\">${formattedPrice}</span>\r\n        </div>\r\n        <div class=\"price-marker-arrow\"></div>\r\n        <div class=\"price-marker-shadow\"></div>\r\n      </div>\r\n    `,\r\n    iconSize: [80, 50],\r\n    iconAnchor: [40, 50],\r\n    popupAnchor: [0, -50],\r\n  });\r\n};\r\n\r\n// User location marker (pulsing dot) - enhanced\r\nconst userLocationIcon = new L.DivIcon({\r\n  className: 'user-location-marker',\r\n  html: `\r\n    <div class=\"user-location-container\">\r\n      <div class=\"user-location-ring\"></div>\r\n      <div class=\"user-location-pulse\"></div>\r\n      <div class=\"user-location-dot\">\r\n        <svg width=\"12\" height=\"12\" viewBox=\"0 0 24 24\" fill=\"white\">\r\n          <path d=\"M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7z\"/>\r\n        </svg>\r\n      </div>\r\n    </div>\r\n  `,\r\n  iconSize: [40, 40],\r\n  iconAnchor: [20, 20],\r\n});\r\n\r\n// Custom marker icons with distinct colors for different listing types\r\n// eslint-disable-next-line no-unused-vars\r\nconst createListingIcon = (type = 'default', price) => {\r\n  if (price) {\r\n    return createPriceMarker(price);\r\n  }\r\n  \r\n  const colors = {\r\n    default: '#ef4444',\r\n    premium: '#f59e0b',\r\n    verified: '#10b981',\r\n    new: '#0d9488'\r\n  };\r\n  \r\n  const color = colors[type] || colors.default;\r\n  \r\n  return new L.Icon({\r\n    iconUrl: 'data:image/svg+xml;base64,' + btoa(`\r\n      <svg width=\"32\" height=\"44\" viewBox=\"0 0 32 44\" xmlns=\"http://www.w3.org/2000/svg\">\r\n        <defs>\r\n          <filter id=\"shadow\" x=\"-20%\" y=\"-20%\" width=\"140%\" height=\"140%\">\r\n            <feDropShadow dx=\"0\" dy=\"2\" stdDeviation=\"2\" flood-color=\"#000\" flood-opacity=\"0.3\"/>\r\n          </filter>\r\n        </defs>\r\n        <path d=\"M16 0C7.163 0 0 7.163 0 16c0 12 16 28 16 28s16-16 16-28C32 7.163 24.837 0 16 0z\" fill=\"${color}\" filter=\"url(#shadow)\"/>\r\n        <circle cx=\"16\" cy=\"15\" r=\"7\" fill=\"white\"/>\r\n        <path d=\"M16 11l-4 3v5h3v-3h2v3h3v-5l-4-3z\" fill=\"${color}\"/>\r\n      </svg>\r\n    `),\r\n    iconSize: [32, 44],\r\n    iconAnchor: [16, 44],\r\n    popupAnchor: [0, -44],\r\n  });\r\n};\r\n\r\n// Mock location coordinates for South African areas - expanded\r\nconst locationCoordinates = {\r\n  'soweto': [-26.2373, 27.8471],\r\n  'johannesburg': [-26.2023, 28.0436],\r\n  'pretoria': [-25.7461, 28.2333],\r\n  'durban': [-29.8587, 31.0192],\r\n  'cape town': [-33.9249, 18.4241],\r\n  'sandton': [-26.1088, 28.0545],\r\n  'midrand': [-25.9860, 28.1144],\r\n  'benoni': [-26.1917, 28.3603],\r\n  'boksburg': [-26.1972, 28.2328],\r\n  'alberton': [-26.2745, 28.1114],\r\n  'randburg': [-26.0936, 28.0065],\r\n  'roodepoort': [-26.1625, 27.8725],\r\n  'kempton park': [-26.1000, 28.2300],\r\n  'germiston': [-26.2200, 28.1700],\r\n  'springs': [-26.2500, 28.4400],\r\n  'ivory park': [-25.9800, 28.1900],\r\n  'tembisa': [-25.9956, 28.2269],\r\n  'alexandra': [-26.1050, 28.0900],\r\n  'diepsloot': [-25.9333, 28.0167],\r\n  'centurion': [-25.8603, 28.1894],\r\n};\r\n\r\nconst getCoordinatesForLocation = (location) => {\r\n  if (!location) return [-26.2023, 28.0436];\r\n  const normalized = location.toLowerCase().trim();\r\n  for (const [key, coords] of Object.entries(locationCoordinates)) {\r\n    if (normalized.includes(key)) {\r\n      // Add slight random offset to prevent marker stacking\r\n      const offset = () => (Math.random() - 0.5) * 0.008;\r\n      return [coords[0] + offset(), coords[1] + offset()];\r\n    }\r\n  }\r\n  return [-26.2023, 28.0436]; // Default to Johannesburg\r\n};\r\n\r\n// Calculate distance between two points\r\nconst getDistance = (lat1, lon1, lat2, lon2) => {\r\n  const R = 6371; // Earth's radius in km\r\n  const dLat = (lat2 - lat1) * Math.PI / 180;\r\n  const dLon = (lon2 - lon1) * Math.PI / 180;\r\n  const a = Math.sin(dLat/2) * Math.sin(dLat/2) +\r\n            Math.cos(lat1 * Math.PI / 180) * Math.cos(lat2 * Math.PI / 180) *\r\n            Math.sin(dLon/2) * Math.sin(dLon/2);\r\n  const c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1-a));\r\n  return R * c;\r\n};\r\n\r\nfunction FitBounds({ bounds, shouldFit }) {\r\n  const map = useMap();\r\n  useEffect(() => {\r\n    if (bounds && bounds.length > 0 && shouldFit) {\r\n      const group = new L.FeatureGroup();\r\n      bounds.forEach(coord => group.addLayer(L.marker(coord)));\r\n      map.fitBounds(group.getBounds(), { padding: [60, 60], maxZoom: 14, animate: true });\r\n    }\r\n  }, [bounds, map, shouldFit]);\r\n  return null;\r\n}\r\n\r\n// Map interaction tracker\r\nfunction MapEventHandler({ onZoomChange, onMoveEnd }) {\r\n  useMapEvents({\r\n    zoomend: (e) => onZoomChange && onZoomChange(e.target.getZoom()),\r\n    moveend: (e) => onMoveEnd && onMoveEnd(e.target.getCenter()),\r\n  });\r\n  return null;\r\n}\r\n\r\n// Compass component\r\nfunction Compass() {\r\n  const map = useMap();\r\n  const [rotation, setRotation] = useState(0);\r\n\r\n  useEffect(() => {\r\n    const updateRotation = () => {\r\n      // Leaflet doesn't have rotation by default, but we can animate compass\r\n      setRotation(0);\r\n    };\r\n    map.on('move', updateRotation);\r\n    return () => map.off('move', updateRotation);\r\n  }, [map]);\r\n\r\n  const handleClick = () => {\r\n    map.setView(map.getCenter(), map.getZoom(), { animate: true });\r\n  };\r\n\r\n  return (\r\n    <button \r\n      className=\"map-compass\" \r\n      onClick={handleClick}\r\n      title=\"Reset orientation\"\r\n      style={{ transform: `rotate(${rotation}deg)` }}\r\n    >\r\n      <svg width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"none\">\r\n        <path d=\"M12 2L8 10H16L12 2Z\" fill=\"#ef4444\"/>\r\n        <path d=\"M12 22L16 14H8L12 22Z\" fill=\"#374151\"/>\r\n        <circle cx=\"12\" cy=\"12\" r=\"2\" fill=\"#374151\"/>\r\n      </svg>\r\n    </button>\r\n  );\r\n}\r\n\r\n// Legend component\r\nfunction MapLegend({ userLocation, nearbyRadius, priceRange }) {\r\n  const [isOpen, setIsOpen] = useState(false);\r\n  \r\n  return (\r\n    <div className={`map-legend ${isOpen ? 'open' : ''}`}>\r\n      <button className=\"legend-toggle\" onClick={() => setIsOpen(!isOpen)}>\r\n        <span>‚ÑπÔ∏è</span>\r\n        <span className=\"legend-toggle-text\">{isOpen ? 'Hide' : 'Legend'}</span>\r\n      </button>\r\n      {isOpen && (\r\n        <div className=\"legend-content\">\r\n          <div className=\"legend-item\">\r\n            <div className=\"legend-marker price-low\"></div>\r\n            <span>R0 - R2,000/mo</span>\r\n          </div>\r\n          <div className=\"legend-item\">\r\n            <div className=\"legend-marker price-mid\"></div>\r\n            <span>R2,000 - R4,000/mo</span>\r\n          </div>\r\n          <div className=\"legend-item\">\r\n            <div className=\"legend-marker price-high\"></div>\r\n            <span>R4,000+/mo</span>\r\n          </div>\r\n          {userLocation && (\r\n            <div className=\"legend-item\">\r\n              <div className=\"legend-user-dot\"></div>\r\n              <span>Your location</span>\r\n            </div>\r\n          )}\r\n          {nearbyRadius > 0 && (\r\n            <div className=\"legend-item\">\r\n              <div className=\"legend-radius\"></div>\r\n              <span>{nearbyRadius}km radius</span>\r\n            </div>\r\n          )}\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n}\r\n\r\n// Quick filters for map\r\nfunction MapQuickFilters({ onFilterChange, activeFilter }) {\r\n  const filters = [\r\n    { id: 'all', label: 'All', icon: 'üè†' },\r\n    { id: 'cheap', label: 'Under R2k', icon: 'üí∞' },\r\n    { id: 'mid', label: 'R2k-R4k', icon: 'üè°' },\r\n    { id: 'wifi', label: 'WiFi', icon: 'üì∂' },\r\n  ];\r\n\r\n  return (\r\n    <div className=\"map-quick-filters\">\r\n      {filters.map(f => (\r\n        <button\r\n          key={f.id}\r\n          className={`quick-filter-btn ${activeFilter === f.id ? 'active' : ''}`}\r\n          onClick={() => onFilterChange(f.id)}\r\n        >\r\n          <span>{f.icon}</span>\r\n          <span className=\"filter-label\">{f.label}</span>\r\n        </button>\r\n      ))}\r\n    </div>\r\n  );\r\n}\r\n\r\n// Map style selector component\r\nfunction MapStyleSelector({ currentStyle, onStyleChange }) {\r\n  const styles = [\r\n    { id: 'streets', label: 'Streets', icon: 'üó∫Ô∏è' },\r\n    { id: 'satellite', label: 'Satellite', icon: 'üõ∞Ô∏è' },\r\n    { id: 'dark', label: 'Dark', icon: 'üåô' },\r\n    { id: 'terrain', label: 'Terrain', icon: '‚õ∞Ô∏è' },\r\n  ];\r\n\r\n  return (\r\n    <div className=\"map-style-selector\">\r\n      {styles.map(style => (\r\n        <button\r\n          key={style.id}\r\n          onClick={() => onStyleChange(style.id)}\r\n          className={`map-style-btn ${currentStyle === style.id ? 'active' : ''}`}\r\n          title={style.label}\r\n        >\r\n          <span className=\"style-icon\">{style.icon}</span>\r\n          <span className=\"style-label\">{style.label}</span>\r\n        </button>\r\n      ))}\r\n    </div>\r\n  );\r\n}\r\n\r\nfunction OverlayControls({ userLocation, nearbyRadius, onRecenter, onRadiusChange, mapStyle, onMapStyleChange, listingsCount, zoomLevel }) {\r\n  const map = useMap();\r\n  const [isExpanded, setIsExpanded] = useState(false);\r\n  const [showSearch, setShowSearch] = useState(false);\r\n\r\n  const handleZoomIn = () => map.zoomIn();\r\n  const handleZoomOut = () => map.zoomOut();\r\n\r\n  return (\r\n    <>\r\n      {/* Top-left: Listings count badge with stats */}\r\n      <div className=\"map-listings-badge\">\r\n        <div className=\"badge-main\">\r\n          <span className=\"badge-icon\">üè†</span>\r\n          <span className=\"badge-count\">{listingsCount}</span>\r\n          <span className=\"badge-label\">rooms</span>\r\n        </div>\r\n        {userLocation && nearbyRadius > 0 && (\r\n          <div className=\"badge-subtitle\">within {nearbyRadius}km</div>\r\n        )}\r\n      </div>\r\n\r\n      {/* Top-right: Controls */}\r\n      <div className=\"map-controls-container\">\r\n        {/* Search in map area */}\r\n        <button\r\n          onClick={() => setShowSearch(!showSearch)}\r\n          className=\"map-control-btn search-btn\"\r\n          title=\"Search this area\"\r\n        >\r\n          <svg width=\"18\" height=\"18\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\">\r\n            <circle cx=\"11\" cy=\"11\" r=\"8\"/>\r\n            <path d=\"m21 21-4.35-4.35\"/>\r\n          </svg>\r\n        </button>\r\n\r\n        {/* Map style toggle */}\r\n        <button\r\n          onClick={() => setIsExpanded(!isExpanded)}\r\n          className={`map-control-btn map-style-toggle ${isExpanded ? 'active' : ''}`}\r\n          title=\"Change map style\"\r\n        >\r\n          <span>üó∫Ô∏è</span>\r\n        </button>\r\n        \r\n        {isExpanded && (\r\n          <MapStyleSelector \r\n            currentStyle={mapStyle} \r\n            onStyleChange={(style) => {\r\n              onMapStyleChange(style);\r\n              setIsExpanded(false);\r\n            }} \r\n          />\r\n        )}\r\n\r\n        {/* Recenter button */}\r\n        {userLocation && (\r\n          <button\r\n            type=\"button\"\r\n            onClick={() => { \r\n              if (onRecenter) onRecenter(); \r\n              map.setView([userLocation.lat, userLocation.lon], 14, { animate: true }); \r\n            }}\r\n            className=\"map-control-btn recenter-btn\"\r\n            title=\"Center on my location\"\r\n          >\r\n            <svg width=\"18\" height=\"18\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\">\r\n              <circle cx=\"12\" cy=\"12\" r=\"3\"/>\r\n              <path d=\"M12 2v4M12 18v4M2 12h4M18 12h4\"/>\r\n            </svg>\r\n          </button>\r\n        )}\r\n\r\n        {/* Zoom controls */}\r\n        <div className=\"zoom-controls\">\r\n          <button onClick={handleZoomIn} className=\"zoom-btn zoom-in\" title=\"Zoom in\">+</button>\r\n          <div className=\"zoom-level\">{zoomLevel}</div>\r\n          <button onClick={handleZoomOut} className=\"zoom-btn zoom-out\" title=\"Zoom out\">‚àí</button>\r\n        </div>\r\n\r\n        {/* Fullscreen toggle */}\r\n        <button\r\n          type=\"button\"\r\n          onClick={() => {\r\n            const container = map.getContainer().parentElement;\r\n            if (document.fullscreenElement) {\r\n              document.exitFullscreen();\r\n            } else {\r\n              container?.requestFullscreen();\r\n            }\r\n          }}\r\n          className=\"map-control-btn fullscreen-btn\"\r\n          title=\"Toggle fullscreen\"\r\n        >\r\n          <svg width=\"18\" height=\"18\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\">\r\n            <path d=\"M8 3H5a2 2 0 0 0-2 2v3M21 8V5a2 2 0 0 0-2-2h-3M3 16v3a2 2 0 0 0 2 2h3M16 21h3a2 2 0 0 0 2-2v-3\"/>\r\n          </svg>\r\n        </button>\r\n      </div>\r\n\r\n      {/* Search area notification */}\r\n      {showSearch && (\r\n        <div className=\"map-search-area\">\r\n          <button \r\n            className=\"search-area-btn\"\r\n            onClick={() => {\r\n              // Trigger search in visible area\r\n              setShowSearch(false);\r\n            }}\r\n          >\r\n            üîç Search this area\r\n          </button>\r\n        </div>\r\n      )}\r\n\r\n      {/* Bottom: Radius slider - enhanced */}\r\n      {userLocation && (\r\n        <div className=\"map-radius-control\">\r\n          <div className=\"radius-header\">\r\n            <span className=\"radius-icon\">üìç</span>\r\n            <span className=\"radius-label\">Search radius</span>\r\n            <span className=\"radius-value-inline\">{nearbyRadius} km</span>\r\n          </div>\r\n          <div className=\"radius-slider-container\">\r\n            <span className=\"radius-min\">1</span>\r\n            <input\r\n              type=\"range\"\r\n              min={1}\r\n              max={25}\r\n              step={1}\r\n              value={nearbyRadius}\r\n              onChange={(e) => onRadiusChange && onRadiusChange(parseInt(e.target.value))}\r\n              className=\"radius-slider\"\r\n            />\r\n            <span className=\"radius-max\">25</span>\r\n          </div>\r\n          <div className=\"radius-presets\">\r\n            {[1, 3, 5, 10, 15, 25].map(r => (\r\n              <button\r\n                key={r}\r\n                onClick={() => onRadiusChange && onRadiusChange(r)}\r\n                className={`radius-preset-btn ${nearbyRadius === r ? 'active' : ''}`}\r\n              >\r\n                {r}km\r\n              </button>\r\n            ))}\r\n          </div>\r\n        </div>\r\n      )}\r\n    </>\r\n  );\r\n}\r\n\r\nexport default function MapView({ listings = [], onMarkerClick = () => {}, userLocation = null, nearbyRadius = 0, fullHeight = false, onRadiusChange, onRecenter }) {\r\n  const [mapStyle, setMapStyle] = useState('streets');\r\n  const [selectedMarkerId, setSelectedMarkerId] = useState(null);\r\n  const [hoveredMarkerId, setHoveredMarkerId] = useState(null);\r\n  const [zoomLevel, setZoomLevel] = useState(12);\r\n  const [activeFilter, setActiveFilter] = useState('all');\r\n  const [shouldFitBounds, setShouldFitBounds] = useState(true);\r\n\r\n  const markers = useMemo(() => {\r\n    return listings\r\n      .filter(l => {\r\n        // Apply active filter\r\n        if (activeFilter === 'cheap') return l.price < 2000;\r\n        if (activeFilter === 'mid') return l.price >= 2000 && l.price <= 4000;\r\n        if (activeFilter === 'wifi') return l.wifi || l.amenities?.includes('WiFi');\r\n        return true;\r\n      })\r\n      .map(l => {\r\n        let lat = l.latitude ?? l.lat ?? (l.coords && l.coords[0]);\r\n        let lng = l.longitude ?? l.lng ?? (l.coords && l.coords[1]);\r\n        \r\n        // Fallback to location-based coordinates if no explicit coords\r\n        if (typeof lat !== 'number' || typeof lng !== 'number') {\r\n          [lat, lng] = getCoordinatesForLocation(l.location);\r\n        }\r\n        \r\n        // Check if listing is new (within 7 days)\r\n        const isNew = l.createdAt && (Date.now() - new Date(l.createdAt).getTime()) < 7 * 24 * 60 * 60 * 1000;\r\n        \r\n        // Calculate distance from user if available\r\n        let distance = null;\r\n        if (userLocation && typeof userLocation.lat === 'number') {\r\n          distance = getDistance(userLocation.lat, userLocation.lon, lat, lng);\r\n        }\r\n        \r\n        return { \r\n          id: l.id, \r\n          title: l.title, \r\n          location: l.location, \r\n          price: l.price, \r\n          lat, \r\n          lng, \r\n          raw: l, \r\n          photos: l.photos,\r\n          hasWifi: l.wifi || l.amenities?.includes('WiFi'),\r\n          isNew,\r\n          distance\r\n        };\r\n      });\r\n  }, [listings, activeFilter, userLocation]);\r\n\r\n  const defaultCenter = [-26.2041, 28.0473]; // Johannesburg fallback\r\n  const bounds = markers.length > 0 ? markers.map(m => [m.lat, m.lng]) : null;\r\n\r\n  // include user location in bounds so map can show renter + listings together\r\n  const allBounds = useMemo(() => {\r\n    const b = bounds ? [...bounds] : [];\r\n    if (userLocation && typeof userLocation.lat === 'number' && typeof userLocation.lon === 'number') {\r\n      b.push([userLocation.lat, userLocation.lon]);\r\n    }\r\n    return b.length > 0 ? b : null;\r\n  }, [bounds, userLocation]);\r\n\r\n  // Map tile layers based on style\r\n  const getTileLayer = useCallback(() => {\r\n    const MAPBOX_KEY = process.env.REACT_APP_MAPBOX_API_KEY;\r\n    \r\n    switch (mapStyle) {\r\n      case 'satellite':\r\n        if (MAPBOX_KEY) {\r\n          return {\r\n            url: `https://api.mapbox.com/styles/v1/mapbox/satellite-streets-v12/tiles/{z}/{x}/{y}?access_token=${MAPBOX_KEY}`,\r\n            attribution: '¬© Mapbox ¬© OpenStreetMap'\r\n          };\r\n        }\r\n        return {\r\n          url: 'https://server.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}',\r\n          attribution: '¬© Esri'\r\n        };\r\n      case 'dark':\r\n        if (MAPBOX_KEY) {\r\n          return {\r\n            url: `https://api.mapbox.com/styles/v1/mapbox/dark-v11/tiles/{z}/{x}/{y}?access_token=${MAPBOX_KEY}`,\r\n            attribution: '¬© Mapbox'\r\n          };\r\n        }\r\n        return {\r\n          url: 'https://{s}.basemaps.cartocdn.com/dark_all/{z}/{x}/{y}{r}.png',\r\n          attribution: '¬© CartoDB'\r\n        };\r\n      default: // streets\r\n        if (MAPBOX_KEY) {\r\n          return {\r\n            url: `https://api.mapbox.com/styles/v1/mapbox/streets-v12/tiles/{z}/{x}/{y}?access_token=${MAPBOX_KEY}`,\r\n            attribution: '¬© Mapbox'\r\n          };\r\n        }\r\n        return {\r\n          url: 'https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png',\r\n          attribution: '¬© OpenStreetMap contributors'\r\n        };\r\n    }\r\n  }, [mapStyle]);\r\n\r\n  const tileLayer = getTileLayer();\r\n  const mapHeight = fullHeight ? 'calc(100vh - 180px)' : '320px';\r\n\r\n  const handleMarkerClick = useCallback((marker) => {\r\n    setSelectedMarkerId(marker.id);\r\n    onMarkerClick(marker.raw);\r\n  }, [onMarkerClick]);\r\n\r\n  return (\r\n    <div className=\"map-container-wrapper\" style={{ height: mapHeight }}>\r\n      {markers.length === 0 ? (\r\n        <div className=\"map-empty-state\">\r\n          <div className=\"empty-state-icon\">üó∫Ô∏è</div>\r\n          <h3 className=\"empty-state-title\">No listings on the map</h3>\r\n          <p className=\"empty-state-text\">\r\n            {listings.length === 0 \r\n              ? \"No listings available in this area\" \r\n              : \"Listings don't have location data yet\"}\r\n          </p>\r\n          {listings.length > 0 && (\r\n            <div className=\"empty-state-list\">\r\n              {listings.slice(0, 3).map(l => (\r\n                <button \r\n                  key={l.id} \r\n                  onClick={() => onMarkerClick(l)} \r\n                  className=\"empty-state-listing\"\r\n                >\r\n                  <span className=\"listing-title\">{l.title}</span>\r\n                  <span className=\"listing-price\">R{Number(l.price).toLocaleString()}</span>\r\n                </button>\r\n              ))}\r\n              {listings.length > 3 && (\r\n                <p className=\"empty-state-more\">+{listings.length - 3} more listings</p>\r\n              )}\r\n            </div>\r\n          )}\r\n        </div>\r\n      ) : (\r\n        <MapContainer \r\n          center={markers[0] ? [markers[0].lat, markers[0].lng] : defaultCenter} \r\n          zoom={12} \r\n          className=\"map-container\"\r\n          zoomControl={false}\r\n        >\r\n          <ZoomControl position=\"bottomright\" />\r\n          <TileLayer\r\n            attribution={tileLayer.attribution}\r\n            url={tileLayer.url}\r\n          />\r\n          \r\n          <OverlayControls \r\n            userLocation={userLocation} \r\n            nearbyRadius={nearbyRadius} \r\n            onRecenter={() => { onRecenter && onRecenter(); setShouldFitBounds(false); }} \r\n            onRadiusChange={onRadiusChange}\r\n            mapStyle={mapStyle}\r\n            onMapStyleChange={setMapStyle}\r\n            listingsCount={markers.length}\r\n            zoomLevel={zoomLevel}\r\n          />\r\n\r\n          {/* Map event handlers */}\r\n          <MapEventHandler \r\n            onZoomChange={setZoomLevel}\r\n            onMoveEnd={() => setShouldFitBounds(false)}\r\n          />\r\n\r\n          {/* Compass */}\r\n          <Compass />\r\n\r\n          {/* Legend */}\r\n          <MapLegend \r\n            userLocation={userLocation} \r\n            nearbyRadius={nearbyRadius}\r\n          />\r\n\r\n          {/* Quick filters */}\r\n          <MapQuickFilters \r\n            activeFilter={activeFilter}\r\n            onFilterChange={setActiveFilter}\r\n          />\r\n\r\n          {/* Scale control */}\r\n          <ScaleControl position=\"bottomleft\" />\r\n\r\n          {/* User location marker with pulse effect */}\r\n          {userLocation && typeof userLocation.lat === 'number' && typeof userLocation.lon === 'number' && (\r\n            <>\r\n              <Marker position={[userLocation.lat, userLocation.lon]} icon={userLocationIcon}>\r\n                <Popup className=\"user-location-popup\">\r\n                  <div className=\"popup-user-location\">\r\n                    <div className=\"popup-icon\">üìç</div>\r\n                    <div className=\"popup-content\">\r\n                      <strong>Your Location</strong>\r\n                      <span className=\"popup-accuracy\">Approximate position</span>\r\n                    </div>\r\n                  </div>\r\n                </Popup>\r\n              </Marker>\r\n              {nearbyRadius > 0 && (\r\n                <Circle \r\n                  center={[userLocation.lat, userLocation.lon]} \r\n                  radius={nearbyRadius * 1000} \r\n                  pathOptions={{ \r\n                    color: '#0d9488', \r\n                    fillColor: '#0d9488',\r\n                    fillOpacity: 0.08,\r\n                    weight: 2,\r\n                    dashArray: '5, 10'\r\n                  }} \r\n                />\r\n              )}\r\n            </>\r\n          )}\r\n\r\n          {/* Listing markers with price tags */}\r\n          {markers.map(m => (\r\n            <Marker \r\n              key={m.id} \r\n              position={[m.lat, m.lng]} \r\n              icon={createPriceMarker(m.price, selectedMarkerId === m.id || hoveredMarkerId === m.id, m.hasWifi, m.isNew)}\r\n              eventHandlers={{ \r\n                click: () => handleMarkerClick(m),\r\n                mouseover: () => setHoveredMarkerId(m.id),\r\n                mouseout: () => setHoveredMarkerId(null)\r\n              }}\r\n            >\r\n              <Popup className=\"listing-popup\">\r\n                <div className=\"popup-listing-card\">\r\n                  {m.photos && m.photos[0] && (\r\n                    <div className=\"popup-image\">\r\n                      <img src={m.photos[0]} alt={m.title} />\r\n                      {m.isNew && <span className=\"popup-badge new\">New</span>}\r\n                    </div>\r\n                  )}\r\n                  <div className=\"popup-details\">\r\n                    <h4 className=\"popup-title\">{m.title}</h4>\r\n                    <p className=\"popup-location\">\r\n                      <span className=\"location-icon\">üìç</span>\r\n                      {m.location}\r\n                      {m.distance !== null && (\r\n                        <span className=\"distance-badge\">{m.distance.toFixed(1)}km</span>\r\n                      )}\r\n                    </p>\r\n                    <div className=\"popup-amenities\">\r\n                      {m.hasWifi && <span className=\"amenity-badge\">üì∂ WiFi</span>}\r\n                    </div>\r\n                    <div className=\"popup-footer\">\r\n                      <span className=\"popup-price\">R{Number(m.price).toLocaleString()}<small>/mo</small></span>\r\n                      <button \r\n                        className=\"popup-view-btn\"\r\n                        onClick={() => handleMarkerClick(m)}\r\n                      >\r\n                        View Details ‚Üí\r\n                      </button>\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n              </Popup>\r\n            </Marker>\r\n          ))}\r\n\r\n          <FitBounds bounds={allBounds || bounds} shouldFit={shouldFitBounds} />\r\n        </MapContainer>\r\n      )}\r\n    </div>\r\n  );\r\n}\r\n\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}