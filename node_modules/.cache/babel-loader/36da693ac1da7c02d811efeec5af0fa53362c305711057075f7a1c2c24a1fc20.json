{"ast":null,"code":"import _objectSpread from\"C:/Users/kutum/Documents/room-rental-platform/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import React,{useState,useEffect,useMemo,useCallback}from'react';import{initFirebase,initAnalytics,requestFcmToken,listenForegroundMessages,trackEvent}from'./firebase';import{Home,PlusCircle,Search,MapPin,X,User,Phone,Mail,Edit,CheckCircle,Heart,Loader2}from'lucide-react';import Map,{Marker as MapMarker}from'react-map-gl/maplibre';import maplibregl from'maplibre-gl';import Header from'./components/Header';import ListingDetailModal from'./components/ListingDetailModal';import Footer from'./components/Footer';import BrowseView from'./components/BrowseView';import PrivacyPolicyModal from'./components/PrivacyPolicyModal';import NotificationBanner from'./components/NotificationBanner';import AnalyticsConsentModal from'./components/AnalyticsConsentModal';import NotificationsPanel from'./components/NotificationsPanel';import PhotoEditor from'./components/PhotoEditor';import{getNotifications}from'./utils/notificationEngine';import{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";const PREVIEW_MAP_STYLE=process.env.REACT_APP_PREVIEW_MAP_STYLE||'https://basemaps.cartocdn.com/gl/positron-gl-style/style.json';const DEFAULT_PREVIEW_CENTER={lat:-26.2041,lon:28.0473};export default function RentalPlatform(){const[currentView,setCurrentView]=useState('browse');const[mapView,setMapView]=useState(false);const[userType,setUserType]=useState(null);const[previewAsRenter,setPreviewAsRenter]=useState(false);// landlord UI preview toggle\nconst[listings,setListings]=useState([]);const[selectedListing,setSelectedListing]=useState(null);const[users,setUsers]=useState([]);// registry of all users (localStorage 'users')\nconst[searchLocation,setSearchLocation]=useState('');const[priceRange,setPriceRange]=useState([0,10000]);const[selectedAmenities,setSelectedAmenities]=useState([]);const[sortBy,setSortBy]=useState('newest');const[currentUser,setCurrentUser]=useState(null);const[showAuthModal,setShowAuthModal]=useState(false);const[authDefaultType,setAuthDefaultType]=useState('renter');const[nearbyMode,setNearbyMode]=useState(false);const[nearbyRadius,setNearbyRadius]=useState(5);// km\nconst[userLocation,setUserLocation]=useState(null);const[nearbyStatus,setNearbyStatus]=useState('');const[showLocationConsent,setShowLocationConsent]=useState(false);// Mobile menu state moved into Header component\nconst[toast,setToast]=useState(null);const[showPrivacyPolicy,setShowPrivacyPolicy]=useState(false);const[notificationBanner,setNotificationBanner]=useState(null);const[showAnalyticsConsent,setShowAnalyticsConsent]=useState(false);const[showNotificationsPanel,setShowNotificationsPanel]=useState(false);const[unreadCount,setUnreadCount]=useState(0);const openAuthModal=function(){let type=arguments.length>0&&arguments[0]!==undefined?arguments[0]:'renter';setAuthDefaultType(type);setShowAuthModal(true);};// Update unread notification count\nuseEffect(()=>{const updateUnreadCount=()=>{const notifications=getNotifications();setUnreadCount(notifications.filter(n=>!n.read).length);};updateUnreadCount();const interval=setInterval(updateUnreadCount,5000);// check every 5s\nreturn()=>clearInterval(interval);},[]);useEffect(()=>{loadData();// Initialize Firebase + FCM token fetch (deferred until user interaction if desired)\nconst app=initFirebase();// Check analytics consent and show modal if not set\nconst analyticsConsent=localStorage.getItem('analytics-consent');if(!analyticsConsent&&process.env.REACT_APP_ENABLE_ANALYTICS==='true'){// Delay modal slightly so UI loads first\nsetTimeout(()=>setShowAnalyticsConsent(true),2000);}else if(analyticsConsent==='yes'){initAnalytics(app);}(async()=>{try{const token=await requestFcmToken();if(token){console.log('Obtained FCM token:',token);trackEvent('fcm_token_obtained');}}catch(e){console.warn('FCM token request failed',e);}})();listenForegroundMessages(payload=>{// Display notification banner instead of toast\nconst notification=(payload===null||payload===void 0?void 0:payload.notification)||{};if(notification.title||notification.body){setNotificationBanner({title:notification.title,body:notification.body});// Auto-dismiss after 8 seconds\nsetTimeout(()=>setNotificationBanner(null),8000);}});},[]);// Guard: if someone navigates to 'add' without landlord auth, prompt to sign in\nuseEffect(()=>{if(currentView==='add'){if(!currentUser){openAuthModal('landlord');setCurrentView('browse');}else if(userType!=='landlord'){// Not a landlord - prompt to become one\nopenAuthModal('landlord');setCurrentView('browse');}else if(!currentUser.landlordComplete){// Landlord but hasn't completed onboarding\nsetCurrentView('landlord-onboarding');}}},[currentView,currentUser,userType]);const loadData=async()=>{try{const listingsResult=localStorage.getItem('listings');const userResult=localStorage.getItem('current-user');const usersResult=localStorage.getItem('users');if(listingsResult)setListings(JSON.parse(listingsResult));if(userResult){const user=JSON.parse(userResult);setCurrentUser(user);setUserType(user.type);}if(usersResult){try{const parsed=JSON.parse(usersResult);setUsers(Array.isArray(parsed)?parsed:[]);}catch(e){console.warn('Corrupt users array in storage, resetting');setUsers([]);}}}catch(error){console.log('No existing data found, starting fresh');// Add sample listings for testing the map\nconst sampleListings=[{id:'listing-1',title:'Cozy Room in Soweto',price:2500,location:'Soweto, Johannesburg',description:'Comfortable room with bathroom and kitchen access',photos:[],status:'available',availableDate:new Date().toISOString(),amenities:['WiFi','Kitchen'],landlordId:'landlord-1',landlordName:'John Smith',landlordPhone:'+27 123 456 7890',landlordEmail:'john@example.com',landlordPhoto:'',createdAt:new Date().toISOString()},{id:'listing-2',title:'Modern Apartment in Sandton',price:4500,location:'Sandton, Johannesburg',description:'Luxurious apartment with parking and security',photos:[],status:'available',availableDate:new Date().toISOString(),amenities:['WiFi','Parking','Air Conditioning'],landlordId:'landlord-2',landlordName:'Jane Doe',landlordPhone:'+27 987 654 3210',landlordEmail:'jane@example.com',landlordPhoto:'',createdAt:new Date().toISOString()},{id:'listing-3',title:'Studio in Midrand',price:3200,location:'Midrand, Johannesburg',description:'Spacious studio flat with laundry facilities',photos:[],status:'available',availableDate:new Date().toISOString(),amenities:['Laundry','WiFi'],landlordId:'landlord-3',landlordName:'Mike Johnson',landlordPhone:'+27 555 555 5555',landlordEmail:'mike@example.com',landlordPhoto:'',createdAt:new Date().toISOString()}];setListings(sampleListings);}};// Helper: check for duplicate phone or email in registry (exclude an optional user id)\nconst isDuplicateContact=function(phone,email){let ignoreId=arguments.length>2&&arguments[2]!==undefined?arguments[2]:null;const normalizedPhone=(phone||'').trim();const normalizedEmail=(email||'').trim().toLowerCase();if(!users||users.length===0)return false;return users.some(u=>{if(ignoreId&&u.id===ignoreId)return false;const uPhone=(u.phone||'').trim();const uEmail=(u.email||'').trim().toLowerCase();const phoneMatch=normalizedPhone&&uPhone&&uPhone===normalizedPhone;const emailMatch=normalizedEmail&&uEmail&&uEmail===normalizedEmail;return phoneMatch||emailMatch;});};// Haversine formula to compute distance in kilometers between two coords\nconst haversineDistance=(lat1,lon1,lat2,lon2)=>{const toRad=v=>v*Math.PI/180;const R=6371;// km\nconst dLat=toRad(lat2-lat1);const dLon=toRad(lon2-lon1);const a=Math.sin(dLat/2)*Math.sin(dLat/2)+Math.cos(toRad(lat1))*Math.cos(toRad(lat2))*Math.sin(dLon/2)*Math.sin(dLon/2);const c=2*Math.atan2(Math.sqrt(a),Math.sqrt(1-a));return R*c;};const handleFindNearby=()=>{if(!navigator.geolocation){setNearbyStatus('Geolocation not supported');return;}// Show consent modal before accessing location\nsetShowLocationConsent(true);};const handleLocationConsentAccept=()=>{setShowLocationConsent(false);setNearbyStatus('Locating...');navigator.geolocation.getCurrentPosition(pos=>{const lat=pos.coords.latitude;const lon=pos.coords.longitude;setUserLocation({lat,lon});setNearbyMode(true);setNearbyStatus('Nearby mode enabled');setTimeout(()=>setNearbyStatus(''),2000);},err=>{console.error('Geolocation error',err);setNearbyStatus('Could not get location');},{enableHighAccuracy:true,timeout:10000});};const clearNearby=()=>{setNearbyMode(false);setUserLocation(null);setNearbyStatus('');};// Toast notification helper\nconst showToast=function(message){let type=arguments.length>1&&arguments[1]!==undefined?arguments[1]:'info';let title=arguments.length>2&&arguments[2]!==undefined?arguments[2]:'';setToast({message,type,title});setTimeout(()=>setToast(null),5000);};const handleAnalyticsConsentAccept=()=>{localStorage.setItem('analytics-consent','yes');setShowAnalyticsConsent(false);const app=initFirebase();initAnalytics(app);trackEvent('analytics_consent_granted');showToast('Analytics enabled','success','Thank you!');};const handleAnalyticsConsentDecline=()=>{localStorage.setItem('analytics-consent','no');setShowAnalyticsConsent(false);showToast('Analytics disabled','info');};const saveListings=async newListings=>{try{localStorage.setItem('listings',JSON.stringify(newListings));setListings(newListings);// Broadcast to runtime service worker for offline snapshot caching\nif(navigator.serviceWorker&&navigator.serviceWorker.controller){try{navigator.serviceWorker.controller.postMessage({type:'SYNC_LISTINGS',payload:newListings});}catch(_unused){}}}catch(error){console.error('Error saving listings:',error);}};const saveSubscriptions=async subscriptions=>{try{localStorage.setItem('subscriptions',JSON.stringify(subscriptions));}catch(error){console.error('Error saving subscriptions:',error);}};const getSubscriptions=async()=>{try{const res=localStorage.getItem('subscriptions');return res?JSON.parse(res):{};}catch(err){console.error('Error loading subscriptions',err);}return{};};const subscribeToArea=async(userId,area)=>{if(!userId){openAuthModal('renter');return;}if(!area||area.trim()===''){alert('Please enter a location to subscribe to.');return;}try{const subs=await getSubscriptions();subs[userId]=subs[userId]||[];if(!subs[userId].includes(area)){subs[userId].push(area);await saveSubscriptions(subs);alert(\"Subscribed to updates for \".concat(area));}else{alert(\"You are already subscribed to \".concat(area));}}catch(err){console.error('Subscribe failed',err);alert('Could not subscribe. Please try again.');}};const handleProfileSetup=async profileData=>{try{// Duplicate guard\nif(isDuplicateContact(profileData.phone,profileData.email)){showToast('Phone or email already registered','error','Duplicate');return;}const userId=\"user-\".concat(Date.now());const user=_objectSpread(_objectSpread({id:userId,type:userType},profileData),{},{whatsapp:profileData.whatsapp||'',notificationPrefs:{updates:true,marketing:false},createdAt:new Date().toISOString()});localStorage.setItem('current-user',JSON.stringify(user));setCurrentUser(user);// Update users registry\nconst existingUsersRaw=localStorage.getItem('users');let existingUsers=[];if(existingUsersRaw){try{existingUsers=JSON.parse(existingUsersRaw);}catch(_unused2){existingUsers=[];}}existingUsers.push(user);localStorage.setItem('users',JSON.stringify(existingUsers));setUsers(existingUsers);showToast('Profile created successfully!','success','Welcome!');setCurrentView('browse');}catch(error){console.error('Error saving profile:',error);// Still set the user locally even if storage fails\nconst userId=\"user-\".concat(Date.now());const user=_objectSpread(_objectSpread({id:userId,type:userType},profileData),{},{whatsapp:profileData.whatsapp||'',createdAt:new Date().toISOString()});setCurrentUser(user);const existingUsersRaw=localStorage.getItem('users');let existingUsers=[];if(existingUsersRaw){try{existingUsers=JSON.parse(existingUsersRaw);}catch(_unused3){existingUsers=[];}}existingUsers.push(user);try{localStorage.setItem('users',JSON.stringify(existingUsers));}catch(_unused4){}setUsers(existingUsers);showToast('Profile created (data may not be persisted)','error');setCurrentView('browse');}};const handleUpdateProfile=async profileData=>{try{// Duplicate guard (exclude current user id)\nif(isDuplicateContact(profileData.phone,profileData.email,currentUser===null||currentUser===void 0?void 0:currentUser.id)){showToast('Phone or email already used by another account','error','Duplicate');return;}const updatedUser=_objectSpread(_objectSpread({},currentUser),profileData);localStorage.setItem('current-user',JSON.stringify(updatedUser));setCurrentUser(updatedUser);// Update registry entry\nconst existingUsersRaw=localStorage.getItem('users');let existingUsers=[];if(existingUsersRaw){try{existingUsers=JSON.parse(existingUsersRaw);}catch(_unused5){existingUsers=[];}}const idx=existingUsers.findIndex(u=>u.id===updatedUser.id);if(idx!==-1){existingUsers[idx]=updatedUser;}else{existingUsers.push(updatedUser);// ensure presence\n}localStorage.setItem('users',JSON.stringify(existingUsers));setUsers(existingUsers);showToast('Profile updated successfully!','success');setCurrentView('browse');}catch(error){console.error('Error updating profile:',error);const updatedUser=_objectSpread(_objectSpread({},currentUser),profileData);setCurrentUser(updatedUser);const existingUsersRaw=localStorage.getItem('users');let existingUsers=[];if(existingUsersRaw){try{existingUsers=JSON.parse(existingUsersRaw);}catch(_unused6){existingUsers=[];}}const idx=existingUsers.findIndex(u=>u.id===updatedUser.id);if(idx!==-1){existingUsers[idx]=updatedUser;}else{existingUsers.push(updatedUser);}try{localStorage.setItem('users',JSON.stringify(existingUsers));}catch(_unused7){}setUsers(existingUsers);showToast('Profile updated (data may not be persisted)','error');setCurrentView('browse');}};const handleQuickAuth=async profileData=>{// Lightweight auth (used by AuthModal) - create and persist a user\ntry{if(isDuplicateContact(profileData.phone,profileData.email)){showToast('Phone or email already registered','error','Duplicate');return;}const userId=\"user-\".concat(Date.now());const user={id:userId,type:profileData.type||'renter',name:profileData.name,phone:profileData.phone||'',email:profileData.email||'',photo:profileData.photo||'',notificationPrefs:{updates:true,marketing:false},createdAt:new Date().toISOString()};localStorage.setItem('current-user',JSON.stringify(user));setCurrentUser(user);setUserType(user.type);// registry update\nconst existingUsersRaw=localStorage.getItem('users');let existingUsers=[];if(existingUsersRaw){try{existingUsers=JSON.parse(existingUsersRaw);}catch(_unused8){existingUsers=[];}}existingUsers.push(user);localStorage.setItem('users',JSON.stringify(existingUsers));setUsers(existingUsers);setShowAuthModal(false);// If landlord, route to onboarding to complete setup before posting\nif(user.type==='landlord'){setCurrentView('landlord-onboarding');}else{setCurrentView('browse');}}catch(err){console.error('Auth failed',err);}};// Sign out helper so you can re-auth as renter for perspective preview\nconst handleSignOut=()=>{try{localStorage.removeItem('current-user');}catch(e){console.warn('Could not clear localStorage current-user');}setCurrentUser(null);setUserType(null);setCurrentView('browse');showToast('Signed out. You can now sign in as Renter.','info');};const handleCompleteOnboarding=async onboardData=>{try{const updated=_objectSpread(_objectSpread({},currentUser),{},{landlordComplete:true,landlordInfo:onboardData});localStorage.setItem('current-user',JSON.stringify(updated));setCurrentUser(updated);setCurrentView('browse');}catch(err){console.error('Onboarding save failed',err);setCurrentUser(_objectSpread(_objectSpread({},currentUser),{},{landlordComplete:true,landlordInfo:onboardData}));setCurrentView('browse');}};const handleAddListing=async listingData=>{var _listingData$latitude,_listingData$longitud;const newListing={id:\"listing-\".concat(Date.now()),title:listingData.title,price:listingData.price,location:listingData.location,description:listingData.description,photos:listingData.photos||[],status:listingData.status||'available',availableDate:listingData.availableDate||new Date().toISOString(),amenities:listingData.amenities||[],latitude:(_listingData$latitude=listingData.latitude)!==null&&_listingData$latitude!==void 0?_listingData$latitude:null,longitude:(_listingData$longitud=listingData.longitude)!==null&&_listingData$longitud!==void 0?_listingData$longitud:null,paymentMethod:listingData.paymentMethod||'Bank and Cash',premium:!!listingData.premium,landlordId:currentUser.id,landlordName:currentUser.name,landlordPhone:currentUser.phone,landlordEmail:currentUser.email,landlordPhoto:currentUser.photo,createdAt:new Date().toISOString()};const updatedListings=[...listings,newListing];await saveListings(updatedListings);showToast('Listing created successfully!','success','Success!');setCurrentView('browse');// Scroll to top to see new listing\nwindow.scrollTo({top:0,behavior:'smooth'});};// Messaging removed\nconst filteredListings=listings.map(listing=>{// attach distance if we have userLocation\nif(userLocation&&listing.latitude!=null&&listing.longitude!=null){const d=haversineDistance(userLocation.lat,userLocation.lon,listing.latitude,listing.longitude);return _objectSpread(_objectSpread({},listing),{},{__distanceKm:d});}if(userLocation&&(listing.latitude==null||listing.longitude==null)){// try to geocode-less accurate: leave distance undefined\nreturn _objectSpread({},listing);}return _objectSpread({},listing);}).filter(listing=>{const matchesLocation=!searchLocation||(listing.location||'').toLowerCase().includes(searchLocation.toLowerCase());const price=parseFloat(listing.price);const matchesPrice=price>=priceRange[0]&&price<=priceRange[1];const matchesAmenities=selectedAmenities.length===0||selectedAmenities.every(amenity=>{var _listing$amenities;return(_listing$amenities=listing.amenities)===null||_listing$amenities===void 0?void 0:_listing$amenities.includes(amenity);});let passesNearby=true;if(nearbyMode&&userLocation){// require listing to have coordinates to be included\nif(listing.latitude!=null&&listing.longitude!=null){var _listing$__distanceKm;const d=(_listing$__distanceKm=listing.__distanceKm)!==null&&_listing$__distanceKm!==void 0?_listing$__distanceKm:haversineDistance(userLocation.lat,userLocation.lon,listing.latitude,listing.longitude);passesNearby=d<=nearbyRadius;}else{passesNearby=false;}}return matchesLocation&&matchesPrice&&matchesAmenities&&passesNearby;}).sort((a,b)=>{if(a.premium&&!b.premium)return-1;if(!a.premium&&b.premium)return 1;if(nearbyMode&&userLocation){var _a$__distanceKm,_b$__distanceKm;const da=(_a$__distanceKm=a.__distanceKm)!==null&&_a$__distanceKm!==void 0?_a$__distanceKm:Infinity;const db=(_b$__distanceKm=b.__distanceKm)!==null&&_b$__distanceKm!==void 0?_b$__distanceKm:Infinity;return da-db;}if(sortBy==='newest'){return new Date(b.createdAt)-new Date(a.createdAt);}else if(sortBy==='cheapest'){return parseFloat(a.price)-parseFloat(b.price);}else if(sortBy==='expensive'){return parseFloat(b.price)-parseFloat(a.price);}return 0;});// Allow guests to land on Browse by default. If userType isn't set,\n// show a gentle callout in the header (below) so users can pick a role\n// when they want to post or set up their profile.\nreturn/*#__PURE__*/_jsxs(\"div\",{className:\"min-h-screen bg-gray-50\",children:[/*#__PURE__*/_jsx(\"a\",{href:\"#main-content\",className:\"absolute left-2 top-2 -translate-y-full focus:translate-y-0 transition bg-blue-600 text-white px-3 py-2 rounded shadow\",style:{clipPath:'inset(0)',zIndex:1000},children:\"Skip to main content\"}),/*#__PURE__*/_jsx(Header,{currentUser:currentUser,previewAsRenter:previewAsRenter,setPreviewAsRenter:setPreviewAsRenter,openAuthModal:openAuthModal,handleSignOut:handleSignOut,setCurrentView:setCurrentView,unreadCount:unreadCount,onOpenNotifications:()=>setShowNotificationsPanel(true)}),previewAsRenter&&(currentUser===null||currentUser===void 0?void 0:currentUser.type)==='landlord'&&/*#__PURE__*/_jsx(\"div\",{className:\"bg-indigo-50 border-b border-indigo-200 text-indigo-700 text-xs py-1 text-center\",role:\"status\",\"aria-live\":\"polite\",children:\"Renter preview mode: interactions are read-only. Toggle off to resume landlord actions.\"}),notificationBanner&&/*#__PURE__*/_jsx(NotificationBanner,{title:notificationBanner.title,body:notificationBanner.body,onClose:()=>setNotificationBanner(null)}),toast&&/*#__PURE__*/_jsx(\"div\",{className:\"fixed top-20 right-4 z-50 max-w-sm w-full transition-all duration-300 \".concat(toast.type==='error'?'bg-red-50 border-red-400':toast.type==='success'?'bg-green-50 border-green-400':toast.type==='warning'?'bg-amber-50 border-amber-400':'bg-blue-50 border-blue-400',\" border-l-4 rounded-lg shadow-xl p-4 fade-in\"),children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-start gap-3\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex-shrink-0 w-6 h-6 rounded-full flex items-center justify-center \".concat(toast.type==='error'?'bg-red-100':toast.type==='success'?'bg-green-100':toast.type==='warning'?'bg-amber-100':'bg-blue-100'),children:[toast.type==='success'&&/*#__PURE__*/_jsx(CheckCircle,{className:\"w-4 h-4 text-green-600\"}),toast.type==='error'&&/*#__PURE__*/_jsx(\"span\",{className:\"text-red-600 font-bold text-sm\",children:\"\\u2715\"}),toast.type==='warning'&&/*#__PURE__*/_jsx(\"span\",{className:\"text-amber-600 font-bold text-sm\",children:\"!\"}),toast.type==='info'&&/*#__PURE__*/_jsx(\"span\",{className:\"text-blue-600 font-bold text-sm\",children:\"i\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex-1\",children:[toast.title&&/*#__PURE__*/_jsx(\"p\",{className:\"font-semibold mb-1 \".concat(toast.type==='error'?'text-red-800':toast.type==='success'?'text-green-800':toast.type==='warning'?'text-amber-800':'text-blue-800'),children:toast.title}),/*#__PURE__*/_jsx(\"p\",{className:\"text-sm \".concat(toast.type==='error'?'text-red-700':toast.type==='success'?'text-green-700':toast.type==='warning'?'text-amber-700':'text-blue-700'),children:toast.message})]}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>setToast(null),className:\"flex-shrink-0 p-1 rounded hover:bg-gray-200 transition \".concat(toast.type==='error'?'text-red-600':toast.type==='success'?'text-green-600':toast.type==='warning'?'text-amber-600':'text-blue-600'),\"aria-label\":\"Close notification\",children:/*#__PURE__*/_jsx(X,{className:\"w-4 h-4\"})})]})}),/*#__PURE__*/_jsxs(\"div\",{id:\"main-content\",className:\"max-w-6xl mx-auto pb-20\",role:\"main\",children:[currentView==='setup-profile'&&/*#__PURE__*/_jsx(ProfileSetupView,{onSubmit:handleProfileSetup,userType:userType}),currentView==='profile'&&currentUser&&/*#__PURE__*/_jsx(ProfileView,{user:currentUser,onEdit:()=>setCurrentView('edit-profile'),onUpdatePrefs:prefs=>{const updated=_objectSpread(_objectSpread({},currentUser),{},{notificationPrefs:prefs});setCurrentUser(updated);try{localStorage.setItem('current-user',JSON.stringify(updated));// update registry\nconst raw=localStorage.getItem('users');if(raw){try{const arr=JSON.parse(raw);const idx=arr.findIndex(u=>u.id===updated.id);if(idx!==-1){arr[idx]=updated;localStorage.setItem('users',JSON.stringify(arr));}}catch(_unused9){}}}catch(_unused0){}showToast('Preferences updated','success');}}),currentView==='edit-profile'&&currentUser&&/*#__PURE__*/_jsx(EditProfileView,{user:currentUser,onSubmit:handleUpdateProfile,onCancel:()=>setCurrentView('profile')}),currentView==='landlord-onboarding'&&currentUser&&userType==='landlord'&&/*#__PURE__*/_jsx(LandlordOnboardingView,{onComplete:handleCompleteOnboarding,onCancel:()=>setCurrentView('browse'),currentUser:currentUser}),currentView==='browse'&&/*#__PURE__*/_jsx(BrowseView,{listings:filteredListings,searchLocation:searchLocation,setSearchLocation:setSearchLocation,priceRange:priceRange,setPriceRange:setPriceRange,selectedAmenities:selectedAmenities,setSelectedAmenities:setSelectedAmenities,sortBy:sortBy,setSortBy:setSortBy,mapView:mapView,setMapView:setMapView,onSelectListing:setSelectedListing,setCurrentView:setCurrentView,currentUser:currentUser,onRequireAuth:openAuthModal,subscribeToArea:subscribeToArea,onFindNearby:handleFindNearby,nearbyRadius:nearbyRadius,setNearbyRadius:setNearbyRadius,nearbyMode:nearbyMode,clearNearby:clearNearby,userLocation:userLocation,nearbyStatus:nearbyStatus,previewMode:previewAsRenter}),currentView==='add'&&/*#__PURE__*/_jsx(AddListingView,{onSubmit:handleAddListing,onCancel:()=>setCurrentView('browse'),currentUser:currentUser,userType:userType,onRequireAuth:openAuthModal,onRequireOnboarding:()=>setCurrentView('landlord-onboarding')}),currentView==='my-listings'&&currentUser&&userType==='landlord'&&/*#__PURE__*/_jsx(MyListingsView,{listings:listings.filter(l=>l.landlordId===currentUser.id),onDelete:async id=>{const updated=listings.filter(l=>l.id!==id);await saveListings(updated);}}),currentView==='favorites'&&/*#__PURE__*/_jsx(FavoritesView,{listings:listings,onSelectListing:setSelectedListing})]}),selectedListing&&/*#__PURE__*/_jsx(ListingDetailModal,{listing:selectedListing,landlord:{name:selectedListing.landlordName,phone:selectedListing.landlordPhone,email:selectedListing.landlordEmail,photo:selectedListing.landlordPhoto},onClose:()=>setSelectedListing(null),userType:userType,currentUser:currentUser,onRequireAuth:openAuthModal,previewMode:previewAsRenter,showToast:showToast}),showAuthModal&&/*#__PURE__*/_jsx(AuthModal,{defaultType:authDefaultType,onClose:()=>setShowAuthModal(false),onSubmit:handleQuickAuth}),/*#__PURE__*/_jsx(BottomNav,{currentView:currentView,setCurrentView:setCurrentView,userType:userType}),showLocationConsent&&/*#__PURE__*/_jsx(LocationConsentModal,{onAccept:handleLocationConsentAccept,onDecline:()=>setShowLocationConsent(false)}),showPrivacyPolicy&&/*#__PURE__*/_jsx(PrivacyPolicyModal,{onClose:()=>setShowPrivacyPolicy(false)}),showAnalyticsConsent&&/*#__PURE__*/_jsx(AnalyticsConsentModal,{onAccept:handleAnalyticsConsentAccept,onDecline:handleAnalyticsConsentDecline}),showNotificationsPanel&&/*#__PURE__*/_jsx(NotificationsPanel,{onClose:()=>{setShowNotificationsPanel(false);setUnreadCount(getNotifications().filter(n=>!n.read).length);},onSelectListing:listingId=>{const listing=listings.find(l=>(l.id||\"\".concat(l.title,\"-\").concat(l.createdAt))===listingId);if(listing){setSelectedListing(listing);}setShowNotificationsPanel(false);}}),/*#__PURE__*/_jsx(Footer,{onOpenPrivacy:()=>setShowPrivacyPolicy(true)})]});}function ProfileSetupView(_ref){let{onSubmit,userType}=_ref;const[formData,setFormData]=useState({name:'',phone:'',email:'',whatsapp:'',photo:''});const[errors,setErrors]=useState({});const[touched,setTouched]=useState({});const validateField=(name,value)=>{const newErrors=_objectSpread({},errors);switch(name){case'name':if(!value||value.trim().length<2){newErrors.name='Name must be at least 2 characters';}else{delete newErrors.name;}break;case'phone':if(!value||!/^[+]?[-0-9()\\s]{7,}$/.test(value.trim())){newErrors.phone='Enter a valid phone number (min 7 digits)';}else{delete newErrors.phone;}break;case'email':if(!value||!/^[^@\\s]+@[^@\\s]+\\.[^@\\s]+$/.test(value.trim())){newErrors.email='Enter a valid email address';}else{delete newErrors.email;}break;case'photo':if(value==='FILE_TOO_LARGE'){newErrors.photo='Photo is too large (max 2MB)';}else{delete newErrors.photo;}break;default:break;}setErrors(newErrors);};const handlePhotoUpload=e=>{const file=e.target.files[0];if(file){if(file.size>2*1024*1024){// 2MB limit\nsetFormData(_objectSpread(_objectSpread({},formData),{},{photo:''}));validateField('photo','FILE_TOO_LARGE');return;}const reader=new FileReader();reader.onloadend=()=>{setFormData(_objectSpread(_objectSpread({},formData),{},{photo:reader.result}));validateField('photo',reader.result);};reader.readAsDataURL(file);}};const handleSubmit=()=>{// Touch all fields\nconst allTouched={name:true,phone:true,email:true,photo:true};setTouched(allTouched);validateField('name',formData.name);validateField('phone',formData.phone);validateField('email',formData.email);if(Object.keys(errors).length===0&&formData.name&&formData.phone&&formData.email){onSubmit(formData);}};return/*#__PURE__*/_jsx(\"div\",{className:\"p-4 min-h-screen bg-gray-50 pb-20\",children:/*#__PURE__*/_jsx(\"div\",{className:\"max-w-2xl mx-auto mt-8\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white rounded-lg shadow-sm border border-gray-200 p-8\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"text-center mb-8\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\"text-3xl font-bold text-gray-800 mb-2\",children:\"Complete Your Profile\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-gray-600\",children:\"Help others know who you are\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-6\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"flex justify-center mb-8\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"relative\",children:[formData.photo?/*#__PURE__*/_jsx(\"img\",{src:formData.photo,alt:\"Profile\",className:\"w-32 h-32 rounded-full object-cover border-4 border-blue-200 shadow-lg\"}):/*#__PURE__*/_jsx(\"div\",{className:\"w-32 h-32 rounded-full bg-gradient-to-br from-blue-100 to-blue-200 flex items-center justify-center border-4 border-blue-200 shadow-lg\",children:/*#__PURE__*/_jsx(User,{className:\"w-16 h-16 text-blue-600\"})}),/*#__PURE__*/_jsxs(\"label\",{className:\"absolute bottom-0 right-0 bg-blue-600 hover:bg-blue-700 text-white p-3 rounded-full cursor-pointer shadow-lg transition group\",\"aria-label\":\"Upload profile photo\",children:[/*#__PURE__*/_jsx(Edit,{className:\"w-5 h-5\"}),/*#__PURE__*/_jsx(\"input\",{type:\"file\",accept:\"image/*\",onChange:handlePhotoUpload,className:\"hidden\"})]})]})}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-semibold text-gray-800 mb-2\",children:\"Full Name *\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",required:true,value:formData.name,onChange:e=>{setFormData(_objectSpread(_objectSpread({},formData),{},{name:e.target.value}));if(touched.name)validateField('name',e.target.value);},onBlur:e=>{setTouched(_objectSpread(_objectSpread({},touched),{},{name:true}));validateField('name',e.target.value);},placeholder:\"Enter your full name\",\"aria-invalid\":errors.name?'true':'false',\"aria-describedby\":errors.name?'profile-name-error':undefined,className:\"w-full px-4 py-3 border \".concat(errors.name?'border-red-500':'border-gray-300',\" bg-white text-gray-800 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition placeholder-gray-400\")}),errors.name&&touched.name&&/*#__PURE__*/_jsx(\"p\",{id:\"profile-name-error\",className:\"mt-1 text-xs text-red-600\",children:errors.name})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-semibold text-gray-800 mb-2\",children:\"Phone Number *\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"relative\",children:[/*#__PURE__*/_jsx(Phone,{className:\"absolute left-4 top-3.5 w-5 h-5 text-gray-400\"}),/*#__PURE__*/_jsx(\"input\",{type:\"tel\",required:true,value:formData.phone,onChange:e=>{setFormData(_objectSpread(_objectSpread({},formData),{},{phone:e.target.value}));if(touched.phone)validateField('phone',e.target.value);},onBlur:e=>{setTouched(_objectSpread(_objectSpread({},touched),{},{phone:true}));validateField('phone',e.target.value);},placeholder:\"e.g., +27 12 345 6789\",\"aria-invalid\":errors.phone?'true':'false',\"aria-describedby\":errors.phone?'profile-phone-error':undefined,className:\"w-full pl-11 pr-4 py-3 border \".concat(errors.phone?'border-red-500':'border-gray-300',\" bg-white text-gray-800 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition placeholder-gray-400\")})]}),errors.phone&&touched.phone&&/*#__PURE__*/_jsx(\"p\",{id:\"profile-phone-error\",className:\"mt-1 text-xs text-red-600\",children:errors.phone})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-semibold text-gray-800 mb-2\",children:\"Email Address *\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"relative\",children:[/*#__PURE__*/_jsx(Mail,{className:\"absolute left-4 top-3.5 w-5 h-5 text-gray-400\"}),/*#__PURE__*/_jsx(\"input\",{type:\"email\",required:true,value:formData.email,onChange:e=>{setFormData(_objectSpread(_objectSpread({},formData),{},{email:e.target.value}));if(touched.email)validateField('email',e.target.value);},onBlur:e=>{setTouched(_objectSpread(_objectSpread({},touched),{},{email:true}));validateField('email',e.target.value);},placeholder:\"your.email@example.com\",\"aria-invalid\":errors.email?'true':'false',\"aria-describedby\":errors.email?'profile-email-error':undefined,className:\"w-full pl-11 pr-4 py-3 border \".concat(errors.email?'border-red-500':'border-gray-300',\" bg-white text-gray-800 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition placeholder-gray-400\")})]}),errors.email&&touched.email&&/*#__PURE__*/_jsx(\"p\",{id:\"profile-email-error\",className:\"mt-1 text-xs text-red-600\",children:errors.email})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-semibold text-gray-800 mb-2\",children:\"WhatsApp (optional)\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"relative\",children:[/*#__PURE__*/_jsx(Phone,{className:\"absolute left-4 top-3.5 w-5 h-5 text-gray-400\"}),/*#__PURE__*/_jsx(\"input\",{type:\"tel\",value:formData.whatsapp,onChange:e=>setFormData(_objectSpread(_objectSpread({},formData),{},{whatsapp:e.target.value})),placeholder:\"e.g., +27 71 234 5678\",className:\"w-full pl-11 pr-4 py-3 border border-gray-300 bg-white text-gray-800 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition placeholder-gray-400\"})]}),/*#__PURE__*/_jsx(\"p\",{className:\"text-xs text-gray-500 mt-1\",children:\"Used to create a WhatsApp chat link on your listings.\"})]}),/*#__PURE__*/_jsx(\"button\",{onClick:handleSubmit,className:\"w-full bg-blue-600 hover:bg-blue-700 text-white font-semibold py-3 rounded-lg transition mt-8 shadow-sm\",children:\"Complete Setup\"})]})]})})});}function ProfileView(_ref2){let{user,onEdit,onUpdatePrefs}=_ref2;const prefs=user.notificationPrefs||{updates:true,marketing:false};const[localPrefs,setLocalPrefs]=React.useState(prefs);const togglePref=key=>{const next=_objectSpread(_objectSpread({},localPrefs),{},{[key]:!localPrefs[key]});setLocalPrefs(next);onUpdatePrefs&&onUpdatePrefs(next);};return/*#__PURE__*/_jsx(\"div\",{className:\"p-4\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white rounded-lg shadow p-6 max-w-xl mx-auto\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-between items-start mb-6\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\"text-2xl font-bold text-gray-800\",children:\"My Profile\"}),/*#__PURE__*/_jsxs(\"button\",{onClick:onEdit,className:\"bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg transition flex items-center gap-2\",children:[/*#__PURE__*/_jsx(Edit,{className:\"w-4 h-4\"}),\"Edit\"]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex flex-col items-center mb-6\",children:[user.photo?/*#__PURE__*/_jsx(\"img\",{src:user.photo,alt:\"Profile\",className:\"w-32 h-32 rounded-full object-cover border-4 border-blue-500 mb-4\"}):/*#__PURE__*/_jsx(\"div\",{className:\"w-32 h-32 rounded-full bg-gray-200 flex items-center justify-center border-4 border-gray-300 mb-4\",children:/*#__PURE__*/_jsx(User,{className:\"w-16 h-16 text-gray-400\"})}),/*#__PURE__*/_jsx(\"h3\",{className:\"text-2xl font-bold text-gray-800\",children:user.name}),/*#__PURE__*/_jsx(\"span\",{className:\"inline-block mt-2 px-4 py-1 bg-blue-100 text-blue-700 rounded-full text-sm font-semibold\",children:user.type==='landlord'?'Landlord':'Renter'})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-4\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"bg-gray-50 rounded-lg p-4\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center text-gray-600\",children:[/*#__PURE__*/_jsx(Phone,{className:\"w-5 h-5 mr-3 text-blue-600\"}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-xs text-gray-500 mb-1\",children:\"Phone Number\"}),/*#__PURE__*/_jsx(\"p\",{className:\"font-semibold text-gray-800\",children:user.phone})]})]})}),/*#__PURE__*/_jsx(\"div\",{className:\"bg-gray-50 rounded-lg p-4\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center text-gray-600\",children:[/*#__PURE__*/_jsx(Mail,{className:\"w-5 h-5 mr-3 text-blue-600\"}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-xs text-gray-500 mb-1\",children:\"Email Address\"}),/*#__PURE__*/_jsx(\"p\",{className:\"font-semibold text-gray-800\",children:user.email})]})]})}),/*#__PURE__*/_jsx(\"div\",{className:\"bg-gray-50 rounded-lg p-4\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center text-gray-600\",children:[/*#__PURE__*/_jsx(User,{className:\"w-5 h-5 mr-3 text-blue-600\"}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-xs text-gray-500 mb-1\",children:\"Member Since\"}),/*#__PURE__*/_jsx(\"p\",{className:\"font-semibold text-gray-800\",children:new Date(user.createdAt).toLocaleDateString()})]})]})}),/*#__PURE__*/_jsxs(\"div\",{className:\"bg-indigo-50 rounded-lg p-4\",children:[/*#__PURE__*/_jsx(\"h4\",{className:\"font-semibold text-gray-800 mb-2\",children:\"Notification Preferences\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-2\",children:[/*#__PURE__*/_jsxs(\"label\",{className:\"flex items-center gap-2 text-sm text-gray-700\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"checkbox\",checked:localPrefs.updates,onChange:()=>togglePref('updates')}),\"Updates about new rooms in subscribed areas\"]}),/*#__PURE__*/_jsxs(\"label\",{className:\"flex items-center gap-2 text-sm text-gray-700\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"checkbox\",checked:localPrefs.marketing,onChange:()=>togglePref('marketing')}),\"Occasional feature & promotion emails\"]})]}),/*#__PURE__*/_jsx(\"p\",{className:\"text-[11px] text-gray-500 mt-2\",children:\"You can opt out anytime. Changes save instantly.\"})]})]})]})});}function LandlordOnboardingView(_ref3){let{onComplete,onCancel,currentUser}=_ref3;const[form,setForm]=useState({businessName:(currentUser===null||currentUser===void 0?void 0:currentUser.name)||'',bankDetails:'',idNumber:'',agree:false});const handleSubmit=()=>{if(!form.businessName||!form.agree){alert('Please provide a display name and agree to the terms.');return;}onComplete(form);};return/*#__PURE__*/_jsx(\"div\",{className:\"p-4 min-h-screen bg-gray-50 pb-20\",children:/*#__PURE__*/_jsx(\"div\",{className:\"max-w-2xl mx-auto mt-8\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white rounded-lg shadow-sm border border-gray-200 p-8\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center gap-6 mb-6\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"w-16 h-16 rounded-full bg-blue-50 flex items-center justify-center text-blue-600 text-2xl font-bold\",children:currentUser&&currentUser.name?currentUser.name.charAt(0):'L'}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsxs(\"h2\",{className:\"text-2xl font-bold text-gray-800\",children:[\"Welcome, \",(currentUser===null||currentUser===void 0?void 0:currentUser.name)||'Landlord']}),/*#__PURE__*/_jsx(\"p\",{className:\"text-gray-600\",children:\"A few details to get your listings live and increase trust with renters.\"})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-4\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-semibold text-gray-800 mb-1\",children:\"Display Name *\"}),/*#__PURE__*/_jsx(\"input\",{value:form.businessName,onChange:e=>setForm(_objectSpread(_objectSpread({},form),{},{businessName:e.target.value})),className:\"w-full px-4 py-3 border border-gray-300 rounded-lg\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-xs text-gray-500 mt-1\",children:\"This name is shown to renters on your listings and messages.\"})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-semibold text-gray-800 mb-1\",children:\"How do you want to receive payments?\"}),/*#__PURE__*/_jsx(\"input\",{value:form.bankDetails,onChange:e=>setForm(_objectSpread(_objectSpread({},form),{},{bankDetails:e.target.value})),placeholder:\"Bank account or payment details (optional)\",className:\"w-full px-4 py-3 border border-gray-300 rounded-lg\"})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-semibold text-gray-800 mb-1\",children:\"ID Number (optional)\"}),/*#__PURE__*/_jsx(\"input\",{value:form.idNumber,onChange:e=>setForm(_objectSpread(_objectSpread({},form),{},{idNumber:e.target.value})),className:\"w-full px-4 py-3 border border-gray-300 rounded-lg\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-start gap-2\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"checkbox\",checked:form.agree,onChange:e=>setForm(_objectSpread(_objectSpread({},form),{},{agree:e.target.checked}))}),/*#__PURE__*/_jsxs(\"div\",{className:\"text-sm text-gray-600\",children:[\"I confirm I am authorised to list these properties and agree to the \",/*#__PURE__*/_jsx(\"button\",{type:\"button\",onClick:e=>e.preventDefault(),className:\"text-blue-600 underline p-0\",children:\"terms of service\"}),\".\"]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex gap-3 pt-4\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:onCancel,className:\"flex-1 bg-gray-100 hover:bg-gray-200 py-3 rounded\",children:\"Cancel\"}),/*#__PURE__*/_jsx(\"button\",{onClick:handleSubmit,className:\"flex-1 bg-blue-600 hover:bg-blue-700 text-white py-3 rounded\",children:\"Complete and Start Listing\"})]})]})]})})});}function EditProfileView(_ref4){let{user,onSubmit,onCancel}=_ref4;const[formData,setFormData]=useState({name:user.name||'',phone:user.phone||'',email:user.email||'',whatsapp:user.whatsapp||'',photo:user.photo||''});const[errors,setErrors]=useState({});const[touched,setTouched]=useState({});const validateField=(name,value)=>{const newErrors=_objectSpread({},errors);switch(name){case'name':if(!value||value.trim().length<2){newErrors.name='Name must be at least 2 characters';}else{delete newErrors.name;}break;case'phone':if(!value||!/^[+]?[-0-9()\\s]{7,}$/.test(value.trim())){newErrors.phone='Enter a valid phone number';}else{delete newErrors.phone;}break;case'email':if(!value||!/^[^@\\s]+@[^@\\s]+\\.[^@\\s]+$/.test(value.trim())){newErrors.email='Enter a valid email';}else{delete newErrors.email;}break;default:break;}setErrors(newErrors);};const handlePhotoUpload=e=>{const file=e.target.files[0];if(file){const reader=new FileReader();reader.onloadend=()=>{setFormData(_objectSpread(_objectSpread({},formData),{},{photo:reader.result}));};reader.readAsDataURL(file);}};const handleSubmit=()=>{setTouched({name:true,phone:true,email:true});validateField('name',formData.name);validateField('phone',formData.phone);validateField('email',formData.email);if(Object.keys(errors).length===0&&formData.name&&formData.phone&&formData.email){onSubmit(formData);}};return/*#__PURE__*/_jsx(\"div\",{className:\"p-4 min-h-screen bg-gray-50 pb-20\",children:/*#__PURE__*/_jsx(\"div\",{className:\"max-w-2xl mx-auto mt-8\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white rounded-lg shadow-sm border border-gray-200 p-8\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between mb-8\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\"text-3xl font-bold text-gray-800\",children:\"Edit Profile\"}),/*#__PURE__*/_jsx(\"button\",{onClick:onCancel,className:\"text-gray-400 hover:text-gray-600 transition\",children:/*#__PURE__*/_jsx(X,{className:\"w-6 h-6\"})})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-6\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"flex justify-center mb-8\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"relative\",children:[formData.photo?/*#__PURE__*/_jsx(\"img\",{src:formData.photo,alt:\"Profile\",className:\"w-32 h-32 rounded-full object-cover border-4 border-blue-200 shadow-lg\"}):/*#__PURE__*/_jsx(\"div\",{className:\"w-32 h-32 rounded-full bg-gradient-to-br from-blue-100 to-blue-200 flex items-center justify-center border-4 border-blue-200 shadow-lg\",children:/*#__PURE__*/_jsx(User,{className:\"w-16 h-16 text-blue-600\"})}),/*#__PURE__*/_jsxs(\"label\",{className:\"absolute bottom-0 right-0 bg-blue-600 hover:bg-blue-700 text-white p-3 rounded-full cursor-pointer shadow-lg transition\",\"aria-label\":\"Upload new profile photo\",children:[/*#__PURE__*/_jsx(Edit,{className:\"w-5 h-5\"}),/*#__PURE__*/_jsx(\"input\",{type:\"file\",accept:\"image/*\",onChange:handlePhotoUpload,className:\"hidden\"})]})]})}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-semibold text-gray-800 mb-2\",children:\"Full Name\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",required:true,value:formData.name,onChange:e=>{setFormData(_objectSpread(_objectSpread({},formData),{},{name:e.target.value}));if(touched.name)validateField('name',e.target.value);},onBlur:e=>{setTouched(_objectSpread(_objectSpread({},touched),{},{name:true}));validateField('name',e.target.value);},\"aria-invalid\":errors.name?'true':'false',\"aria-describedby\":errors.name?'edit-name-error':undefined,className:\"w-full px-4 py-3 border \".concat(errors.name?'border-red-500':'border-gray-300',\" bg-white text-gray-800 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition placeholder-gray-400\")}),errors.name&&touched.name&&/*#__PURE__*/_jsx(\"p\",{id:\"edit-name-error\",className:\"mt-1 text-xs text-red-600\",children:errors.name})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-semibold text-gray-800 mb-2\",children:\"Phone Number\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"relative\",children:[/*#__PURE__*/_jsx(Phone,{className:\"absolute left-4 top-3.5 w-5 h-5 text-gray-400\"}),/*#__PURE__*/_jsx(\"input\",{type:\"tel\",required:true,value:formData.phone,onChange:e=>{setFormData(_objectSpread(_objectSpread({},formData),{},{phone:e.target.value}));if(touched.phone)validateField('phone',e.target.value);},onBlur:e=>{setTouched(_objectSpread(_objectSpread({},touched),{},{phone:true}));validateField('phone',e.target.value);},\"aria-invalid\":errors.phone?'true':'false',\"aria-describedby\":errors.phone?'edit-phone-error':undefined,className:\"w-full pl-11 pr-4 py-3 border \".concat(errors.phone?'border-red-500':'border-gray-300',\" bg-white text-gray-800 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition placeholder-gray-400\")})]}),errors.phone&&touched.phone&&/*#__PURE__*/_jsx(\"p\",{id:\"edit-phone-error\",className:\"mt-1 text-xs text-red-600\",children:errors.phone})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-semibold text-gray-800 mb-2\",children:\"Email Address\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"relative\",children:[/*#__PURE__*/_jsx(Mail,{className:\"absolute left-4 top-3.5 w-5 h-5 text-gray-400\"}),/*#__PURE__*/_jsx(\"input\",{type:\"email\",required:true,value:formData.email,onChange:e=>{setFormData(_objectSpread(_objectSpread({},formData),{},{email:e.target.value}));if(touched.email)validateField('email',e.target.value);},onBlur:e=>{setTouched(_objectSpread(_objectSpread({},touched),{},{email:true}));validateField('email',e.target.value);},\"aria-invalid\":errors.email?'true':'false',\"aria-describedby\":errors.email?'edit-email-error':undefined,className:\"w-full pl-11 pr-4 py-3 border \".concat(errors.email?'border-red-500':'border-gray-300',\" bg-white text-gray-800 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition placeholder-gray-400\")})]}),errors.email&&touched.email&&/*#__PURE__*/_jsx(\"p\",{id:\"edit-email-error\",className:\"mt-1 text-xs text-red-600\",children:errors.email})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-semibold text-gray-800 mb-2\",children:\"WhatsApp (optional)\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"relative\",children:[/*#__PURE__*/_jsx(Phone,{className:\"absolute left-4 top-3.5 w-5 h-5 text-gray-400\"}),/*#__PURE__*/_jsx(\"input\",{type:\"tel\",value:formData.whatsapp,onChange:e=>setFormData(_objectSpread(_objectSpread({},formData),{},{whatsapp:e.target.value})),placeholder:\"e.g., +27 71 234 5678\",className:\"w-full pl-11 pr-4 py-3 border border-gray-300 bg-white text-gray-800 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition placeholder-gray-400\"})]}),/*#__PURE__*/_jsx(\"p\",{className:\"text-xs text-gray-500 mt-1\",children:\"Used to create a WhatsApp chat link on your listings.\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex gap-3 pt-6 border-t border-gray-200\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:onCancel,className:\"flex-1 bg-gray-100 hover:bg-gray-200 text-gray-800 font-semibold py-3 rounded-lg transition\",children:\"Cancel\"}),/*#__PURE__*/_jsx(\"button\",{onClick:handleSubmit,className:\"flex-1 bg-blue-600 hover:bg-blue-700 text-white font-semibold py-3 rounded-lg transition shadow-sm\",children:\"Save Changes\"})]})]})]})})});}/* BrowseView extracted to components/BrowseView.jsx */function FavoritesView(_ref5){let{listings,onSelectListing}=_ref5;const[favorites,setFavorites]=useState([]);useEffect(()=>{try{const rawFavorites=localStorage.getItem('favorites');if(rawFavorites){const arr=JSON.parse(rawFavorites);if(Array.isArray(arr))setFavorites(arr);}}catch(_unused1){}},[]);const toggleFavorite=listingId=>{setFavorites(prev=>{const updated=prev.filter(id=>id!==listingId);try{localStorage.setItem('favorites',JSON.stringify(updated));}catch(_unused10){}return updated;});};const favoriteListings=listings.filter(l=>favorites.includes(l.id));return/*#__PURE__*/_jsx(\"div\",{className:\"p-4 min-h-screen bg-gray-50 pb-20\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"max-w-7xl mx-auto mt-8\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"mb-6\",children:[/*#__PURE__*/_jsxs(\"h2\",{className:\"text-3xl font-bold text-gray-800 flex items-center gap-3\",children:[/*#__PURE__*/_jsx(Heart,{className:\"w-8 h-8 text-red-500 fill-red-500\"}),\"Saved Listings\"]}),/*#__PURE__*/_jsx(\"p\",{className:\"text-gray-600 mt-2\",children:favoriteListings.length===0?'No saved listings yet. Browse and tap the heart icon to save your favorites!':\"\".concat(favoriteListings.length,\" saved \").concat(favoriteListings.length===1?'listing':'listings')})]}),favoriteListings.length===0?/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white rounded-lg border border-gray-200 p-12 text-center\",children:[/*#__PURE__*/_jsx(Heart,{className:\"w-24 h-24 mx-auto mb-4 text-gray-300\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-gray-600 font-medium mb-2\",children:\"No saved listings\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-gray-500 text-sm mb-6\",children:\"Start browsing and save your favorite rooms to find them here later\"})]}):/*#__PURE__*/_jsx(\"div\",{className:\"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6\",children:favoriteListings.map(listing=>{const ListingCard=require('./components/ListingCard').default;return/*#__PURE__*/_jsx(ListingCard,{listing:listing,onClick:()=>onSelectListing(listing),isFavorite:true,onToggleFavorite:toggleFavorite},listing.id);})})]})});}function AddListingView(_ref6){let{onSubmit,onCancel,currentUser,userType,onRequireAuth,onRequireOnboarding}=_ref6;const GEOCODER_KEY=process.env.REACT_APP_GEOCODER_API_KEY;const GEOCODER_PROVIDER=(process.env.REACT_APP_GEOCODER_PROVIDER||'').toLowerCase();const[formData,setFormData]=useState({title:'',price:'',location:'',streetAddress:'',description:'',photos:[],status:'available',availableDate:new Date().toISOString().split('T')[0],amenities:[],latitude:null,longitude:null,paymentMethod:'Bank and Cash',roomType:'private',leaseDuration:'7-12',petFriendly:false,genderPreference:'any'});const[geocodingStatus,setGecodingStatus]=useState('');const[errors,setErrors]=useState({});const[locationHelpBanner,setLocationHelpBanner]=useState('');const[locationSuggestions,setLocationSuggestions]=useState([]);const[locationSuggestionsLoading,setLocationSuggestionsLoading]=useState(false);const locationSuggestionCacheRef=React.useRef({});// { queryLower: { data, ts } }\nconst LOCATION_SUGGESTION_TTL_MS=15*60*1000;const[showPhotoEditor,setShowPhotoEditor]=useState(false);const reverseGeocodeCacheRef=React.useRef({});const[lastGeocodeSource,setLastGeocodeSource]=useState(null);// 'cached' | 'mapbox' | 'proxy' | 'direct' | 'coords-only' | 'manual-geocode'\nconst[isReverseGeocoding,setIsReverseGeocoding]=useState(false);// Helper: fetch with graceful fallbacks when third-party APIs lack CORS headers\nconst corsFallbackTransforms=useMemo(()=>[url=>url.startsWith('https://cors.isomorphic-git.org/')?url:\"https://cors.isomorphic-git.org/\".concat(url),url=>url.startsWith('https://corsproxy.io/?')?url:\"https://corsproxy.io/?\".concat(encodeURIComponent(url))],[]);const fetchWithCorsFallback=useCallback(async function(url){let options=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};const cloneOptions=()=>{const base=_objectSpread({},options);if(options.headers)base.headers=_objectSpread({},options.headers);return base;};const attempt=async targetUrl=>{const resp=await fetch(targetUrl,cloneOptions());if(!resp.ok)throw new Error(\"Request failed with status \".concat(resp.status));return resp;};try{return await attempt(url);}catch(err){var _options$signal;if((_options$signal=options.signal)!==null&&_options$signal!==void 0&&_options$signal.aborted)throw err;let lastError=err;for(const transform of corsFallbackTransforms){try{const proxiedUrl=transform(url);return await attempt(proxiedUrl);}catch(proxyErr){var _options$signal2;lastError=proxyErr;if((_options$signal2=options.signal)!==null&&_options$signal2!==void 0&&_options$signal2.aborted)break;}}throw lastError;}},[corsFallbackTransforms]);// Reusable reverse geocoding function - extracted for use by both GPS and draggable marker\nconst reverseGeocodeCoords=async(lat,lon)=>{const cacheKey=\"\".concat(lat.toFixed(4),\",\").concat(lon.toFixed(4));// Check cache first\nconst cached=reverseGeocodeCacheRef.current[cacheKey];if(cached&&cached.streetAddress&&cached.location){return{streetAddress:cached.streetAddress,location:cached.location,source:'cached'};}// Try geocoding\ntry{var _revData;// Try Mapbox if available\nif(GEOCODER_PROVIDER==='mapbox'&&GEOCODER_KEY){var _revData$features;const rev=await fetch(\"https://api.mapbox.com/geocoding/v5/mapbox.places/\".concat(lon,\",\").concat(lat,\".json?access_token=\").concat(GEOCODER_KEY,\"&limit=1&country=za&types=address,poi\"));const revData=await rev.json();if((revData===null||revData===void 0?void 0:(_revData$features=revData.features)===null||_revData$features===void 0?void 0:_revData$features.length)>0){const feature=revData.features[0];const address=feature.address||'';const streetName=feature.text||'';const fullStreet=address?\"\".concat(address,\" \").concat(streetName):streetName;let area='';if(feature.context){const place=feature.context.find(c=>c.id.startsWith('place'));const locality=feature.context.find(c=>c.id.startsWith('locality'));const region=feature.context.find(c=>c.id.startsWith('region'));const baseArea=(place?place.text:locality?locality.text:'')||'';const province=region?region.text:'';area=province&&baseArea&&province.toLowerCase()!==baseArea.toLowerCase()?\"\".concat(baseArea,\", \").concat(province):baseArea||province;}area=area.replace(/ (Metropolitan|Local|District) Municipality$/i,'').replace(/^City of /i,'').trim();if(fullStreet||area){reverseGeocodeCacheRef.current[cacheKey]={streetAddress:fullStreet,location:area,ts:Date.now()};try{localStorage.setItem('reverse-geocode-cache',JSON.stringify(reverseGeocodeCacheRef.current));}catch(_unused11){}return{streetAddress:fullStreet,location:area,source:'mapbox'};}}}// Try geocode.maps.co (Nominatim mirror with CORS enabled)\ntry{const mapsCoResp=await fetch(\"https://geocode.maps.co/reverse?lat=\".concat(lat,\"&lon=\").concat(lon));if(mapsCoResp.ok){const mapsCoData=await mapsCoResp.json();if(mapsCoData!==null&&mapsCoData!==void 0&&mapsCoData.address){const addr=mapsCoData.address;const houseNumber=addr.house_number||'';const road=addr.road||addr.street||'';const suburb=addr.suburb||addr.neighbourhood||'';const street=[houseNumber,road].filter(Boolean).join(' ').trim()||suburb;const area=formatAreaFromAddress(addr)||suburb;if(street||area){reverseGeocodeCacheRef.current[cacheKey]={streetAddress:street,location:area,ts:Date.now()};try{localStorage.setItem('reverse-geocode-cache',JSON.stringify(reverseGeocodeCacheRef.current));}catch(_unused12){}return{streetAddress:street,location:area,source:'maps.co'};}}}}catch(mapsCoErr){console.warn('maps.co reverse geocode failed',mapsCoErr);}// Try BigDataCloud (CORS-friendly, no key required)\ntry{const bdcResp=await fetch(\"https://api.bigdatacloud.net/data/reverse-geocode-client?latitude=\".concat(lat,\"&longitude=\").concat(lon,\"&localityLanguage=en\"));if(bdcResp.ok){const bdcData=await bdcResp.json();const formatted=formatBigDataCloudAddress(bdcData);if(formatted.streetAddress||formatted.location){reverseGeocodeCacheRef.current[cacheKey]={streetAddress:formatted.streetAddress,location:formatted.location,ts:Date.now()};try{localStorage.setItem('reverse-geocode-cache',JSON.stringify(reverseGeocodeCacheRef.current));}catch(_unused13){}return _objectSpread(_objectSpread({},formatted),{},{source:'bigdatacloud'});}}}catch(bdcErr){console.warn('BigDataCloud reverse geocode failed',bdcErr);}// Try proxy/Nominatim\nconst API_BASE=process.env.REACT_APP_PROXY_BASE||(window.location&&window.location.port==='8443'?'https://localhost:4443':'');let revData=null;try{const rev=await fetch(\"\".concat(API_BASE,\"/api/reverse?lat=\").concat(lat,\"&lon=\").concat(lon));if(rev.ok)revData=await rev.json();}catch(proxyErr){console.warn('Proxy reverse geocode failed, trying direct',proxyErr);}// Direct Nominatim fallback\nif(!revData){try{const direct=await fetchWithCorsFallback(\"https://nominatim.openstreetmap.org/reverse?format=json&lat=\".concat(lat,\"&lon=\").concat(lon,\"&zoom=18&addressdetails=1\"),{headers:{'Accept':'application/json','User-Agent':'room-rental-platform/1.0'}});revData=await direct.json();}catch(directErr){console.warn('Direct nominatim failed',directErr);}}if((_revData=revData)!==null&&_revData!==void 0&&_revData.address){const addr=revData.address;const houseNumber=addr.house_number||'';const road=addr.road||addr.street||'';const suburb=addr.suburb||addr.neighbourhood||'';const street=[houseNumber,road].filter(Boolean).join(' ').trim()||suburb;const area=formatAreaFromAddress(addr)||suburb;if(street||area){reverseGeocodeCacheRef.current[cacheKey]={streetAddress:street,location:area,ts:Date.now()};try{localStorage.setItem('reverse-geocode-cache',JSON.stringify(reverseGeocodeCacheRef.current));}catch(_unused14){}return{streetAddress:street,location:area,source:'nominatim'};}}}catch(e){console.error('Reverse geocode error:',e);}return null;// Failed to geocode\n};// Forward geocode helper for manual address lookups\nconst forwardGeocodeAddress=async query=>{if(!query||query.trim().length<3)return[];// 1. Mapbox (if configured)\nif(GEOCODER_PROVIDER==='mapbox'&&GEOCODER_KEY){try{var _data$features;const resp=await fetch(\"https://api.mapbox.com/geocoding/v5/mapbox.places/\".concat(encodeURIComponent(query),\".json?access_token=\").concat(GEOCODER_KEY,\"&limit=3&country=za&types=address,place,locality\"));const data=await resp.json();if(data!==null&&data!==void 0&&(_data$features=data.features)!==null&&_data$features!==void 0&&_data$features.length){return data.features.map(f=>{var _f$geometry,_f$geometry$coordinat,_f$geometry2,_f$geometry2$coordina;return{lat:f.center?f.center[1]:(_f$geometry=f.geometry)===null||_f$geometry===void 0?void 0:(_f$geometry$coordinat=_f$geometry.coordinates)===null||_f$geometry$coordinat===void 0?void 0:_f$geometry$coordinat[1],lon:f.center?f.center[0]:(_f$geometry2=f.geometry)===null||_f$geometry2===void 0?void 0:(_f$geometry2$coordina=_f$geometry2.coordinates)===null||_f$geometry2$coordina===void 0?void 0:_f$geometry2$coordina[0],label:f.place_name||f.text,source:'mapbox'};}).filter(entry=>typeof entry.lat==='number'&&typeof entry.lon==='number');}}catch(err){console.warn('Mapbox forward geocode failed',err);}}// 2. maps.co (CORS-friendly)\ntry{const mapsResp=await fetch(\"https://geocode.maps.co/search?q=\".concat(encodeURIComponent(query),\"&limit=3\"));if(mapsResp.ok){const mapsData=await mapsResp.json();if(Array.isArray(mapsData)&&mapsData.length){return mapsData.slice(0,3).map(entry=>({lat:parseFloat(entry.lat),lon:parseFloat(entry.lon),label:entry.display_name||entry.name,source:'maps.co'}));}}}catch(mapsErr){console.warn('maps.co forward geocode failed',mapsErr);}// 3. Local proxy (if running)\nconst API_BASE=process.env.REACT_APP_PROXY_BASE||(window.location&&window.location.port==='8443'?'https://localhost:4443':'');if(API_BASE){try{const proxyResp=await fetch(\"\".concat(API_BASE,\"/api/search?q=\").concat(encodeURIComponent(query)));if(proxyResp.ok){const proxyData=await proxyResp.json();if(Array.isArray(proxyData)&&proxyData.length){return proxyData.slice(0,3).map(entry=>({lat:parseFloat(entry.lat),lon:parseFloat(entry.lon),label:entry.display_name,source:API_BASE.includes('localhost')?'local-proxy':'proxy'}));}}}catch(proxyErr){console.warn('Local proxy forward geocode failed',proxyErr);}}// 4. Direct Nominatim fallback (may still be blocked, but last resort)\ntry{const directResp=await fetchWithCorsFallback(\"https://nominatim.openstreetmap.org/search?format=json&addressdetails=1&q=\".concat(encodeURIComponent(query)),{headers:{'User-Agent':'room-rental-platform/1.0 (direct fallback)','Accept':'application/json'}});if(directResp.ok){const directData=await directResp.json();if(Array.isArray(directData)&&directData.length){return directData.slice(0,3).map(entry=>({lat:parseFloat(entry.lat),lon:parseFloat(entry.lon),label:entry.display_name,source:'direct'}));}}}catch(directErr){console.warn('Direct nominatim forward geocode failed',directErr);}return[];};const availableAmenities=['WiFi','Parking','Kitchen','Laundry','Air Conditioning','Heating','TV','Furnished','Pet Friendly','Garden'];const validateField=(name,value)=>{const newErrors=_objectSpread({},errors);switch(name){case'title':if(!value||value.trim().length<5){newErrors.title='Title must be at least 5 characters';}else{delete newErrors.title;}break;case'price':if(!value||parseFloat(value)<=0){newErrors.price='Price must be greater than 0';}else if(parseFloat(value)<500){newErrors.price='Price seems too low (minimum R500)';}else if(parseFloat(value)>50000){newErrors.price='Price seems too high (maximum R50,000)';}else{delete newErrors.price;}break;case'location':if(!value||value.trim().length<3){newErrors.location='Location is required (min 3 characters)';}else{delete newErrors.location;}break;case'description':if(value&&value.length>500){newErrors.description='Description is too long (max 500 characters)';}else{delete newErrors.description;}break;default:break;}setErrors(newErrors);};// Debounced provider-aware suggestions (Mapbox/Nominatim) with caching & bias\nuseEffect(()=>{const raw=(formData.location||'').trim();if(raw.length<3){setLocationSuggestions([]);setLocationSuggestionsLoading(false);return;}const qLower=raw.toLowerCase();const cached=locationSuggestionCacheRef.current[qLower];if(cached&&Date.now()-cached.ts<LOCATION_SUGGESTION_TTL_MS){setLocationSuggestions(cached.data);return;}const controller=new AbortController();setLocationSuggestionsLoading(true);const t=setTimeout(async()=>{try{let suggestions=[];if(GEOCODER_PROVIDER==='mapbox'&&GEOCODER_KEY){const proximity=formData.latitude&&formData.longitude?\"&proximity=\".concat(formData.longitude,\",\").concat(formData.latitude):'';const url=\"https://api.mapbox.com/geocoding/v5/mapbox.places/\".concat(encodeURIComponent(raw),\".json?access_token=\").concat(GEOCODER_KEY,\"&limit=5&country=ZA&language=en\").concat(proximity,\"&types=place,locality,neighborhood\");const resp=await fetch(url,{signal:controller.signal});const data=await resp.json();if(data&&Array.isArray(data.features)){suggestions=data.features.map(f=>f.place_name).filter(Boolean);}}else{// Use local proxy when available, otherwise fall back to direct fetch with CORS helpers.\nconst API_BASE=process.env.REACT_APP_PROXY_BASE||(window.location&&window.location.port==='8443'?'http://localhost:4000':'');const query=\"\".concat(raw,\", South Africa\");// country hint for specificity\nlet data=[];try{if(API_BASE){const resp=await fetch(\"\".concat(API_BASE,\"/api/search?q=\").concat(encodeURIComponent(query)),{signal:controller.signal});data=await resp.json();}else{const searchUrl=\"https://nominatim.openstreetmap.org/search?format=json&limit=5&addressdetails=1&q=\".concat(encodeURIComponent(query));const resp=await fetchWithCorsFallback(searchUrl,{signal:controller.signal,headers:{'Accept':'application/json'}});data=await resp.json();}}catch(proxyErr){console.warn('Search proxy failed, using CORS fallback',proxyErr);if(!API_BASE)throw proxyErr;try{const searchUrl=\"https://nominatim.openstreetmap.org/search?format=json&limit=5&addressdetails=1&q=\".concat(encodeURIComponent(query));const resp=await fetchWithCorsFallback(searchUrl,{signal:controller.signal,headers:{'Accept':'application/json'}});data=await resp.json();}catch(directErr){console.error('Nominatim search failed',directErr);data=[];}}if(Array.isArray(data)){const uniq=[];data.forEach(item=>{const display=item.display_name||'';const parts=display.split(',').map(p=>p.trim());// Construct concise area: first two parts (e.g., Suburb, City or City, Province)\nconst area=parts.slice(0,2).join(', ');if(area&&!uniq.includes(area))uniq.push(area);});suggestions=uniq.slice(0,5);}}locationSuggestionCacheRef.current[qLower]={data:suggestions,ts:Date.now()};setLocationSuggestions(suggestions);}catch(e){setLocationSuggestions([]);}finally{setLocationSuggestionsLoading(false);}},500);return()=>{clearTimeout(t);controller.abort();};},[formData.location,formData.latitude,formData.longitude,GEOCODER_PROVIDER,GEOCODER_KEY,LOCATION_SUGGESTION_TTL_MS,fetchWithCorsFallback]);// Load persisted reverse geocode cache\nuseEffect(()=>{try{const raw=localStorage.getItem('reverse-geocode-cache');if(raw){const parsed=JSON.parse(raw);if(parsed&&typeof parsed==='object'){reverseGeocodeCacheRef.current=parsed;}}}catch(e){/* ignore */}},[]);// Geocode address using Nominatim (OpenStreetMap)\n// Use browser geolocation and reverse-geocode to fill address/coords\n// Helper: format city + province (South Africa) removing verbose municipality suffixes\nconst formatAreaFromAddress=addr=>{if(!addr)return'';const cleanMunicipality=val=>{if(!val)return'';return val.replace(/ City of /i,'').replace(/ (Metropolitan|Local|District) Municipality$/i,'').trim();};// Prioritize suburb/neighborhood first as it's most specific\nlet suburb=addr.suburb||addr.neighbourhood||'';let city=addr.city||addr.town||addr.village||addr.hamlet||'';let municipality=cleanMunicipality(addr.municipality||'');city=cleanMunicipality(city);// Use suburb if available, otherwise fall back to city, then municipality\nlet primaryArea=suburb||city||municipality;const province=addr.state||'';// Avoid duplication like \"Johannesburg, Johannesburg\"\nif(province&&primaryArea&&province.toLowerCase()===primaryArea.toLowerCase()){return primaryArea;}if(primaryArea&&province)return\"\".concat(primaryArea,\", \").concat(province);return primaryArea||province||'';};const formatBigDataCloudAddress=data=>{var _data$localityInfo,_data$localityInfo2;if(!data)return{streetAddress:'',location:''};const informative=((_data$localityInfo=data.localityInfo)===null||_data$localityInfo===void 0?void 0:_data$localityInfo.informative)||[];const admin=((_data$localityInfo2=data.localityInfo)===null||_data$localityInfo2===void 0?void 0:_data$localityInfo2.administrative)||[];const streetCandidate=informative.find(entry=>/road|street|route|drive|avenue|lane|close|crescent/i.test(entry.description||entry.name||''))||informative.find(entry=>/residential|locality/i.test(entry.description||''));const suburbCandidate=admin.find(entry=>entry.order===5)||admin.find(entry=>/suburb|township|neighbourhood/i.test(entry.description||''));const cityCandidate=admin.find(entry=>entry.order===6)||admin.find(entry=>/city|town/i.test(entry.description||''));const streetAddress=(streetCandidate===null||streetCandidate===void 0?void 0:streetCandidate.name)||'';const areaParts=[(suburbCandidate===null||suburbCandidate===void 0?void 0:suburbCandidate.name)||data.locality||data.city||'',data.principalSubdivision||(cityCandidate===null||cityCandidate===void 0?void 0:cityCandidate.name)||''].filter(Boolean);return{streetAddress,location:areaParts.filter((val,idx,arr)=>val&&arr.indexOf(val)===idx).join(', ')};};// (Cache ref declared earlier in component; duplicate removed)\nconst geolocateCurrentPosition=()=>{const insecure=typeof window!=='undefined'&&!window.isSecureContext&&window.location.hostname!=='localhost';if(insecure){setGecodingStatus('Location is blocked on HTTP. Use HTTPS to enable.');setLocationHelpBanner('Your browser requires HTTPS to access GPS on mobile. Use the HTTPS link below.');return;}if(!navigator.geolocation){setGecodingStatus('Geolocation not supported by your browser');setLocationHelpBanner('Location is disabled. Tap for steps to enable.');return;}setGecodingStatus('Getting your precise location...');navigator.geolocation.getCurrentPosition(async pos=>{const lat=pos.coords.latitude;const lon=pos.coords.longitude;const accuracy=pos.coords.accuracy;console.log(\"Location obtained: \".concat(lat,\", \").concat(lon,\" (accuracy: \").concat(accuracy,\"m)\"));try{const geocodeResult=await reverseGeocodeCoords(lat,lon);if(geocodeResult){setFormData(prev=>_objectSpread(_objectSpread({},prev),{},{streetAddress:geocodeResult.streetAddress||prev.streetAddress,location:geocodeResult.location||prev.location,latitude:lat,longitude:lon}));setGecodingStatus(\"\\u2713 Location set (\".concat(accuracy.toFixed(0),\"m accuracy)\"));setTimeout(()=>setGecodingStatus(''),3000);setLastGeocodeSource(geocodeResult.source||'manual-geocode');return;}}catch(e){console.error('Reverse geocode failed',e);}// Only use coordinate placeholders if reverse geocoding completely failed\nsetFormData(prev=>_objectSpread(_objectSpread({},prev),{},{latitude:lat,longitude:lon}));setGecodingStatus(\"\\u2713 Coordinates captured (\".concat(accuracy.toFixed(0),\"m accuracy). Add the street or suburb manually while we reconnect to the address service.\"));setTimeout(()=>setGecodingStatus(''),3000);setLastGeocodeSource('coords-only');},err=>{console.error('Geolocation error',err);if(err&&err.code===1){// PERMISSION_DENIED\nsetGecodingStatus('Permission denied. Allow location access to continue.');setLocationHelpBanner('Tap the lock icon in the address bar and set Location to Allow, then refresh.');}else if(err&&err.code===2){// POSITION_UNAVAILABLE\nsetGecodingStatus('Position unavailable. Check GPS and network, then retry.');}else if(err&&err.code===3){// TIMEOUT\nsetGecodingStatus('Location timed out. Move to open area or retry.');}else{setGecodingStatus('Could not get your location - '+((err===null||err===void 0?void 0:err.message)||'Unknown error'));}setLocationHelpBanner('Location permission denied. Tap here for steps to enable.');setLastGeocodeSource(null);},{enableHighAccuracy:true,timeout:15000,maximumAge:0});};const geocodeAddress=async()=>{if(!formData.streetAddress){setGecodingStatus('Please enter a street address');return;}setGecodingStatus('Finding coordinates...');try{const fullAddress=\"\".concat(formData.streetAddress,\", \").concat(formData.location,\", South Africa\");const results=await forwardGeocodeAddress(fullAddress);if(results.length>0){const best=results[0];setFormData(_objectSpread(_objectSpread({},formData),{},{latitude:parseFloat(best.lat),longitude:parseFloat(best.lon)}));setGecodingStatus(\"\\u2713 Address found!\");setTimeout(()=>setGecodingStatus(''),2000);setLastGeocodeSource(best.source||'manual-geocode');return;}setGecodingStatus('Address not found. Trying with area only...');const areaResults=await forwardGeocodeAddress(\"\".concat(formData.location,\", South Africa\"));if(areaResults.length>0){const bestArea=areaResults[0];setFormData(_objectSpread(_objectSpread({},formData),{},{latitude:parseFloat(bestArea.lat),longitude:parseFloat(bestArea.lon)}));setGecodingStatus(' Area found!');setTimeout(()=>setGecodingStatus(''),2000);setLastGeocodeSource(bestArea.source||'manual-geocode');}else{setGecodingStatus('Could not find location');}}catch(error){console.error('Geocoding error:',error);setGecodingStatus('Error finding address. Check your connection.');setLastGeocodeSource(null);}};// Draggable preview marker component for Add Listing\nfunction DraggablePreview(_ref7){let{lat,lng}=_ref7;const[pos,setPos]=useState(lat&&lng?{lat,lng}:null);const[isDragging,setIsDragging]=useState(false);const[viewState,setViewState]=useState({latitude:lat!==null&&lat!==void 0?lat:DEFAULT_PREVIEW_CENTER.lat,longitude:lng!==null&&lng!==void 0?lng:DEFAULT_PREVIEW_CENTER.lon,zoom:15,bearing:0,pitch:0});useEffect(()=>{if(lat&&lng){setPos({lat,lng});setViewState(prev=>_objectSpread(_objectSpread({},prev),{},{latitude:lat,longitude:lng}));}},[lat,lng]);const handleDragEnd=async event=>{const lngLat=event===null||event===void 0?void 0:event.lngLat;if(!lngLat)return;const next={lat:lngLat.lat,lng:lngLat.lng};setPos(next);setIsDragging(false);setViewState(prev=>_objectSpread(_objectSpread({},prev),{},{latitude:next.lat,longitude:next.lng}));setFormData(prev=>_objectSpread(_objectSpread({},prev),{},{latitude:next.lat,longitude:next.lng}));setIsReverseGeocoding(true);setGecodingStatus(' Finding address...');try{const result=await reverseGeocodeCoords(next.lat,next.lng);if(result){setFormData(prev=>_objectSpread(_objectSpread({},prev),{},{latitude:next.lat,longitude:next.lng,streetAddress:result.streetAddress||prev.streetAddress,location:result.location||prev.location}));setGecodingStatus(\"\\u2713 Location updated: \".concat(result.location||'Address found'));setLastGeocodeSource(result.source);}else{setGecodingStatus(' Could not find address for this location');}}catch(err){console.error('Drag geocode failed:',err);setGecodingStatus(' Address lookup failed');}finally{setIsReverseGeocoding(false);setTimeout(()=>setGecodingStatus(''),3000);}};if(!pos){return/*#__PURE__*/_jsx(\"div\",{className:\"w-full h-48 rounded-lg bg-gray-100 flex items-center justify-center text-sm text-gray-500 border border-dashed border-gray-300\",children:\"Set an address to drop a pin on the map\"});}return/*#__PURE__*/_jsxs(\"div\",{className:\"relative\",children:[/*#__PURE__*/_jsx(Map,_objectSpread(_objectSpread({mapLib:maplibregl,mapStyle:PREVIEW_MAP_STYLE},viewState),{},{onMove:evt=>setViewState(evt.viewState),attributionControl:false,style:{width:'100%',height:'12rem',borderRadius:'0.75rem'},children:/*#__PURE__*/_jsx(MapMarker,{latitude:pos.lat,longitude:pos.lng,draggable:true,onDragStart:()=>setIsDragging(true),onDragEnd:handleDragEnd,anchor:\"bottom\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"price-marker-container selected\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"price-marker-bubble text-xs\",children:/*#__PURE__*/_jsx(\"span\",{className:\"price-text\",children:\"Drag me\"})}),/*#__PURE__*/_jsx(\"div\",{className:\"price-marker-arrow\"})]})})})),!isDragging&&/*#__PURE__*/_jsxs(\"div\",{className:\"absolute bottom-2 left-1/2 -translate-x-1/2 bg-black/70 text-white text-xs px-3 py-1.5 rounded-full pointer-events-none flex items-center gap-1.5\",children:[/*#__PURE__*/_jsx(\"span\",{children:\"\\u270B\"}),\" Drag pin to adjust location\"]}),isDragging&&/*#__PURE__*/_jsx(\"div\",{className:\"absolute top-2 left-1/2 -translate-x-1/2 bg-teal-600 text-white text-xs px-3 py-1.5 rounded-full pointer-events-none animate-pulse\",children:\"\\uD83D\\uDCCD Drop to set new location\"})]});}// Compact inline map shown immediately after coordinates appear (quick visual confirmation)\nfunction InlineMiniMap(_ref8){let{lat,lng}=_ref8;if(typeof lat!=='number'||typeof lng!=='number')return null;return/*#__PURE__*/_jsx(\"div\",{className:\"mt-3 w-full border border-gray-200 rounded-lg overflow-hidden\",children:/*#__PURE__*/_jsx(Map,{mapLib:maplibregl,mapStyle:PREVIEW_MAP_STYLE,initialViewState:{latitude:lat,longitude:lng,zoom:15},style:{width:'100%',height:'10rem'},interactive:false,attributionControl:false,children:/*#__PURE__*/_jsx(MapMarker,{latitude:lat,longitude:lng,anchor:\"bottom\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"user-location-container\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"user-location-pulse\"}),/*#__PURE__*/_jsx(\"div\",{className:\"user-location-dot\"})]})})})});}const toggleAmenity=amenity=>{if(formData.amenities.includes(amenity)){setFormData(_objectSpread(_objectSpread({},formData),{},{amenities:formData.amenities.filter(a=>a!==amenity)}));}else{setFormData(_objectSpread(_objectSpread({},formData),{},{amenities:[...formData.amenities,amenity]}));}};const[isSubmitting,setIsSubmitting]=useState(false);const handleSubmit=async()=>{// Enforce auth and onboarding checks before allowing submission\nif(!currentUser){onRequireAuth&&onRequireAuth('landlord');return;}if(userType!=='landlord'){// prompt to become landlord\nonRequireAuth&&onRequireAuth('landlord');return;}if(!currentUser.landlordComplete){// send to onboarding\nonRequireOnboarding&&onRequireOnboarding();return;}// Validate all fields\nvalidateField('title',formData.title);validateField('price',formData.price);validateField('location',formData.location);validateField('description',formData.description);if(!formData.title||formData.title.trim().length<5){setErrors(prev=>_objectSpread(_objectSpread({},prev),{},{title:'Title must be at least 5 characters'}));return;}if(!formData.price||parseFloat(formData.price)<=0){setErrors(prev=>_objectSpread(_objectSpread({},prev),{},{price:'Price must be greater than 0'}));return;}if(!formData.location||formData.location.trim().length<3){setErrors(prev=>_objectSpread(_objectSpread({},prev),{},{location:'Location is required'}));return;}if(Object.keys(errors).length>0){return;}setIsSubmitting(true);try{await onSubmit(formData);}finally{setIsSubmitting(false);}};// Auto-attempt geolocation shortly after mount for landlord convenience\nuseEffect(()=>{const shouldAttempt=!formData.latitude&&!formData.longitude;if(shouldAttempt){const t=setTimeout(()=>{console.log('Auto-triggering current location detection...');geolocateCurrentPosition();},500);// Faster trigger\nreturn()=>clearTimeout(t);}// eslint-disable-next-line react-hooks/exhaustive-deps\n},[formData.latitude,formData.longitude]);return/*#__PURE__*/_jsx(\"div\",{className:\"p-4 bg-gray-50 min-h-screen pb-20\",children:/*#__PURE__*/_jsx(\"div\",{className:\"max-w-3xl mx-auto mt-8\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white rounded-lg shadow-sm border border-gray-200 p-8\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between mb-8\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\"text-3xl font-bold text-gray-800\",children:\"Post a Room\"}),/*#__PURE__*/_jsx(\"button\",{onClick:onCancel,className:\"text-gray-400 hover:text-gray-600 transition\",children:/*#__PURE__*/_jsx(X,{className:\"w-6 h-6\"})})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-6\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsxs(\"label\",{className:\"block text-sm font-semibold text-gray-800 mb-2\",children:[\"Room Title *\",formData.title&&formData.title.trim().length>=5&&!errors.title&&/*#__PURE__*/_jsx(\"span\",{className:\"ml-2 text-green-600 text-xs\",children:\"\\u2713 Looks good\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"relative\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"text\",required:true,value:formData.title,onChange:e=>{setFormData(_objectSpread(_objectSpread({},formData),{},{title:e.target.value}));validateField('title',e.target.value);},onBlur:e=>validateField('title',e.target.value),placeholder:\"e.g., Cozy backroom with private bathroom\",className:\"w-full px-4 py-3 pr-10 border \".concat(errors.title?'border-red-500 bg-red-50':formData.title&&formData.title.trim().length>=5?'border-green-500 bg-green-50':'border-gray-300',\" text-gray-800 rounded-lg focus:ring-2 \").concat(errors.title?'focus:ring-red-500':'focus:ring-blue-500',\" focus:border-transparent transition-all placeholder-gray-400\")}),formData.title&&formData.title.trim().length>=5&&!errors.title&&/*#__PURE__*/_jsx(CheckCircle,{className:\"absolute right-3 top-1/2 -translate-y-1/2 w-5 h-5 text-green-600\"})]}),errors.title&&/*#__PURE__*/_jsxs(\"p\",{className:\"text-red-500 text-xs mt-1 flex items-center gap-1\",children:[/*#__PURE__*/_jsx(\"span\",{children:\"\\u26A0\"}),\" \",errors.title]})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsxs(\"label\",{className:\"block text-sm font-semibold text-gray-800 mb-2\",children:[\"Monthly Price (R) *\",formData.price&&parseFloat(formData.price)>=500&&parseFloat(formData.price)<=50000&&!errors.price&&/*#__PURE__*/_jsx(\"span\",{className:\"ml-2 text-green-600 text-xs\",children:\"\\u2713 Valid price\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"relative\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"absolute left-4 top-1/2 -translate-y-1/2 text-gray-500 font-medium\",children:\"R\"}),/*#__PURE__*/_jsx(\"input\",{type:\"number\",required:true,value:formData.price,onChange:e=>{setFormData(_objectSpread(_objectSpread({},formData),{},{price:e.target.value}));validateField('price',e.target.value);},onBlur:e=>validateField('price',e.target.value),placeholder:\"2500\",min:\"500\",max:\"50000\",className:\"w-full pl-10 pr-4 py-3 border \".concat(errors.price?'border-red-500 bg-red-50':formData.price&&parseFloat(formData.price)>=500&&parseFloat(formData.price)<=50000?'border-green-500 bg-green-50':'border-gray-300',\" text-gray-800 rounded-lg focus:ring-2 \").concat(errors.price?'focus:ring-red-500':'focus:ring-blue-500',\" focus:border-transparent transition-all placeholder-gray-400\")}),formData.price&&parseFloat(formData.price)>=500&&parseFloat(formData.price)<=50000&&!errors.price&&/*#__PURE__*/_jsx(CheckCircle,{className:\"absolute right-3 top-1/2 -translate-y-1/2 w-5 h-5 text-green-600\"})]}),errors.price&&/*#__PURE__*/_jsxs(\"p\",{className:\"text-red-500 text-xs mt-1 flex items-center gap-1\",children:[/*#__PURE__*/_jsx(\"span\",{children:\"\\u26A0\"}),\" \",errors.price]}),!errors.price&&formData.price&&/*#__PURE__*/_jsx(\"p\",{className:\"text-gray-500 text-xs mt-1\",children:\"Suggested range: R500 - R50,000 per month\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"grid grid-cols-1 md:grid-cols-2 gap-4\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-semibold text-gray-800 mb-2\",children:\"Area / City *\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",required:true,value:formData.location,onChange:e=>{setFormData(_objectSpread(_objectSpread({},formData),{},{location:e.target.value}));validateField('location',e.target.value);},onBlur:e=>validateField('location',e.target.value),placeholder:\"e.g., Soweto, Johannesburg\",className:\"w-full px-4 py-3 border \".concat(errors.location?'border-red-500':'border-gray-300',\" bg-white text-gray-800 rounded-lg focus:ring-2 \").concat(errors.location?'focus:ring-red-500':'focus:ring-blue-500',\" focus:border-transparent transition placeholder-gray-400\")}),errors.location&&/*#__PURE__*/_jsx(\"p\",{className:\"text-red-500 text-xs mt-1\",children:errors.location}),locationSuggestionsLoading&&/*#__PURE__*/_jsx(\"p\",{className:\"text-xs text-blue-600 mt-1 animate-pulse\",\"aria-live\":\"polite\",children:\"Loading suggestions...\"}),locationSuggestions.length>0&&/*#__PURE__*/_jsx(\"div\",{className:\"mt-2 border border-gray-200 rounded-lg bg-white shadow-sm divide-y\",children:locationSuggestions.map(s=>/*#__PURE__*/_jsx(\"button\",{type:\"button\",onClick:()=>{setFormData(_objectSpread(_objectSpread({},formData),{},{location:s}));setLocationSuggestions([]);validateField('location',s);},className:\"w-full text-left px-3 py-2 text-sm hover:bg-blue-50\",children:s},s))})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-semibold text-gray-800 mb-2\",children:\"Street Address\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",value:formData.streetAddress,onChange:e=>setFormData(_objectSpread(_objectSpread({},formData),{},{streetAddress:e.target.value})),placeholder:\"e.g., 123 Main Street\",className:\"w-full px-4 py-3 border border-gray-300 bg-white text-gray-800 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition placeholder-gray-400\"})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"bg-gradient-to-br from-blue-50 to-indigo-50 border-2 border-blue-300 rounded-lg p-6\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-start gap-3 mb-4\",children:[/*#__PURE__*/_jsx(MapPin,{className:\"w-6 h-6 text-blue-600 flex-shrink-0 mt-1\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex-1\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"text-lg font-semibold text-gray-800 mb-1\",children:\"Set Your Precise Location\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-sm text-gray-600\",children:\"For best accuracy, use your current GPS location. The exact address will be automatically detected.\"})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex flex-wrap gap-3 items-center mb-4\",children:[locationHelpBanner&&/*#__PURE__*/_jsxs(\"div\",{className:\"w-full bg-yellow-50 border-2 border-yellow-200 text-yellow-800 rounded-lg p-3 text-sm flex items-start gap-2\",children:[/*#__PURE__*/_jsx(\"span\",{children:\"\\u26A0\\uFE0F\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex-1\",children:[locationHelpBanner,/*#__PURE__*/_jsx(\"button\",{type:\"button\",className:\"ml-2 underline font-semibold\",onClick:()=>window.alert('To enable location: 1) Tap the lock icon in the address bar. 2) Find Location permission. 3) Set to Allow. Then refresh the page.'),children:\"How to enable\"})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"w-full flex items-start gap-2 text-xs text-blue-800 bg-white border border-blue-300 rounded p-3\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"text-lg\",children:\"\\uD83D\\uDCA1\"}),/*#__PURE__*/_jsxs(\"span\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Recommended:\"}),\" Click \\\"Use Current Location\\\" for GPS accuracy (within meters). You can then drag the pin on the map to fine-tune if needed.\"]})]}),/*#__PURE__*/_jsxs(\"button\",{type:\"button\",onClick:geolocateCurrentPosition,className:\"w-full md:w-auto bg-gradient-to-r from-blue-600 to-indigo-600 hover:from-blue-700 hover:to-indigo-700 text-white px-8 py-3 rounded-lg font-bold transition shadow-md flex items-center justify-center gap-2 text-base\",children:[/*#__PURE__*/_jsx(MapPin,{className:\"w-5 h-5\"}),\"Use Current Location (Recommended)\"]}),/*#__PURE__*/_jsxs(\"button\",{type:\"button\",onClick:geocodeAddress,className:\"w-full md:w-auto bg-white hover:bg-gray-50 text-gray-700 border-2 border-gray-300 px-6 py-3 rounded-lg text-sm font-semibold transition flex items-center justify-center gap-2\",children:[/*#__PURE__*/_jsx(MapPin,{className:\"w-4 h-4\"}),\"Find Address on Map\"]}),/*#__PURE__*/_jsxs(\"div\",{className:\"text-sm flex-1\",children:[geocodingStatus&&/*#__PURE__*/_jsxs(\"span\",{className:\"\".concat(geocodingStatus.startsWith('')?'text-green-600 font-semibold':geocodingStatus.startsWith('')?'text-blue-600':geocodingStatus.startsWith('')?'text-amber-600':'text-gray-700',\" flex items-center gap-1\"),children:[geocodingStatus.startsWith('')&&/*#__PURE__*/_jsx(CheckCircle,{className:\"w-4 h-4\"}),isReverseGeocoding&&/*#__PURE__*/_jsx(Loader2,{className:\"w-4 h-4 animate-spin\"}),geocodingStatus,lastGeocodeSource==='cached'&&/*#__PURE__*/_jsx(\"span\",{className:\"ml-2 inline-block px-2 py-1 text-[10px] rounded bg-purple-100 text-purple-600 font-semibold\",children:\"CACHED\"}),lastGeocodeSource==='mapbox'&&/*#__PURE__*/_jsx(\"span\",{className:\"ml-2 inline-block px-2 py-1 text-[10px] rounded bg-blue-100 text-blue-600 font-semibold\",children:\"MAPBOX\"}),lastGeocodeSource==='maps.co'&&/*#__PURE__*/_jsx(\"span\",{className:\"ml-2 inline-block px-2 py-1 text-[10px] rounded bg-indigo-100 text-indigo-600 font-semibold\",children:\"MAPS.CO\"}),lastGeocodeSource==='proxy'&&/*#__PURE__*/_jsx(\"span\",{className:\"ml-2 inline-block px-2 py-1 text-[10px] rounded bg-green-100 text-green-600 font-semibold\",children:\"PROXY\"}),lastGeocodeSource==='direct'&&/*#__PURE__*/_jsx(\"span\",{className:\"ml-2 inline-block px-2 py-1 text-[10px] rounded bg-yellow-100 text-yellow-700 font-semibold\",children:\"FALLBACK\"}),lastGeocodeSource==='coords-only'&&/*#__PURE__*/_jsx(\"span\",{className:\"ml-2 inline-block px-2 py-1 text-[10px] rounded bg-red-100 text-red-600 font-semibold\",children:\"COORDS ONLY\"})]}),formData.latitude&&formData.longitude&&!geocodingStatus&&/*#__PURE__*/_jsxs(\"span\",{className:\"text-green-600 font-semibold flex items-center gap-1\",children:[/*#__PURE__*/_jsx(CheckCircle,{className:\"w-4 h-4\"}),\"Location set: \",formData.latitude.toFixed(4),\", \",formData.longitude.toFixed(4),lastGeocodeSource==='cached'&&/*#__PURE__*/_jsx(\"span\",{className:\"ml-2 inline-block px-2 py-1 text-[10px] rounded bg-purple-100 text-purple-600 font-semibold\",children:\"CACHED\"}),lastGeocodeSource==='maps.co'&&/*#__PURE__*/_jsx(\"span\",{className:\"ml-2 inline-block px-2 py-1 text-[10px] rounded bg-indigo-100 text-indigo-600 font-semibold\",children:\"MAPS.CO\"}),lastGeocodeSource==='coords-only'&&/*#__PURE__*/_jsx(\"span\",{className:\"ml-2 inline-block px-2 py-1 text-[10px] rounded bg-red-100 text-red-600 font-semibold\",children:\"COORDS ONLY\"})]}),lastGeocodeSource==='coords-only'&&/*#__PURE__*/_jsx(\"button\",{type:\"button\",onClick:geolocateCurrentPosition,className:\"mt-2 text-xs font-semibold underline text-blue-700\",children:\"Retry address lookup\"}),/*#__PURE__*/_jsx(InlineMiniMap,{lat:formData.latitude,lng:formData.longitude})]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"mt-4\",children:formData.latitude&&formData.longitude?/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-semibold text-gray-800 mb-2\",children:\"Fine-tune Location (drag pin)\"}),/*#__PURE__*/_jsx(DraggablePreview,{lat:formData.latitude,lng:formData.longitude})]}):/*#__PURE__*/_jsxs(\"div\",{className:\"text-sm text-gray-600 bg-white border border-gray-200 rounded-lg p-4 text-center\",children:[/*#__PURE__*/_jsx(MapPin,{className:\"w-8 h-8 mx-auto mb-2 text-gray-400\"}),\"No location set yet. Click \\\"Find on Map\\\" or \\\"Use Current Location\\\" to place a pin.\"]})})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"grid grid-cols-1 md:grid-cols-2 gap-4\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-semibold text-gray-800 mb-2\",children:\"Status\"}),/*#__PURE__*/_jsxs(\"select\",{value:formData.status,onChange:e=>setFormData(_objectSpread(_objectSpread({},formData),{},{status:e.target.value})),className:\"w-full px-4 py-3 border border-gray-300 bg-white text-gray-800 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition\",children:[/*#__PURE__*/_jsx(\"option\",{value:\"available\",children:\"Available\"}),/*#__PURE__*/_jsx(\"option\",{value:\"rented\",children:\"Rented\"})]})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-semibold text-gray-800 mb-2\",children:\"Available Date\"}),/*#__PURE__*/_jsx(\"input\",{type:\"date\",value:formData.availableDate,onChange:e=>setFormData(_objectSpread(_objectSpread({},formData),{},{availableDate:e.target.value})),className:\"w-full px-4 py-3 border border-gray-300 bg-white text-gray-800 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition\"})]})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-semibold text-gray-800 mb-2\",children:\"Payment Method\"}),/*#__PURE__*/_jsxs(\"select\",{value:formData.paymentMethod,onChange:e=>setFormData(_objectSpread(_objectSpread({},formData),{},{paymentMethod:e.target.value})),className:\"w-full px-4 py-3 border border-gray-300 bg-white text-gray-800 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition\",children:[/*#__PURE__*/_jsx(\"option\",{value:\"Bank and Cash\",children:\"Bank and Cash\"}),/*#__PURE__*/_jsx(\"option\",{value:\"Cash Only\",children:\"Cash Only\"}),/*#__PURE__*/_jsx(\"option\",{value:\"Bank Only\",children:\"Bank Only\"})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"grid grid-cols-1 md:grid-cols-2 gap-4\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-semibold text-gray-800 mb-2\",children:\"Room Type\"}),/*#__PURE__*/_jsxs(\"select\",{value:formData.roomType,onChange:e=>setFormData(_objectSpread(_objectSpread({},formData),{},{roomType:e.target.value})),className:\"w-full px-4 py-3 border border-gray-300 bg-white text-gray-800 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition\",children:[/*#__PURE__*/_jsx(\"option\",{value:\"private\",children:\"Private Room\"}),/*#__PURE__*/_jsx(\"option\",{value:\"shared\",children:\"Shared Room\"})]})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-semibold text-gray-800 mb-2\",children:\"Lease Duration (months)\"}),/*#__PURE__*/_jsxs(\"select\",{value:formData.leaseDuration,onChange:e=>setFormData(_objectSpread(_objectSpread({},formData),{},{leaseDuration:e.target.value})),className:\"w-full px-4 py-3 border border-gray-300 bg-white text-gray-800 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition\",children:[/*#__PURE__*/_jsx(\"option\",{value:\"1-3\",children:\"1-3 months\"}),/*#__PURE__*/_jsx(\"option\",{value:\"4-6\",children:\"4-6 months\"}),/*#__PURE__*/_jsx(\"option\",{value:\"7-12\",children:\"7-12 months\"}),/*#__PURE__*/_jsx(\"option\",{value:\"12+\",children:\"12+ months\"})]})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"grid grid-cols-1 md:grid-cols-2 gap-4\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center gap-3\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"checkbox\",checked:formData.petFriendly,onChange:e=>setFormData(_objectSpread(_objectSpread({},formData),{},{petFriendly:e.target.checked})),id:\"petFriendly\",className:\"w-4 h-4 text-blue-600 border-gray-300 rounded focus:ring-blue-500\"}),/*#__PURE__*/_jsx(\"label\",{htmlFor:\"petFriendly\",className:\"text-sm font-medium text-gray-700\",children:\"\\uD83D\\uDC3E Pet Friendly\"})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-semibold text-gray-800 mb-2\",children:\"Gender Preference\"}),/*#__PURE__*/_jsxs(\"select\",{value:formData.genderPreference,onChange:e=>setFormData(_objectSpread(_objectSpread({},formData),{},{genderPreference:e.target.value})),className:\"w-full px-4 py-3 border border-gray-300 bg-white text-gray-800 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition\",children:[/*#__PURE__*/_jsx(\"option\",{value:\"any\",children:\"Any\"}),/*#__PURE__*/_jsx(\"option\",{value:\"male\",children:\"Male Only\"}),/*#__PURE__*/_jsx(\"option\",{value:\"female\",children:\"Female Only\"})]})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center gap-3\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"checkbox\",checked:!!formData.premium,onChange:e=>setFormData(_objectSpread(_objectSpread({},formData),{},{premium:e.target.checked})),id:\"premiumFlag\"}),/*#__PURE__*/_jsx(\"label\",{htmlFor:\"premiumFlag\",className:\"text-sm font-medium text-gray-700\",children:\"Premium listing (highlight & priority sorting)\"})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsxs(\"label\",{className:\"block text-sm font-semibold text-gray-800 mb-2\",children:[\"Description\",formData.description&&/*#__PURE__*/_jsxs(\"span\",{className:\"ml-2 text-xs \".concat(formData.description.length>500?'text-red-500':'text-gray-500'),children:[\"(\",formData.description.length,\"/500 characters)\"]})]}),/*#__PURE__*/_jsx(\"textarea\",{value:formData.description,onChange:e=>{setFormData(_objectSpread(_objectSpread({},formData),{},{description:e.target.value}));validateField('description',e.target.value);},onBlur:e=>validateField('description',e.target.value),placeholder:\"Describe the room, amenities, rules, and any other details...\",rows:\"4\",className:\"w-full px-4 py-3 border \".concat(errors.description?'border-red-500':'border-gray-300',\" bg-white text-gray-800 rounded-lg focus:ring-2 \").concat(errors.description?'focus:ring-red-500':'focus:ring-blue-500',\" focus:border-transparent transition placeholder-gray-400\")}),errors.description&&/*#__PURE__*/_jsx(\"p\",{className:\"text-red-500 text-xs mt-1\",children:errors.description})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-semibold text-gray-800 mb-3\",children:\"Amenities\"}),/*#__PURE__*/_jsx(\"div\",{className:\"grid grid-cols-2 md:grid-cols-3 gap-2\",children:availableAmenities.map(amenity=>/*#__PURE__*/_jsx(\"button\",{type:\"button\",onClick:()=>toggleAmenity(amenity),className:\"px-4 py-2 rounded-lg text-sm font-medium transition \".concat(formData.amenities.includes(amenity)?'bg-blue-600 text-white shadow-sm':'bg-gray-100 text-gray-700 border border-gray-300 hover:bg-gray-200'),children:amenity},amenity))})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-semibold text-gray-800 mb-2\",children:\"Photos (Max 5)\"}),/*#__PURE__*/_jsx(\"div\",{className:\"flex gap-2\",children:/*#__PURE__*/_jsx(\"button\",{type:\"button\",onClick:()=>setShowPhotoEditor(true),className:\"flex-1 px-4 py-3 border-2 border-dashed border-gray-300 bg-gray-50 text-gray-700 rounded-lg hover:border-blue-500 hover:bg-blue-50 transition font-medium\",children:formData.photos.length===0?' Add Photos':\"\\u270F\\uFE0F Edit Photos (\".concat(formData.photos.length,\"/5)\")})}),formData.photos.length>0&&/*#__PURE__*/_jsx(\"div\",{className:\"mt-4 grid grid-cols-2 md:grid-cols-3 gap-3\",children:formData.photos.map((photo,index)=>/*#__PURE__*/_jsxs(\"div\",{className:\"relative group\",children:[index===0&&/*#__PURE__*/_jsx(\"div\",{className:\"absolute top-2 left-2 bg-blue-600 text-white text-xs px-2 py-1 rounded-full font-semibold z-10\",children:\"Cover\"}),/*#__PURE__*/_jsx(\"img\",{src:photo,alt:\"Preview \".concat(index+1),className:\"w-full h-32 object-cover rounded-lg border border-gray-200 shadow-sm\"})]},index))})]}),showPhotoEditor&&/*#__PURE__*/_jsx(PhotoEditor,{photos:formData.photos,onPhotosChange:newPhotos=>setFormData(_objectSpread(_objectSpread({},formData),{},{photos:newPhotos})),onClose:()=>setShowPhotoEditor(false),maxPhotos:5}),/*#__PURE__*/_jsxs(\"div\",{className:\"border-t border-gray-200 pt-6\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:handleSubmit,disabled:isSubmitting||Object.keys(errors).length>0,className:\"w-full font-semibold py-3 rounded-lg transition shadow-sm relative \".concat(isSubmitting||Object.keys(errors).length>0?'bg-gray-400 cursor-not-allowed':'bg-blue-600 hover:bg-blue-700 text-white'),children:isSubmitting?/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"span\",{className:\"opacity-0\",children:\"Post Room\"}),/*#__PURE__*/_jsx(\"div\",{className:\"absolute inset-0 flex items-center justify-center\",children:/*#__PURE__*/_jsx(\"div\",{className:\"w-5 h-5 border-2 border-white border-t-transparent rounded-full animate-spin\"})})]}):'Post Room'}),Object.keys(errors).length>0&&/*#__PURE__*/_jsx(\"p\",{className:\"text-red-500 text-xs mt-2 text-center\",children:\"Please fix the errors above before submitting\"})]})]})]})})});}// MessagesView removed - using direct contact instead\nfunction MyListingsView(_ref9){let{listings,onDelete}=_ref9;return/*#__PURE__*/_jsxs(\"div\",{className:\"p-4\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\"text-2xl font-bold mb-4 text-gray-800\",children:\"My Listings\"}),/*#__PURE__*/_jsx(\"div\",{className:\"space-y-4\",children:listings.length===0?/*#__PURE__*/_jsxs(\"div\",{className:\"bg-gradient-to-br from-blue-50 to-teal-50 rounded-xl shadow-sm p-12 text-center border border-blue-100\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"bg-white w-24 h-24 rounded-full flex items-center justify-center mx-auto mb-6 shadow-md\",children:/*#__PURE__*/_jsx(Home,{className:\"w-12 h-12 text-blue-500\"})}),/*#__PURE__*/_jsx(\"h3\",{className:\"text-xl font-bold text-gray-800 mb-2\",children:\"No Listings Yet\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-gray-600 mb-6 max-w-md mx-auto\",children:\"Start earning by posting your first room. It only takes a few minutes!\"}),/*#__PURE__*/_jsxs(\"button\",{onClick:()=>window.location.hash='#add',className:\"inline-flex items-center gap-2 bg-blue-600 hover:bg-blue-700 text-white font-semibold px-6 py-3 rounded-lg transition shadow-md hover:shadow-lg\",children:[/*#__PURE__*/_jsx(PlusCircle,{className:\"w-5 h-5\"}),\"Post Your First Room\"]})]}):listings.map(listing=>/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white rounded-lg shadow p-4\",children:[listing.photos&&listing.photos.length>0&&/*#__PURE__*/_jsxs(\"div\",{className:\"relative mb-3\",children:[/*#__PURE__*/_jsx(\"img\",{src:listing.photos[0],alt:\"Room\",className:\"w-full h-32 object-cover rounded-lg\"}),listing.photos.length>1&&/*#__PURE__*/_jsxs(\"div\",{className:\"absolute top-2 right-2 bg-black bg-opacity-60 text-white px-2 py-1 rounded text-xs\",children:[listing.photos.length,\" photos\"]})]}),/*#__PURE__*/_jsx(\"h3\",{className:\"font-bold text-lg mb-1\",children:listing.title}),/*#__PURE__*/_jsxs(\"div\",{className:\"text-blue-600 font-bold mb-2\",children:[\"R\",listing.price,\"/month\"]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center text-gray-600 text-sm mb-3\",children:[/*#__PURE__*/_jsx(MapPin,{className:\"w-4 h-4 mr-1\"}),listing.location]}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>onDelete(listing.id),className:\"w-full bg-red-500 hover:bg-red-600 text-white py-2 rounded-lg transition\",children:\"Delete Listing\"})]},listing.id))})]});}// Inline message box component with validation for listing detail view\n// ListingInlineMessageBox removed\n// ConversationModal removed\nfunction AuthModal(_ref0){let{defaultType='renter',onClose,onSubmit}=_ref0;const[form,setForm]=useState({name:'',phone:'',email:'',type:defaultType,photo:''});const[errors,setErrors]=useState({});const[isSubmitting,setIsSubmitting]=useState(false);const validateForm=()=>{const newErrors={};if(!form.name||form.name.trim().length<2){newErrors.name='Name must be at least 2 characters';}if(!form.email||!/^[^\\s@]+@[^\\s@]+\\.[^\\s@]+$/.test(form.email)){newErrors.email='Please enter a valid email address';}setErrors(newErrors);return Object.keys(newErrors).length===0;};const handleSubmit=async()=>{if(!validateForm())return;setIsSubmitting(true);try{await onSubmit(form);}finally{setIsSubmitting(false);}};return/*#__PURE__*/_jsx(\"div\",{className:\"fixed inset-0 bg-black/60 backdrop-blur-sm flex items-start sm:items-center justify-center p-4 pt-16 sm:pt-4 z-50 overflow-y-auto\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white rounded-2xl w-full max-w-md p-6 my-auto shadow-2xl fade-in\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between mb-6\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h3\",{className:\"text-xl font-bold text-gray-800\",children:\"Welcome to Room24\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-sm text-gray-500 mt-1\",children:\"Sign in or create an account\"})]}),/*#__PURE__*/_jsx(\"button\",{onClick:onClose,className:\"p-2 text-gray-400 hover:text-gray-600 hover:bg-gray-100 rounded-full transition\",children:/*#__PURE__*/_jsx(X,{className:\"w-5 h-5\"})})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-4\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-semibold text-gray-700 mb-1.5\",children:\"Full name *\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",value:form.name,onChange:e=>{setForm(_objectSpread(_objectSpread({},form),{},{name:e.target.value}));setErrors(_objectSpread(_objectSpread({},errors),{},{name:''}));},className:\"w-full px-4 py-2.5 border-2 rounded-lg transition-all focus:ring-2 focus:ring-blue-100 focus:border-blue-500 \".concat(errors.name?'border-red-400 bg-red-50':'border-gray-200 hover:border-gray-300'),placeholder:\"John Doe\"}),errors.name&&/*#__PURE__*/_jsx(\"p\",{className:\"text-red-500 text-xs mt-1\",children:errors.name})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-semibold text-gray-700 mb-1.5\",children:\"Email *\"}),/*#__PURE__*/_jsx(\"input\",{type:\"email\",value:form.email,onChange:e=>{setForm(_objectSpread(_objectSpread({},form),{},{email:e.target.value}));setErrors(_objectSpread(_objectSpread({},errors),{},{email:''}));},className:\"w-full px-4 py-2.5 border-2 rounded-lg transition-all focus:ring-2 focus:ring-blue-100 focus:border-blue-500 \".concat(errors.email?'border-red-400 bg-red-50':'border-gray-200 hover:border-gray-300'),placeholder:\"john@example.com\"}),errors.email&&/*#__PURE__*/_jsx(\"p\",{className:\"text-red-500 text-xs mt-1\",children:errors.email})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsxs(\"label\",{className:\"block text-sm font-semibold text-gray-700 mb-1.5\",children:[\"Phone \",/*#__PURE__*/_jsx(\"span\",{className:\"text-gray-400 font-normal\",children:\"(optional)\"})]}),/*#__PURE__*/_jsx(\"input\",{type:\"tel\",value:form.phone,onChange:e=>setForm(_objectSpread(_objectSpread({},form),{},{phone:e.target.value})),className:\"w-full px-4 py-2.5 border-2 border-gray-200 hover:border-gray-300 rounded-lg transition-all focus:ring-2 focus:ring-blue-100 focus:border-blue-500\",placeholder:\"+27 12 345 6789\"})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-semibold text-gray-700 mb-1.5\",children:\"I am a\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"grid grid-cols-2 gap-3\",children:[/*#__PURE__*/_jsxs(\"button\",{type:\"button\",onClick:()=>setForm(_objectSpread(_objectSpread({},form),{},{type:'renter'})),className:\"p-3 rounded-lg border-2 transition-all flex flex-col items-center gap-1 \".concat(form.type==='renter'?'border-blue-500 bg-blue-50 text-blue-700':'border-gray-200 hover:border-gray-300 text-gray-600'),children:[/*#__PURE__*/_jsx(Search,{className:\"w-5 h-5\"}),/*#__PURE__*/_jsx(\"span\",{className:\"text-sm font-medium\",children:\"Looking for a room\"})]}),/*#__PURE__*/_jsxs(\"button\",{type:\"button\",onClick:()=>setForm(_objectSpread(_objectSpread({},form),{},{type:'landlord'})),className:\"p-3 rounded-lg border-2 transition-all flex flex-col items-center gap-1 \".concat(form.type==='landlord'?'border-blue-500 bg-blue-50 text-blue-700':'border-gray-200 hover:border-gray-300 text-gray-600'),children:[/*#__PURE__*/_jsx(Home,{className:\"w-5 h-5\"}),/*#__PURE__*/_jsx(\"span\",{className:\"text-sm font-medium\",children:\"Listing rooms\"})]})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex gap-3 pt-4\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:onClose,className:\"flex-1 bg-gray-100 hover:bg-gray-200 text-gray-700 font-medium py-2.5 rounded-lg transition\",children:\"Cancel\"}),/*#__PURE__*/_jsx(\"button\",{onClick:handleSubmit,disabled:isSubmitting,className:\"flex-1 font-semibold py-2.5 rounded-lg transition-all relative \".concat(isSubmitting?'bg-blue-400 cursor-not-allowed':'bg-blue-600 hover:bg-blue-700 text-white hover:shadow-lg'),children:isSubmitting?/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"span\",{className:\"opacity-0\",children:\"Continue\"}),/*#__PURE__*/_jsx(\"div\",{className:\"absolute inset-0 flex items-center justify-center\",children:/*#__PURE__*/_jsx(\"div\",{className:\"w-5 h-5 border-2 border-white border-t-transparent rounded-full animate-spin\"})})]}):'Continue'})]})]}),/*#__PURE__*/_jsx(\"p\",{className:\"text-xs text-gray-400 text-center mt-6\",children:\"By continuing, you agree to our Terms of Service and Privacy Policy\"})]})});}function LocationConsentModal(_ref1){let{onAccept,onDecline}=_ref1;return/*#__PURE__*/_jsx(\"div\",{className:\"fixed inset-0 bg-black bg-opacity-60 flex items-center justify-center p-4 z-50\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white rounded-lg max-w-md w-full p-6 shadow-xl\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center gap-3 mb-4\",children:[/*#__PURE__*/_jsx(MapPin,{className:\"w-8 h-8 text-blue-600\"}),/*#__PURE__*/_jsx(\"h3\",{className:\"text-xl font-bold text-gray-800\",children:\"Location Access\"})]}),/*#__PURE__*/_jsx(\"p\",{className:\"text-gray-600 mb-4\",children:\"Room24 would like to access your location to show nearby rental listings. Your location data:\"}),/*#__PURE__*/_jsxs(\"ul\",{className:\"text-sm text-gray-600 mb-6 space-y-2\",children:[/*#__PURE__*/_jsxs(\"li\",{className:\"flex items-start gap-2\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"text-green-600 mt-0.5\",children:\"\\u2713\"}),/*#__PURE__*/_jsx(\"span\",{children:\"Is only used to calculate distances to listings\"})]}),/*#__PURE__*/_jsxs(\"li\",{className:\"flex items-start gap-2\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"text-green-600 mt-0.5\",children:\"\\u2713\"}),/*#__PURE__*/_jsx(\"span\",{children:\"Is not stored on our servers\"})]}),/*#__PURE__*/_jsxs(\"li\",{className:\"flex items-start gap-2\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"text-green-600 mt-0.5\",children:\"\\u2713\"}),/*#__PURE__*/_jsx(\"span\",{children:\"Is not shared with third parties\"})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex gap-3\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:onDecline,className:\"flex-1 bg-gray-100 hover:bg-gray-200 text-gray-800 font-semibold py-3 rounded-lg transition\",children:\"Not Now\"}),/*#__PURE__*/_jsx(\"button\",{onClick:onAccept,className:\"flex-1 bg-blue-600 hover:bg-blue-700 text-white font-semibold py-3 rounded-lg transition\",children:\"Allow\"})]}),/*#__PURE__*/_jsx(\"p\",{className:\"text-xs text-gray-500 mt-4 text-center\",children:\"You can change this permission anytime in your browser settings.\"})]})});}function BottomNav(_ref10){let{currentView,setCurrentView,userType}=_ref10;const navItems=[{id:'browse',label:'Browse',icon:/*#__PURE__*/_jsx(Search,{className:\"w-5 h-5\"})},{id:'add',label:'List Room',icon:/*#__PURE__*/_jsx(PlusCircle,{className:\"w-5 h-5\"}),requiresLandlord:true},{id:'my-rooms',label:'My Rooms',icon:/*#__PURE__*/_jsx(Home,{className:\"w-5 h-5\"})},{id:'profile',label:'Profile',icon:/*#__PURE__*/_jsx(User,{className:\"w-5 h-5\"})}];return/*#__PURE__*/_jsx(\"div\",{className:\"fixed bottom-0 left-0 right-0 bg-white border-t border-gray-200 px-4 py-2 z-20 md:hidden\",children:/*#__PURE__*/_jsx(\"div\",{className:\"grid grid-cols-4 gap-2\",children:navItems.map(item=>{const disabled=item.requiresLandlord&&userType!=='landlord';const isActive=currentView===item.id;return/*#__PURE__*/_jsxs(\"button\",{type:\"button\",disabled:disabled,onClick:()=>!disabled&&setCurrentView(item.id),className:\"flex flex-col items-center gap-1 py-1.5 rounded-xl transition-all \".concat(disabled?'opacity-40 cursor-not-allowed':'hover:text-blue-600',\" \").concat(isActive?'text-blue-600 font-semibold bg-blue-50':'text-gray-500'),children:[item.icon,/*#__PURE__*/_jsx(\"span\",{className:\"text-xs\",children:item.label})]},item.id);})})});}","map":{"version":3,"names":["React","useState","useEffect","useMemo","useCallback","initFirebase","initAnalytics","requestFcmToken","listenForegroundMessages","trackEvent","Home","PlusCircle","Search","MapPin","X","User","Phone","Mail","Edit","CheckCircle","Heart","Loader2","Map","Marker","MapMarker","maplibregl","Header","ListingDetailModal","Footer","BrowseView","PrivacyPolicyModal","NotificationBanner","AnalyticsConsentModal","NotificationsPanel","PhotoEditor","getNotifications","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","PREVIEW_MAP_STYLE","process","env","REACT_APP_PREVIEW_MAP_STYLE","DEFAULT_PREVIEW_CENTER","lat","lon","RentalPlatform","currentView","setCurrentView","mapView","setMapView","userType","setUserType","previewAsRenter","setPreviewAsRenter","listings","setListings","selectedListing","setSelectedListing","users","setUsers","searchLocation","setSearchLocation","priceRange","setPriceRange","selectedAmenities","setSelectedAmenities","sortBy","setSortBy","currentUser","setCurrentUser","showAuthModal","setShowAuthModal","authDefaultType","setAuthDefaultType","nearbyMode","setNearbyMode","nearbyRadius","setNearbyRadius","userLocation","setUserLocation","nearbyStatus","setNearbyStatus","showLocationConsent","setShowLocationConsent","toast","setToast","showPrivacyPolicy","setShowPrivacyPolicy","notificationBanner","setNotificationBanner","showAnalyticsConsent","setShowAnalyticsConsent","showNotificationsPanel","setShowNotificationsPanel","unreadCount","setUnreadCount","openAuthModal","type","arguments","length","undefined","updateUnreadCount","notifications","filter","n","read","interval","setInterval","clearInterval","loadData","app","analyticsConsent","localStorage","getItem","REACT_APP_ENABLE_ANALYTICS","setTimeout","token","console","log","e","warn","payload","notification","title","body","landlordComplete","listingsResult","userResult","usersResult","JSON","parse","user","parsed","Array","isArray","error","sampleListings","id","price","location","description","photos","status","availableDate","Date","toISOString","amenities","landlordId","landlordName","landlordPhone","landlordEmail","landlordPhoto","createdAt","isDuplicateContact","phone","email","ignoreId","normalizedPhone","trim","normalizedEmail","toLowerCase","some","u","uPhone","uEmail","phoneMatch","emailMatch","haversineDistance","lat1","lon1","lat2","lon2","toRad","v","Math","PI","R","dLat","dLon","a","sin","cos","c","atan2","sqrt","handleFindNearby","navigator","geolocation","handleLocationConsentAccept","getCurrentPosition","pos","coords","latitude","longitude","err","enableHighAccuracy","timeout","clearNearby","showToast","message","handleAnalyticsConsentAccept","setItem","handleAnalyticsConsentDecline","saveListings","newListings","stringify","serviceWorker","controller","postMessage","_unused","saveSubscriptions","subscriptions","getSubscriptions","res","subscribeToArea","userId","area","alert","subs","includes","push","concat","handleProfileSetup","profileData","now","_objectSpread","whatsapp","notificationPrefs","updates","marketing","existingUsersRaw","existingUsers","_unused2","_unused3","_unused4","handleUpdateProfile","updatedUser","_unused5","idx","findIndex","_unused6","_unused7","handleQuickAuth","name","photo","_unused8","handleSignOut","removeItem","handleCompleteOnboarding","onboardData","updated","landlordInfo","handleAddListing","listingData","_listingData$latitude","_listingData$longitud","newListing","paymentMethod","premium","updatedListings","window","scrollTo","top","behavior","filteredListings","map","listing","d","__distanceKm","matchesLocation","parseFloat","matchesPrice","matchesAmenities","every","amenity","_listing$amenities","passesNearby","_listing$__distanceKm","sort","b","_a$__distanceKm","_b$__distanceKm","da","Infinity","db","className","children","href","style","clipPath","zIndex","onOpenNotifications","role","onClose","onClick","ProfileSetupView","onSubmit","ProfileView","onEdit","onUpdatePrefs","prefs","raw","arr","_unused9","_unused0","EditProfileView","onCancel","LandlordOnboardingView","onComplete","onSelectListing","onRequireAuth","onFindNearby","previewMode","AddListingView","onRequireOnboarding","MyListingsView","l","onDelete","FavoritesView","landlord","AuthModal","defaultType","BottomNav","LocationConsentModal","onAccept","onDecline","listingId","find","onOpenPrivacy","_ref","formData","setFormData","errors","setErrors","touched","setTouched","validateField","value","newErrors","test","handlePhotoUpload","file","target","files","size","reader","FileReader","onloadend","result","readAsDataURL","handleSubmit","allTouched","Object","keys","src","alt","accept","onChange","required","onBlur","placeholder","_ref2","localPrefs","setLocalPrefs","togglePref","key","next","toLocaleDateString","checked","_ref3","form","setForm","businessName","bankDetails","idNumber","agree","charAt","preventDefault","_ref4","_ref5","favorites","setFavorites","rawFavorites","_unused1","toggleFavorite","prev","_unused10","favoriteListings","ListingCard","require","default","isFavorite","onToggleFavorite","_ref6","GEOCODER_KEY","REACT_APP_GEOCODER_API_KEY","GEOCODER_PROVIDER","REACT_APP_GEOCODER_PROVIDER","streetAddress","split","roomType","leaseDuration","petFriendly","genderPreference","geocodingStatus","setGecodingStatus","locationHelpBanner","setLocationHelpBanner","locationSuggestions","setLocationSuggestions","locationSuggestionsLoading","setLocationSuggestionsLoading","locationSuggestionCacheRef","useRef","LOCATION_SUGGESTION_TTL_MS","showPhotoEditor","setShowPhotoEditor","reverseGeocodeCacheRef","lastGeocodeSource","setLastGeocodeSource","isReverseGeocoding","setIsReverseGeocoding","corsFallbackTransforms","url","startsWith","encodeURIComponent","fetchWithCorsFallback","options","cloneOptions","base","headers","attempt","targetUrl","resp","fetch","ok","Error","_options$signal","signal","aborted","lastError","transform","proxiedUrl","proxyErr","_options$signal2","reverseGeocodeCoords","cacheKey","toFixed","cached","current","source","_revData","_revData$features","rev","revData","json","features","feature","address","streetName","text","fullStreet","context","place","locality","region","baseArea","province","replace","ts","_unused11","mapsCoResp","mapsCoData","addr","houseNumber","house_number","road","street","suburb","neighbourhood","Boolean","join","formatAreaFromAddress","_unused12","mapsCoErr","bdcResp","bdcData","formatted","formatBigDataCloudAddress","_unused13","bdcErr","API_BASE","REACT_APP_PROXY_BASE","port","direct","directErr","_unused14","forwardGeocodeAddress","query","_data$features","data","f","_f$geometry","_f$geometry$coordinat","_f$geometry2","_f$geometry2$coordina","center","geometry","coordinates","label","place_name","entry","mapsResp","mapsData","slice","display_name","mapsErr","proxyResp","proxyData","directResp","directData","availableAmenities","qLower","AbortController","t","suggestions","proximity","searchUrl","uniq","forEach","item","display","parts","p","clearTimeout","abort","cleanMunicipality","val","city","town","village","hamlet","municipality","primaryArea","state","_data$localityInfo","_data$localityInfo2","informative","localityInfo","admin","administrative","streetCandidate","suburbCandidate","order","cityCandidate","areaParts","principalSubdivision","indexOf","geolocateCurrentPosition","insecure","isSecureContext","hostname","accuracy","geocodeResult","code","maximumAge","geocodeAddress","fullAddress","results","best","areaResults","bestArea","DraggablePreview","_ref7","lng","setPos","isDragging","setIsDragging","viewState","setViewState","zoom","bearing","pitch","handleDragEnd","event","lngLat","mapLib","mapStyle","onMove","evt","attributionControl","width","height","borderRadius","draggable","onDragStart","onDragEnd","anchor","InlineMiniMap","_ref8","initialViewState","interactive","toggleAmenity","isSubmitting","setIsSubmitting","shouldAttempt","min","max","s","htmlFor","rows","index","onPhotosChange","newPhotos","maxPhotos","disabled","_ref9","hash","_ref0","validateForm","_ref1","_ref10","navItems","icon","requiresLandlord","isActive"],"sources":["C:/Users/kutum/Documents/room-rental-platform/src/App.js"],"sourcesContent":["import React, { useState, useEffect, useMemo, useCallback } from 'react';\nimport { initFirebase, initAnalytics, requestFcmToken, listenForegroundMessages, trackEvent } from './firebase';\nimport { Home, PlusCircle, Search, MapPin, X, User, Phone, Mail, Edit, CheckCircle, Heart, Loader2 } from 'lucide-react';\nimport Map, { Marker as MapMarker } from 'react-map-gl/maplibre';\nimport maplibregl from 'maplibre-gl';\nimport Header from './components/Header';\nimport ListingDetailModal from './components/ListingDetailModal';\nimport Footer from './components/Footer';\nimport BrowseView from './components/BrowseView';\nimport PrivacyPolicyModal from './components/PrivacyPolicyModal';\nimport NotificationBanner from './components/NotificationBanner';\nimport AnalyticsConsentModal from './components/AnalyticsConsentModal';\nimport NotificationsPanel from './components/NotificationsPanel';\nimport PhotoEditor from './components/PhotoEditor';\nimport { getNotifications } from './utils/notificationEngine';\n\nconst PREVIEW_MAP_STYLE = process.env.REACT_APP_PREVIEW_MAP_STYLE || 'https://basemaps.cartocdn.com/gl/positron-gl-style/style.json';\nconst DEFAULT_PREVIEW_CENTER = { lat: -26.2041, lon: 28.0473 };\nexport default function RentalPlatform() {\n  const [currentView, setCurrentView] = useState('browse');\n  const [mapView, setMapView] = useState(false);\n  const [userType, setUserType] = useState(null);\n  const [previewAsRenter, setPreviewAsRenter] = useState(false); // landlord UI preview toggle\n  const [listings, setListings] = useState([]);\n  const [selectedListing, setSelectedListing] = useState(null);\n  const [users, setUsers] = useState([]); // registry of all users (localStorage 'users')\n  const [searchLocation, setSearchLocation] = useState('');\n  const [priceRange, setPriceRange] = useState([0, 10000]);\n  const [selectedAmenities, setSelectedAmenities] = useState([]);\n  const [sortBy, setSortBy] = useState('newest');\n  const [currentUser, setCurrentUser] = useState(null);\n  const [showAuthModal, setShowAuthModal] = useState(false);\n  const [authDefaultType, setAuthDefaultType] = useState('renter');\n  const [nearbyMode, setNearbyMode] = useState(false);\n  const [nearbyRadius, setNearbyRadius] = useState(5); // km\n  const [userLocation, setUserLocation] = useState(null);\n  const [nearbyStatus, setNearbyStatus] = useState('');\n  const [showLocationConsent, setShowLocationConsent] = useState(false);\n  // Mobile menu state moved into Header component\n  const [toast, setToast] = useState(null);\n  const [showPrivacyPolicy, setShowPrivacyPolicy] = useState(false);\n  const [notificationBanner, setNotificationBanner] = useState(null);\n  const [showAnalyticsConsent, setShowAnalyticsConsent] = useState(false);\n  const [showNotificationsPanel, setShowNotificationsPanel] = useState(false);\n  const [unreadCount, setUnreadCount] = useState(0);\n\n  const openAuthModal = (type = 'renter') => {\n    setAuthDefaultType(type);\n    setShowAuthModal(true);\n  };\n\n  // Update unread notification count\n  useEffect(() => {\n    const updateUnreadCount = () => {\n      const notifications = getNotifications();\n      setUnreadCount(notifications.filter(n => !n.read).length);\n    };\n    updateUnreadCount();\n    const interval = setInterval(updateUnreadCount, 5000); // check every 5s\n    return () => clearInterval(interval);\n  }, []);\n  \n\n  useEffect(() => {\n    loadData();\n    // Initialize Firebase + FCM token fetch (deferred until user interaction if desired)\n    const app = initFirebase();\n    \n    // Check analytics consent and show modal if not set\n    const analyticsConsent = localStorage.getItem('analytics-consent');\n    if (!analyticsConsent && process.env.REACT_APP_ENABLE_ANALYTICS === 'true') {\n      // Delay modal slightly so UI loads first\n      setTimeout(() => setShowAnalyticsConsent(true), 2000);\n    } else if (analyticsConsent === 'yes') {\n      initAnalytics(app);\n    }\n\n    (async () => {\n      try {\n        const token = await requestFcmToken();\n        if (token) {\n          console.log('Obtained FCM token:', token);\n          trackEvent('fcm_token_obtained');\n        }\n      } catch (e) {\n        console.warn('FCM token request failed', e);\n      }\n    })();\n    \n    listenForegroundMessages((payload) => {\n      // Display notification banner instead of toast\n      const notification = payload?.notification || {};\n      if (notification.title || notification.body) {\n        setNotificationBanner({\n          title: notification.title,\n          body: notification.body\n        });\n        // Auto-dismiss after 8 seconds\n        setTimeout(() => setNotificationBanner(null), 8000);\n      }\n    });\n  }, []);\n\n  // Guard: if someone navigates to 'add' without landlord auth, prompt to sign in\n  useEffect(() => {\n    if (currentView === 'add') {\n      if (!currentUser) {\n        openAuthModal('landlord');\n        setCurrentView('browse');\n      } else if (userType !== 'landlord') {\n        // Not a landlord - prompt to become one\n        openAuthModal('landlord');\n        setCurrentView('browse');\n      } else if (!currentUser.landlordComplete) {\n        // Landlord but hasn't completed onboarding\n        setCurrentView('landlord-onboarding');\n      }\n    }\n  }, [currentView, currentUser, userType]);\n\n  const loadData = async () => {\n    try {\n      const listingsResult = localStorage.getItem('listings');\n      const userResult = localStorage.getItem('current-user');\n      const usersResult = localStorage.getItem('users');\n      \n      if (listingsResult) setListings(JSON.parse(listingsResult));\n      if (userResult) {\n        const user = JSON.parse(userResult);\n        setCurrentUser(user);\n        setUserType(user.type);\n      }\n      if (usersResult) {\n        try {\n          const parsed = JSON.parse(usersResult);\n          setUsers(Array.isArray(parsed) ? parsed : []);\n        } catch (e) {\n          console.warn('Corrupt users array in storage, resetting');\n          setUsers([]);\n        }\n      }\n    } catch (error) {\n      console.log('No existing data found, starting fresh');\n      // Add sample listings for testing the map\n      const sampleListings = [\n        {\n          id: 'listing-1',\n          title: 'Cozy Room in Soweto',\n          price: 2500,\n          location: 'Soweto, Johannesburg',\n          description: 'Comfortable room with bathroom and kitchen access',\n          photos: [],\n          status: 'available',\n          availableDate: new Date().toISOString(),\n          amenities: ['WiFi', 'Kitchen'],\n          landlordId: 'landlord-1',\n          landlordName: 'John Smith',\n          landlordPhone: '+27 123 456 7890',\n          landlordEmail: 'john@example.com',\n          landlordPhoto: '',\n          createdAt: new Date().toISOString()\n        },\n        {\n          id: 'listing-2',\n          title: 'Modern Apartment in Sandton',\n          price: 4500,\n          location: 'Sandton, Johannesburg',\n          description: 'Luxurious apartment with parking and security',\n          photos: [],\n          status: 'available',\n          availableDate: new Date().toISOString(),\n          amenities: ['WiFi', 'Parking', 'Air Conditioning'],\n          landlordId: 'landlord-2',\n          landlordName: 'Jane Doe',\n          landlordPhone: '+27 987 654 3210',\n          landlordEmail: 'jane@example.com',\n          landlordPhoto: '',\n          createdAt: new Date().toISOString()\n        },\n        {\n          id: 'listing-3',\n          title: 'Studio in Midrand',\n          price: 3200,\n          location: 'Midrand, Johannesburg',\n          description: 'Spacious studio flat with laundry facilities',\n          photos: [],\n          status: 'available',\n          availableDate: new Date().toISOString(),\n          amenities: ['Laundry', 'WiFi'],\n          landlordId: 'landlord-3',\n          landlordName: 'Mike Johnson',\n          landlordPhone: '+27 555 555 5555',\n          landlordEmail: 'mike@example.com',\n          landlordPhoto: '',\n          createdAt: new Date().toISOString()\n        }\n      ];\n      setListings(sampleListings);\n    }\n  };\n\n  // Helper: check for duplicate phone or email in registry (exclude an optional user id)\n  const isDuplicateContact = (phone, email, ignoreId = null) => {\n    const normalizedPhone = (phone || '').trim();\n    const normalizedEmail = (email || '').trim().toLowerCase();\n    if (!users || users.length === 0) return false;\n    return users.some(u => {\n      if (ignoreId && u.id === ignoreId) return false;\n      const uPhone = (u.phone || '').trim();\n      const uEmail = (u.email || '').trim().toLowerCase();\n      const phoneMatch = normalizedPhone && uPhone && uPhone === normalizedPhone;\n      const emailMatch = normalizedEmail && uEmail && uEmail === normalizedEmail;\n      return phoneMatch || emailMatch;\n    });\n  };\n\n  // Haversine formula to compute distance in kilometers between two coords\n  const haversineDistance = (lat1, lon1, lat2, lon2) => {\n    const toRad = (v) => (v * Math.PI) / 180;\n    const R = 6371; // km\n    const dLat = toRad(lat2 - lat1);\n    const dLon = toRad(lon2 - lon1);\n    const a = Math.sin(dLat / 2) * Math.sin(dLat / 2) + Math.cos(toRad(lat1)) * Math.cos(toRad(lat2)) * Math.sin(dLon / 2) * Math.sin(dLon / 2);\n    const c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1 - a));\n    return R * c;\n  };\n\n  const handleFindNearby = () => {\n    if (!navigator.geolocation) {\n      setNearbyStatus('Geolocation not supported');\n      return;\n    }\n    // Show consent modal before accessing location\n    setShowLocationConsent(true);\n  };\n\n  const handleLocationConsentAccept = () => {\n    setShowLocationConsent(false);\n    setNearbyStatus('Locating...');\n    navigator.geolocation.getCurrentPosition((pos) => {\n      const lat = pos.coords.latitude;\n      const lon = pos.coords.longitude;\n      setUserLocation({ lat, lon });\n      setNearbyMode(true);\n      setNearbyStatus('Nearby mode enabled');\n      setTimeout(() => setNearbyStatus(''), 2000);\n    }, (err) => {\n      console.error('Geolocation error', err);\n      setNearbyStatus('Could not get location');\n    }, { enableHighAccuracy: true, timeout: 10000 });\n  };\n\n  const clearNearby = () => {\n    setNearbyMode(false);\n    setUserLocation(null);\n    setNearbyStatus('');\n  };\n\n  // Toast notification helper\n  const showToast = (message, type = 'info', title = '') => {\n    setToast({ message, type, title });\n    setTimeout(() => setToast(null), 5000);\n  };\n\n  const handleAnalyticsConsentAccept = () => {\n    localStorage.setItem('analytics-consent', 'yes');\n    setShowAnalyticsConsent(false);\n    const app = initFirebase();\n    initAnalytics(app);\n    trackEvent('analytics_consent_granted');\n    showToast('Analytics enabled', 'success', 'Thank you!');\n  };\n\n  const handleAnalyticsConsentDecline = () => {\n    localStorage.setItem('analytics-consent', 'no');\n    setShowAnalyticsConsent(false);\n    showToast('Analytics disabled', 'info');\n  };\n\n  const saveListings = async (newListings) => {\n    try {\n      localStorage.setItem('listings', JSON.stringify(newListings));\n      setListings(newListings);\n      // Broadcast to runtime service worker for offline snapshot caching\n      if (navigator.serviceWorker && navigator.serviceWorker.controller) {\n        try { navigator.serviceWorker.controller.postMessage({ type: 'SYNC_LISTINGS', payload: newListings }); } catch {}\n      }\n    } catch (error) {\n      console.error('Error saving listings:', error);\n    }\n  };\n\n  const saveSubscriptions = async (subscriptions) => {\n    try {\n      localStorage.setItem('subscriptions', JSON.stringify(subscriptions));\n    } catch (error) {\n      console.error('Error saving subscriptions:', error);\n    }\n  };\n\n  const getSubscriptions = async () => {\n    try {\n      const res = localStorage.getItem('subscriptions');\n      return res ? JSON.parse(res) : {};\n    } catch (err) {\n      console.error('Error loading subscriptions', err);\n    }\n    return {};\n  };\n\n  const subscribeToArea = async (userId, area) => {\n    if (!userId) {\n      openAuthModal('renter');\n      return;\n    }\n    if (!area || area.trim() === '') {\n      alert('Please enter a location to subscribe to.');\n      return;\n    }\n    try {\n      const subs = await getSubscriptions();\n      subs[userId] = subs[userId] || [];\n      if (!subs[userId].includes(area)) {\n        subs[userId].push(area);\n        await saveSubscriptions(subs);\n        alert(`Subscribed to updates for ${area}`);\n      } else {\n        alert(`You are already subscribed to ${area}`);\n      }\n    } catch (err) {\n      console.error('Subscribe failed', err);\n      alert('Could not subscribe. Please try again.');\n    }\n  };\n\n  \n\nconst handleProfileSetup = async (profileData) => {\n  try {\n    // Duplicate guard\n    if (isDuplicateContact(profileData.phone, profileData.email)) {\n      showToast('Phone or email already registered', 'error', 'Duplicate');\n      return;\n    }\n    const userId = `user-${Date.now()}`;\n    const user = { \n      id: userId, \n      type: userType, \n      ...profileData,\n      whatsapp: profileData.whatsapp || '',\n      notificationPrefs: { updates: true, marketing: false },\n      createdAt: new Date().toISOString()\n    };\n    \n    localStorage.setItem('current-user', JSON.stringify(user));\n    setCurrentUser(user);\n    // Update users registry\n    const existingUsersRaw = localStorage.getItem('users');\n    let existingUsers = [];\n    if (existingUsersRaw) {\n      try { existingUsers = JSON.parse(existingUsersRaw); } catch { existingUsers = []; }\n    }\n    existingUsers.push(user);\n    localStorage.setItem('users', JSON.stringify(existingUsers));\n    setUsers(existingUsers);\n    showToast('Profile created successfully!', 'success', 'Welcome!');\n    setCurrentView('browse');\n  } catch (error) {\n    console.error('Error saving profile:', error);\n    // Still set the user locally even if storage fails\n    const userId = `user-${Date.now()}`;\n    const user = { \n      id: userId, \n      type: userType, \n      ...profileData,\n      whatsapp: profileData.whatsapp || '',\n      createdAt: new Date().toISOString()\n    };\n    setCurrentUser(user);\n    const existingUsersRaw = localStorage.getItem('users');\n    let existingUsers = [];\n    if (existingUsersRaw) {\n      try { existingUsers = JSON.parse(existingUsersRaw); } catch { existingUsers = []; }\n    }\n    existingUsers.push(user);\n    try { localStorage.setItem('users', JSON.stringify(existingUsers)); } catch {}\n    setUsers(existingUsers);\n    showToast('Profile created (data may not be persisted)', 'error');\n    setCurrentView('browse');\n  }\n};\n\nconst handleUpdateProfile = async (profileData) => {\n  try {\n    // Duplicate guard (exclude current user id)\n    if (isDuplicateContact(profileData.phone, profileData.email, currentUser?.id)) {\n      showToast('Phone or email already used by another account', 'error', 'Duplicate');\n      return;\n    }\n    const updatedUser = { ...currentUser, ...profileData };\n    \n    localStorage.setItem('current-user', JSON.stringify(updatedUser));\n    setCurrentUser(updatedUser);\n    // Update registry entry\n    const existingUsersRaw = localStorage.getItem('users');\n    let existingUsers = [];\n    if (existingUsersRaw) {\n      try { existingUsers = JSON.parse(existingUsersRaw); } catch { existingUsers = []; }\n    }\n    const idx = existingUsers.findIndex(u => u.id === updatedUser.id);\n    if (idx !== -1) {\n      existingUsers[idx] = updatedUser;\n    } else {\n      existingUsers.push(updatedUser); // ensure presence\n    }\n    localStorage.setItem('users', JSON.stringify(existingUsers));\n    setUsers(existingUsers);\n    showToast('Profile updated successfully!', 'success');\n    setCurrentView('browse');\n  } catch (error) {\n    console.error('Error updating profile:', error);\n    const updatedUser = { ...currentUser, ...profileData };\n    setCurrentUser(updatedUser);\n    const existingUsersRaw = localStorage.getItem('users');\n    let existingUsers = [];\n    if (existingUsersRaw) {\n      try { existingUsers = JSON.parse(existingUsersRaw); } catch { existingUsers = []; }\n    }\n    const idx = existingUsers.findIndex(u => u.id === updatedUser.id);\n    if (idx !== -1) {\n      existingUsers[idx] = updatedUser;\n    } else {\n      existingUsers.push(updatedUser);\n    }\n    try { localStorage.setItem('users', JSON.stringify(existingUsers)); } catch {}\n    setUsers(existingUsers);\n    showToast('Profile updated (data may not be persisted)', 'error');\n    setCurrentView('browse');\n  }\n};\n\nconst handleQuickAuth = async (profileData) => {\n  // Lightweight auth (used by AuthModal) - create and persist a user\n  try {\n    if (isDuplicateContact(profileData.phone, profileData.email)) {\n      showToast('Phone or email already registered', 'error', 'Duplicate');\n      return;\n    }\n    const userId = `user-${Date.now()}`;\n    const user = {\n      id: userId,\n      type: profileData.type || 'renter',\n      name: profileData.name,\n      phone: profileData.phone || '',\n      email: profileData.email || '',\n      photo: profileData.photo || '',\n      notificationPrefs: { updates: true, marketing: false },\n      createdAt: new Date().toISOString()\n    };\n    localStorage.setItem('current-user', JSON.stringify(user));\n    setCurrentUser(user);\n    setUserType(user.type);\n    // registry update\n    const existingUsersRaw = localStorage.getItem('users');\n    let existingUsers = [];\n    if (existingUsersRaw) {\n      try { existingUsers = JSON.parse(existingUsersRaw); } catch { existingUsers = []; }\n    }\n    existingUsers.push(user);\n    localStorage.setItem('users', JSON.stringify(existingUsers));\n    setUsers(existingUsers);\n    setShowAuthModal(false);\n    // If landlord, route to onboarding to complete setup before posting\n    if (user.type === 'landlord') {\n      setCurrentView('landlord-onboarding');\n    } else {\n      setCurrentView('browse');\n    }\n  } catch (err) {\n    console.error('Auth failed', err);\n  }\n};\n\n// Sign out helper so you can re-auth as renter for perspective preview\nconst handleSignOut = () => {\n  try {\n    localStorage.removeItem('current-user');\n  } catch (e) {\n    console.warn('Could not clear localStorage current-user');\n  }\n  setCurrentUser(null);\n  setUserType(null);\n  setCurrentView('browse');\n  showToast('Signed out. You can now sign in as Renter.', 'info');\n};\n\nconst handleCompleteOnboarding = async (onboardData) => {\n  try {\n    const updated = { ...currentUser, landlordComplete: true, landlordInfo: onboardData };\n    localStorage.setItem('current-user', JSON.stringify(updated));\n    setCurrentUser(updated);\n    setCurrentView('browse');\n  } catch (err) {\n    console.error('Onboarding save failed', err);\n    setCurrentUser({ ...currentUser, landlordComplete: true, landlordInfo: onboardData });\n    setCurrentView('browse');\n  }\n};\n\nconst handleAddListing = async (listingData) => {\n  const newListing = {\n    id: `listing-${Date.now()}`,\n    title: listingData.title,\n    price: listingData.price,\n    location: listingData.location,\n    description: listingData.description,\n    photos: listingData.photos || [],\n    status: listingData.status || 'available',\n    availableDate: listingData.availableDate || new Date().toISOString(),\n    amenities: listingData.amenities || [],\n    latitude: listingData.latitude ?? null,\n    longitude: listingData.longitude ?? null,\n      paymentMethod: listingData.paymentMethod || 'Bank and Cash',\n    premium: !!listingData.premium,\n    landlordId: currentUser.id,\n    landlordName: currentUser.name,\n    landlordPhone: currentUser.phone,\n    landlordEmail: currentUser.email,\n    landlordPhoto: currentUser.photo,\n    createdAt: new Date().toISOString()\n  };\n\n    const updatedListings = [...listings, newListing];\n    await saveListings(updatedListings);\n    showToast('Listing created successfully!', 'success', 'Success!');\n    setCurrentView('browse');\n    // Scroll to top to see new listing\n    window.scrollTo({ top: 0, behavior: 'smooth' });\n  };\n\n  // Messaging removed\n\nconst filteredListings = listings\n  .map(listing => {\n    // attach distance if we have userLocation\n    if (userLocation && listing.latitude != null && listing.longitude != null) {\n      const d = haversineDistance(userLocation.lat, userLocation.lon, listing.latitude, listing.longitude);\n      return { ...listing, __distanceKm: d };\n    }\n    if (userLocation && (listing.latitude == null || listing.longitude == null)) {\n      // try to geocode-less accurate: leave distance undefined\n      return { ...listing };\n    }\n    return { ...listing };\n  })\n  .filter(listing => {\n    const matchesLocation = !searchLocation || \n      (listing.location || '').toLowerCase().includes(searchLocation.toLowerCase());\n    const price = parseFloat(listing.price);\n    const matchesPrice = price >= priceRange[0] && price <= priceRange[1];\n    const matchesAmenities = selectedAmenities.length === 0 || \n      selectedAmenities.every(amenity => listing.amenities?.includes(amenity));\n\n    let passesNearby = true;\n    if (nearbyMode && userLocation) {\n      // require listing to have coordinates to be included\n      if (listing.latitude != null && listing.longitude != null) {\n        const d = listing.__distanceKm ?? haversineDistance(userLocation.lat, userLocation.lon, listing.latitude, listing.longitude);\n        passesNearby = d <= nearbyRadius;\n      } else {\n        passesNearby = false;\n      }\n    }\n\n    return matchesLocation && matchesPrice && matchesAmenities && passesNearby;\n  })\n  .sort((a, b) => {\n    if (a.premium && !b.premium) return -1;\n    if (!a.premium && b.premium) return 1;\n    if (nearbyMode && userLocation) {\n      const da = a.__distanceKm ?? Infinity;\n      const db = b.__distanceKm ?? Infinity;\n      return da - db;\n    }\n    if (sortBy === 'newest') {\n      return new Date(b.createdAt) - new Date(a.createdAt);\n    } else if (sortBy === 'cheapest') {\n      return parseFloat(a.price) - parseFloat(b.price);\n    } else if (sortBy === 'expensive') {\n      return parseFloat(b.price) - parseFloat(a.price);\n    }\n    return 0;\n  });\n\n  // Allow guests to land on Browse by default. If userType isn't set,\n  // show a gentle callout in the header (below) so users can pick a role\n  // when they want to post or set up their profile.\n\n  return (\n    <div className=\"min-h-screen bg-gray-50\">\n      {/* Accessibility: Skip link */}\n      <a href=\"#main-content\" className=\"absolute left-2 top-2 -translate-y-full focus:translate-y-0 transition bg-blue-600 text-white px-3 py-2 rounded shadow\" style={{clipPath: 'inset(0)', zIndex: 1000}}>Skip to main content</a>\n      <Header\n        currentUser={currentUser}\n        previewAsRenter={previewAsRenter}\n        setPreviewAsRenter={setPreviewAsRenter}\n        openAuthModal={openAuthModal}\n        handleSignOut={handleSignOut}\n        setCurrentView={setCurrentView}\n        unreadCount={unreadCount}\n        onOpenNotifications={() => setShowNotificationsPanel(true)}\n      />\n      {previewAsRenter && currentUser?.type === 'landlord' && (\n        <div className=\"bg-indigo-50 border-b border-indigo-200 text-indigo-700 text-xs py-1 text-center\" role=\"status\" aria-live=\"polite\">\n          Renter preview mode: interactions are read-only. Toggle off to resume landlord actions.\n        </div>\n      )}\n\n      {/* Notification Banner (Push Notifications) */}\n      {notificationBanner && (\n        <NotificationBanner\n          title={notificationBanner.title}\n          body={notificationBanner.body}\n          onClose={() => setNotificationBanner(null)}\n        />\n      )}\n\n      {/* Toast Notification */}\n      {toast && (\n        <div className={`fixed top-20 right-4 z-50 max-w-sm w-full transition-all duration-300 ${\n          toast.type === 'error' ? 'bg-red-50 border-red-400' :\n          toast.type === 'success' ? 'bg-green-50 border-green-400' :\n          toast.type === 'warning' ? 'bg-amber-50 border-amber-400' :\n          'bg-blue-50 border-blue-400'\n        } border-l-4 rounded-lg shadow-xl p-4 fade-in`}>\n          <div className=\"flex items-start gap-3\">\n            <div className={`flex-shrink-0 w-6 h-6 rounded-full flex items-center justify-center ${\n              toast.type === 'error' ? 'bg-red-100' :\n              toast.type === 'success' ? 'bg-green-100' :\n              toast.type === 'warning' ? 'bg-amber-100' :\n              'bg-blue-100'\n            }`}>\n              {toast.type === 'success' && <CheckCircle className=\"w-4 h-4 text-green-600\" />}\n              {toast.type === 'error' && <span className=\"text-red-600 font-bold text-sm\"></span>}\n              {toast.type === 'warning' && <span className=\"text-amber-600 font-bold text-sm\">!</span>}\n              {toast.type === 'info' && <span className=\"text-blue-600 font-bold text-sm\">i</span>}\n            </div>\n            <div className=\"flex-1\">\n              {toast.title && <p className={`font-semibold mb-1 ${\n                toast.type === 'error' ? 'text-red-800' :\n                toast.type === 'success' ? 'text-green-800' :\n                toast.type === 'warning' ? 'text-amber-800' :\n                'text-blue-800'\n              }`}>{toast.title}</p>}\n              <p className={`text-sm ${\n                toast.type === 'error' ? 'text-red-700' :\n                toast.type === 'success' ? 'text-green-700' :\n                toast.type === 'warning' ? 'text-amber-700' :\n                'text-blue-700'\n              }`}>{toast.message}</p>\n            </div>\n            <button \n              onClick={() => setToast(null)}\n              className={`flex-shrink-0 p-1 rounded hover:bg-gray-200 transition ${\n                toast.type === 'error' ? 'text-red-600' :\n                toast.type === 'success' ? 'text-green-600' :\n                toast.type === 'warning' ? 'text-amber-600' :\n                'text-blue-600'\n              }`}\n              aria-label=\"Close notification\"\n            >\n              <X className=\"w-4 h-4\" />\n            </button>\n          </div>\n        </div>\n      )}\n\n      <div id=\"main-content\" className=\"max-w-6xl mx-auto pb-20\" role=\"main\">\n        {currentView === 'setup-profile' && (\n          <ProfileSetupView onSubmit={handleProfileSetup} userType={userType} />\n        )}\n\n        {currentView === 'profile' && currentUser && (\n          <ProfileView \n            user={currentUser} \n            onEdit={() => setCurrentView('edit-profile')} \n            onUpdatePrefs={(prefs) => {\n              const updated = { ...currentUser, notificationPrefs: prefs };\n              setCurrentUser(updated);\n              try {\n                localStorage.setItem('current-user', JSON.stringify(updated));\n                // update registry\n                const raw = localStorage.getItem('users');\n                if (raw) {\n                  try {\n                    const arr = JSON.parse(raw);\n                    const idx = arr.findIndex(u => u.id === updated.id);\n                    if (idx !== -1) { arr[idx] = updated; localStorage.setItem('users', JSON.stringify(arr)); }\n                  } catch {}\n                }\n              } catch {}\n              showToast('Preferences updated', 'success');\n            }}\n          />\n        )}\n\n        {currentView === 'edit-profile' && currentUser && (\n          <EditProfileView user={currentUser} onSubmit={handleUpdateProfile} onCancel={() => setCurrentView('profile')} />\n        )}\n\n        {currentView === 'landlord-onboarding' && currentUser && userType === 'landlord' && (\n          <LandlordOnboardingView onComplete={handleCompleteOnboarding} onCancel={() => setCurrentView('browse')} currentUser={currentUser} />\n        )}\n\n        {currentView === 'browse' && (\n                    <BrowseView \n                      listings={filteredListings}\n                      searchLocation={searchLocation}\n                      setSearchLocation={setSearchLocation}\n                      priceRange={priceRange}\n                      setPriceRange={setPriceRange}\n                      selectedAmenities={selectedAmenities}\n                      setSelectedAmenities={setSelectedAmenities}\n                      sortBy={sortBy}\n                      setSortBy={setSortBy}\n                      mapView={mapView}\n                      setMapView={setMapView}\n                      onSelectListing={setSelectedListing}\n                      setCurrentView={setCurrentView}\n                      currentUser={currentUser}\n                      onRequireAuth={openAuthModal}\n                      subscribeToArea={subscribeToArea}\n                      onFindNearby={handleFindNearby}\n                      nearbyRadius={nearbyRadius}\n                      setNearbyRadius={setNearbyRadius}\n                      nearbyMode={nearbyMode}\n                      clearNearby={clearNearby}\n                      userLocation={userLocation}\n                      nearbyStatus={nearbyStatus}\n                      previewMode={previewAsRenter}\n                    />\n        )}\n\n        {/* Messages view removed */}\n\n        {currentView === 'add' && (\n          <AddListingView\n            onSubmit={handleAddListing}\n            onCancel={() => setCurrentView('browse')}\n            currentUser={currentUser}\n            userType={userType}\n            onRequireAuth={openAuthModal}\n            onRequireOnboarding={() => setCurrentView('landlord-onboarding')}\n          />\n        )}\n\n        {currentView === 'my-listings' && currentUser && userType === 'landlord' && (\n          <MyListingsView \n            listings={listings.filter(l => l.landlordId === currentUser.id)}\n            onDelete={async (id) => {\n              const updated = listings.filter(l => l.id !== id);\n              await saveListings(updated);\n            }}\n          />\n        )}\n\n        {currentView === 'favorites' && (\n          <FavoritesView\n            listings={listings}\n            onSelectListing={setSelectedListing}\n          />\n        )}\n      </div>\n\n      {selectedListing && (\n        <ListingDetailModal \n          listing={selectedListing}\n          landlord={{\n            name: selectedListing.landlordName,\n            phone: selectedListing.landlordPhone,\n            email: selectedListing.landlordEmail,\n            photo: selectedListing.landlordPhoto\n          }}\n          onClose={() => setSelectedListing(null)}\n          userType={userType}\n          currentUser={currentUser}\n          onRequireAuth={openAuthModal}\n          previewMode={previewAsRenter}\n          showToast={showToast}\n        />\n      )}\n\n      {/* Conversation modal removed */}\n\n      {showAuthModal && (\n        <AuthModal\n          defaultType={authDefaultType}\n          onClose={() => setShowAuthModal(false)}\n          onSubmit={handleQuickAuth}\n        />\n      )}\n\n      <BottomNav \n        currentView={currentView}\n        setCurrentView={setCurrentView}\n        userType={userType}\n      />\n\n      {showLocationConsent && (\n        <LocationConsentModal\n          onAccept={handleLocationConsentAccept}\n          onDecline={() => setShowLocationConsent(false)}\n        />\n      )}\n\n      {showPrivacyPolicy && (\n        <PrivacyPolicyModal onClose={() => setShowPrivacyPolicy(false)} />\n      )}\n\n      {showAnalyticsConsent && (\n        <AnalyticsConsentModal\n          onAccept={handleAnalyticsConsentAccept}\n          onDecline={handleAnalyticsConsentDecline}\n        />\n      )}\n\n      {showNotificationsPanel && (\n        <NotificationsPanel\n          onClose={() => {\n            setShowNotificationsPanel(false);\n            setUnreadCount(getNotifications().filter(n => !n.read).length);\n          }}\n          onSelectListing={(listingId) => {\n            const listing = listings.find(l => (l.id || `${l.title}-${l.createdAt}`) === listingId);\n            if (listing) {\n              setSelectedListing(listing);\n            }\n            setShowNotificationsPanel(false);\n          }}\n        />\n      )}\n\n      <Footer onOpenPrivacy={() => setShowPrivacyPolicy(true)} />\n    </div>\n  );\n}\n\n\n\nfunction ProfileSetupView({ onSubmit, userType }) {\n  const [formData, setFormData] = useState({\n    name: '',\n    phone: '',\n    email: '',\n    whatsapp: '',\n    photo: ''\n  });\n  const [errors, setErrors] = useState({});\n  const [touched, setTouched] = useState({});\n\n  const validateField = (name, value) => {\n    const newErrors = { ...errors };\n    switch (name) {\n      case 'name':\n        if (!value || value.trim().length < 2) {\n          newErrors.name = 'Name must be at least 2 characters';\n        } else {\n          delete newErrors.name;\n        }\n        break;\n      case 'phone':\n        if (!value || !/^[+]?[-0-9()\\s]{7,}$/.test(value.trim())) {\n          newErrors.phone = 'Enter a valid phone number (min 7 digits)';\n        } else {\n          delete newErrors.phone;\n        }\n        break;\n      case 'email':\n        if (!value || !/^[^@\\s]+@[^@\\s]+\\.[^@\\s]+$/.test(value.trim())) {\n          newErrors.email = 'Enter a valid email address';\n        } else {\n          delete newErrors.email;\n        }\n        break;\n      case 'photo':\n        if (value === 'FILE_TOO_LARGE') {\n          newErrors.photo = 'Photo is too large (max 2MB)';\n        } else {\n          delete newErrors.photo;\n        }\n        break;\n      default:\n        break;\n    }\n    setErrors(newErrors);\n  };\n\n  const handlePhotoUpload = (e) => {\n    const file = e.target.files[0];\n    if (file) {\n      if (file.size > 2 * 1024 * 1024) { // 2MB limit\n        setFormData({ ...formData, photo: '' });\n        validateField('photo', 'FILE_TOO_LARGE');\n        return;\n      }\n      const reader = new FileReader();\n      reader.onloadend = () => {\n        setFormData({ ...formData, photo: reader.result });\n        validateField('photo', reader.result);\n      };\n      reader.readAsDataURL(file);\n    }\n  };\n\n  const handleSubmit = () => {\n    // Touch all fields\n    const allTouched = { name: true, phone: true, email: true, photo: true };\n    setTouched(allTouched);\n    validateField('name', formData.name);\n    validateField('phone', formData.phone);\n    validateField('email', formData.email);\n    if (Object.keys(errors).length === 0 && formData.name && formData.phone && formData.email) {\n      onSubmit(formData);\n    }\n  };\n\n  return (\n    <div className=\"p-4 min-h-screen bg-gray-50 pb-20\">\n      <div className=\"max-w-2xl mx-auto mt-8\">\n        <div className=\"bg-white rounded-lg shadow-sm border border-gray-200 p-8\">\n          <div className=\"text-center mb-8\">\n            <h2 className=\"text-3xl font-bold text-gray-800 mb-2\">Complete Your Profile</h2>\n            <p className=\"text-gray-600\">Help others know who you are</p>\n          </div>\n\n          <div className=\"space-y-6\">\n            {/* Photo Upload */}\n            <div className=\"flex justify-center mb-8\">\n              <div className=\"relative\">\n                {formData.photo ? (\n                  <img \n                    src={formData.photo} \n                    alt=\"Profile\" \n                    className=\"w-32 h-32 rounded-full object-cover border-4 border-blue-200 shadow-lg\" \n                  />\n                ) : (\n                  <div className=\"w-32 h-32 rounded-full bg-gradient-to-br from-blue-100 to-blue-200 flex items-center justify-center border-4 border-blue-200 shadow-lg\">\n                    <User className=\"w-16 h-16 text-blue-600\" />\n                  </div>\n                )}\n                <label className=\"absolute bottom-0 right-0 bg-blue-600 hover:bg-blue-700 text-white p-3 rounded-full cursor-pointer shadow-lg transition group\" aria-label=\"Upload profile photo\">\n                  <Edit className=\"w-5 h-5\" />\n                  <input\n                    type=\"file\"\n                    accept=\"image/*\"\n                    onChange={handlePhotoUpload}\n                    className=\"hidden\"\n                  />\n                </label>\n              </div>\n            </div>\n\n            {/* Form Fields */}\n            <div>\n              <label className=\"block text-sm font-semibold text-gray-800 mb-2\">Full Name *</label>\n              <input\n                type=\"text\"\n                required\n                value={formData.name}\n                onChange={(e) => { setFormData({ ...formData, name: e.target.value }); if (touched.name) validateField('name', e.target.value); }}\n                onBlur={(e) => { setTouched({ ...touched, name: true }); validateField('name', e.target.value); }}\n                placeholder=\"Enter your full name\"\n                aria-invalid={errors.name ? 'true' : 'false'}\n                aria-describedby={errors.name ? 'profile-name-error' : undefined}\n                className={`w-full px-4 py-3 border ${errors.name ? 'border-red-500' : 'border-gray-300'} bg-white text-gray-800 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition placeholder-gray-400`}\n              />\n              {errors.name && touched.name && <p id=\"profile-name-error\" className=\"mt-1 text-xs text-red-600\">{errors.name}</p>}\n            </div>\n\n            <div>\n              <label className=\"block text-sm font-semibold text-gray-800 mb-2\">Phone Number *</label>\n              <div className=\"relative\">\n                <Phone className=\"absolute left-4 top-3.5 w-5 h-5 text-gray-400\" />\n                <input\n                  type=\"tel\"\n                  required\n                  value={formData.phone}\n                  onChange={(e) => { setFormData({ ...formData, phone: e.target.value }); if (touched.phone) validateField('phone', e.target.value); }}\n                  onBlur={(e) => { setTouched({ ...touched, phone: true }); validateField('phone', e.target.value); }}\n                  placeholder=\"e.g., +27 12 345 6789\"\n                  aria-invalid={errors.phone ? 'true' : 'false'}\n                  aria-describedby={errors.phone ? 'profile-phone-error' : undefined}\n                  className={`w-full pl-11 pr-4 py-3 border ${errors.phone ? 'border-red-500' : 'border-gray-300'} bg-white text-gray-800 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition placeholder-gray-400`}\n                />\n              </div>\n              {errors.phone && touched.phone && <p id=\"profile-phone-error\" className=\"mt-1 text-xs text-red-600\">{errors.phone}</p>}\n            </div>\n\n            <div>\n              <label className=\"block text-sm font-semibold text-gray-800 mb-2\">Email Address *</label>\n              <div className=\"relative\">\n                <Mail className=\"absolute left-4 top-3.5 w-5 h-5 text-gray-400\" />\n                <input\n                  type=\"email\"\n                  required\n                  value={formData.email}\n                  onChange={(e) => { setFormData({ ...formData, email: e.target.value }); if (touched.email) validateField('email', e.target.value); }}\n                  onBlur={(e) => { setTouched({ ...touched, email: true }); validateField('email', e.target.value); }}\n                  placeholder=\"your.email@example.com\"\n                  aria-invalid={errors.email ? 'true' : 'false'}\n                  aria-describedby={errors.email ? 'profile-email-error' : undefined}\n                  className={`w-full pl-11 pr-4 py-3 border ${errors.email ? 'border-red-500' : 'border-gray-300'} bg-white text-gray-800 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition placeholder-gray-400`}\n                />\n              </div>\n              {errors.email && touched.email && <p id=\"profile-email-error\" className=\"mt-1 text-xs text-red-600\">{errors.email}</p>}\n            </div>\n\n            <div>\n              <label className=\"block text-sm font-semibold text-gray-800 mb-2\">WhatsApp (optional)</label>\n              <div className=\"relative\">\n                <Phone className=\"absolute left-4 top-3.5 w-5 h-5 text-gray-400\" />\n                <input\n                  type=\"tel\"\n                  value={formData.whatsapp}\n                  onChange={(e) => setFormData({ ...formData, whatsapp: e.target.value })}\n                  placeholder=\"e.g., +27 71 234 5678\"\n                  className=\"w-full pl-11 pr-4 py-3 border border-gray-300 bg-white text-gray-800 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition placeholder-gray-400\"\n                />\n              </div>\n              <p className=\"text-xs text-gray-500 mt-1\">Used to create a WhatsApp chat link on your listings.</p>\n            </div>\n\n            {/* Submit Button */}\n            <button\n              onClick={handleSubmit}\n              className=\"w-full bg-blue-600 hover:bg-blue-700 text-white font-semibold py-3 rounded-lg transition mt-8 shadow-sm\"\n            >\n              Complete Setup\n            </button>\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n}\n\nfunction ProfileView({ user, onEdit, onUpdatePrefs }) {\n  const prefs = user.notificationPrefs || { updates: true, marketing: false };\n  const [localPrefs, setLocalPrefs] = React.useState(prefs);\n\n  const togglePref = (key) => {\n    const next = { ...localPrefs, [key]: !localPrefs[key] };\n    setLocalPrefs(next);\n    onUpdatePrefs && onUpdatePrefs(next);\n  };\n\n  return (\n    <div className=\"p-4\">\n      <div className=\"bg-white rounded-lg shadow p-6 max-w-xl mx-auto\">\n        <div className=\"flex justify-between items-start mb-6\">\n          <h2 className=\"text-2xl font-bold text-gray-800\">My Profile</h2>\n          <button\n            onClick={onEdit}\n            className=\"bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg transition flex items-center gap-2\"\n          >\n            <Edit className=\"w-4 h-4\" />\n            Edit\n          </button>\n        </div>\n\n        <div className=\"flex flex-col items-center mb-6\">\n          {user.photo ? (\n            <img src={user.photo} alt=\"Profile\" className=\"w-32 h-32 rounded-full object-cover border-4 border-blue-500 mb-4\" />\n          ) : (\n            <div className=\"w-32 h-32 rounded-full bg-gray-200 flex items-center justify-center border-4 border-gray-300 mb-4\">\n              <User className=\"w-16 h-16 text-gray-400\" />\n            </div>\n          )}\n          <h3 className=\"text-2xl font-bold text-gray-800\">{user.name}</h3>\n          <span className=\"inline-block mt-2 px-4 py-1 bg-blue-100 text-blue-700 rounded-full text-sm font-semibold\">\n            {user.type === 'landlord' ? 'Landlord' : 'Renter'}\n          </span>\n        </div>\n\n        <div className=\"space-y-4\">\n          <div className=\"bg-gray-50 rounded-lg p-4\">\n            <div className=\"flex items-center text-gray-600\">\n              <Phone className=\"w-5 h-5 mr-3 text-blue-600\" />\n              <div>\n                <p className=\"text-xs text-gray-500 mb-1\">Phone Number</p>\n                <p className=\"font-semibold text-gray-800\">{user.phone}</p>\n              </div>\n            </div>\n          </div>\n\n          <div className=\"bg-gray-50 rounded-lg p-4\">\n            <div className=\"flex items-center text-gray-600\">\n              <Mail className=\"w-5 h-5 mr-3 text-blue-600\" />\n              <div>\n                <p className=\"text-xs text-gray-500 mb-1\">Email Address</p>\n                <p className=\"font-semibold text-gray-800\">{user.email}</p>\n              </div>\n            </div>\n          </div>\n\n          <div className=\"bg-gray-50 rounded-lg p-4\">\n            <div className=\"flex items-center text-gray-600\">\n              <User className=\"w-5 h-5 mr-3 text-blue-600\" />\n              <div>\n                <p className=\"text-xs text-gray-500 mb-1\">Member Since</p>\n                <p className=\"font-semibold text-gray-800\">\n                  {new Date(user.createdAt).toLocaleDateString()}\n                </p>\n              </div>\n            </div>\n          </div>\n\n          <div className=\"bg-indigo-50 rounded-lg p-4\">\n            <h4 className=\"font-semibold text-gray-800 mb-2\">Notification Preferences</h4>\n            <div className=\"space-y-2\">\n              <label className=\"flex items-center gap-2 text-sm text-gray-700\">\n                <input\n                  type=\"checkbox\"\n                  checked={localPrefs.updates}\n                  onChange={() => togglePref('updates')}\n                />\n                Updates about new rooms in subscribed areas\n              </label>\n              <label className=\"flex items-center gap-2 text-sm text-gray-700\">\n                <input\n                  type=\"checkbox\"\n                  checked={localPrefs.marketing}\n                  onChange={() => togglePref('marketing')}\n                />\n                Occasional feature & promotion emails\n              </label>\n            </div>\n            <p className=\"text-[11px] text-gray-500 mt-2\">You can opt out anytime. Changes save instantly.</p>\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n}\n\nfunction LandlordOnboardingView({ onComplete, onCancel, currentUser }) {\n  const [form, setForm] = useState({ businessName: currentUser?.name || '', bankDetails: '', idNumber: '', agree: false });\n\n  const handleSubmit = () => {\n    if (!form.businessName || !form.agree) {\n      alert('Please provide a display name and agree to the terms.');\n      return;\n    }\n    onComplete(form);\n  };\n\n  return (\n    <div className=\"p-4 min-h-screen bg-gray-50 pb-20\">\n      <div className=\"max-w-2xl mx-auto mt-8\">\n        <div className=\"bg-white rounded-lg shadow-sm border border-gray-200 p-8\">\n          <div className=\"flex items-center gap-6 mb-6\">\n            <div className=\"w-16 h-16 rounded-full bg-blue-50 flex items-center justify-center text-blue-600 text-2xl font-bold\">\n              {currentUser && currentUser.name ? currentUser.name.charAt(0) : 'L'}\n            </div>\n            <div>\n              <h2 className=\"text-2xl font-bold text-gray-800\">Welcome, {currentUser?.name || 'Landlord'}</h2>\n              <p className=\"text-gray-600\">A few details to get your listings live and increase trust with renters.</p>\n            </div>\n          </div>\n\n          <div className=\"space-y-4\">\n            <div>\n              <label className=\"block text-sm font-semibold text-gray-800 mb-1\">Display Name *</label>\n              <input value={form.businessName} onChange={(e) => setForm({ ...form, businessName: e.target.value })} className=\"w-full px-4 py-3 border border-gray-300 rounded-lg\" />\n              <p className=\"text-xs text-gray-500 mt-1\">This name is shown to renters on your listings and messages.</p>\n            </div>\n\n            <div>\n              <label className=\"block text-sm font-semibold text-gray-800 mb-1\">How do you want to receive payments?</label>\n              <input value={form.bankDetails} onChange={(e) => setForm({ ...form, bankDetails: e.target.value })} placeholder=\"Bank account or payment details (optional)\" className=\"w-full px-4 py-3 border border-gray-300 rounded-lg\" />\n            </div>\n\n            <div>\n              <label className=\"block text-sm font-semibold text-gray-800 mb-1\">ID Number (optional)</label>\n              <input value={form.idNumber} onChange={(e) => setForm({ ...form, idNumber: e.target.value })} className=\"w-full px-4 py-3 border border-gray-300 rounded-lg\" />\n            </div>\n\n            <div className=\"flex items-start gap-2\">\n              <input type=\"checkbox\" checked={form.agree} onChange={(e) => setForm({ ...form, agree: e.target.checked })} />\n              <div className=\"text-sm text-gray-600\">I confirm I am authorised to list these properties and agree to the <button type=\"button\" onClick={(e) => e.preventDefault()} className=\"text-blue-600 underline p-0\">terms of service</button>.</div>\n            </div>\n\n            <div className=\"flex gap-3 pt-4\">\n              <button onClick={onCancel} className=\"flex-1 bg-gray-100 hover:bg-gray-200 py-3 rounded\">Cancel</button>\n              <button onClick={handleSubmit} className=\"flex-1 bg-blue-600 hover:bg-blue-700 text-white py-3 rounded\">Complete and Start Listing</button>\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n}\n\nfunction EditProfileView({ user, onSubmit, onCancel }) {\n  const [formData, setFormData] = useState({\n    name: user.name || '',\n    phone: user.phone || '',\n    email: user.email || '',\n    whatsapp: user.whatsapp || '',\n    photo: user.photo || ''\n  });\n  const [errors, setErrors] = useState({});\n  const [touched, setTouched] = useState({});\n\n  const validateField = (name, value) => {\n    const newErrors = { ...errors };\n    switch (name) {\n      case 'name':\n        if (!value || value.trim().length < 2) {\n          newErrors.name = 'Name must be at least 2 characters';\n        } else {\n          delete newErrors.name;\n        }\n        break;\n      case 'phone':\n        if (!value || !/^[+]?[-0-9()\\s]{7,}$/.test(value.trim())) {\n          newErrors.phone = 'Enter a valid phone number';\n        } else {\n          delete newErrors.phone;\n        }\n        break;\n      case 'email':\n        if (!value || !/^[^@\\s]+@[^@\\s]+\\.[^@\\s]+$/.test(value.trim())) {\n          newErrors.email = 'Enter a valid email';\n        } else {\n          delete newErrors.email;\n        }\n        break;\n      default:\n        break;\n    }\n    setErrors(newErrors);\n  };\n\n  const handlePhotoUpload = (e) => {\n    const file = e.target.files[0];\n    if (file) {\n      const reader = new FileReader();\n      reader.onloadend = () => {\n        setFormData({ ...formData, photo: reader.result });\n      };\n      reader.readAsDataURL(file);\n    }\n  };\n\n  const handleSubmit = () => {\n    setTouched({ name: true, phone: true, email: true });\n    validateField('name', formData.name);\n    validateField('phone', formData.phone);\n    validateField('email', formData.email);\n    if (Object.keys(errors).length === 0 && formData.name && formData.phone && formData.email) {\n      onSubmit(formData);\n    }\n  };\n\n  return (\n    <div className=\"p-4 min-h-screen bg-gray-50 pb-20\">\n      <div className=\"max-w-2xl mx-auto mt-8\">\n        <div className=\"bg-white rounded-lg shadow-sm border border-gray-200 p-8\">\n          <div className=\"flex items-center justify-between mb-8\">\n            <h2 className=\"text-3xl font-bold text-gray-800\">Edit Profile</h2>\n            <button onClick={onCancel} className=\"text-gray-400 hover:text-gray-600 transition\">\n              <X className=\"w-6 h-6\" />\n            </button>\n          </div>\n\n          <div className=\"space-y-6\">\n            {/* Photo Upload */}\n            <div className=\"flex justify-center mb-8\">\n              <div className=\"relative\">\n                {formData.photo ? (\n                  <img src={formData.photo} alt=\"Profile\" className=\"w-32 h-32 rounded-full object-cover border-4 border-blue-200 shadow-lg\" />\n                ) : (\n                  <div className=\"w-32 h-32 rounded-full bg-gradient-to-br from-blue-100 to-blue-200 flex items-center justify-center border-4 border-blue-200 shadow-lg\">\n                    <User className=\"w-16 h-16 text-blue-600\" />\n                  </div>\n                )}\n                <label className=\"absolute bottom-0 right-0 bg-blue-600 hover:bg-blue-700 text-white p-3 rounded-full cursor-pointer shadow-lg transition\" aria-label=\"Upload new profile photo\">\n                  <Edit className=\"w-5 h-5\" />\n                  <input\n                    type=\"file\"\n                    accept=\"image/*\"\n                    onChange={handlePhotoUpload}\n                    className=\"hidden\"\n                  />\n                </label>\n              </div>\n            </div>\n\n            {/* Form Fields */}\n            <div>\n              <label className=\"block text-sm font-semibold text-gray-800 mb-2\">Full Name</label>\n              <input\n                type=\"text\"\n                required\n                value={formData.name}\n                onChange={(e) => { setFormData({ ...formData, name: e.target.value }); if (touched.name) validateField('name', e.target.value); }}\n                onBlur={(e) => { setTouched({ ...touched, name: true }); validateField('name', e.target.value); }}\n                aria-invalid={errors.name ? 'true' : 'false'}\n                aria-describedby={errors.name ? 'edit-name-error' : undefined}\n                className={`w-full px-4 py-3 border ${errors.name ? 'border-red-500' : 'border-gray-300'} bg-white text-gray-800 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition placeholder-gray-400`}\n              />\n              {errors.name && touched.name && <p id=\"edit-name-error\" className=\"mt-1 text-xs text-red-600\">{errors.name}</p>}\n            </div>\n\n            <div>\n              <label className=\"block text-sm font-semibold text-gray-800 mb-2\">Phone Number</label>\n              <div className=\"relative\">\n                <Phone className=\"absolute left-4 top-3.5 w-5 h-5 text-gray-400\" />\n                <input\n                  type=\"tel\"\n                  required\n                  value={formData.phone}\n                  onChange={(e) => { setFormData({ ...formData, phone: e.target.value }); if (touched.phone) validateField('phone', e.target.value); }}\n                  onBlur={(e) => { setTouched({ ...touched, phone: true }); validateField('phone', e.target.value); }}\n                  aria-invalid={errors.phone ? 'true' : 'false'}\n                  aria-describedby={errors.phone ? 'edit-phone-error' : undefined}\n                  className={`w-full pl-11 pr-4 py-3 border ${errors.phone ? 'border-red-500' : 'border-gray-300'} bg-white text-gray-800 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition placeholder-gray-400`}\n                />\n              </div>\n              {errors.phone && touched.phone && <p id=\"edit-phone-error\" className=\"mt-1 text-xs text-red-600\">{errors.phone}</p>}\n            </div>\n\n            <div>\n              <label className=\"block text-sm font-semibold text-gray-800 mb-2\">Email Address</label>\n              <div className=\"relative\">\n                <Mail className=\"absolute left-4 top-3.5 w-5 h-5 text-gray-400\" />\n                <input\n                  type=\"email\"\n                  required\n                  value={formData.email}\n                  onChange={(e) => { setFormData({ ...formData, email: e.target.value }); if (touched.email) validateField('email', e.target.value); }}\n                  onBlur={(e) => { setTouched({ ...touched, email: true }); validateField('email', e.target.value); }}\n                  aria-invalid={errors.email ? 'true' : 'false'}\n                  aria-describedby={errors.email ? 'edit-email-error' : undefined}\n                  className={`w-full pl-11 pr-4 py-3 border ${errors.email ? 'border-red-500' : 'border-gray-300'} bg-white text-gray-800 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition placeholder-gray-400`}\n                />\n              </div>\n              {errors.email && touched.email && <p id=\"edit-email-error\" className=\"mt-1 text-xs text-red-600\">{errors.email}</p>}\n            </div>\n\n            <div>\n              <label className=\"block text-sm font-semibold text-gray-800 mb-2\">WhatsApp (optional)</label>\n              <div className=\"relative\">\n                <Phone className=\"absolute left-4 top-3.5 w-5 h-5 text-gray-400\" />\n                <input\n                  type=\"tel\"\n                  value={formData.whatsapp}\n                  onChange={(e) => setFormData({ ...formData, whatsapp: e.target.value })}\n                  placeholder=\"e.g., +27 71 234 5678\"\n                  className=\"w-full pl-11 pr-4 py-3 border border-gray-300 bg-white text-gray-800 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition placeholder-gray-400\"\n                />\n              </div>\n              <p className=\"text-xs text-gray-500 mt-1\">Used to create a WhatsApp chat link on your listings.</p>\n            </div>\n\n            {/* Action Buttons */}\n            <div className=\"flex gap-3 pt-6 border-t border-gray-200\">\n              <button\n                onClick={onCancel}\n                className=\"flex-1 bg-gray-100 hover:bg-gray-200 text-gray-800 font-semibold py-3 rounded-lg transition\"\n              >\n                Cancel\n              </button>\n              <button\n                onClick={handleSubmit}\n                className=\"flex-1 bg-blue-600 hover:bg-blue-700 text-white font-semibold py-3 rounded-lg transition shadow-sm\"\n              >\n                Save Changes\n              </button>\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n}\n\n/* BrowseView extracted to components/BrowseView.jsx */\n\nfunction FavoritesView({ listings, onSelectListing }) {\n  const [favorites, setFavorites] = useState([]);\n\n  useEffect(() => {\n    try {\n      const rawFavorites = localStorage.getItem('favorites');\n      if (rawFavorites) {\n        const arr = JSON.parse(rawFavorites);\n        if (Array.isArray(arr)) setFavorites(arr);\n      }\n    } catch {}\n  }, []);\n\n  const toggleFavorite = (listingId) => {\n    setFavorites(prev => {\n      const updated = prev.filter(id => id !== listingId);\n      try {\n        localStorage.setItem('favorites', JSON.stringify(updated));\n      } catch {}\n      return updated;\n    });\n  };\n\n  const favoriteListings = listings.filter(l => favorites.includes(l.id));\n\n  return (\n    <div className=\"p-4 min-h-screen bg-gray-50 pb-20\">\n      <div className=\"max-w-7xl mx-auto mt-8\">\n        <div className=\"mb-6\">\n          <h2 className=\"text-3xl font-bold text-gray-800 flex items-center gap-3\">\n            <Heart className=\"w-8 h-8 text-red-500 fill-red-500\" />\n            Saved Listings\n          </h2>\n          <p className=\"text-gray-600 mt-2\">\n            {favoriteListings.length === 0\n              ? 'No saved listings yet. Browse and tap the heart icon to save your favorites!'\n              : `${favoriteListings.length} saved ${favoriteListings.length === 1 ? 'listing' : 'listings'}`}\n          </p>\n        </div>\n\n        {favoriteListings.length === 0 ? (\n          <div className=\"bg-white rounded-lg border border-gray-200 p-12 text-center\">\n            <Heart className=\"w-24 h-24 mx-auto mb-4 text-gray-300\" />\n            <p className=\"text-gray-600 font-medium mb-2\">No saved listings</p>\n            <p className=\"text-gray-500 text-sm mb-6\">\n              Start browsing and save your favorite rooms to find them here later\n            </p>\n          </div>\n        ) : (\n          <div className=\"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6\">\n            {favoriteListings.map(listing => {\n              const ListingCard = require('./components/ListingCard').default;\n              return (\n                <ListingCard\n                  key={listing.id}\n                  listing={listing}\n                  onClick={() => onSelectListing(listing)}\n                  isFavorite={true}\n                  onToggleFavorite={toggleFavorite}\n                />\n              );\n            })}\n          </div>\n        )}\n      </div>\n    </div>\n  );\n}\n\nfunction AddListingView({ onSubmit, onCancel, currentUser, userType, onRequireAuth, onRequireOnboarding }) {\n  const GEOCODER_KEY = process.env.REACT_APP_GEOCODER_API_KEY;\n  const GEOCODER_PROVIDER = (process.env.REACT_APP_GEOCODER_PROVIDER || '').toLowerCase();\n\n  const [formData, setFormData] = useState({\n    title: '',\n    price: '',\n    location: '',\n    streetAddress: '',\n    description: '',\n    photos: [],\n    status: 'available',\n    availableDate: new Date().toISOString().split('T')[0],\n    amenities: [],\n    latitude: null,\n    longitude: null,\n    paymentMethod: 'Bank and Cash',\n    roomType: 'private',\n    leaseDuration: '7-12',\n    petFriendly: false,\n    genderPreference: 'any'\n  });\n  const [geocodingStatus, setGecodingStatus] = useState('');\n  const [errors, setErrors] = useState({});\n  const [locationHelpBanner, setLocationHelpBanner] = useState('');\n  const [locationSuggestions, setLocationSuggestions] = useState([]);\n  const [locationSuggestionsLoading, setLocationSuggestionsLoading] = useState(false);\n  const locationSuggestionCacheRef = React.useRef({}); // { queryLower: { data, ts } }\n  const LOCATION_SUGGESTION_TTL_MS = 15 * 60 * 1000;\n  const [showPhotoEditor, setShowPhotoEditor] = useState(false);\n  const reverseGeocodeCacheRef = React.useRef({});\n  const [lastGeocodeSource, setLastGeocodeSource] = useState(null); // 'cached' | 'mapbox' | 'proxy' | 'direct' | 'coords-only' | 'manual-geocode'\n  const [isReverseGeocoding, setIsReverseGeocoding] = useState(false);\n\n  // Helper: fetch with graceful fallbacks when third-party APIs lack CORS headers\n  const corsFallbackTransforms = useMemo(() => [\n    (url) => url.startsWith('https://cors.isomorphic-git.org/') ? url : `https://cors.isomorphic-git.org/${url}`,\n    (url) => url.startsWith('https://corsproxy.io/?') ? url : `https://corsproxy.io/?${encodeURIComponent(url)}`\n  ], []);\n\n  const fetchWithCorsFallback = useCallback(async (url, options = {}) => {\n    const cloneOptions = () => {\n      const base = { ...options };\n      if (options.headers) base.headers = { ...options.headers };\n      return base;\n    };\n\n    const attempt = async (targetUrl) => {\n      const resp = await fetch(targetUrl, cloneOptions());\n      if (!resp.ok) throw new Error(`Request failed with status ${resp.status}`);\n      return resp;\n    };\n\n    try {\n      return await attempt(url);\n    } catch (err) {\n      if (options.signal?.aborted) throw err;\n      let lastError = err;\n      for (const transform of corsFallbackTransforms) {\n        try {\n          const proxiedUrl = transform(url);\n          return await attempt(proxiedUrl);\n        } catch (proxyErr) {\n          lastError = proxyErr;\n          if (options.signal?.aborted) break;\n        }\n      }\n      throw lastError;\n    }\n  }, [corsFallbackTransforms]);\n\n  // Reusable reverse geocoding function - extracted for use by both GPS and draggable marker\n  const reverseGeocodeCoords = async (lat, lon) => {\n    const cacheKey = `${lat.toFixed(4)},${lon.toFixed(4)}`;\n    \n    // Check cache first\n    const cached = reverseGeocodeCacheRef.current[cacheKey];\n    if (cached && cached.streetAddress && cached.location) {\n      return { streetAddress: cached.streetAddress, location: cached.location, source: 'cached' };\n    }\n\n    // Try geocoding\n    try {\n      // Try Mapbox if available\n      if (GEOCODER_PROVIDER === 'mapbox' && GEOCODER_KEY) {\n        const rev = await fetch(`https://api.mapbox.com/geocoding/v5/mapbox.places/${lon},${lat}.json?access_token=${GEOCODER_KEY}&limit=1&country=za&types=address,poi`);\n        const revData = await rev.json();\n        if (revData?.features?.length > 0) {\n          const feature = revData.features[0];\n          const address = feature.address || '';\n          const streetName = feature.text || '';\n          const fullStreet = address ? `${address} ${streetName}` : streetName;\n          \n          let area = '';\n          if (feature.context) {\n            const place = feature.context.find(c => c.id.startsWith('place'));\n            const locality = feature.context.find(c => c.id.startsWith('locality'));\n            const region = feature.context.find(c => c.id.startsWith('region'));\n            const baseArea = (place ? place.text : (locality ? locality.text : '')) || '';\n            const province = region ? region.text : '';\n            area = province && baseArea && province.toLowerCase() !== baseArea.toLowerCase() ? `${baseArea}, ${province}` : (baseArea || province);\n          }\n          area = area.replace(/ (Metropolitan|Local|District) Municipality$/i, '').replace(/^City of /i, '').trim();\n          \n          if (fullStreet || area) {\n            reverseGeocodeCacheRef.current[cacheKey] = { streetAddress: fullStreet, location: area, ts: Date.now() };\n            try { localStorage.setItem('reverse-geocode-cache', JSON.stringify(reverseGeocodeCacheRef.current)); } catch {}\n            return { streetAddress: fullStreet, location: area, source: 'mapbox' };\n          }\n        }\n      }\n\n      // Try geocode.maps.co (Nominatim mirror with CORS enabled)\n      try {\n        const mapsCoResp = await fetch(`https://geocode.maps.co/reverse?lat=${lat}&lon=${lon}`);\n        if (mapsCoResp.ok) {\n          const mapsCoData = await mapsCoResp.json();\n          if (mapsCoData?.address) {\n            const addr = mapsCoData.address;\n            const houseNumber = addr.house_number || '';\n            const road = addr.road || addr.street || '';\n            const suburb = addr.suburb || addr.neighbourhood || '';\n            const street = [houseNumber, road].filter(Boolean).join(' ').trim() || suburb;\n            const area = formatAreaFromAddress(addr) || suburb;\n            if (street || area) {\n              reverseGeocodeCacheRef.current[cacheKey] = { streetAddress: street, location: area, ts: Date.now() };\n              try { localStorage.setItem('reverse-geocode-cache', JSON.stringify(reverseGeocodeCacheRef.current)); } catch {}\n              return { streetAddress: street, location: area, source: 'maps.co' };\n            }\n          }\n        }\n      } catch (mapsCoErr) {\n        console.warn('maps.co reverse geocode failed', mapsCoErr);\n      }\n\n      // Try BigDataCloud (CORS-friendly, no key required)\n      try {\n        const bdcResp = await fetch(`https://api.bigdatacloud.net/data/reverse-geocode-client?latitude=${lat}&longitude=${lon}&localityLanguage=en`);\n        if (bdcResp.ok) {\n          const bdcData = await bdcResp.json();\n          const formatted = formatBigDataCloudAddress(bdcData);\n          if (formatted.streetAddress || formatted.location) {\n            reverseGeocodeCacheRef.current[cacheKey] = { streetAddress: formatted.streetAddress, location: formatted.location, ts: Date.now() };\n            try { localStorage.setItem('reverse-geocode-cache', JSON.stringify(reverseGeocodeCacheRef.current)); } catch {}\n            return { ...formatted, source: 'bigdatacloud' };\n          }\n        }\n      } catch (bdcErr) {\n        console.warn('BigDataCloud reverse geocode failed', bdcErr);\n      }\n\n      // Try proxy/Nominatim\n      const API_BASE = (process.env.REACT_APP_PROXY_BASE || (window.location && window.location.port === '8443' ? 'https://localhost:4443' : ''));\n      let revData = null;\n      \n      try {\n        const rev = await fetch(`${API_BASE}/api/reverse?lat=${lat}&lon=${lon}`);\n        if (rev.ok) revData = await rev.json();\n      } catch (proxyErr) {\n        console.warn('Proxy reverse geocode failed, trying direct', proxyErr);\n      }\n\n      // Direct Nominatim fallback\n      if (!revData) {\n        try {\n          const direct = await fetchWithCorsFallback(\n            `https://nominatim.openstreetmap.org/reverse?format=json&lat=${lat}&lon=${lon}&zoom=18&addressdetails=1`,\n            { headers: { 'Accept': 'application/json', 'User-Agent': 'room-rental-platform/1.0' } }\n          );\n          revData = await direct.json();\n        } catch (directErr) {\n          console.warn('Direct nominatim failed', directErr);\n        }\n      }\n\n      if (revData?.address) {\n        const addr = revData.address;\n        const houseNumber = addr.house_number || '';\n        const road = addr.road || addr.street || '';\n        const suburb = addr.suburb || addr.neighbourhood || '';\n        const street = [houseNumber, road].filter(Boolean).join(' ').trim() || suburb;\n        const area = formatAreaFromAddress(addr) || suburb;\n        \n        if (street || area) {\n          reverseGeocodeCacheRef.current[cacheKey] = { streetAddress: street, location: area, ts: Date.now() };\n          try { localStorage.setItem('reverse-geocode-cache', JSON.stringify(reverseGeocodeCacheRef.current)); } catch {}\n          return { streetAddress: street, location: area, source: 'nominatim' };\n        }\n      }\n    } catch (e) {\n      console.error('Reverse geocode error:', e);\n    }\n    \n    return null; // Failed to geocode\n  };\n\n  // Forward geocode helper for manual address lookups\n  const forwardGeocodeAddress = async (query) => {\n    if (!query || query.trim().length < 3) return [];\n\n    // 1. Mapbox (if configured)\n    if (GEOCODER_PROVIDER === 'mapbox' && GEOCODER_KEY) {\n      try {\n        const resp = await fetch(`https://api.mapbox.com/geocoding/v5/mapbox.places/${encodeURIComponent(query)}.json?access_token=${GEOCODER_KEY}&limit=3&country=za&types=address,place,locality`);\n        const data = await resp.json();\n        if (data?.features?.length) {\n          return data.features.map(f => ({\n            lat: f.center ? f.center[1] : f.geometry?.coordinates?.[1],\n            lon: f.center ? f.center[0] : f.geometry?.coordinates?.[0],\n            label: f.place_name || f.text,\n            source: 'mapbox'\n          })).filter(entry => typeof entry.lat === 'number' && typeof entry.lon === 'number');\n        }\n      } catch (err) {\n        console.warn('Mapbox forward geocode failed', err);\n      }\n    }\n\n    // 2. maps.co (CORS-friendly)\n    try {\n      const mapsResp = await fetch(`https://geocode.maps.co/search?q=${encodeURIComponent(query)}&limit=3`);\n      if (mapsResp.ok) {\n        const mapsData = await mapsResp.json();\n        if (Array.isArray(mapsData) && mapsData.length) {\n          return mapsData.slice(0, 3).map(entry => ({\n            lat: parseFloat(entry.lat),\n            lon: parseFloat(entry.lon),\n            label: entry.display_name || entry.name,\n            source: 'maps.co'\n          }));\n        }\n      }\n    } catch (mapsErr) {\n      console.warn('maps.co forward geocode failed', mapsErr);\n    }\n\n    // 3. Local proxy (if running)\n    const API_BASE = (process.env.REACT_APP_PROXY_BASE || (window.location && window.location.port === '8443' ? 'https://localhost:4443' : ''));\n    if (API_BASE) {\n      try {\n        const proxyResp = await fetch(`${API_BASE}/api/search?q=${encodeURIComponent(query)}`);\n        if (proxyResp.ok) {\n          const proxyData = await proxyResp.json();\n          if (Array.isArray(proxyData) && proxyData.length) {\n            return proxyData.slice(0, 3).map(entry => ({\n              lat: parseFloat(entry.lat),\n              lon: parseFloat(entry.lon),\n              label: entry.display_name,\n              source: API_BASE.includes('localhost') ? 'local-proxy' : 'proxy'\n            }));\n          }\n        }\n      } catch (proxyErr) {\n        console.warn('Local proxy forward geocode failed', proxyErr);\n      }\n    }\n\n    // 4. Direct Nominatim fallback (may still be blocked, but last resort)\n    try {\n      const directResp = await fetchWithCorsFallback(`https://nominatim.openstreetmap.org/search?format=json&addressdetails=1&q=${encodeURIComponent(query)}`, {\n        headers: {\n          'User-Agent': 'room-rental-platform/1.0 (direct fallback)',\n          'Accept': 'application/json'\n        }\n      });\n      if (directResp.ok) {\n        const directData = await directResp.json();\n        if (Array.isArray(directData) && directData.length) {\n          return directData.slice(0, 3).map(entry => ({\n            lat: parseFloat(entry.lat),\n            lon: parseFloat(entry.lon),\n            label: entry.display_name,\n            source: 'direct'\n          }));\n        }\n      }\n    } catch (directErr) {\n      console.warn('Direct nominatim forward geocode failed', directErr);\n    }\n\n    return [];\n  };\n\n  const availableAmenities = [\n    'WiFi', 'Parking', 'Kitchen', 'Laundry', 'Air Conditioning', \n    'Heating', 'TV', 'Furnished', 'Pet Friendly', 'Garden'\n  ];\n\n  const validateField = (name, value) => {\n    const newErrors = { ...errors };\n    \n    switch (name) {\n      case 'title':\n        if (!value || value.trim().length < 5) {\n          newErrors.title = 'Title must be at least 5 characters';\n        } else {\n          delete newErrors.title;\n        }\n        break;\n      case 'price':\n        if (!value || parseFloat(value) <= 0) {\n          newErrors.price = 'Price must be greater than 0';\n        } else if (parseFloat(value) < 500) {\n          newErrors.price = 'Price seems too low (minimum R500)';\n        } else if (parseFloat(value) > 50000) {\n          newErrors.price = 'Price seems too high (maximum R50,000)';\n        } else {\n          delete newErrors.price;\n        }\n        break;\n      case 'location':\n        if (!value || value.trim().length < 3) {\n          newErrors.location = 'Location is required (min 3 characters)';\n        } else {\n          delete newErrors.location;\n        }\n        break;\n      case 'description':\n        if (value && value.length > 500) {\n          newErrors.description = 'Description is too long (max 500 characters)';\n        } else {\n          delete newErrors.description;\n        }\n        break;\n      default:\n        break;\n    }\n    \n    setErrors(newErrors);\n  };\n\n  // Debounced provider-aware suggestions (Mapbox/Nominatim) with caching & bias\n  useEffect(() => {\n    const raw = (formData.location || '').trim();\n    if (raw.length < 3) { setLocationSuggestions([]); setLocationSuggestionsLoading(false); return; }\n    const qLower = raw.toLowerCase();\n    const cached = locationSuggestionCacheRef.current[qLower];\n    if (cached && (Date.now() - cached.ts) < LOCATION_SUGGESTION_TTL_MS) {\n      setLocationSuggestions(cached.data);\n      return;\n    }\n    const controller = new AbortController();\n    setLocationSuggestionsLoading(true);\n    const t = setTimeout(async () => {\n      try {\n        let suggestions = [];\n        if (GEOCODER_PROVIDER === 'mapbox' && GEOCODER_KEY) {\n          const proximity = (formData.latitude && formData.longitude) ? `&proximity=${formData.longitude},${formData.latitude}` : '';\n          const url = `https://api.mapbox.com/geocoding/v5/mapbox.places/${encodeURIComponent(raw)}.json?access_token=${GEOCODER_KEY}&limit=5&country=ZA&language=en${proximity}&types=place,locality,neighborhood`;\n          const resp = await fetch(url, { signal: controller.signal });\n          const data = await resp.json();\n          if (data && Array.isArray(data.features)) {\n            suggestions = data.features.map(f => f.place_name).filter(Boolean);\n          }\n        } else {\n          // Use local proxy when available, otherwise fall back to direct fetch with CORS helpers.\n          const API_BASE = (process.env.REACT_APP_PROXY_BASE || (window.location && window.location.port === '8443' ? 'http://localhost:4000' : ''));\n          const query = `${raw}, South Africa`; // country hint for specificity\n          let data = [];\n          try {\n            if (API_BASE) {\n              const resp = await fetch(`${API_BASE}/api/search?q=${encodeURIComponent(query)}`, { signal: controller.signal });\n              data = await resp.json();\n            } else {\n              const searchUrl = `https://nominatim.openstreetmap.org/search?format=json&limit=5&addressdetails=1&q=${encodeURIComponent(query)}`;\n              const resp = await fetchWithCorsFallback(searchUrl, { signal: controller.signal, headers: { 'Accept': 'application/json' } });\n              data = await resp.json();\n            }\n          } catch (proxyErr) {\n            console.warn('Search proxy failed, using CORS fallback', proxyErr);\n            if (!API_BASE) throw proxyErr;\n            try {\n              const searchUrl = `https://nominatim.openstreetmap.org/search?format=json&limit=5&addressdetails=1&q=${encodeURIComponent(query)}`;\n              const resp = await fetchWithCorsFallback(searchUrl, { signal: controller.signal, headers: { 'Accept': 'application/json' } });\n              data = await resp.json();\n            } catch (directErr) {\n              console.error('Nominatim search failed', directErr);\n              data = [];\n            }\n          }\n\n          if (Array.isArray(data)) {\n            const uniq = [];\n            data.forEach(item => {\n              const display = item.display_name || '';\n              const parts = display.split(',').map(p => p.trim());\n              // Construct concise area: first two parts (e.g., Suburb, City or City, Province)\n              const area = parts.slice(0, 2).join(', ');\n              if (area && !uniq.includes(area)) uniq.push(area);\n            });\n            suggestions = uniq.slice(0, 5);\n          }\n        }\n        locationSuggestionCacheRef.current[qLower] = { data: suggestions, ts: Date.now() };\n        setLocationSuggestions(suggestions);\n      } catch (e) {\n        setLocationSuggestions([]);\n      } finally {\n        setLocationSuggestionsLoading(false);\n      }\n    }, 500);\n    return () => { clearTimeout(t); controller.abort(); };\n  }, [formData.location, formData.latitude, formData.longitude, GEOCODER_PROVIDER, GEOCODER_KEY, LOCATION_SUGGESTION_TTL_MS, fetchWithCorsFallback]);\n\n  // Load persisted reverse geocode cache\n  useEffect(() => {\n    try {\n      const raw = localStorage.getItem('reverse-geocode-cache');\n      if (raw) {\n        const parsed = JSON.parse(raw);\n        if (parsed && typeof parsed === 'object') {\n          reverseGeocodeCacheRef.current = parsed;\n        }\n      }\n    } catch (e) { /* ignore */ }\n  }, []);\n\n  // Geocode address using Nominatim (OpenStreetMap)\n  // Use browser geolocation and reverse-geocode to fill address/coords\n  // Helper: format city + province (South Africa) removing verbose municipality suffixes\n  const formatAreaFromAddress = (addr) => {\n    if (!addr) return '';\n    const cleanMunicipality = (val) => {\n      if (!val) return '';\n      return val\n        .replace(/ City of /i, '')\n        .replace(/ (Metropolitan|Local|District) Municipality$/i, '')\n        .trim();\n    };\n    \n    // Prioritize suburb/neighborhood first as it's most specific\n    let suburb = addr.suburb || addr.neighbourhood || '';\n    let city = addr.city || addr.town || addr.village || addr.hamlet || '';\n    let municipality = cleanMunicipality(addr.municipality || '');\n    city = cleanMunicipality(city);\n    \n    // Use suburb if available, otherwise fall back to city, then municipality\n    let primaryArea = suburb || city || municipality;\n    const province = addr.state || '';\n    \n    // Avoid duplication like \"Johannesburg, Johannesburg\"\n    if (province && primaryArea && province.toLowerCase() === primaryArea.toLowerCase()) {\n      return primaryArea;\n    }\n    if (primaryArea && province) return `${primaryArea}, ${province}`;\n    return primaryArea || province || '';\n  };\n\n  const formatBigDataCloudAddress = (data) => {\n    if (!data) return { streetAddress: '', location: '' };\n    const informative = data.localityInfo?.informative || [];\n    const admin = data.localityInfo?.administrative || [];\n\n    const streetCandidate = informative.find((entry) => /road|street|route|drive|avenue|lane|close|crescent/i.test(entry.description || entry.name || ''))\n      || informative.find((entry) => /residential|locality/i.test(entry.description || ''));\n\n    const suburbCandidate = admin.find((entry) => entry.order === 5)\n      || admin.find((entry) => /suburb|township|neighbourhood/i.test(entry.description || ''));\n\n    const cityCandidate = admin.find((entry) => entry.order === 6)\n      || admin.find((entry) => /city|town/i.test(entry.description || ''));\n\n    const streetAddress = streetCandidate?.name || '';\n    const areaParts = [\n      suburbCandidate?.name || data.locality || data.city || '',\n      data.principalSubdivision || cityCandidate?.name || ''\n    ].filter(Boolean);\n\n    return {\n      streetAddress,\n      location: areaParts.filter((val, idx, arr) => val && arr.indexOf(val) === idx).join(', ')\n    };\n  };\n\n  // (Cache ref declared earlier in component; duplicate removed)\n\n  const geolocateCurrentPosition = () => {\n    const insecure = (typeof window !== 'undefined') && !window.isSecureContext && window.location.hostname !== 'localhost';\n    if (insecure) {\n      setGecodingStatus('Location is blocked on HTTP. Use HTTPS to enable.');\n      setLocationHelpBanner('Your browser requires HTTPS to access GPS on mobile. Use the HTTPS link below.');\n      return;\n    }\n    if (!navigator.geolocation) {\n      setGecodingStatus('Geolocation not supported by your browser');\n      setLocationHelpBanner('Location is disabled. Tap for steps to enable.');\n      return;\n    }\n\n    setGecodingStatus('Getting your precise location...');\n    navigator.geolocation.getCurrentPosition(async (pos) => {\n      const lat = pos.coords.latitude;\n      const lon = pos.coords.longitude;\n      const accuracy = pos.coords.accuracy;\n      \n      console.log(`Location obtained: ${lat}, ${lon} (accuracy: ${accuracy}m)`);\n      \n      try {\n        const geocodeResult = await reverseGeocodeCoords(lat, lon);\n        if (geocodeResult) {\n          setFormData(prev => ({\n            ...prev,\n            streetAddress: geocodeResult.streetAddress || prev.streetAddress,\n            location: geocodeResult.location || prev.location,\n            latitude: lat,\n            longitude: lon\n          }));\n          setGecodingStatus(` Location set (${accuracy.toFixed(0)}m accuracy)`);\n          setTimeout(() => setGecodingStatus(''), 3000);\n          setLastGeocodeSource(geocodeResult.source || 'manual-geocode');\n          return;\n        }\n      } catch (e) {\n        console.error('Reverse geocode failed', e);\n      }\n\n      // Only use coordinate placeholders if reverse geocoding completely failed\n      setFormData(prev => ({\n        ...prev,\n        latitude: lat,\n        longitude: lon\n      }));\n      setGecodingStatus(` Coordinates captured (${accuracy.toFixed(0)}m accuracy). Add the street or suburb manually while we reconnect to the address service.`);\n      setTimeout(() => setGecodingStatus(''), 3000);\n      setLastGeocodeSource('coords-only');\n    }, (err) => {\n      console.error('Geolocation error', err);\n      if (err && (err.code === 1)) {\n        // PERMISSION_DENIED\n        setGecodingStatus('Permission denied. Allow location access to continue.');\n        setLocationHelpBanner('Tap the lock icon in the address bar and set Location to Allow, then refresh.');\n      } else if (err && (err.code === 2)) {\n        // POSITION_UNAVAILABLE\n        setGecodingStatus('Position unavailable. Check GPS and network, then retry.');\n      } else if (err && (err.code === 3)) {\n        // TIMEOUT\n        setGecodingStatus('Location timed out. Move to open area or retry.');\n      } else {\n        setGecodingStatus('Could not get your location - ' + (err?.message || 'Unknown error'));\n      }\n      setLocationHelpBanner('Location permission denied. Tap here for steps to enable.');\n      setLastGeocodeSource(null);\n    }, { \n      enableHighAccuracy: true, \n      timeout: 15000, \n      maximumAge: 0 \n    });\n  };\n\n  const geocodeAddress = async () => {\n    if (!formData.streetAddress) {\n      setGecodingStatus('Please enter a street address');\n      return;\n    }\n    \n    setGecodingStatus('Finding coordinates...');\n    try {\n      const fullAddress = `${formData.streetAddress}, ${formData.location}, South Africa`;\n      const results = await forwardGeocodeAddress(fullAddress);\n\n      if (results.length > 0) {\n        const best = results[0];\n        setFormData({ \n          ...formData, \n          latitude: parseFloat(best.lat), \n          longitude: parseFloat(best.lon) \n        });\n        setGecodingStatus(` Address found!`);\n        setTimeout(() => setGecodingStatus(''), 2000);\n        setLastGeocodeSource(best.source || 'manual-geocode');\n        return;\n      }\n\n      setGecodingStatus('Address not found. Trying with area only...');\n      const areaResults = await forwardGeocodeAddress(`${formData.location}, South Africa`);\n      if (areaResults.length > 0) {\n        const bestArea = areaResults[0];\n        setFormData({ \n          ...formData, \n          latitude: parseFloat(bestArea.lat), \n          longitude: parseFloat(bestArea.lon) \n        });\n        setGecodingStatus(' Area found!');\n        setTimeout(() => setGecodingStatus(''), 2000);\n        setLastGeocodeSource(bestArea.source || 'manual-geocode');\n      } else {\n        setGecodingStatus('Could not find location');\n      }\n    } catch (error) {\n      console.error('Geocoding error:', error);\n      setGecodingStatus('Error finding address. Check your connection.');\n      setLastGeocodeSource(null);\n    }\n  };\n\n  // Draggable preview marker component for Add Listing\n  function DraggablePreview({ lat, lng }) {\n    const [pos, setPos] = useState(lat && lng ? { lat, lng } : null);\n    const [isDragging, setIsDragging] = useState(false);\n    const [viewState, setViewState] = useState({\n      latitude: lat ?? DEFAULT_PREVIEW_CENTER.lat,\n      longitude: lng ?? DEFAULT_PREVIEW_CENTER.lon,\n      zoom: 15,\n      bearing: 0,\n      pitch: 0\n    });\n    \n    useEffect(() => {\n      if (lat && lng) {\n        setPos({ lat, lng });\n        setViewState(prev => ({ ...prev, latitude: lat, longitude: lng }));\n      }\n    }, [lat, lng]);\n\n    const handleDragEnd = async (event) => {\n      const lngLat = event?.lngLat;\n      if (!lngLat) return;\n      const next = { lat: lngLat.lat, lng: lngLat.lng };\n      setPos(next);\n      setIsDragging(false);\n      setViewState(prev => ({ ...prev, latitude: next.lat, longitude: next.lng }));\n      \n      setFormData(prev => ({ ...prev, latitude: next.lat, longitude: next.lng }));\n      setIsReverseGeocoding(true);\n      setGecodingStatus(' Finding address...');\n      \n      try {\n        const result = await reverseGeocodeCoords(next.lat, next.lng);\n        if (result) {\n          setFormData(prev => ({ \n            ...prev, \n            latitude: next.lat, \n            longitude: next.lng,\n            streetAddress: result.streetAddress || prev.streetAddress,\n            location: result.location || prev.location\n          }));\n          setGecodingStatus(` Location updated: ${result.location || 'Address found'}`);\n          setLastGeocodeSource(result.source);\n        } else {\n          setGecodingStatus(' Could not find address for this location');\n        }\n      } catch (err) {\n        console.error('Drag geocode failed:', err);\n        setGecodingStatus(' Address lookup failed');\n      } finally {\n        setIsReverseGeocoding(false);\n        setTimeout(() => setGecodingStatus(''), 3000);\n      }\n    };\n\n    if (!pos) {\n      return (\n        <div className=\"w-full h-48 rounded-lg bg-gray-100 flex items-center justify-center text-sm text-gray-500 border border-dashed border-gray-300\">\n          Set an address to drop a pin on the map\n        </div>\n      );\n    }\n\n    return (\n      <div className=\"relative\">\n        <Map\n          mapLib={maplibregl}\n          mapStyle={PREVIEW_MAP_STYLE}\n          {...viewState}\n          onMove={(evt) => setViewState(evt.viewState)}\n          attributionControl={false}\n          style={{ width: '100%', height: '12rem', borderRadius: '0.75rem' }}\n        >\n          <MapMarker\n            latitude={pos.lat}\n            longitude={pos.lng}\n            draggable\n            onDragStart={() => setIsDragging(true)}\n            onDragEnd={handleDragEnd}\n            anchor=\"bottom\"\n          >\n            <div className=\"price-marker-container selected\">\n              <div className=\"price-marker-bubble text-xs\">\n                <span className=\"price-text\">Drag me</span>\n              </div>\n              <div className=\"price-marker-arrow\" />\n            </div>\n          </MapMarker>\n        </Map>\n        {!isDragging && (\n          <div className=\"absolute bottom-2 left-1/2 -translate-x-1/2 bg-black/70 text-white text-xs px-3 py-1.5 rounded-full pointer-events-none flex items-center gap-1.5\">\n            <span></span> Drag pin to adjust location\n          </div>\n        )}\n        {isDragging && (\n          <div className=\"absolute top-2 left-1/2 -translate-x-1/2 bg-teal-600 text-white text-xs px-3 py-1.5 rounded-full pointer-events-none animate-pulse\">\n             Drop to set new location\n          </div>\n        )}\n      </div>\n    );\n  }\n\n  // Compact inline map shown immediately after coordinates appear (quick visual confirmation)\n  function InlineMiniMap({ lat, lng }) {\n    if (typeof lat !== 'number' || typeof lng !== 'number') return null;\n    return (\n      <div className=\"mt-3 w-full border border-gray-200 rounded-lg overflow-hidden\">\n        <Map\n          mapLib={maplibregl}\n          mapStyle={PREVIEW_MAP_STYLE}\n          initialViewState={{ latitude: lat, longitude: lng, zoom: 15 }}\n          style={{ width: '100%', height: '10rem' }}\n          interactive={false}\n          attributionControl={false}\n        >\n          <MapMarker latitude={lat} longitude={lng} anchor=\"bottom\">\n            <div className=\"user-location-container\">\n              <div className=\"user-location-pulse\" />\n              <div className=\"user-location-dot\" />\n            </div>\n          </MapMarker>\n        </Map>\n      </div>\n    );\n  }\n\n  const toggleAmenity = (amenity) => {\n    if (formData.amenities.includes(amenity)) {\n      setFormData({ ...formData, amenities: formData.amenities.filter(a => a !== amenity) });\n    } else {\n      setFormData({ ...formData, amenities: [...formData.amenities, amenity] });\n    }\n  };\n\n  const [isSubmitting, setIsSubmitting] = useState(false);\n\n  const handleSubmit = async () => {\n    // Enforce auth and onboarding checks before allowing submission\n    if (!currentUser) {\n      onRequireAuth && onRequireAuth('landlord');\n      return;\n    }\n    if (userType !== 'landlord') {\n      // prompt to become landlord\n      onRequireAuth && onRequireAuth('landlord');\n      return;\n    }\n    if (!currentUser.landlordComplete) {\n      // send to onboarding\n      onRequireOnboarding && onRequireOnboarding();\n      return;\n    }\n\n    // Validate all fields\n    validateField('title', formData.title);\n    validateField('price', formData.price);\n    validateField('location', formData.location);\n    validateField('description', formData.description);\n\n    if (!formData.title || formData.title.trim().length < 5) {\n      setErrors(prev => ({ ...prev, title: 'Title must be at least 5 characters' }));\n      return;\n    }\n    if (!formData.price || parseFloat(formData.price) <= 0) {\n      setErrors(prev => ({ ...prev, price: 'Price must be greater than 0' }));\n      return;\n    }\n    if (!formData.location || formData.location.trim().length < 3) {\n      setErrors(prev => ({ ...prev, location: 'Location is required' }));\n      return;\n    }\n    if (Object.keys(errors).length > 0) {\n      return;\n    }\n\n    setIsSubmitting(true);\n    try {\n      await onSubmit(formData);\n    } finally {\n      setIsSubmitting(false);\n    }\n  };\n\n  // Auto-attempt geolocation shortly after mount for landlord convenience\n  useEffect(() => {\n    const shouldAttempt = !formData.latitude && !formData.longitude;\n    if (shouldAttempt) {\n      const t = setTimeout(() => {\n        console.log('Auto-triggering current location detection...');\n        geolocateCurrentPosition();\n      }, 500); // Faster trigger\n      return () => clearTimeout(t);\n    }\n  // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [formData.latitude, formData.longitude]);\n\n  return (\n    <div className=\"p-4 bg-gray-50 min-h-screen pb-20\">\n      <div className=\"max-w-3xl mx-auto mt-8\">\n        <div className=\"bg-white rounded-lg shadow-sm border border-gray-200 p-8\">\n          <div className=\"flex items-center justify-between mb-8\">\n            <h2 className=\"text-3xl font-bold text-gray-800\">Post a Room</h2>\n            <button onClick={onCancel} className=\"text-gray-400 hover:text-gray-600 transition\">\n              <X className=\"w-6 h-6\" />\n            </button>\n          </div>\n\n          <div className=\"space-y-6\">\n            {/* Title */}\n            <div>\n              <label className=\"block text-sm font-semibold text-gray-800 mb-2\">\n                Room Title *\n                {formData.title && formData.title.trim().length >= 5 && !errors.title && (\n                  <span className=\"ml-2 text-green-600 text-xs\"> Looks good</span>\n                )}\n              </label>\n              <div className=\"relative\">\n                <input\n                  type=\"text\"\n                  required\n                  value={formData.title}\n                  onChange={(e) => {\n                    setFormData({ ...formData, title: e.target.value });\n                    validateField('title', e.target.value);\n                  }}\n                  onBlur={(e) => validateField('title', e.target.value)}\n                  placeholder=\"e.g., Cozy backroom with private bathroom\"\n                  className={`w-full px-4 py-3 pr-10 border ${\n                    errors.title ? 'border-red-500 bg-red-50' : \n                    formData.title && formData.title.trim().length >= 5 ? 'border-green-500 bg-green-50' : \n                    'border-gray-300'\n                  } text-gray-800 rounded-lg focus:ring-2 ${\n                    errors.title ? 'focus:ring-red-500' : 'focus:ring-blue-500'\n                  } focus:border-transparent transition-all placeholder-gray-400`}\n                />\n                {formData.title && formData.title.trim().length >= 5 && !errors.title && (\n                  <CheckCircle className=\"absolute right-3 top-1/2 -translate-y-1/2 w-5 h-5 text-green-600\" />\n                )}\n              </div>\n              {errors.title && <p className=\"text-red-500 text-xs mt-1 flex items-center gap-1\"><span></span> {errors.title}</p>}\n            </div>\n\n            {/* Price */}\n            <div>\n              <label className=\"block text-sm font-semibold text-gray-800 mb-2\">\n                Monthly Price (R) *\n                {formData.price && parseFloat(formData.price) >= 500 && parseFloat(formData.price) <= 50000 && !errors.price && (\n                  <span className=\"ml-2 text-green-600 text-xs\"> Valid price</span>\n                )}\n              </label>\n              <div className=\"relative\">\n                <span className=\"absolute left-4 top-1/2 -translate-y-1/2 text-gray-500 font-medium\">R</span>\n                <input\n                  type=\"number\"\n                  required\n                  value={formData.price}\n                  onChange={(e) => {\n                    setFormData({ ...formData, price: e.target.value });\n                    validateField('price', e.target.value);\n                  }}\n                  onBlur={(e) => validateField('price', e.target.value)}\n                  placeholder=\"2500\"\n                  min=\"500\"\n                  max=\"50000\"\n                  className={`w-full pl-10 pr-4 py-3 border ${\n                    errors.price ? 'border-red-500 bg-red-50' : \n                    formData.price && parseFloat(formData.price) >= 500 && parseFloat(formData.price) <= 50000 ? 'border-green-500 bg-green-50' : \n                    'border-gray-300'\n                  } text-gray-800 rounded-lg focus:ring-2 ${\n                    errors.price ? 'focus:ring-red-500' : 'focus:ring-blue-500'\n                  } focus:border-transparent transition-all placeholder-gray-400`}\n                />\n                {formData.price && parseFloat(formData.price) >= 500 && parseFloat(formData.price) <= 50000 && !errors.price && (\n                  <CheckCircle className=\"absolute right-3 top-1/2 -translate-y-1/2 w-5 h-5 text-green-600\" />\n                )}\n              </div>\n              {errors.price && <p className=\"text-red-500 text-xs mt-1 flex items-center gap-1\"><span></span> {errors.price}</p>}\n              {!errors.price && formData.price && (\n                <p className=\"text-gray-500 text-xs mt-1\">Suggested range: R500 - R50,000 per month</p>\n              )}\n            </div>\n\n            {/* Location and Street Address */}\n            <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n              <div>\n                <label className=\"block text-sm font-semibold text-gray-800 mb-2\">Area / City *</label>\n                <input\n                  type=\"text\"\n                  required\n                  value={formData.location}\n                  onChange={(e) => {\n                    setFormData({ ...formData, location: e.target.value });\n                    validateField('location', e.target.value);\n                  }}\n                  onBlur={(e) => validateField('location', e.target.value)}\n                  placeholder=\"e.g., Soweto, Johannesburg\"\n                  className={`w-full px-4 py-3 border ${errors.location ? 'border-red-500' : 'border-gray-300'} bg-white text-gray-800 rounded-lg focus:ring-2 ${errors.location ? 'focus:ring-red-500' : 'focus:ring-blue-500'} focus:border-transparent transition placeholder-gray-400`}\n                />\n                {errors.location && <p className=\"text-red-500 text-xs mt-1\">{errors.location}</p>}\n                {locationSuggestionsLoading && (\n                  <p className=\"text-xs text-blue-600 mt-1 animate-pulse\" aria-live=\"polite\">Loading suggestions...</p>\n                )}\n                {locationSuggestions.length > 0 && (\n                  <div className=\"mt-2 border border-gray-200 rounded-lg bg-white shadow-sm divide-y\">\n                    {locationSuggestions.map(s => (\n                      <button\n                        key={s}\n                        type=\"button\"\n                        onClick={() => { setFormData({ ...formData, location: s }); setLocationSuggestions([]); validateField('location', s); }}\n                        className=\"w-full text-left px-3 py-2 text-sm hover:bg-blue-50\"\n                      >{s}</button>\n                    ))}\n                  </div>\n                )}\n              </div>\n\n              <div>\n                <label className=\"block text-sm font-semibold text-gray-800 mb-2\">Street Address</label>\n                <input\n                  type=\"text\"\n                  value={formData.streetAddress}\n                  onChange={(e) => setFormData({ ...formData, streetAddress: e.target.value })}\n                  placeholder=\"e.g., 123 Main Street\"\n                  className=\"w-full px-4 py-3 border border-gray-300 bg-white text-gray-800 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition placeholder-gray-400\"\n                />\n              </div>\n            </div>\n\n            {/* Geocode Section - Prominent Auto-Location */}\n            <div className=\"bg-gradient-to-br from-blue-50 to-indigo-50 border-2 border-blue-300 rounded-lg p-6\">\n              <div className=\"flex items-start gap-3 mb-4\">\n                <MapPin className=\"w-6 h-6 text-blue-600 flex-shrink-0 mt-1\" />\n                <div className=\"flex-1\">\n                  <h3 className=\"text-lg font-semibold text-gray-800 mb-1\">Set Your Precise Location</h3>\n                  <p className=\"text-sm text-gray-600\">For best accuracy, use your current GPS location. The exact address will be automatically detected.</p>\n                </div>\n              </div>\n\n              <div className=\"flex flex-wrap gap-3 items-center mb-4\">\n                {locationHelpBanner && (\n                  <div className=\"w-full bg-yellow-50 border-2 border-yellow-200 text-yellow-800 rounded-lg p-3 text-sm flex items-start gap-2\">\n                    <span></span>\n                    <div className=\"flex-1\">\n                      {locationHelpBanner}\n                      <button\n                        type=\"button\"\n                        className=\"ml-2 underline font-semibold\"\n                        onClick={() => window.alert('To enable location: 1) Tap the lock icon in the address bar. 2) Find Location permission. 3) Set to Allow. Then refresh the page.')}\n                      >How to enable</button>\n                    </div>\n                  </div>\n                )}\n                <div className=\"w-full flex items-start gap-2 text-xs text-blue-800 bg-white border border-blue-300 rounded p-3\">\n                  <span className=\"text-lg\"></span>\n                  <span><strong>Recommended:</strong> Click \"Use Current Location\" for GPS accuracy (within meters). You can then drag the pin on the map to fine-tune if needed.</span>\n                </div>\n                \n                {/* Primary action - Current Location */}\n                <button\n                  type=\"button\"\n                  onClick={geolocateCurrentPosition}\n                  className=\"w-full md:w-auto bg-gradient-to-r from-blue-600 to-indigo-600 hover:from-blue-700 hover:to-indigo-700 text-white px-8 py-3 rounded-lg font-bold transition shadow-md flex items-center justify-center gap-2 text-base\"\n                >\n                  <MapPin className=\"w-5 h-5\" />\n                  Use Current Location (Recommended)\n                </button>\n\n                {/* Secondary action - Manual address lookup */}\n                <button\n                  type=\"button\"\n                  onClick={geocodeAddress}\n                  className=\"w-full md:w-auto bg-white hover:bg-gray-50 text-gray-700 border-2 border-gray-300 px-6 py-3 rounded-lg text-sm font-semibold transition flex items-center justify-center gap-2\"\n                >\n                  <MapPin className=\"w-4 h-4\" />\n                  Find Address on Map\n                </button>\n\n                <div className=\"text-sm flex-1\">\n                  {geocodingStatus && (\n                    <span className={`${geocodingStatus.startsWith('') ? 'text-green-600 font-semibold' : geocodingStatus.startsWith('') ? 'text-blue-600' : geocodingStatus.startsWith('') ? 'text-amber-600' : 'text-gray-700'} flex items-center gap-1`}>\n                      {geocodingStatus.startsWith('') && <CheckCircle className=\"w-4 h-4\" />}\n                      {isReverseGeocoding && <Loader2 className=\"w-4 h-4 animate-spin\" />}\n                      {geocodingStatus}\n                      {lastGeocodeSource === 'cached' && (\n                        <span className=\"ml-2 inline-block px-2 py-1 text-[10px] rounded bg-purple-100 text-purple-600 font-semibold\">CACHED</span>\n                      )}\n                      {lastGeocodeSource === 'mapbox' && (\n                        <span className=\"ml-2 inline-block px-2 py-1 text-[10px] rounded bg-blue-100 text-blue-600 font-semibold\">MAPBOX</span>\n                      )}\n                      {lastGeocodeSource === 'maps.co' && (\n                        <span className=\"ml-2 inline-block px-2 py-1 text-[10px] rounded bg-indigo-100 text-indigo-600 font-semibold\">MAPS.CO</span>\n                      )}\n                      {lastGeocodeSource === 'proxy' && (\n                        <span className=\"ml-2 inline-block px-2 py-1 text-[10px] rounded bg-green-100 text-green-600 font-semibold\">PROXY</span>\n                      )}\n                      {lastGeocodeSource === 'direct' && (\n                        <span className=\"ml-2 inline-block px-2 py-1 text-[10px] rounded bg-yellow-100 text-yellow-700 font-semibold\">FALLBACK</span>\n                      )}\n                      {lastGeocodeSource === 'coords-only' && (\n                        <span className=\"ml-2 inline-block px-2 py-1 text-[10px] rounded bg-red-100 text-red-600 font-semibold\">COORDS ONLY</span>\n                      )}\n                    </span>\n                  )}\n                  {formData.latitude && formData.longitude && !geocodingStatus && (\n                    <span className=\"text-green-600 font-semibold flex items-center gap-1\">\n                      <CheckCircle className=\"w-4 h-4\" />\n                      Location set: {formData.latitude.toFixed(4)}, {formData.longitude.toFixed(4)}\n                      {lastGeocodeSource === 'cached' && (\n                        <span className=\"ml-2 inline-block px-2 py-1 text-[10px] rounded bg-purple-100 text-purple-600 font-semibold\">CACHED</span>\n                      )}\n                      {lastGeocodeSource === 'maps.co' && (\n                        <span className=\"ml-2 inline-block px-2 py-1 text-[10px] rounded bg-indigo-100 text-indigo-600 font-semibold\">MAPS.CO</span>\n                      )}\n                      {lastGeocodeSource === 'coords-only' && (\n                        <span className=\"ml-2 inline-block px-2 py-1 text-[10px] rounded bg-red-100 text-red-600 font-semibold\">COORDS ONLY</span>\n                      )}\n                    </span>\n                  )}\n                  {lastGeocodeSource === 'coords-only' && (\n                    <button\n                      type=\"button\"\n                      onClick={geolocateCurrentPosition}\n                      className=\"mt-2 text-xs font-semibold underline text-blue-700\"\n                    >Retry address lookup</button>\n                  )}\n                  {/* Inline mini preview map for immediate visual feedback */}\n                  <InlineMiniMap lat={formData.latitude} lng={formData.longitude} />\n                </div>\n              </div>\n\n              {/* Draggable preview map */}\n              <div className=\"mt-4\">\n                {(formData.latitude && formData.longitude) ? (\n                  <div>\n                    <label className=\"block text-sm font-semibold text-gray-800 mb-2\">Fine-tune Location (drag pin)</label>\n                    <DraggablePreview lat={formData.latitude} lng={formData.longitude} />\n                  </div>\n                ) : (\n                  <div className=\"text-sm text-gray-600 bg-white border border-gray-200 rounded-lg p-4 text-center\">\n                    <MapPin className=\"w-8 h-8 mx-auto mb-2 text-gray-400\" />\n                    No location set yet. Click \"Find on Map\" or \"Use Current Location\" to place a pin.\n                  </div>\n                )}\n              </div>\n            </div>\n\n            {/* Status and Available Date - Two columns */}\n            <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n              <div>\n                <label className=\"block text-sm font-semibold text-gray-800 mb-2\">Status</label>\n                <select\n                  value={formData.status}\n                  onChange={(e) => setFormData({ ...formData, status: e.target.value })}\n                  className=\"w-full px-4 py-3 border border-gray-300 bg-white text-gray-800 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition\"\n                >\n                  <option value=\"available\">Available</option>\n                  <option value=\"rented\">Rented</option>\n                </select>\n              </div>\n\n              <div>\n                <label className=\"block text-sm font-semibold text-gray-800 mb-2\">Available Date</label>\n                <input\n                  type=\"date\"\n                  value={formData.availableDate}\n                  onChange={(e) => setFormData({ ...formData, availableDate: e.target.value })}\n                  className=\"w-full px-4 py-3 border border-gray-300 bg-white text-gray-800 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition\"\n                />\n              </div>\n            </div>\n\n            {/* Payment Method */}\n            <div>\n              <label className=\"block text-sm font-semibold text-gray-800 mb-2\">Payment Method</label>\n              <select\n                value={formData.paymentMethod}\n                onChange={(e) => setFormData({ ...formData, paymentMethod: e.target.value })}\n                className=\"w-full px-4 py-3 border border-gray-300 bg-white text-gray-800 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition\"\n              >\n                <option value=\"Bank and Cash\">Bank and Cash</option>\n                <option value=\"Cash Only\">Cash Only</option>\n                <option value=\"Bank Only\">Bank Only</option>\n              </select>\n            </div>\n\n            {/* Room Type and Lease Duration - Two columns */}\n            <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n              <div>\n                <label className=\"block text-sm font-semibold text-gray-800 mb-2\">Room Type</label>\n                <select\n                  value={formData.roomType}\n                  onChange={(e) => setFormData({ ...formData, roomType: e.target.value })}\n                  className=\"w-full px-4 py-3 border border-gray-300 bg-white text-gray-800 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition\"\n                >\n                  <option value=\"private\">Private Room</option>\n                  <option value=\"shared\">Shared Room</option>\n                </select>\n              </div>\n\n              <div>\n                <label className=\"block text-sm font-semibold text-gray-800 mb-2\">Lease Duration (months)</label>\n                <select\n                  value={formData.leaseDuration}\n                  onChange={(e) => setFormData({ ...formData, leaseDuration: e.target.value })}\n                  className=\"w-full px-4 py-3 border border-gray-300 bg-white text-gray-800 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition\"\n                >\n                  <option value=\"1-3\">1-3 months</option>\n                  <option value=\"4-6\">4-6 months</option>\n                  <option value=\"7-12\">7-12 months</option>\n                  <option value=\"12+\">12+ months</option>\n                </select>\n              </div>\n            </div>\n\n            {/* Pet Friendly and Gender Preference */}\n            <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n              <div className=\"flex items-center gap-3\">\n                <input\n                  type=\"checkbox\"\n                  checked={formData.petFriendly}\n                  onChange={(e) => setFormData({ ...formData, petFriendly: e.target.checked })}\n                  id=\"petFriendly\"\n                  className=\"w-4 h-4 text-blue-600 border-gray-300 rounded focus:ring-blue-500\"\n                />\n                <label htmlFor=\"petFriendly\" className=\"text-sm font-medium text-gray-700\">\n                   Pet Friendly\n                </label>\n              </div>\n\n              <div>\n                <label className=\"block text-sm font-semibold text-gray-800 mb-2\">Gender Preference</label>\n                <select\n                  value={formData.genderPreference}\n                  onChange={(e) => setFormData({ ...formData, genderPreference: e.target.value })}\n                  className=\"w-full px-4 py-3 border border-gray-300 bg-white text-gray-800 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition\"\n                >\n                  <option value=\"any\">Any</option>\n                  <option value=\"male\">Male Only</option>\n                  <option value=\"female\">Female Only</option>\n                </select>\n              </div>\n            </div>\n\n            {/* Premium Flag */}\n            <div className=\"flex items-center gap-3\">\n              <input\n                type=\"checkbox\"\n                checked={!!formData.premium}\n                onChange={(e) => setFormData({ ...formData, premium: e.target.checked })}\n                id=\"premiumFlag\"\n              />\n              <label htmlFor=\"premiumFlag\" className=\"text-sm font-medium text-gray-700\">\n                Premium listing (highlight & priority sorting)\n              </label>\n            </div>\n\n            {/* Description */}\n            <div>\n              <label className=\"block text-sm font-semibold text-gray-800 mb-2\">\n                Description \n                {formData.description && (\n                  <span className={`ml-2 text-xs ${formData.description.length > 500 ? 'text-red-500' : 'text-gray-500'}`}>\n                    ({formData.description.length}/500 characters)\n                  </span>\n                )}\n              </label>\n              <textarea\n                value={formData.description}\n                onChange={(e) => {\n                  setFormData({ ...formData, description: e.target.value });\n                  validateField('description', e.target.value);\n                }}\n                onBlur={(e) => validateField('description', e.target.value)}\n                placeholder=\"Describe the room, amenities, rules, and any other details...\"\n                rows=\"4\"\n                className={`w-full px-4 py-3 border ${errors.description ? 'border-red-500' : 'border-gray-300'} bg-white text-gray-800 rounded-lg focus:ring-2 ${errors.description ? 'focus:ring-red-500' : 'focus:ring-blue-500'} focus:border-transparent transition placeholder-gray-400`}\n              />\n              {errors.description && <p className=\"text-red-500 text-xs mt-1\">{errors.description}</p>}\n            </div>\n\n            {/* Amenities */}\n            <div>\n              <label className=\"block text-sm font-semibold text-gray-800 mb-3\">Amenities</label>\n              <div className=\"grid grid-cols-2 md:grid-cols-3 gap-2\">\n                {availableAmenities.map(amenity => (\n                  <button\n                    key={amenity}\n                    type=\"button\"\n                    onClick={() => toggleAmenity(amenity)}\n                    className={`px-4 py-2 rounded-lg text-sm font-medium transition ${\n                      formData.amenities.includes(amenity)\n                        ? 'bg-blue-600 text-white shadow-sm'\n                        : 'bg-gray-100 text-gray-700 border border-gray-300 hover:bg-gray-200'\n                    }`}\n                  >\n                    {amenity}\n                  </button>\n                ))}\n              </div>\n            </div>\n\n            {/* Photos */}\n            <div>\n              <label className=\"block text-sm font-semibold text-gray-800 mb-2\">Photos (Max 5)</label>\n              <div className=\"flex gap-2\">\n                <button\n                  type=\"button\"\n                  onClick={() => setShowPhotoEditor(true)}\n                  className=\"flex-1 px-4 py-3 border-2 border-dashed border-gray-300 bg-gray-50 text-gray-700 rounded-lg hover:border-blue-500 hover:bg-blue-50 transition font-medium\"\n                >\n                  {formData.photos.length === 0 ? ' Add Photos' : ` Edit Photos (${formData.photos.length}/5)`}\n                </button>\n              </div>\n              {formData.photos.length > 0 && (\n                <div className=\"mt-4 grid grid-cols-2 md:grid-cols-3 gap-3\">\n                  {formData.photos.map((photo, index) => (\n                    <div key={index} className=\"relative group\">\n                      {index === 0 && (\n                        <div className=\"absolute top-2 left-2 bg-blue-600 text-white text-xs px-2 py-1 rounded-full font-semibold z-10\">\n                          Cover\n                        </div>\n                      )}\n                      <img \n                        src={photo} \n                        alt={`Preview ${index + 1}`} \n                        className=\"w-full h-32 object-cover rounded-lg border border-gray-200 shadow-sm\" \n                      />\n                    </div>\n                  ))}\n                </div>\n              )}\n            </div>\n\n            {showPhotoEditor && (\n              <PhotoEditor\n                photos={formData.photos}\n                onPhotosChange={(newPhotos) => setFormData({ ...formData, photos: newPhotos })}\n                onClose={() => setShowPhotoEditor(false)}\n                maxPhotos={5}\n              />\n            )}\n\n            {/* Submit Button */}\n            <div className=\"border-t border-gray-200 pt-6\">\n              <button\n                onClick={handleSubmit}\n                disabled={isSubmitting || Object.keys(errors).length > 0}\n                className={`w-full font-semibold py-3 rounded-lg transition shadow-sm relative ${\n                  isSubmitting || Object.keys(errors).length > 0\n                    ? 'bg-gray-400 cursor-not-allowed'\n                    : 'bg-blue-600 hover:bg-blue-700 text-white'\n                }`}\n              >\n                {isSubmitting ? (\n                  <>\n                    <span className=\"opacity-0\">Post Room</span>\n                    <div className=\"absolute inset-0 flex items-center justify-center\">\n                      <div className=\"w-5 h-5 border-2 border-white border-t-transparent rounded-full animate-spin\" />\n                    </div>\n                  </>\n                ) : (\n                  'Post Room'\n                )}\n              </button>\n              {Object.keys(errors).length > 0 && (\n                <p className=\"text-red-500 text-xs mt-2 text-center\">Please fix the errors above before submitting</p>\n              )}\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n}\n\n// MessagesView removed - using direct contact instead\n\nfunction MyListingsView({ listings, onDelete }) {\n  return (\n    <div className=\"p-4\">\n      <h2 className=\"text-2xl font-bold mb-4 text-gray-800\">My Listings</h2>\n      <div className=\"space-y-4\">\n        {listings.length === 0 ? (\n          <div className=\"bg-gradient-to-br from-blue-50 to-teal-50 rounded-xl shadow-sm p-12 text-center border border-blue-100\">\n            <div className=\"bg-white w-24 h-24 rounded-full flex items-center justify-center mx-auto mb-6 shadow-md\">\n              <Home className=\"w-12 h-12 text-blue-500\" />\n            </div>\n            <h3 className=\"text-xl font-bold text-gray-800 mb-2\">No Listings Yet</h3>\n            <p className=\"text-gray-600 mb-6 max-w-md mx-auto\">\n              Start earning by posting your first room. It only takes a few minutes!\n            </p>\n            <button\n              onClick={() => window.location.hash = '#add'}\n              className=\"inline-flex items-center gap-2 bg-blue-600 hover:bg-blue-700 text-white font-semibold px-6 py-3 rounded-lg transition shadow-md hover:shadow-lg\"\n            >\n              <PlusCircle className=\"w-5 h-5\" />\n              Post Your First Room\n            </button>\n          </div>\n        ) : (\n          listings.map(listing => (\n            <div key={listing.id} className=\"bg-white rounded-lg shadow p-4\">\n{listing.photos && listing.photos.length > 0 && (\n  <div className=\"relative mb-3\">\n    <img src={listing.photos[0]} alt=\"Room\" className=\"w-full h-32 object-cover rounded-lg\" />\n    {listing.photos.length > 1 && (\n      <div className=\"absolute top-2 right-2 bg-black bg-opacity-60 text-white px-2 py-1 rounded text-xs\">\n        {listing.photos.length} photos\n      </div>\n    )}\n  </div>\n)}\n              <h3 className=\"font-bold text-lg mb-1\">{listing.title}</h3>\n              <div className=\"text-blue-600 font-bold mb-2\">R{listing.price}/month</div>\n              <div className=\"flex items-center text-gray-600 text-sm mb-3\">\n                <MapPin className=\"w-4 h-4 mr-1\" />\n                {listing.location}\n              </div>\n              <button\n                onClick={() => onDelete(listing.id)}\n                className=\"w-full bg-red-500 hover:bg-red-600 text-white py-2 rounded-lg transition\"\n              >\n                Delete Listing\n              </button>\n            </div>\n          ))\n        )}\n      </div>\n    </div>\n  );\n}\n\n\n// Inline message box component with validation for listing detail view\n// ListingInlineMessageBox removed\n\n// ConversationModal removed\n\nfunction AuthModal({ defaultType = 'renter', onClose, onSubmit }) {\n  const [form, setForm] = useState({ name: '', phone: '', email: '', type: defaultType, photo: '' });\n  const [errors, setErrors] = useState({});\n  const [isSubmitting, setIsSubmitting] = useState(false);\n\n  const validateForm = () => {\n    const newErrors = {};\n    if (!form.name || form.name.trim().length < 2) {\n      newErrors.name = 'Name must be at least 2 characters';\n    }\n    if (!form.email || !/^[^\\s@]+@[^\\s@]+\\.[^\\s@]+$/.test(form.email)) {\n      newErrors.email = 'Please enter a valid email address';\n    }\n    setErrors(newErrors);\n    return Object.keys(newErrors).length === 0;\n  };\n\n  const handleSubmit = async () => {\n    if (!validateForm()) return;\n    setIsSubmitting(true);\n    try {\n      await onSubmit(form);\n    } finally {\n      setIsSubmitting(false);\n    }\n  };\n\n  return (\n    <div className=\"fixed inset-0 bg-black/60 backdrop-blur-sm flex items-start sm:items-center justify-center p-4 pt-16 sm:pt-4 z-50 overflow-y-auto\">\n      <div className=\"bg-white rounded-2xl w-full max-w-md p-6 my-auto shadow-2xl fade-in\">\n        {/* Header */}\n        <div className=\"flex items-center justify-between mb-6\">\n          <div>\n            <h3 className=\"text-xl font-bold text-gray-800\">Welcome to Room24</h3>\n            <p className=\"text-sm text-gray-500 mt-1\">Sign in or create an account</p>\n          </div>\n          <button \n            onClick={onClose} \n            className=\"p-2 text-gray-400 hover:text-gray-600 hover:bg-gray-100 rounded-full transition\"\n          >\n            <X className=\"w-5 h-5\" />\n          </button>\n        </div>\n\n        <div className=\"space-y-4\">\n          {/* Name */}\n          <div>\n            <label className=\"block text-sm font-semibold text-gray-700 mb-1.5\">Full name *</label>\n            <input \n              type=\"text\" \n              value={form.name} \n              onChange={(e) => { setForm({ ...form, name: e.target.value }); setErrors({ ...errors, name: '' }); }}\n              className={`w-full px-4 py-2.5 border-2 rounded-lg transition-all focus:ring-2 focus:ring-blue-100 focus:border-blue-500 ${\n                errors.name ? 'border-red-400 bg-red-50' : 'border-gray-200 hover:border-gray-300'\n              }`}\n              placeholder=\"John Doe\"\n            />\n            {errors.name && <p className=\"text-red-500 text-xs mt-1\">{errors.name}</p>}\n          </div>\n\n          {/* Email */}\n          <div>\n            <label className=\"block text-sm font-semibold text-gray-700 mb-1.5\">Email *</label>\n            <input \n              type=\"email\" \n              value={form.email} \n              onChange={(e) => { setForm({ ...form, email: e.target.value }); setErrors({ ...errors, email: '' }); }}\n              className={`w-full px-4 py-2.5 border-2 rounded-lg transition-all focus:ring-2 focus:ring-blue-100 focus:border-blue-500 ${\n                errors.email ? 'border-red-400 bg-red-50' : 'border-gray-200 hover:border-gray-300'\n              }`}\n              placeholder=\"john@example.com\"\n            />\n            {errors.email && <p className=\"text-red-500 text-xs mt-1\">{errors.email}</p>}\n          </div>\n\n          {/* Phone */}\n          <div>\n            <label className=\"block text-sm font-semibold text-gray-700 mb-1.5\">\n              Phone <span className=\"text-gray-400 font-normal\">(optional)</span>\n            </label>\n            <input \n              type=\"tel\" \n              value={form.phone} \n              onChange={(e) => setForm({ ...form, phone: e.target.value })}\n              className=\"w-full px-4 py-2.5 border-2 border-gray-200 hover:border-gray-300 rounded-lg transition-all focus:ring-2 focus:ring-blue-100 focus:border-blue-500\"\n              placeholder=\"+27 12 345 6789\"\n            />\n          </div>\n\n          {/* User Type */}\n          <div>\n            <label className=\"block text-sm font-semibold text-gray-700 mb-1.5\">I am a</label>\n            <div className=\"grid grid-cols-2 gap-3\">\n              <button\n                type=\"button\"\n                onClick={() => setForm({ ...form, type: 'renter' })}\n                className={`p-3 rounded-lg border-2 transition-all flex flex-col items-center gap-1 ${\n                  form.type === 'renter' \n                    ? 'border-blue-500 bg-blue-50 text-blue-700' \n                    : 'border-gray-200 hover:border-gray-300 text-gray-600'\n                }`}\n              >\n                <Search className=\"w-5 h-5\" />\n                <span className=\"text-sm font-medium\">Looking for a room</span>\n              </button>\n              <button\n                type=\"button\"\n                onClick={() => setForm({ ...form, type: 'landlord' })}\n                className={`p-3 rounded-lg border-2 transition-all flex flex-col items-center gap-1 ${\n                  form.type === 'landlord' \n                    ? 'border-blue-500 bg-blue-50 text-blue-700' \n                    : 'border-gray-200 hover:border-gray-300 text-gray-600'\n                }`}\n              >\n                <Home className=\"w-5 h-5\" />\n                <span className=\"text-sm font-medium\">Listing rooms</span>\n              </button>\n            </div>\n          </div>\n\n          {/* Buttons */}\n          <div className=\"flex gap-3 pt-4\">\n            <button \n              onClick={onClose} \n              className=\"flex-1 bg-gray-100 hover:bg-gray-200 text-gray-700 font-medium py-2.5 rounded-lg transition\"\n            >\n              Cancel\n            </button>\n            <button \n              onClick={handleSubmit}\n              disabled={isSubmitting}\n              className={`flex-1 font-semibold py-2.5 rounded-lg transition-all relative ${\n                isSubmitting ? 'bg-blue-400 cursor-not-allowed' : 'bg-blue-600 hover:bg-blue-700 text-white hover:shadow-lg'\n              }`}\n            >\n              {isSubmitting ? (\n                <>\n                  <span className=\"opacity-0\">Continue</span>\n                  <div className=\"absolute inset-0 flex items-center justify-center\">\n                    <div className=\"w-5 h-5 border-2 border-white border-t-transparent rounded-full animate-spin\" />\n                  </div>\n                </>\n              ) : (\n                'Continue'\n              )}\n            </button>\n          </div>\n        </div>\n\n        {/* Footer */}\n        <p className=\"text-xs text-gray-400 text-center mt-6\">\n          By continuing, you agree to our Terms of Service and Privacy Policy\n        </p>\n      </div>\n    </div>\n  );\n}\n\nfunction LocationConsentModal({ onAccept, onDecline }) {\n  return (\n    <div className=\"fixed inset-0 bg-black bg-opacity-60 flex items-center justify-center p-4 z-50\">\n      <div className=\"bg-white rounded-lg max-w-md w-full p-6 shadow-xl\">\n        <div className=\"flex items-center gap-3 mb-4\">\n          <MapPin className=\"w-8 h-8 text-blue-600\" />\n          <h3 className=\"text-xl font-bold text-gray-800\">Location Access</h3>\n        </div>\n        \n        <p className=\"text-gray-600 mb-4\">\n          Room24 would like to access your location to show nearby rental listings. Your location data:\n        </p>\n        \n        <ul className=\"text-sm text-gray-600 mb-6 space-y-2\">\n          <li className=\"flex items-start gap-2\">\n            <span className=\"text-green-600 mt-0.5\"></span>\n            <span>Is only used to calculate distances to listings</span>\n          </li>\n          <li className=\"flex items-start gap-2\">\n            <span className=\"text-green-600 mt-0.5\"></span>\n            <span>Is not stored on our servers</span>\n          </li>\n          <li className=\"flex items-start gap-2\">\n            <span className=\"text-green-600 mt-0.5\"></span>\n            <span>Is not shared with third parties</span>\n          </li>\n        </ul>\n\n        <div className=\"flex gap-3\">\n          <button\n            onClick={onDecline}\n            className=\"flex-1 bg-gray-100 hover:bg-gray-200 text-gray-800 font-semibold py-3 rounded-lg transition\"\n          >\n            Not Now\n          </button>\n          <button\n            onClick={onAccept}\n            className=\"flex-1 bg-blue-600 hover:bg-blue-700 text-white font-semibold py-3 rounded-lg transition\"\n          >\n            Allow\n          </button>\n        </div>\n        \n        <p className=\"text-xs text-gray-500 mt-4 text-center\">\n          You can change this permission anytime in your browser settings.\n        </p>\n      </div>\n    </div>\n  );\n}\n\nfunction BottomNav({ currentView, setCurrentView, userType }) {\n  const navItems = [\n    { id: 'browse', label: 'Browse', icon: <Search className=\"w-5 h-5\" /> },\n    { id: 'add', label: 'List Room', icon: <PlusCircle className=\"w-5 h-5\" />, requiresLandlord: true },\n    { id: 'my-rooms', label: 'My Rooms', icon: <Home className=\"w-5 h-5\" /> },\n    { id: 'profile', label: 'Profile', icon: <User className=\"w-5 h-5\" /> }\n  ];\n\n  return (\n    <div className=\"fixed bottom-0 left-0 right-0 bg-white border-t border-gray-200 px-4 py-2 z-20 md:hidden\">\n      <div className=\"grid grid-cols-4 gap-2\">\n        {navItems.map(item => {\n          const disabled = item.requiresLandlord && userType !== 'landlord';\n          const isActive = currentView === item.id;\n          return (\n            <button\n              key={item.id}\n              type=\"button\"\n              disabled={disabled}\n              onClick={() => !disabled && setCurrentView(item.id)}\n              className={`flex flex-col items-center gap-1 py-1.5 rounded-xl transition-all ${disabled ? 'opacity-40 cursor-not-allowed' : 'hover:text-blue-600'} ${isActive ? 'text-blue-600 font-semibold bg-blue-50' : 'text-gray-500'}`}\n            >\n              {item.icon}\n              <span className=\"text-xs\">{item.label}</span>\n            </button>\n          );\n        })}\n      </div>\n    </div>\n  );\n}"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}